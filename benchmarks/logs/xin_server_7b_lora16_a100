For some LLaMA-based models, initializing the fast tokenizer may take a long time. To eliminate the initialization time, consider using 'hf-internal-testing/llama-tokenizer' instead of the original tokenizer.
llama-7b: 12.06 GB
peak working mem for (bs=20, seqlen=512): 0.70 GB
peak working mem for (bs=100, seqlen=512): 3.52 GB
all adapters (101) estimated size: 3.16 GB
avg adapter estimated size: 32.00 MB
INFO:     127.0.0.1:53148 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53164 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53166 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53178 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53186 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53196 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53198 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53212 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53222 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53238 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53248 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53250 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53264 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53272 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53278 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53290 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53298 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53300 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53310 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53320 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53336 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53344 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53346 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53350 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53366 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53376 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53380 - "POST /generate_stream HTTP/1.1" 200 OK
cost load scan: 0.018596649169921875
load 1 adapters, 1 in total
Function load_lora_A took 2.206087112426758 ms to run.
Function load_lora_B took 1.9221305847167969 ms to run.
cost realload: 8.646965026855469
Function load_adapters took 8.674144744873047 ms to run.
Avg tokens(prompt+generate) throughput:   25.260 tokens/s
Avg prompt tokens throughput:             25.260 tokens/s
Avg generate tokens throughput:            0.000 tokens/s
current batch size: 1 token used ratio: 0.005707692307692308
cost load scan: 0.01049041748046875
load 4 adapters, 5 in total
Function load_lora_A took 1.8880367279052734 ms to run.
Function load_lora_B took 1.898050308227539 ms to run.
Function load_lora_A took 1.8887519836425781 ms to run.
Function load_lora_B took 1.8868446350097656 ms to run.
Function load_lora_A took 1.9011497497558594 ms to run.
Function load_lora_B took 1.8587112426757812 ms to run.
Function load_lora_A took 1.8811225891113281 ms to run.
Function load_lora_B took 1.8711090087890625 ms to run.
cost realload: 15.793561935424805
Function load_adapters took 15.818119049072266 ms to run.
cost load scan: 0.009059906005859375
load 2 adapters, 7 in total
Function load_lora_A took 1.9004344940185547 ms to run.
Function load_lora_B took 1.9207000732421875 ms to run.
Function load_lora_A took 1.8625259399414062 ms to run.
Function load_lora_B took 1.859903335571289 ms to run.
cost realload: 8.017778396606445
Function load_adapters took 8.040189743041992 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 8 in total
Function load_lora_A took 1.8768310546875 ms to run.
Function load_lora_B took 1.888275146484375 ms to run.
cost realload: 4.201650619506836
Function load_adapters took 4.226446151733398 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 9 in total
Function load_lora_A took 1.8608570098876953 ms to run.
Function load_lora_B took 1.8913745880126953 ms to run.
cost realload: 4.174232482910156
Function load_adapters took 4.197120666503906 ms to run.
current batch size: 10 token used ratio: 0.039492307692307695
cost load scan: 0.009298324584960938
load 1 adapters, 10 in total
Function load_lora_A took 1.8877983093261719 ms to run.
Function load_lora_B took 1.9104480743408203 ms to run.
cost realload: 4.190921783447266
Function load_adapters took 4.214048385620117 ms to run.
cost load scan: 0.0095367431640625
load 2 adapters, 12 in total
Function load_lora_A took 1.9080638885498047 ms to run.
Function load_lora_B took 1.9156932830810547 ms to run.
Function load_lora_A took 1.8868446350097656 ms to run.
Function load_lora_B took 1.8782615661621094 ms to run.
cost realload: 8.056879043579102
Function load_adapters took 8.07952880859375 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 13 in total
Function load_lora_A took 1.916646957397461 ms to run.
Function load_lora_B took 1.8954277038574219 ms to run.
cost realload: 4.23431396484375
Function load_adapters took 4.258632659912109 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 14 in total
Function load_lora_A took 1.8775463104248047 ms to run.
Function load_lora_B took 1.8782615661621094 ms to run.
cost realload: 4.191160202026367
Function load_adapters took 4.215478897094727 ms to run.
cost load scan: 0.008821487426757812
load 0 adapters, 14 in total
cost realload: 0.30875205993652344
Function load_adapters took 0.3349781036376953 ms to run.
current batch size: 16 token used ratio: 0.07363076923076924
cost load scan: 0.009298324584960938
load 1 adapters, 15 in total
Function load_lora_A took 1.9164085388183594 ms to run.
Function load_lora_B took 1.8932819366455078 ms to run.
cost realload: 4.229545593261719
Function load_adapters took 4.254579544067383 ms to run.
offload 0 adapters, 15 remains
Function offload_adapters took 0.015020370483398438 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 16 in total
Function load_lora_A took 1.903533935546875 ms to run.
Function load_lora_B took 1.88446044921875 ms to run.
cost realload: 4.208087921142578
Function load_adapters took 4.235267639160156 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 17 in total
Function load_lora_A took 1.9061565399169922 ms to run.
Function load_lora_B took 1.870870590209961 ms to run.
cost realload: 4.207849502563477
Function load_adapters took 4.231691360473633 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 18 in total
Function load_lora_A took 1.897573471069336 ms to run.
Function load_lora_B took 1.8854141235351562 ms to run.
cost realload: 4.204511642456055
Function load_adapters took 4.228115081787109 ms to run.
cost offload scan: 0.1571178436279297
offload 1 adapters, 17 remains
cost offload cat: 0.036716461181640625
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 11.688709259033203
Function offload_adapters took 12.249231338500977 ms to run.
current batch size: 18 token used ratio: 0.08987692307692308
cost offload scan: 0.1354217529296875
offload 1 adapters, 16 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11515617370605469
Function offload_adapters took 0.6520748138427734 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 17 in total
Function load_lora_A took 1.8930435180664062 ms to run.
Function load_lora_B took 1.9068717956542969 ms to run.
cost realload: 4.212856292724609
Function load_adapters took 4.235267639160156 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 18 in total
Function load_lora_A took 1.8849372863769531 ms to run.
Function load_lora_B took 1.8849372863769531 ms to run.
cost realload: 4.182577133178711
Function load_adapters took 4.209756851196289 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 18 in total
cost realload: 0.2944469451904297
Function load_adapters took 0.3199577331542969 ms to run.
cost offload scan: 0.14519691467285156
offload 1 adapters, 17 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.644683837890625 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 16 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.049114227294921875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5898475646972656 ms to run.
cost offload scan: 0.08368492126464844
offload 1 adapters, 15 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5867481231689453 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 14 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.57220458984375 ms to run.
current batch size: 16 token used ratio: 0.08875384615384616
offload 0 adapters, 14 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 13 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5843639373779297 ms to run.
cost load scan: 0.010013580322265625
load 2 adapters, 15 in total
Function load_lora_A took 1.9221305847167969 ms to run.
Function load_lora_B took 1.8761157989501953 ms to run.
Function load_lora_A took 1.8897056579589844 ms to run.
Function load_lora_B took 1.8968582153320312 ms to run.
cost realload: 8.072853088378906
Function load_adapters took 8.09931755065918 ms to run.
cost load scan: 0.010013580322265625
load 2 adapters, 17 in total
INFO:     127.0.0.1:53394 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53400 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53416 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53426 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53438 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53448 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53460 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53476 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53490 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53500 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53516 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53518 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53526 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53536 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53550 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53554 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53566 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53568 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53580 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53596 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53600 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44724 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44736 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44744 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44756 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44772 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 1.9180774688720703 ms to run.
Function load_lora_B took 1.9104480743408203 ms to run.
Function load_lora_A took 1.9016265869140625 ms to run.
Function load_lora_B took 1.9083023071289062 ms to run.
cost realload: 8.168220520019531
Function load_adapters took 8.191108703613281 ms to run.
cost offload scan: 0.12445449829101562
offload 2 adapters, 15 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.6330013275146484 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 14 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5779266357421875 ms to run.
current batch size: 15 token used ratio: 0.0806
offload 0 adapters, 14 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 13 remains
cost offload cat: 0.03814697265625
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5984306335449219 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 14 in total
Function load_lora_A took 1.9044876098632812 ms to run.
Function load_lora_B took 1.9245147705078125 ms to run.
cost realload: 4.2591094970703125
Function load_adapters took 4.290580749511719 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 13 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5843639373779297 ms to run.
cost offload scan: 0.08368492126464844
offload 1 adapters, 12 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.583648681640625 ms to run.
cost load scan: 0.011682510375976562
load 6 adapters, 18 in total
Function load_lora_A took 1.895904541015625 ms to run.
Function load_lora_B took 1.9037723541259766 ms to run.
Function load_lora_A took 1.8813610076904297 ms to run.
Function load_lora_B took 1.8925666809082031 ms to run.
Function load_lora_A took 1.8892288208007812 ms to run.
Function load_lora_B took 1.9123554229736328 ms to run.
Function load_lora_A took 1.8687248229980469 ms to run.
Function load_lora_B took 1.8799304962158203 ms to run.
Function load_lora_A took 1.8830299377441406 ms to run.
Function load_lora_B took 1.8756389617919922 ms to run.
Function load_lora_A took 1.9023418426513672 ms to run.
Function load_lora_B took 1.91497802734375 ms to run.
cost realload: 23.433923721313477
Function load_adapters took 23.456096649169922 ms to run.
cost offload scan: 0.12230873107910156
offload 1 adapters, 17 remains
cost offload cat: 0.05269050598144531
cost offload free mem manager: 0.06031990051269531
cost offload torch.empty: 0.030040740966796875
cost offload a_loc update: 0.14257431030273438
Function offload_adapters took 0.81634521484375 ms to run.
cost load scan: 0.0133514404296875
load 2 adapters, 19 in total
Function load_lora_A took 1.91497802734375 ms to run.
Function load_lora_B took 1.8985271453857422 ms to run.
Function load_lora_A took 1.9004344940185547 ms to run.
Function load_lora_B took 1.8744468688964844 ms to run.
cost realload: 8.208274841308594
Function load_adapters took 8.236408233642578 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 18 remains
cost offload cat: 0.03886222839355469
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11920928955078125
Function offload_adapters took 0.6127357482910156 ms to run.
cost offload scan: 0.13113021850585938
offload 1 adapters, 17 remains
cost offload cat: 0.0457763671875
cost offload free mem manager: 0.05340576171875
cost offload torch.empty: 0.028133392333984375
cost offload a_loc update: 0.1327991485595703
Function offload_adapters took 0.7808208465576172 ms to run.
cost load scan: 0.01049041748046875
load 3 adapters, 20 in total
Function load_lora_A took 1.8894672393798828 ms to run.
Function load_lora_B took 1.9025802612304688 ms to run.
Function load_lora_A took 1.8968582153320312 ms to run.
Function load_lora_B took 1.8644332885742188 ms to run.
Function load_lora_A took 1.8916130065917969 ms to run.
Function load_lora_B took 1.9125938415527344 ms to run.
cost realload: 11.983871459960938
Function load_adapters took 12.017488479614258 ms to run.
current batch size: 20 token used ratio: 0.09727692307692308
cost load scan: 0.014543533325195312
load 1 adapters, 21 in total
Function load_lora_A took 1.9414424896240234 ms to run.
Function load_lora_B took 1.8796920776367188 ms to run.
cost realload: 4.418373107910156
Function load_adapters took 4.444360733032227 ms to run.
cost load scan: 0.012159347534179688
load 4 adapters, 25 in total
Function load_lora_A took 1.9359588623046875 ms to run.
Function load_lora_B took 1.8630027770996094 ms to run.
Function load_lora_A took 1.901865005493164 ms to run.
Function load_lora_B took 1.8856525421142578 ms to run.
Function load_lora_A took 1.8916130065917969 ms to run.
Function load_lora_B took 1.8715858459472656 ms to run.
Function load_lora_A took 1.8656253814697266 ms to run.
Function load_lora_B took 1.9021034240722656 ms to run.
cost realload: 15.958070755004883
Function load_adapters took 15.987157821655273 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 26 in total
Function load_lora_A took 1.8987655639648438 ms to run.
Function load_lora_B took 1.8889904022216797 ms to run.
cost realload: 4.277467727661133
Function load_adapters took 4.299640655517578 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 27 in total
Function load_lora_A took 1.898050308227539 ms to run.
Function load_lora_B took 1.8932819366455078 ms to run.
cost realload: 4.306316375732422
Function load_adapters took 4.332065582275391 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 28 in total
Function load_lora_A took 1.9137859344482422 ms to run.
Function load_lora_B took 1.8832683563232422 ms to run.
cost realload: 4.218578338623047
Function load_adapters took 4.240989685058594 ms to run.
current batch size: 28 token used ratio: 0.15416923076923078
cost offload scan: 0.09369850158691406
offload 1 adapters, 27 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.12159347534179688
Function offload_adapters took 0.6210803985595703 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 28 in total
Function load_lora_A took 1.9025802612304688 ms to run.
Function load_lora_B took 1.926422119140625 ms to run.
cost realload: 4.249095916748047
Function load_adapters took 4.272699356079102 ms to run.
cost offload scan: 0.095367431640625
offload 1 adapters, 27 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.6186962127685547 ms to run.
cost load scan: 0.008821487426757812
load 2 adapters, 29 in total
Function load_lora_A took 1.9190311431884766 ms to run.
Function load_lora_B took 1.901865005493164 ms to run.
Function load_lora_A took 1.8734931945800781 ms to run.
Function load_lora_B took 1.9099712371826172 ms to run.
cost realload: 8.098125457763672
Function load_adapters took 8.119583129882812 ms to run.
cost load scan: 0.0095367431640625
load 2 adapters, 31 in total
Function load_lora_A took 1.8603801727294922 ms to run.
Function load_lora_B took 1.8799304962158203 ms to run.
INFO:     127.0.0.1:44778 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44784 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44798 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44810 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44822 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44836 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44846 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44854 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 1.88446044921875 ms to run.
Function load_lora_B took 1.8694400787353516 ms to run.
cost realload: 8.020639419555664
Function load_adapters took 8.042573928833008 ms to run.
Avg tokens(prompt+generate) throughput: 2009.393 tokens/s
Avg prompt tokens throughput:           1377.067 tokens/s
Avg generate tokens throughput:          632.326 tokens/s
cost offload scan: 0.09870529174804688
offload 1 adapters, 30 remains
cost offload cat: 0.0362396240234375
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.024557113647460938
cost offload a_loc update: 0.11897087097167969
Function offload_adapters took 0.6313323974609375 ms to run.
current batch size: 31 token used ratio: 0.1829230769230769
offload 0 adapters, 30 remains
Function offload_adapters took 0.0133514404296875 ms to run.
cost offload scan: 0.09393692016601562
offload 1 adapters, 29 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.6103515625 ms to run.
cost offload scan: 0.09465217590332031
offload 1 adapters, 28 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.6146430969238281 ms to run.
cost offload scan: 0.10037422180175781
offload 1 adapters, 27 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.050067901611328125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11515617370605469
Function offload_adapters took 0.6353855133056641 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 28 in total
Function load_lora_A took 1.895904541015625 ms to run.
Function load_lora_B took 1.8703937530517578 ms to run.
cost realload: 4.191875457763672
Function load_adapters took 4.215478897094727 ms to run.
cost offload scan: 0.10085105895996094
offload 1 adapters, 27 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.614166259765625 ms to run.
cost offload scan: 0.09942054748535156
offload 1 adapters, 26 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.6060600280761719 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 25 remains
cost offload cat: 0.03647804260253906
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.6184577941894531 ms to run.
cost load scan: 0.008821487426757812
load 0 adapters, 25 in total
cost realload: 0.4782676696777344
Function load_adapters took 0.5121231079101562 ms to run.
cost offload scan: 0.10943412780761719
offload 1 adapters, 24 remains
cost offload cat: 0.03838539123535156
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.6420612335205078 ms to run.
cost load scan: 0.01621246337890625
load 1 adapters, 25 in total
Function load_lora_A took 1.943349838256836 ms to run.
Function load_lora_B took 1.9021034240722656 ms to run.
cost realload: 4.33659553527832
Function load_adapters took 4.358768463134766 ms to run.
cost offload scan: 0.095367431640625
offload 1 adapters, 24 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.6155967712402344 ms to run.
current batch size: 25 token used ratio: 0.15076923076923077
cost offload scan: 0.10514259338378906
offload 1 adapters, 23 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11467933654785156
Function offload_adapters took 0.6303787231445312 ms to run.
cost load scan: 0.019311904907226562
load 1 adapters, 24 in total
Function load_lora_A took 1.9114017486572266 ms to run.
Function load_lora_B took 1.9047260284423828 ms to run.
cost realload: 4.7092437744140625
Function load_adapters took 4.730939865112305 ms to run.
offload 0 adapters, 24 remains
Function offload_adapters took 0.014781951904296875 ms to run.
cost offload scan: 0.09632110595703125
offload 1 adapters, 23 remains
cost offload cat: 0.03695487976074219
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.12183189392089844
Function offload_adapters took 0.6542205810546875 ms to run.
cost offload scan: 0.10228157043457031
offload 1 adapters, 22 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.6110668182373047 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 23 in total
Function load_lora_A took 1.9829273223876953 ms to run.
Function load_lora_B took 1.8782615661621094 ms to run.
cost realload: 4.293680191040039
Function load_adapters took 4.3239593505859375 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 22 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11038780212402344
Function offload_adapters took 0.6005764007568359 ms to run.
cost offload scan: 0.102996826171875
offload 1 adapters, 21 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.621795654296875 ms to run.
current batch size: 21 token used ratio: 0.13544615384615386
cost offload scan: 0.0972747802734375
offload 1 adapters, 20 remains
cost offload cat: 0.041961669921875
cost offload free mem manager: 0.04792213439941406
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.12063980102539062
Function offload_adapters took 0.6520748138427734 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 20 in total
cost realload: 0.3647804260253906
Function load_adapters took 0.3886222839355469 ms to run.
cost offload scan: 0.09369850158691406
offload 1 adapters, 19 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.051021575927734375
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.12493133544921875
Function offload_adapters took 0.6361007690429688 ms to run.
cost load scan: 0.02002716064453125
load 1 adapters, 20 in total
Function load_lora_A took 1.94549560546875 ms to run.
Function load_lora_B took 1.8792152404785156 ms to run.
cost realload: 4.280567169189453
Function load_adapters took 4.303455352783203 ms to run.
cost offload scan: 0.09799003601074219
offload 1 adapters, 19 remains
cost offload cat: 0.041484832763671875
cost offload free mem manager: 0.050067901611328125
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.1220703125
Function offload_adapters took 0.6601810455322266 ms to run.
cost offload scan: 0.09751319885253906
offload 1 adapters, 18 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.6136894226074219 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 19 in total
Function load_lora_A took 1.9385814666748047 ms to run.
Function load_lora_B took 1.9106864929199219 ms to run.
INFO:     127.0.0.1:44866 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44868 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44874 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44880 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44896 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44906 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44912 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44926 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44940 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44942 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44954 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44958 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44972 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44976 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44988 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44990 - "POST /generate_stream HTTP/1.1" 200 OK
cost realload: 4.336357116699219
Function load_adapters took 4.407167434692383 ms to run.
current batch size: 19 token used ratio: 0.1252
cost offload scan: 0.10967254638671875
offload 1 adapters, 18 remains
cost offload cat: 0.03981590270996094
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11444091796875
Function offload_adapters took 0.6589889526367188 ms to run.
cost offload scan: 0.15211105346679688
offload 2 adapters, 16 remains
cost offload cat: 0.44846534729003906
cost offload free mem manager: 0.06365776062011719
cost offload torch.empty: 0.025510787963867188
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 1.1227130889892578 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 15 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5893707275390625 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 14 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.029802322387695312
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5984306335449219 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 13 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.6003379821777344 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 12 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5998611450195312 ms to run.
cost load scan: 0.019073486328125
load 1 adapters, 13 in total
Function load_lora_A took 1.9378662109375 ms to run.
Function load_lora_B took 1.9168853759765625 ms to run.
cost realload: 4.340648651123047
Function load_adapters took 4.363775253295898 ms to run.
current batch size: 13 token used ratio: 0.084
cost offload scan: 0.08678436279296875
offload 1 adapters, 12 remains
cost offload cat: 0.03600120544433594
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.60272216796875 ms to run.
cost load scan: 0.015020370483398438
load 2 adapters, 14 in total
Function load_lora_A took 1.9276142120361328 ms to run.
Function load_lora_B took 1.8894672393798828 ms to run.
Function load_lora_A took 1.9075870513916016 ms to run.
Function load_lora_B took 1.8768310546875 ms to run.
cost realload: 8.116483688354492
Function load_adapters took 8.147716522216797 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 15 in total
Function load_lora_A took 1.9028186798095703 ms to run.
Function load_lora_B took 1.9099712371826172 ms to run.
cost realload: 4.21905517578125
Function load_adapters took 4.240512847900391 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 16 in total
Function load_lora_A took 1.9118785858154297 ms to run.
Function load_lora_B took 1.9011497497558594 ms to run.
cost realload: 4.236936569213867
Function load_adapters took 4.258632659912109 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 17 in total
Function load_lora_A took 1.895904541015625 ms to run.
Function load_lora_B took 1.8930435180664062 ms to run.
cost realload: 4.201173782348633
Function load_adapters took 4.228830337524414 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 16 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.5967617034912109 ms to run.
current batch size: 16 token used ratio: 0.09378461538461538
cost offload scan: 0.09512901306152344
offload 1 adapters, 15 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.6124973297119141 ms to run.
cost load scan: 0.014543533325195312
load 2 adapters, 17 in total
Function load_lora_A took 1.8932819366455078 ms to run.
Function load_lora_B took 1.8837451934814453 ms to run.
Function load_lora_A took 1.903533935546875 ms to run.
Function load_lora_B took 1.9085407257080078 ms to run.
cost realload: 8.072376251220703
Function load_adapters took 8.094310760498047 ms to run.
cost offload scan: 0.091552734375
offload 1 adapters, 16 remains
cost offload cat: 0.04220008850097656
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.11038780212402344
Function offload_adapters took 0.614166259765625 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 15 remains
cost offload cat: 0.03790855407714844
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5948543548583984 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 16 in total
Function load_lora_A took 1.8870830535888672 ms to run.
Function load_lora_B took 1.9059181213378906 ms to run.
cost realload: 4.230022430419922
Function load_adapters took 4.252195358276367 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 15 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5795955657958984 ms to run.
offload 0 adapters, 15 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 14 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5767345428466797 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 15 in total
Function load_lora_A took 1.9369125366210938 ms to run.
Function load_lora_B took 1.8935203552246094 ms to run.
cost realload: 4.256725311279297
Function load_adapters took 4.277706146240234 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 14 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11873245239257812
Function offload_adapters took 0.6074905395507812 ms to run.
current batch size: 15 token used ratio: 0.07718461538461538
cost load scan: 0.00858306884765625
load 1 adapters, 15 in total
Function load_lora_A took 1.9288063049316406 ms to run.
Function load_lora_B took 1.9092559814453125 ms to run.
cost realload: 4.2934417724609375
Function load_adapters took 4.315376281738281 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 16 in total
Function load_lora_A took 1.9271373748779297 ms to run.
Function load_lora_B took 1.8947124481201172 ms to run.
cost realload: 4.252910614013672
Function load_adapters took 4.277467727661133 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 17 in total
Function load_lora_A took 1.911163330078125 ms to run.
Function load_lora_B took 1.8780231475830078 ms to run.
cost realload: 4.201650619506836
Function load_adapters took 4.22358512878418 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 16 remains
cost offload cat: 0.03695487976074219
cost offload free mem manager: 0.049114227294921875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11372566223144531
INFO:     127.0.0.1:44996 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45012 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45026 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45028 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41604 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41606 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41618 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41630 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41636 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41646 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41660 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41662 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41668 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41676 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41690 - "POST /generate_stream HTTP/1.1" 200 OK
Function offload_adapters took 0.6172657012939453 ms to run.
current batch size: 17 token used ratio: 0.09226153846153846
cost offload scan: 0.091552734375
offload 1 adapters, 15 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.6077289581298828 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 15 in total
cost realload: 0.3387928009033203
Function load_adapters took 0.3654956817626953 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 16 in total
Function load_lora_A took 1.8916130065917969 ms to run.
Function load_lora_B took 1.8792152404785156 ms to run.
cost realload: 4.200458526611328
Function load_adapters took 4.225730895996094 ms to run.
cost load scan: 0.012159347534179688
load 2 adapters, 18 in total
Function load_lora_A took 1.8961429595947266 ms to run.
Function load_lora_B took 1.9006729125976562 ms to run.
Function load_lora_A took 1.8939971923828125 ms to run.
Function load_lora_B took 1.8677711486816406 ms to run.
cost realload: 8.046627044677734
Function load_adapters took 8.069515228271484 ms to run.
cost load scan: 0.02002716064453125
load 2 adapters, 20 in total
Function load_lora_A took 1.8916130065917969 ms to run.
Function load_lora_B took 1.8892288208007812 ms to run.
Function load_lora_A took 1.8930435180664062 ms to run.
Function load_lora_B took 1.9211769104003906 ms to run.
cost realload: 8.127450942993164
Function load_adapters took 8.149862289428711 ms to run.
current batch size: 23 token used ratio: 0.12873846153846155
cost offload scan: 0.09679794311523438
offload 1 adapters, 19 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.057697296142578125
cost offload torch.empty: 0.034332275390625
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.6506443023681641 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 18 remains
cost offload cat: 0.039577484130859375
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.6427764892578125 ms to run.
Avg tokens(prompt+generate) throughput: 1544.962 tokens/s
Avg prompt tokens throughput:            758.349 tokens/s
Avg generate tokens throughput:          786.613 tokens/s
cost offload scan: 0.09894371032714844
offload 1 adapters, 17 remains
cost offload cat: 0.04076957702636719
cost offload free mem manager: 0.04839897155761719
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11610984802246094
Function offload_adapters took 0.6754398345947266 ms to run.
cost offload scan: 0.09679794311523438
offload 1 adapters, 16 remains
cost offload cat: 0.042438507080078125
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.6422996520996094 ms to run.
current batch size: 18 token used ratio: 0.10604615384615385
cost load scan: 0.011444091796875
load 1 adapters, 17 in total
Function load_lora_A took 1.924753189086914 ms to run.
Function load_lora_B took 1.9087791442871094 ms to run.
cost realload: 4.307746887207031
Function load_adapters took 4.330873489379883 ms to run.
offload 0 adapters, 17 remains
Function offload_adapters took 0.017404556274414062 ms to run.
offload 0 adapters, 17 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 16 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.12063980102539062
Function offload_adapters took 0.6167888641357422 ms to run.
cost load scan: 0.0152587890625
load 1 adapters, 17 in total
Function load_lora_A took 1.889944076538086 ms to run.
Function load_lora_B took 1.8887519836425781 ms to run.
cost realload: 4.206418991088867
Function load_adapters took 4.228353500366211 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 16 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.579833984375 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 17 in total
Function load_lora_A took 1.9087791442871094 ms to run.
Function load_lora_B took 1.9047260284423828 ms to run.
cost realload: 4.222869873046875
Function load_adapters took 4.247426986694336 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 16 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5877017974853516 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 16 in total
cost realload: 0.2989768981933594
Function load_adapters took 0.3256797790527344 ms to run.
current batch size: 17 token used ratio: 0.09721538461538462
cost load scan: 0.0133514404296875
load 2 adapters, 18 in total
Function load_lora_A took 1.886129379272461 ms to run.
Function load_lora_B took 1.8944740295410156 ms to run.
Function load_lora_A took 1.8839836120605469 ms to run.
Function load_lora_B took 1.8646717071533203 ms to run.
cost realload: 8.014678955078125
Function load_adapters took 8.036613464355469 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 17 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.6077289581298828 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 16 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5819797515869141 ms to run.
offload 0 adapters, 16 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 15 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5922317504882812 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 14 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.13518333435058594
Function offload_adapters took 0.6330013275146484 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 15 in total
Function load_lora_A took 1.9118785858154297 ms to run.
Function load_lora_B took 1.9249916076660156 ms to run.
cost realload: 4.240512847900391
Function load_adapters took 4.261493682861328 ms to run.
cost offload scan: 0.09679794311523438
offload 1 adapters, 14 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5888938903808594 ms to run.
current batch size: 14 token used ratio: 0.08181538461538461
cost load scan: 0.007867813110351562
load 0 adapters, 14 in total
cost realload: 0.28586387634277344
Function load_adapters took 0.3097057342529297 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 13 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5886554718017578 ms to run.
offload 0 adapters, 13 remains
INFO:     127.0.0.1:41698 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41708 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41712 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41714 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41730 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41738 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41740 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41756 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41766 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41780 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41790 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41804 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41816 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41832 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41840 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41852 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41854 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41866 - "POST /generate_stream HTTP/1.1" 200 OK
Function offload_adapters took 0.011920928955078125 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 14 in total
Function load_lora_A took 1.9078254699707031 ms to run.
Function load_lora_B took 1.8987655639648438 ms to run.
cost realload: 4.234790802001953
Function load_adapters took 4.256725311279297 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 13 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5896091461181641 ms to run.
cost load scan: 0.011682510375976562
load 2 adapters, 15 in total
Function load_lora_A took 1.91497802734375 ms to run.
Function load_lora_B took 1.8994808197021484 ms to run.
Function load_lora_A took 1.8913745880126953 ms to run.
Function load_lora_B took 1.8930435180664062 ms to run.
cost realload: 8.080005645751953
Function load_adapters took 8.101940155029297 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 14 remains
cost offload cat: 0.041961669921875
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5915164947509766 ms to run.
cost load scan: 0.011682510375976562
load 2 adapters, 16 in total
Function load_lora_A took 1.9259452819824219 ms to run.
Function load_lora_B took 1.920461654663086 ms to run.
Function load_lora_A took 1.8804073333740234 ms to run.
Function load_lora_B took 1.9004344940185547 ms to run.
cost realload: 8.106708526611328
Function load_adapters took 8.129119873046875 ms to run.
cost load scan: 0.01239776611328125
load 2 adapters, 18 in total
Function load_lora_A took 1.8982887268066406 ms to run.
Function load_lora_B took 1.8808841705322266 ms to run.
Function load_lora_A took 1.8913745880126953 ms to run.
Function load_lora_B took 1.9311904907226562 ms to run.
cost realload: 8.10098648071289
Function load_adapters took 8.122444152832031 ms to run.
current batch size: 18 token used ratio: 0.09598461538461539
cost offload scan: 0.08797645568847656
offload 1 adapters, 17 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5819797515869141 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 18 in total
Function load_lora_A took 1.9299983978271484 ms to run.
Function load_lora_B took 1.8715858459472656 ms to run.
cost realload: 4.219770431518555
Function load_adapters took 4.240751266479492 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 17 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.0553131103515625
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5981922149658203 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 18 in total
Function load_lora_A took 1.8892288208007812 ms to run.
Function load_lora_B took 1.9140243530273438 ms to run.
cost realload: 4.20689582824707
Function load_adapters took 4.228115081787109 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 17 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5877017974853516 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 16 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.12612342834472656
Function offload_adapters took 0.6296634674072266 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 17 in total
Function load_lora_A took 1.8739700317382812 ms to run.
Function load_lora_B took 1.897573471069336 ms to run.
cost realload: 4.17637825012207
Function load_adapters took 4.199028015136719 ms to run.
current batch size: 17 token used ratio: 0.09383076923076923
cost offload scan: 0.08535385131835938
offload 1 adapters, 16 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5943775177001953 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 17 in total
Function load_lora_A took 1.894235610961914 ms to run.
Function load_lora_B took 1.9137859344482422 ms to run.
cost realload: 4.205465316772461
Function load_adapters took 4.225730895996094 ms to run.
cost load scan: 0.01239776611328125
load 2 adapters, 19 in total
Function load_lora_A took 1.9042491912841797 ms to run.
Function load_lora_B took 1.8887519836425781 ms to run.
Function load_lora_A took 1.89208984375 ms to run.
Function load_lora_B took 1.89971923828125 ms to run.
cost realload: 8.065223693847656
Function load_adapters took 8.089542388916016 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 20 in total
Function load_lora_A took 1.8944740295410156 ms to run.
Function load_lora_B took 1.8787384033203125 ms to run.
cost realload: 4.185914993286133
Function load_adapters took 4.207849502563477 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 19 remains
cost offload cat: 0.035762786865234375
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.1163482666015625
Function offload_adapters took 0.6155967712402344 ms to run.
current batch size: 21 token used ratio: 0.12030769230769231
cost load scan: 0.011205673217773438
load 1 adapters, 20 in total
Function load_lora_A took 1.9414424896240234 ms to run.
Function load_lora_B took 1.9023418426513672 ms to run.
cost realload: 4.268884658813477
Function load_adapters took 4.291296005249023 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 19 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.6005764007568359 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 20 in total
Function load_lora_A took 1.9092559814453125 ms to run.
Function load_lora_B took 1.9178390502929688 ms to run.
cost realload: 4.249095916748047
Function load_adapters took 4.276275634765625 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 19 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.05412101745605469
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.6000995635986328 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 20 in total
Function load_lora_A took 1.8889904022216797 ms to run.
Function load_lora_B took 1.9123554229736328 ms to run.
cost realload: 4.244565963745117
Function load_adapters took 4.269123077392578 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 19 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04935264587402344
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.6124973297119141 ms to run.
current batch size: 21 token used ratio: 0.12556923076923077
offload 0 adapters, 19 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 18 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5924701690673828 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 17 remains
cost offload cat: 0.03147125244140625
INFO:     127.0.0.1:41876 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41878 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41888 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53114 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53118 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53128 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53130 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53144 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53158 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53174 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53178 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53190 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53204 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53206 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53210 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53218 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53234 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.0247955322265625
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.6468296051025391 ms to run.
cost load scan: 0.013828277587890625
load 2 adapters, 19 in total
Function load_lora_A took 1.8768310546875 ms to run.
Function load_lora_B took 1.8727779388427734 ms to run.
Function load_lora_A took 1.8990039825439453 ms to run.
Function load_lora_B took 1.8939971923828125 ms to run.
cost realload: 8.025884628295898
Function load_adapters took 8.047819137573242 ms to run.
cost offload scan: 0.12564659118652344
offload 2 adapters, 17 remains
cost offload cat: 0.025033950805664062
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.6213188171386719 ms to run.
current batch size: 18 token used ratio: 0.11564615384615384
offload 0 adapters, 17 remains
Function offload_adapters took 0.0133514404296875 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 16 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.5979537963867188 ms to run.
cost offload scan: 0.09584426879882812
offload 1 adapters, 15 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.6177425384521484 ms to run.
cost load scan: 0.009775161743164062
load 1 adapters, 16 in total
Function load_lora_A took 1.9044876098632812 ms to run.
Function load_lora_B took 1.8658638000488281 ms to run.
cost realload: 4.189252853393555
Function load_adapters took 4.217624664306641 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 15 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5834102630615234 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 14 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.6051063537597656 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 15 in total
Function load_lora_A took 1.9121170043945312 ms to run.
Function load_lora_B took 1.9083023071289062 ms to run.
cost realload: 4.2285919189453125
Function load_adapters took 4.251003265380859 ms to run.
cost offload scan: 0.10013580322265625
offload 1 adapters, 14 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.6029605865478516 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 14 in total
cost realload: 0.2956390380859375
Function load_adapters took 0.3204345703125 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 13 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5917549133300781 ms to run.
cost offload scan: 0.13256072998046875
offload 2 adapters, 11 remains
cost offload cat: 0.025033950805664062
cost offload free mem manager: 0.0476837158203125
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.6334781646728516 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 10 remains
cost offload cat: 0.03910064697265625
cost offload free mem manager: 0.052928924560546875
cost offload torch.empty: 0.03170967102050781
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.6761550903320312 ms to run.
current batch size: 11 token used ratio: 0.06667692307692308
Avg tokens(prompt+generate) throughput: 1564.345 tokens/s
Avg prompt tokens throughput:            843.339 tokens/s
Avg generate tokens throughput:          721.006 tokens/s
cost load scan: 0.01049041748046875
load 1 adapters, 11 in total
Function load_lora_A took 1.9078254699707031 ms to run.
Function load_lora_B took 1.9421577453613281 ms to run.
cost realload: 4.27556037902832
Function load_adapters took 4.297494888305664 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 11 in total
cost realload: 0.29206275939941406
Function load_adapters took 0.31685829162597656 ms to run.
cost load scan: 0.01239776611328125
load 1 adapters, 12 in total
Function load_lora_A took 1.8970966339111328 ms to run.
Function load_lora_B took 1.9321441650390625 ms to run.
cost realload: 4.246950149536133
Function load_adapters took 4.268884658813477 ms to run.
offload 0 adapters, 12 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 11 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5838871002197266 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 10 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5893707275390625 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 11 in total
Function load_lora_A took 1.8863677978515625 ms to run.
Function load_lora_B took 1.9114017486572266 ms to run.
cost realload: 4.207611083984375
Function load_adapters took 4.230022430419922 ms to run.
cost offload scan: 0.09679794311523438
offload 1 adapters, 10 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5931854248046875 ms to run.
current batch size: 11 token used ratio: 0.06107692307692308
cost load scan: 0.013828277587890625
load 1 adapters, 11 in total
Function load_lora_A took 1.9142627716064453 ms to run.
Function load_lora_B took 1.9173622131347656 ms to run.
cost realload: 4.258632659912109
Function load_adapters took 4.284143447875977 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 11 in total
cost realload: 0.29850006103515625
Function load_adapters took 0.3230571746826172 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 10 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5834102630615234 ms to run.
cost load scan: 0.015020370483398438
load 0 adapters, 10 in total
cost realload: 0.31375885009765625
Function load_adapters took 0.3409385681152344 ms to run.
cost load scan: 0.009298324584960938
load 3 adapters, 13 in total
Function load_lora_A took 1.9068717956542969 ms to run.
Function load_lora_B took 1.9001960754394531 ms to run.
Function load_lora_A took 1.8825531005859375 ms to run.
Function load_lora_B took 1.9164085388183594 ms to run.
Function load_lora_A took 1.889944076538086 ms to run.
Function load_lora_B took 1.8775463104248047 ms to run.
cost realload: 11.937618255615234
Function load_adapters took 11.960268020629883 ms to run.
current batch size: 17 token used ratio: 0.08887692307692308
cost offload scan: 0.08702278137207031
offload 1 adapters, 12 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: INFO:     127.0.0.1:53238 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53254 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53264 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53280 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53282 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53296 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53308 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53318 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53320 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53334 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53336 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53348 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53350 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53354 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53362 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53372 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53376 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53380 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53384 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53386 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53398 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53402 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53406 - "POST /generate_stream HTTP/1.1" 200 OK
0.023126602172851562
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.6186962127685547 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 13 in total
Function load_lora_A took 1.8765926361083984 ms to run.
Function load_lora_B took 1.878976821899414 ms to run.
cost realload: 4.15802001953125
Function load_adapters took 4.179716110229492 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 12 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5853176116943359 ms to run.
offload 0 adapters, 12 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 13 in total
Function load_lora_A took 1.9075870513916016 ms to run.
Function load_lora_B took 1.8734931945800781 ms to run.
cost realload: 4.1904449462890625
Function load_adapters took 4.212379455566406 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 12 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.5958080291748047 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 13 in total
Function load_lora_A took 1.9032955169677734 ms to run.
Function load_lora_B took 1.9292831420898438 ms to run.
cost realload: 4.233598709106445
Function load_adapters took 4.256010055541992 ms to run.
cost load scan: 0.010013580322265625
load 2 adapters, 15 in total
Function load_lora_A took 1.9037723541259766 ms to run.
Function load_lora_B took 1.9156932830810547 ms to run.
Function load_lora_A took 1.8947124481201172 ms to run.
Function load_lora_B took 1.886129379272461 ms to run.
cost realload: 8.089303970336914
Function load_adapters took 8.111715316772461 ms to run.
current batch size: 18 token used ratio: 0.0892
cost offload scan: 0.087738037109375
offload 1 adapters, 14 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5970001220703125 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 14 in total
cost realload: 0.3032684326171875
Function load_adapters took 0.3275871276855469 ms to run.
offload 0 adapters, 14 remains
Function offload_adapters took 0.013113021850585938 ms to run.
offload 0 adapters, 14 remains
Function offload_adapters took 0.012874603271484375 ms to run.
current batch size: 16 token used ratio: 0.08595384615384616
cost load scan: 0.007867813110351562
load 0 adapters, 14 in total
cost realload: 0.29087066650390625
Function load_adapters took 0.31638145446777344 ms to run.
offload 0 adapters, 14 remains
Function offload_adapters took 0.0133514404296875 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 15 in total
Function load_lora_A took 1.9268989562988281 ms to run.
Function load_lora_B took 1.875162124633789 ms to run.
cost realload: 4.204988479614258
Function load_adapters took 4.2266845703125 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 14 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5903244018554688 ms to run.
cost load scan: 0.012874603271484375
load 2 adapters, 16 in total
Function load_lora_A took 1.8930435180664062 ms to run.
Function load_lora_B took 1.8897056579589844 ms to run.
Function load_lora_A took 1.8830299377441406 ms to run.
Function load_lora_B took 1.8908977508544922 ms to run.
cost realload: 8.037328720092773
Function load_adapters took 8.061647415161133 ms to run.
current batch size: 18 token used ratio: 0.0992923076923077
cost load scan: 0.007867813110351562
load 0 adapters, 16 in total
cost realload: 0.2930164337158203
Function load_adapters took 0.3230571746826172 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 17 in total
Function load_lora_A took 1.9073486328125 ms to run.
Function load_lora_B took 1.9087791442871094 ms to run.
cost realload: 4.218101501464844
Function load_adapters took 4.24504280090332 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 16 remains
cost offload cat: 0.03600120544433594
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.6089210510253906 ms to run.
cost offload scan: 0.09703636169433594
offload 1 adapters, 15 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5955696105957031 ms to run.
cost load scan: 0.01430511474609375
load 2 adapters, 17 in total
Function load_lora_A took 1.9102096557617188 ms to run.
Function load_lora_B took 1.8930435180664062 ms to run.
Function load_lora_A took 1.893758773803711 ms to run.
Function load_lora_B took 1.89208984375 ms to run.
cost realload: 8.089542388916016
Function load_adapters took 8.115053176879883 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 18 in total
Function load_lora_A took 1.8870830535888672 ms to run.
Function load_lora_B took 1.8732547760009766 ms to run.
cost realload: 4.171848297119141
Function load_adapters took 4.1942596435546875 ms to run.
current batch size: 21 token used ratio: 0.1208
cost load scan: 0.011205673217773438
load 1 adapters, 19 in total
Function load_lora_A took 1.9028186798095703 ms to run.
Function load_lora_B took 1.9023418426513672 ms to run.
cost realload: 4.220485687255859
Function load_adapters took 4.242420196533203 ms to run.
cost offload scan: 0.09489059448242188
offload 1 adapters, 18 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.6031990051269531 ms to run.
cost offload scan: 0.13065338134765625
offload 2 adapters, 16 remains
cost offload cat: 0.0247955322265625
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.6291866302490234 ms to run.
cost load scan: 0.012636184692382812
load 3 adapters, 19 in total
Function load_lora_A took 1.8777847290039062 ms to run.
Function load_lora_B took 1.9407272338867188 ms to run.
Function load_lora_A took 1.8835067749023438 ms to run.
Function load_lora_B took 1.928091049194336 ms to run.
Function load_lora_A took 1.9207000732421875 ms to run.
Function load_lora_B took 1.9016265869140625 ms to run.
cost realload: 12.020587921142578
Function load_adapters took 12.043476104736328 ms to run.
cost offload scan: 0.09417533874511719
offload 1 adapters, 18 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5958080291748047 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.011205673217773438
load 3 adapters, 21 in total
Function load_lora_A took 1.8699169158935547 ms to run.
Function load_lora_B took 1.894235610961914 ms to run.
Function load_lora_A took 1.9202232360839844 ms to run.
Function load_lora_B took 1.9066333770751953 ms to run.
Function load_lora_A took 1.8880367279052734 ms to run.
Function load_lora_B took 1.867532730102539 ms to run.
cost realload: 11.902570724487305
Function load_adapters took 11.925458908081055 ms to run.
cost load scan: 0.013589859008789062
load 2 adapters, 23 in total
INFO:     127.0.0.1:53412 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53420 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53424 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53430 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53444 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53446 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53462 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53470 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58698 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58704 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58718 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58728 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58730 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58734 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 1.909017562866211 ms to run.
Function load_lora_B took 1.8935203552246094 ms to run.
Function load_lora_A took 1.8944740295410156 ms to run.
Function load_lora_B took 1.8944740295410156 ms to run.
cost realload: 8.105039596557617
Function load_adapters took 8.127212524414062 ms to run.
cost offload scan: 0.09751319885253906
offload 1 adapters, 22 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5979537963867188 ms to run.
cost offload scan: 0.095367431640625
offload 1 adapters, 21 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5991458892822266 ms to run.
current batch size: 22 token used ratio: 0.1166
cost load scan: 0.015020370483398438
load 4 adapters, 25 in total
Function load_lora_A took 1.9042491912841797 ms to run.
Function load_lora_B took 1.8928050994873047 ms to run.
Function load_lora_A took 1.9063949584960938 ms to run.
Function load_lora_B took 1.9254684448242188 ms to run.
Function load_lora_A took 1.9104480743408203 ms to run.
Function load_lora_B took 1.8727779388427734 ms to run.
Function load_lora_A took 1.8763542175292969 ms to run.
Function load_lora_B took 1.9335746765136719 ms to run.
cost realload: 15.851020812988281
Function load_adapters took 15.872478485107422 ms to run.
offload 0 adapters, 25 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.01239776611328125
load 1 adapters, 26 in total
Function load_lora_A took 1.8963813781738281 ms to run.
Function load_lora_B took 1.9276142120361328 ms to run.
cost realload: 4.233837127685547
Function load_adapters took 4.255771636962891 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 27 in total
Function load_lora_A took 1.9156932830810547 ms to run.
Function load_lora_B took 1.9326210021972656 ms to run.
cost realload: 4.246950149536133
Function load_adapters took 4.270076751708984 ms to run.
cost load scan: 0.012874603271484375
load 2 adapters, 29 in total
Function load_lora_A took 1.9109249114990234 ms to run.
Function load_lora_B took 1.9030570983886719 ms to run.
Function load_lora_A took 1.8863677978515625 ms to run.
Function load_lora_B took 1.8873214721679688 ms to run.
cost realload: 8.074522018432617
Function load_adapters took 8.098602294921875 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 29 in total
cost realload: 0.2961158752441406
Function load_adapters took 0.3209114074707031 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 28 remains
cost offload cat: 0.04267692565917969
cost offload free mem manager: 0.04744529724121094
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.6144046783447266 ms to run.
current batch size: 29 token used ratio: 0.16095384615384614
cost offload scan: 0.09322166442871094
offload 1 adapters, 27 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11682510375976562
Function offload_adapters took 0.6058216094970703 ms to run.
cost offload scan: 0.09441375732421875
offload 1 adapters, 26 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.6046295166015625 ms to run.
cost offload scan: 0.09393692016601562
offload 1 adapters, 25 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.5953311920166016 ms to run.
cost offload scan: 0.11038780212402344
offload 1 adapters, 24 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.6206035614013672 ms to run.
cost load scan: 0.01239776611328125
load 1 adapters, 25 in total
Function load_lora_A took 1.9252300262451172 ms to run.
Function load_lora_B took 1.9040107727050781 ms to run.
cost realload: 4.223823547363281
Function load_adapters took 4.244804382324219 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 24 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5893707275390625 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 24 in total
cost realload: 0.2884864807128906
Function load_adapters took 0.31304359436035156 ms to run.
Avg tokens(prompt+generate) throughput: 1895.454 tokens/s
Avg prompt tokens throughput:           1178.912 tokens/s
Avg generate tokens throughput:          716.542 tokens/s
cost load scan: 0.009059906005859375
load 1 adapters, 25 in total
Function load_lora_A took 1.9159317016601562 ms to run.
Function load_lora_B took 1.8897056579589844 ms to run.
cost realload: 4.223346710205078
Function load_adapters took 4.2476654052734375 ms to run.
cost offload scan: 0.1285076141357422
offload 2 adapters, 23 remains
cost offload cat: 0.027418136596679688
cost offload free mem manager: 0.051021575927734375
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.63323974609375 ms to run.
cost offload scan: 0.10538101196289062
offload 1 adapters, 22 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.621795654296875 ms to run.
current batch size: 24 token used ratio: 0.14016923076923077
cost offload scan: 0.09179115295410156
offload 1 adapters, 21 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.5948543548583984 ms to run.
cost offload scan: 0.09465217590332031
offload 1 adapters, 20 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5896091461181641 ms to run.
cost offload scan: 0.09799003601074219
offload 1 adapters, 19 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5919933319091797 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 19 in total
cost realload: 0.3123283386230469
Function load_adapters took 0.33736228942871094 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 18 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5936622619628906 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 17 remains
cost offload cat: 0.0438690185546875
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.6022453308105469 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 18 in total
Function load_lora_A took 1.8813610076904297 ms to run.
Function load_lora_B took 1.909494400024414 ms to run.
cost realload: 4.192113876342773
INFO:     127.0.0.1:58746 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58762 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58770 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58782 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58784 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58790 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58806 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58816 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58818 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58820 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58836 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58846 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58860 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58874 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58884 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_adapters took 4.240751266479492 ms to run.
cost offload scan: 0.12373924255371094
offload 2 adapters, 16 remains
cost offload cat: 0.024557113647460938
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.6170272827148438 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 17 in total
Function load_lora_A took 1.8880367279052734 ms to run.
Function load_lora_B took 1.9004344940185547 ms to run.
cost realload: 4.1942596435546875
Function load_adapters took 4.216909408569336 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 16 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.591278076171875 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 17 in total
Function load_lora_A took 1.9040107727050781 ms to run.
Function load_lora_B took 1.8839836120605469 ms to run.
cost realload: 4.193544387817383
Function load_adapters took 4.216909408569336 ms to run.
current batch size: 20 token used ratio: 0.11746153846153846
cost load scan: 0.0095367431640625
load 3 adapters, 20 in total
Function load_lora_A took 1.9125938415527344 ms to run.
Function load_lora_B took 1.888275146484375 ms to run.
Function load_lora_A took 1.8875598907470703 ms to run.
Function load_lora_B took 1.911163330078125 ms to run.
Function load_lora_A took 1.8775463104248047 ms to run.
Function load_lora_B took 1.9004344940185547 ms to run.
cost realload: 11.927127838134766
Function load_adapters took 11.951208114624023 ms to run.
cost load scan: 0.01430511474609375
load 1 adapters, 21 in total
Function load_lora_A took 1.8870830535888672 ms to run.
Function load_lora_B took 1.9011497497558594 ms to run.
cost realload: 4.195690155029297
Function load_adapters took 4.218339920043945 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 20 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.6010532379150391 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 19 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5886554718017578 ms to run.
current batch size: 21 token used ratio: 0.1325076923076923
cost offload scan: 0.08893013000488281
offload 1 adapters, 18 remains
cost offload cat: 0.03886222839355469
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5993843078613281 ms to run.
cost offload scan: 0.091552734375
offload 1 adapters, 17 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.6079673767089844 ms to run.
cost offload scan: 0.08559226989746094
offload 1 adapters, 16 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5877017974853516 ms to run.
offload 0 adapters, 16 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 17 in total
Function load_lora_A took 1.9061565399169922 ms to run.
Function load_lora_B took 1.8811225891113281 ms to run.
cost realload: 4.207134246826172
Function load_adapters took 4.233360290527344 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 16 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5838871002197266 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 17 in total
Function load_lora_A took 1.890420913696289 ms to run.
Function load_lora_B took 1.9178390502929688 ms to run.
cost realload: 4.209280014038086
Function load_adapters took 4.23121452331543 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 18 in total
Function load_lora_A took 1.9297599792480469 ms to run.
Function load_lora_B took 1.8792152404785156 ms to run.
cost realload: 4.215478897094727
Function load_adapters took 4.237651824951172 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 17 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5972385406494141 ms to run.
current batch size: 18 token used ratio: 0.11016923076923077
cost offload scan: 0.09107589721679688
offload 1 adapters, 16 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11038780212402344
Function offload_adapters took 0.5917549133300781 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 17 in total
Function load_lora_A took 1.8832683563232422 ms to run.
Function load_lora_B took 1.889944076538086 ms to run.
cost realload: 4.172325134277344
Function load_adapters took 4.192829132080078 ms to run.
cost load scan: 0.011920928955078125
load 2 adapters, 19 in total
Function load_lora_A took 1.9164085388183594 ms to run.
Function load_lora_B took 1.8477439880371094 ms to run.
Function load_lora_A took 1.8801689147949219 ms to run.
Function load_lora_B took 1.8782615661621094 ms to run.
cost realload: 8.008241653442383
Function load_adapters took 8.029937744140625 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 20 in total
Function load_lora_A took 1.9087791442871094 ms to run.
Function load_lora_B took 1.890420913696289 ms to run.
cost realload: 4.204988479614258
Function load_adapters took 4.226922988891602 ms to run.
cost offload scan: 0.09584426879882812
offload 1 adapters, 19 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5991458892822266 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 18 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.05173683166503906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5950927734375 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 19 in total
Function load_lora_A took 1.909494400024414 ms to run.
Function load_lora_B took 1.8985271453857422 ms to run.
cost realload: 4.202127456665039
Function load_adapters took 4.223108291625977 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 18 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5838871002197266 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 19 in total
Function load_lora_A took 1.8897056579589844 ms to run.
Function load_lora_B took 1.8911361694335938 ms to run.
cost realload: 4.179477691650391
Function load_adapters took 4.20069694519043 ms to run.
current batch size: 20 token used ratio: 0.11644615384615385
cost offload scan: 0.09870529174804688
offload 1 adapters, 18 remains
cost offload cat: 0.03170967102050781
INFO:     127.0.0.1:58898 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58906 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58916 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58928 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58932 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58938 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58948 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58964 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58968 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58980 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58996 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59000 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59012 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59018 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59032 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload free mem manager: 0.047206878662109375
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.6263256072998047 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 19 in total
Function load_lora_A took 1.8923282623291016 ms to run.
Function load_lora_B took 1.8725395202636719 ms to run.
cost realload: 4.174232482910156
Function load_adapters took 4.1961669921875 ms to run.
cost load scan: 0.010251998901367188
load 4 adapters, 23 in total
Function load_lora_A took 1.8684864044189453 ms to run.
Function load_lora_B took 1.9030570983886719 ms to run.
Function load_lora_A took 1.8830299377441406 ms to run.
Function load_lora_B took 1.8992424011230469 ms to run.
Function load_lora_A took 1.9309520721435547 ms to run.
Function load_lora_B took 1.8889904022216797 ms to run.
Function load_lora_A took 1.905202865600586 ms to run.
Function load_lora_B took 1.890420913696289 ms to run.
cost realload: 15.779256820678711
Function load_adapters took 15.801668167114258 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 22 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5915164947509766 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 21 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5958080291748047 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.01430511474609375 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 22 in total
Function load_lora_A took 1.8842220306396484 ms to run.
Function load_lora_B took 1.8985271453857422 ms to run.
cost realload: 4.214048385620117
Function load_adapters took 4.237651824951172 ms to run.
current batch size: 22 token used ratio: 0.12724615384615384
cost offload scan: 0.09679794311523438
offload 1 adapters, 21 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.04935264587402344
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11968612670898438
Function offload_adapters took 0.63323974609375 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 22 in total
Function load_lora_A took 1.8930435180664062 ms to run.
Function load_lora_B took 1.8856525421142578 ms to run.
cost realload: 4.210948944091797
Function load_adapters took 4.233360290527344 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 23 in total
Function load_lora_A took 1.9116401672363281 ms to run.
Function load_lora_B took 1.912832260131836 ms to run.
cost realload: 4.230022430419922
Function load_adapters took 4.252195358276367 ms to run.
cost offload scan: 0.1304149627685547
offload 2 adapters, 21 remains
cost offload cat: 0.025272369384765625
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.1163482666015625
Function offload_adapters took 0.6361007690429688 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 22 in total
Function load_lora_A took 1.9040107727050781 ms to run.
Function load_lora_B took 1.9109249114990234 ms to run.
cost realload: 4.2266845703125
Function load_adapters took 4.248380661010742 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 21 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.6024837493896484 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 20 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1163482666015625
Function offload_adapters took 0.5898475646972656 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 19 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.05078315734863281
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5979537963867188 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 20 in total
Function load_lora_A took 1.8677711486816406 ms to run.
Function load_lora_B took 1.918792724609375 ms to run.
cost realload: 4.183769226074219
Function load_adapters took 4.204511642456055 ms to run.
current batch size: 20 token used ratio: 0.1166
cost load scan: 0.011920928955078125
load 1 adapters, 21 in total
Function load_lora_A took 1.8954277038574219 ms to run.
Function load_lora_B took 1.9023418426513672 ms to run.
cost realload: 4.202127456665039
Function load_adapters took 4.22358512878418 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 20 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5898475646972656 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 19 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.030994415283203125
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5984306335449219 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 20 in total
Function load_lora_A took 1.8930435180664062 ms to run.
Function load_lora_B took 1.9190311431884766 ms to run.
cost realload: 4.204750061035156
Function load_adapters took 4.227161407470703 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 19 remains
cost offload cat: 0.03552436828613281
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.6127357482910156 ms to run.
cost load scan: 0.017642974853515625
load 1 adapters, 20 in total
Function load_lora_A took 1.9123554229736328 ms to run.
Function load_lora_B took 1.909017562866211 ms to run.
cost realload: 4.247188568115234
Function load_adapters took 4.2705535888671875 ms to run.
cost offload scan: 0.09584426879882812
offload 1 adapters, 19 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.6096363067626953 ms to run.
cost offload scan: 0.09417533874511719
offload 1 adapters, 18 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5891323089599609 ms to run.
cost load scan: 0.009059906005859375
load 2 adapters, 20 in total
Function load_lora_A took 1.880645751953125 ms to run.
Function load_lora_B took 1.926422119140625 ms to run.
Function load_lora_A took 1.8978118896484375 ms to run.
Function load_lora_B took 1.8758773803710938 ms to run.
cost realload: 8.066654205322266
Function load_adapters took 8.089303970336914 ms to run.
current batch size: 20 token used ratio: 0.11478461538461539
cost offload scan: 0.08893013000488281
offload 1 adapters, 19 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5960464477539062 ms to run.
cost offload scan: 0.09512901306152344
offload 1 adapters, 18 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.05221366882324219
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10919570922851562
INFO:     127.0.0.1:59042 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56732 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56734 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56746 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56762 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56768 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56770 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56778 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56794 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56800 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56804 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56820 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56822 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56836 - "POST /generate_stream HTTP/1.1" 200 OK
Function offload_adapters took 0.6082057952880859 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 19 in total
Function load_lora_A took 1.8777847290039062 ms to run.
Function load_lora_B took 1.8961429595947266 ms to run.
cost realload: 4.191160202026367
Function load_adapters took 4.212856292724609 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 18 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5950927734375 ms to run.
cost load scan: 0.013589859008789062
load 1 adapters, 19 in total
Function load_lora_A took 1.8994808197021484 ms to run.
Function load_lora_B took 1.8849372863769531 ms to run.
cost realload: 4.204034805297852
Function load_adapters took 4.225492477416992 ms to run.
current batch size: 20 token used ratio: 0.11663076923076923
Avg tokens(prompt+generate) throughput: 1767.299 tokens/s
Avg prompt tokens throughput:            948.302 tokens/s
Avg generate tokens throughput:          818.997 tokens/s
cost offload scan: 0.09202957153320312
offload 1 adapters, 18 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5948543548583984 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 18 in total
cost realload: 0.3001689910888672
Function load_adapters took 0.3249645233154297 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 17 remains
cost offload cat: 0.03790855407714844
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5910396575927734 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 16 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.05173683166503906
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.598907470703125 ms to run.
cost load scan: 0.01239776611328125
load 1 adapters, 17 in total
Function load_lora_A took 1.905202865600586 ms to run.
Function load_lora_B took 1.913309097290039 ms to run.
cost realload: 4.244089126586914
Function load_adapters took 4.266262054443359 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 16 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.053882598876953125
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.6039142608642578 ms to run.
current batch size: 17 token used ratio: 0.10309230769230769
cost offload scan: 0.118255615234375
offload 1 adapters, 15 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.6394386291503906 ms to run.
cost load scan: 0.012159347534179688
load 1 adapters, 16 in total
Function load_lora_A took 1.9178390502929688 ms to run.
Function load_lora_B took 1.8944740295410156 ms to run.
cost realload: 4.208564758300781
Function load_adapters took 4.230022430419922 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 15 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5810260772705078 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 14 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5791187286376953 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 15 in total
Function load_lora_A took 1.888275146484375 ms to run.
Function load_lora_B took 1.8639564514160156 ms to run.
cost realload: 4.168033599853516
Function load_adapters took 4.193782806396484 ms to run.
current batch size: 16 token used ratio: 0.09944615384615385
cost offload scan: 0.09131431579589844
offload 1 adapters, 14 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5815029144287109 ms to run.
cost load scan: 0.012159347534179688
load 1 adapters, 15 in total
Function load_lora_A took 1.88446044921875 ms to run.
Function load_lora_B took 1.9032955169677734 ms to run.
cost realload: 4.206657409667969
Function load_adapters took 4.235982894897461 ms to run.
cost load scan: 0.009775161743164062
load 1 adapters, 16 in total
Function load_lora_A took 1.8634796142578125 ms to run.
Function load_lora_B took 1.9164085388183594 ms to run.
cost realload: 4.185914993286133
Function load_adapters took 4.206418991088867 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 15 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5910396575927734 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 16 in total
Function load_lora_A took 1.8994808197021484 ms to run.
Function load_lora_B took 1.9350051879882812 ms to run.
cost realload: 4.244327545166016
Function load_adapters took 4.2667388916015625 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 15 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5881786346435547 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 16 in total
Function load_lora_A took 1.8973350524902344 ms to run.
Function load_lora_B took 1.9011497497558594 ms to run.
cost realload: 4.201650619506836
Function load_adapters took 4.223346710205078 ms to run.
current batch size: 18 token used ratio: 0.10716923076923077
cost offload scan: 0.08893013000488281
offload 1 adapters, 15 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.024318695068359375
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5946159362792969 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 16 in total
Function load_lora_A took 1.8842220306396484 ms to run.
Function load_lora_B took 1.8875598907470703 ms to run.
cost realload: 4.174470901489258
Function load_adapters took 4.195928573608398 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 15 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5884170532226562 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 14 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5829334259033203 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 15 in total
Function load_lora_A took 1.9042491912841797 ms to run.
Function load_lora_B took 1.9004344940185547 ms to run.
cost realload: 4.202365875244141
Function load_adapters took 4.22358512878418 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 14 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: INFO:     127.0.0.1:56838 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56854 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56864 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56868 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56876 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56888 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56896 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56908 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56912 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56918 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56934 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56946 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56958 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56970 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56978 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56988 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57000 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57016 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57024 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57028 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57042 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57058 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57062 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57066 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57078 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57086 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57098 - "POST /generate_stream HTTP/1.1" 200 OK
0.043392181396484375
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.6165504455566406 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 14 in total
cost realload: 0.2903938293457031
Function load_adapters took 0.3154277801513672 ms to run.
offload 0 adapters, 14 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 14 in total
cost realload: 0.28824806213378906
Function load_adapters took 0.3123283386230469 ms to run.
current batch size: 17 token used ratio: 0.09666153846153847
cost load scan: 0.010967254638671875
load 1 adapters, 15 in total
Function load_lora_A took 1.8842220306396484 ms to run.
Function load_lora_B took 1.9016265869140625 ms to run.
cost realload: 4.205942153930664
Function load_adapters took 4.227161407470703 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 16 in total
Function load_lora_A took 1.886606216430664 ms to run.
Function load_lora_B took 1.8854141235351562 ms to run.
cost realload: 4.1675567626953125
Function load_adapters took 4.189252853393555 ms to run.
cost load scan: 0.015020370483398438
load 5 adapters, 21 in total
Function load_lora_A took 1.8656253814697266 ms to run.
Function load_lora_B took 1.8982887268066406 ms to run.
Function load_lora_A took 1.9040107727050781 ms to run.
Function load_lora_B took 1.878499984741211 ms to run.
Function load_lora_A took 1.8820762634277344 ms to run.
Function load_lora_B took 1.8889904022216797 ms to run.
Function load_lora_A took 1.8877983093261719 ms to run.
Function load_lora_B took 1.903533935546875 ms to run.
Function load_lora_A took 1.8880367279052734 ms to run.
Function load_lora_B took 1.8763542175292969 ms to run.
cost realload: 19.552946090698242
Function load_adapters took 19.576549530029297 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 20 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5941390991210938 ms to run.
cost offload scan: 0.09369850158691406
offload 1 adapters, 19 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.6031990051269531 ms to run.
cost load scan: 0.013828277587890625
load 2 adapters, 21 in total
Function load_lora_A took 1.901865005493164 ms to run.
Function load_lora_B took 1.9042491912841797 ms to run.
Function load_lora_A took 1.9292831420898438 ms to run.
Function load_lora_B took 1.8999576568603516 ms to run.
cost realload: 8.12077522277832
Function load_adapters took 8.14199447631836 ms to run.
current batch size: 24 token used ratio: 0.1318923076923077
cost load scan: 0.008106231689453125
load 0 adapters, 21 in total
cost realload: 0.29158592224121094
Function load_adapters took 0.3180503845214844 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 20 remains
cost offload cat: 0.04029273986816406
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5986690521240234 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 21 in total
Function load_lora_A took 1.9009113311767578 ms to run.
Function load_lora_B took 1.9135475158691406 ms to run.
cost realload: 4.218816757202148
Function load_adapters took 4.2400360107421875 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 22 in total
Function load_lora_A took 1.9419193267822266 ms to run.
Function load_lora_B took 1.920461654663086 ms to run.
cost realload: 4.300832748413086
Function load_adapters took 4.323720932006836 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.013828277587890625 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 21 remains
cost offload cat: 0.040531158447265625
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.6089210510253906 ms to run.
current batch size: 24 token used ratio: 0.13813846153846154
cost offload scan: 0.08869171142578125
offload 1 adapters, 20 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5819797515869141 ms to run.
cost load scan: 0.009775161743164062
load 1 adapters, 21 in total
Function load_lora_A took 1.8918514251708984 ms to run.
Function load_lora_B took 1.9254684448242188 ms to run.
cost realload: 4.228115081787109
Function load_adapters took 4.250526428222656 ms to run.
cost offload scan: 0.13065338134765625
offload 2 adapters, 19 remains
cost offload cat: 0.025510787963867188
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.6272792816162109 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 18 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5853176116943359 ms to run.
cost load scan: 0.013828277587890625
load 3 adapters, 21 in total
Function load_lora_A took 1.8851757049560547 ms to run.
Function load_lora_B took 1.8949508666992188 ms to run.
Function load_lora_A took 1.8918514251708984 ms to run.
Function load_lora_B took 1.901388168334961 ms to run.
Function load_lora_A took 1.9049644470214844 ms to run.
Function load_lora_B took 1.871347427368164 ms to run.
cost realload: 11.886835098266602
Function load_adapters took 11.908769607543945 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 20 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5929470062255859 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 21 in total
Function load_lora_A took 1.8925666809082031 ms to run.
Function load_lora_B took 1.9097328186035156 ms to run.
cost realload: 4.211664199829102
Function load_adapters took 4.232645034790039 ms to run.
current batch size: 23 token used ratio: 0.13101538461538462
cost load scan: 0.00858306884765625
load 1 adapters, 22 in total
Function load_lora_A took 1.867055892944336 ms to run.
Function load_lora_B took 1.8665790557861328 ms to run.
cost realload: 4.136562347412109
Function load_adapters took 4.157304763793945 ms to run.
cost load scan: 0.010967254638671875
load 3 adapters, 25 in total
Function load_lora_A took 1.8868446350097656 ms to run.
Function load_lora_B took 1.8863677978515625 ms to run.
Function load_lora_A took 1.8799304962158203 ms to run.
Function load_lora_B took 1.8739700317382812 ms to run.
Function load_lora_A took 1.903533935546875 ms to run.
Function load_lora_B took 1.898050308227539 ms to run.
cost realload: 11.869192123413086
Function load_adapters took 11.890649795532227 ms to run.
offload 0 adapters, 25 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.09655952453613281
offload 1 adapters, 24 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.5986690521240234 ms to run.
cost load scan: 0.011444091796875
load 2 adapters, 26 in total
Function load_lora_A took 1.8818378448486328 ms to run.
INFO:     127.0.0.1:57114 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36324 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36340 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36348 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36364 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36374 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36388 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36404 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36418 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36426 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_B took 1.8618106842041016 ms to run.
Function load_lora_A took 1.918792724609375 ms to run.
Function load_lora_B took 1.9273757934570312 ms to run.
cost realload: 8.083343505859375
Function load_adapters took 8.104801177978516 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 25 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5908012390136719 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 26 in total
Function load_lora_A took 1.8925666809082031 ms to run.
Function load_lora_B took 1.89208984375 ms to run.
cost realload: 4.197120666503906
Function load_adapters took 4.218578338623047 ms to run.
cost offload scan: 0.09608268737792969
offload 1 adapters, 25 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.051975250244140625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.6120204925537109 ms to run.
current batch size: 27 token used ratio: 0.14992307692307694
cost load scan: 0.010728836059570312
load 1 adapters, 26 in total
Function load_lora_A took 1.8870830535888672 ms to run.
Function load_lora_B took 1.8916130065917969 ms to run.
cost realload: 4.185914993286133
Function load_adapters took 4.208087921142578 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 25 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11539459228515625
Function offload_adapters took 0.6096363067626953 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 24 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5862712860107422 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 23 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5862712860107422 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 22 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5981922149658203 ms to run.
Avg tokens(prompt+generate) throughput: 1873.315 tokens/s
Avg prompt tokens throughput:           1040.941 tokens/s
Avg generate tokens throughput:          832.373 tokens/s
cost offload scan: 0.08940696716308594
offload 1 adapters, 21 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5886554718017578 ms to run.
cost load scan: 0.015020370483398438
load 1 adapters, 22 in total
Function load_lora_A took 1.9001960754394531 ms to run.
Function load_lora_B took 1.8870830535888672 ms to run.
cost realload: 4.195213317871094
Function load_adapters took 4.217624664306641 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 21 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11563301086425781
Function offload_adapters took 0.5974769592285156 ms to run.
cost offload scan: 0.09489059448242188
offload 1 adapters, 20 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.6024837493896484 ms to run.
current batch size: 21 token used ratio: 0.11992307692307692
cost load scan: 0.00858306884765625
load 1 adapters, 21 in total
Function load_lora_A took 1.9006729125976562 ms to run.
Function load_lora_B took 1.882314682006836 ms to run.
cost realload: 4.183053970336914
Function load_adapters took 4.204750061035156 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 22 in total
Function load_lora_A took 1.9001960754394531 ms to run.
Function load_lora_B took 1.8930435180664062 ms to run.
cost realload: 4.200458526611328
Function load_adapters took 4.22215461730957 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 21 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.60272216796875 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 20 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5970001220703125 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 21 in total
Function load_lora_A took 1.8947124481201172 ms to run.
Function load_lora_B took 1.9245147705078125 ms to run.
cost realload: 4.21905517578125
Function load_adapters took 4.242181777954102 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 20 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11587142944335938
Function offload_adapters took 0.5927085876464844 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 19 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5970001220703125 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 18 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.05245208740234375
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5958080291748047 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 17 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5788803100585938 ms to run.
cost offload scan: 0.13899803161621094
offload 2 adapters, 15 remains
cost offload cat: 0.025033950805664062
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.6308555603027344 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 14 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5772113800048828 ms to run.
current batch size: 16 token used ratio: 0.09129230769230769
cost load scan: 0.016689300537109375
load 1 adapters, 15 in total
Function load_lora_A took 1.8880367279052734 ms to run.
Function load_lora_B took 1.9063949584960938 ms to run.
cost realload: 4.206180572509766
Function load_adapters took 4.227876663208008 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 16 in total
Function load_lora_A took 1.9001960754394531 ms to run.
Function load_lora_B took 1.8744468688964844 ms to run.
cost realload: 4.1751861572265625
Function load_adapters took 4.196643829345703 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 17 in total
INFO:     127.0.0.1:36440 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36448 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36456 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36472 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36484 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36488 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36496 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36506 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36512 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36528 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36540 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36548 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36552 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36566 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36580 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36586 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36592 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36594 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 1.8982887268066406 ms to run.
Function load_lora_B took 1.901388168334961 ms to run.
cost realload: 4.227876663208008
Function load_adapters took 4.24957275390625 ms to run.
offload 0 adapters, 17 remains
Function offload_adapters took 0.0133514404296875 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 18 in total
Function load_lora_A took 1.9106864929199219 ms to run.
Function load_lora_B took 1.9519329071044922 ms to run.
cost realload: 4.26793098449707
Function load_adapters took 4.2896270751953125 ms to run.
current batch size: 18 token used ratio: 0.10090769230769231
cost offload scan: 0.08749961853027344
offload 1 adapters, 17 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11730194091796875
Function offload_adapters took 0.5900859832763672 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 16 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5807876586914062 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 17 in total
Function load_lora_A took 1.8620491027832031 ms to run.
Function load_lora_B took 1.93023681640625 ms to run.
cost realload: 4.197120666503906
Function load_adapters took 4.218339920043945 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 16 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5929470062255859 ms to run.
current batch size: 16 token used ratio: 0.09447692307692308
cost offload scan: 0.08702278137207031
offload 1 adapters, 15 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5788803100585938 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 16 in total
Function load_lora_A took 1.8985271453857422 ms to run.
Function load_lora_B took 1.8930435180664062 ms to run.
cost realload: 4.188299179077148
Function load_adapters took 4.210472106933594 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 15 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11205673217773438
Function offload_adapters took 0.5838871002197266 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 14 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5958080291748047 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 14 in total
cost realload: 0.2830028533935547
Function load_adapters took 0.3063678741455078 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 13 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5991458892822266 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 14 in total
Function load_lora_A took 1.882314682006836 ms to run.
Function load_lora_B took 1.86920166015625 ms to run.
cost realload: 4.136562347412109
Function load_adapters took 4.160642623901367 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 13 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5826950073242188 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 12 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5745887756347656 ms to run.
cost load scan: 0.011205673217773438
load 2 adapters, 14 in total
Function load_lora_A took 1.8897056579589844 ms to run.
Function load_lora_B took 1.8954277038574219 ms to run.
Function load_lora_A took 1.8928050994873047 ms to run.
Function load_lora_B took 1.8744468688964844 ms to run.
cost realload: 8.033514022827148
Function load_adapters took 8.05521011352539 ms to run.
current batch size: 15 token used ratio: 0.07632307692307692
cost load scan: 0.01239776611328125
load 3 adapters, 17 in total
Function load_lora_A took 1.8954277038574219 ms to run.
Function load_lora_B took 1.8544197082519531 ms to run.
Function load_lora_A took 1.8846988677978516 ms to run.
Function load_lora_B took 1.8963813781738281 ms to run.
Function load_lora_A took 1.9199848175048828 ms to run.
Function load_lora_B took 1.8987655639648438 ms to run.
cost realload: 11.900663375854492
Function load_adapters took 11.922597885131836 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 16 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5841255187988281 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 17 in total
Function load_lora_A took 1.8668174743652344 ms to run.
Function load_lora_B took 1.8887519836425781 ms to run.
cost realload: 4.153966903686523
Function load_adapters took 4.175662994384766 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 16 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.58746337890625 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 15 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.024318695068359375
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5941390991210938 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 16 in total
Function load_lora_A took 1.8999576568603516 ms to run.
Function load_lora_B took 1.8906593322753906 ms to run.
cost realload: 4.193782806396484
Function load_adapters took 4.221439361572266 ms to run.
current batch size: 18 token used ratio: 0.09013846153846154
cost offload scan: 0.09393692016601562
offload 1 adapters, 15 remains
cost offload cat: 0.03933906555175781
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11038780212402344
Function offload_adapters took 0.6086826324462891 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 16 in total
Function load_lora_A took 1.9288063049316406 ms to run.
Function load_lora_B took 1.8897056579589844 ms to run.
cost realload: 4.222393035888672
Function load_adapters took 4.246234893798828 ms to run.
cost load scan: 0.009298324584960938
load 2 adapters, 18 in total
Function load_lora_A took 1.9135475158691406 ms to run.
Function load_lora_B took 1.9049644470214844 ms to run.
Function load_lora_A took 1.86920166015625 ms to run.
Function load_lora_B took 1.898050308227539 ms to run.
cost realload: 8.064508438110352
Function load_adapters took 8.086204528808594 ms to run.
cost offload scan: 0.09441375732421875
offload 1 adapters, 17 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5960464477539062 ms to run.
INFO:     127.0.0.1:36608 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36616 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36632 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36636 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36642 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53016 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53024 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53034 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53048 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53054 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53060 - "POST /generate_stream HTTP/1.1" 200 OK
cost load scan: 0.011682510375976562
load 1 adapters, 18 in total
Function load_lora_A took 1.895904541015625 ms to run.
Function load_lora_B took 1.870870590209961 ms to run.
cost realload: 4.203081130981445
Function load_adapters took 4.224538803100586 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 17 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11730194091796875
Function offload_adapters took 0.5972385406494141 ms to run.
current batch size: 19 token used ratio: 0.09496923076923076
cost offload scan: 0.08821487426757812
offload 1 adapters, 16 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5974769592285156 ms to run.
cost load scan: 0.01239776611328125
load 1 adapters, 17 in total
Function load_lora_A took 1.9075870513916016 ms to run.
Function load_lora_B took 1.9030570983886719 ms to run.
cost realload: 4.215478897094727
Function load_adapters took 4.237174987792969 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 16 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5905628204345703 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 15 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5826950073242188 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 14 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.583648681640625 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 15 in total
Function load_lora_A took 1.8968582153320312 ms to run.
Function load_lora_B took 1.9373893737792969 ms to run.
cost realload: 4.220247268676758
Function load_adapters took 4.240989685058594 ms to run.
cost load scan: 0.009298324584960938
load 2 adapters, 17 in total
Function load_lora_A took 1.89971923828125 ms to run.
Function load_lora_B took 1.8992424011230469 ms to run.
Function load_lora_A took 1.9335746765136719 ms to run.
Function load_lora_B took 1.9073486328125 ms to run.
cost realload: 8.107185363769531
Function load_adapters took 8.128881454467773 ms to run.
offload 0 adapters, 17 remains
Function offload_adapters took 0.012874603271484375 ms to run.
current batch size: 18 token used ratio: 0.09086153846153847
cost offload scan: 0.08654594421386719
offload 1 adapters, 16 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5817413330078125 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 16 in total
cost realload: 0.29587745666503906
Function load_adapters took 0.3204345703125 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 15 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11515617370605469
Function offload_adapters took 0.5919933319091797 ms to run.
cost offload scan: 0.08559226989746094
offload 1 adapters, 14 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5812644958496094 ms to run.
offload 0 adapters, 14 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 15 in total
Function load_lora_A took 1.8854141235351562 ms to run.
Function load_lora_B took 1.8949508666992188 ms to run.
cost realload: 4.18853759765625
Function load_adapters took 4.211902618408203 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 14 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.5838871002197266 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 15 in total
Function load_lora_A took 1.8906593322753906 ms to run.
Function load_lora_B took 1.8832683563232422 ms to run.
cost realload: 4.179954528808594
Function load_adapters took 4.200935363769531 ms to run.
cost load scan: 0.00858306884765625
load 2 adapters, 17 in total
Function load_lora_A took 1.8663406372070312 ms to run.
Function load_lora_B took 1.9135475158691406 ms to run.
Function load_lora_A took 1.8832683563232422 ms to run.
Function load_lora_B took 1.8825531005859375 ms to run.
cost realload: 8.031129837036133
Function load_adapters took 8.05211067199707 ms to run.
current batch size: 18 token used ratio: 0.09183076923076923
cost offload scan: 0.08797645568847656
offload 1 adapters, 16 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5919933319091797 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 17 in total
Function load_lora_A took 1.8639564514160156 ms to run.
Function load_lora_B took 1.9249916076660156 ms to run.
cost realload: 4.204988479614258
Function load_adapters took 4.2266845703125 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 16 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5948543548583984 ms to run.
Avg tokens(prompt+generate) throughput: 1537.302 tokens/s
Avg prompt tokens throughput:            805.629 tokens/s
Avg generate tokens throughput:          731.673 tokens/s
cost offload scan: 0.08702278137207031
offload 1 adapters, 15 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.5888938903808594 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 16 in total
Function load_lora_A took 1.8835067749023438 ms to run.
Function load_lora_B took 1.9047260284423828 ms to run.
cost realload: 4.196882247924805
Function load_adapters took 4.218101501464844 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 15 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5857944488525391 ms to run.
current batch size: 16 token used ratio: 0.08749230769230769
cost load scan: 0.008106231689453125
load 1 adapters, 16 in total
Function load_lora_A took 1.863241195678711 ms to run.
Function load_lora_B took 1.8918514251708984 ms to run.
cost realload: 4.15492057800293
Function load_adapters took 4.17637825012207 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 15 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5869865417480469 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 14 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: INFO:     127.0.0.1:53066 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53080 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53092 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53102 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53110 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53126 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53140 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53152 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53154 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53162 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53176 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53188 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53200 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53216 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53226 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53236 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53244 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53248 - "POST /generate_stream HTTP/1.1" 200 OK
0.04363059997558594
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.6189346313476562 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 14 in total
cost realload: 0.29659271240234375
Function load_adapters took 0.32067298889160156 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 13 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5810260772705078 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 14 in total
Function load_lora_A took 1.8687248229980469 ms to run.
Function load_lora_B took 1.8508434295654297 ms to run.
cost realload: 4.120349884033203
Function load_adapters took 4.141807556152344 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 13 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10228157043457031
Function offload_adapters took 0.57220458984375 ms to run.
offload 0 adapters, 13 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 14 in total
Function load_lora_A took 1.903533935546875 ms to run.
Function load_lora_B took 1.9154548645019531 ms to run.
cost realload: 4.2266845703125
Function load_adapters took 4.248142242431641 ms to run.
current batch size: 15 token used ratio: 0.07575384615384616
cost load scan: 0.00858306884765625
load 1 adapters, 15 in total
Function load_lora_A took 1.8928050994873047 ms to run.
Function load_lora_B took 1.8897056579589844 ms to run.
cost realload: 4.1904449462890625
Function load_adapters took 4.212141036987305 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 14 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5881786346435547 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 13 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5855560302734375 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 13 in total
cost realload: 0.28896331787109375
Function load_adapters took 0.3135204315185547 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 12 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.024318695068359375
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5838871002197266 ms to run.
offload 0 adapters, 12 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 11 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5886554718017578 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 11 in total
cost realload: 0.2963542938232422
Function load_adapters took 0.3204345703125 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 10 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10228157043457031
Function offload_adapters took 0.5764961242675781 ms to run.
current batch size: 12 token used ratio: 0.053123076923076926
offload 0 adapters, 10 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 11 in total
Function load_lora_A took 1.9071102142333984 ms to run.
Function load_lora_B took 1.874685287475586 ms to run.
cost realload: 4.1828155517578125
Function load_adapters took 4.203557968139648 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 12 in total
Function load_lora_A took 1.8982887268066406 ms to run.
Function load_lora_B took 1.8870830535888672 ms to run.
cost realload: 4.187107086181641
Function load_adapters took 4.208803176879883 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 11 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5996227264404297 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 12 in total
Function load_lora_A took 1.8918514251708984 ms to run.
Function load_lora_B took 1.9078254699707031 ms to run.
cost realload: 4.188776016235352
Function load_adapters took 4.209756851196289 ms to run.
current batch size: 13 token used ratio: 0.0669076923076923
cost offload scan: 0.08630752563476562
offload 1 adapters, 11 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.5831718444824219 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 10 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.5867481231689453 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 11 in total
Function load_lora_A took 1.8837451934814453 ms to run.
Function load_lora_B took 1.8970966339111328 ms to run.
cost realload: 4.183530807495117
Function load_adapters took 4.205465316772461 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 12 in total
Function load_lora_A took 1.9135475158691406 ms to run.
Function load_lora_B took 1.8978118896484375 ms to run.
cost realload: 4.209995269775391
Function load_adapters took 4.231452941894531 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 11 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5867481231689453 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 12 in total
Function load_lora_A took 1.8889904022216797 ms to run.
Function load_lora_B took 1.9335746765136719 ms to run.
cost realload: 4.218578338623047
Function load_adapters took 4.239320755004883 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 13 in total
Function load_lora_A took 1.8873214721679688 ms to run.
Function load_lora_B took 1.8901824951171875 ms to run.
cost realload: 4.177570343017578
Function load_adapters took 4.199028015136719 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 12 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5784034729003906 ms to run.
current batch size: 13 token used ratio: 0.06576923076923077
cost load scan: 0.008344650268554688
load 1 adapters, 13 in total
Function load_lora_A took 1.8839836120605469 ms to run.
Function load_lora_B took 1.8737316131591797 ms to run.
cost realload: 4.156589508056641
Function load_adapters took 4.178524017333984 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 14 in total
Function load_lora_A took 1.9044876098632812 ms to run.
Function load_lora_B took 1.8978118896484375 ms to run.
cost realload: 4.214048385620117
Function load_adapters took 4.235982894897461 ms to run.
cost load scan: 0.00858306884765625
INFO:     127.0.0.1:53264 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53272 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53276 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53284 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53286 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53290 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53300 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53314 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53318 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53322 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53324 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53332 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53340 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53348 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53356 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53370 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53382 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44672 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44682 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44684 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44690 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44692 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44704 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44716 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44732 - "POST /generate_stream HTTP/1.1" 200 OK
load 1 adapters, 15 in total
Function load_lora_A took 1.9037723541259766 ms to run.
Function load_lora_B took 1.8932819366455078 ms to run.
cost realload: 4.232883453369141
Function load_adapters took 4.254579544067383 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 14 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5762577056884766 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 13 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5931854248046875 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 14 in total
Function load_lora_A took 1.8970966339111328 ms to run.
Function load_lora_B took 1.8610954284667969 ms to run.
cost realload: 4.166126251220703
Function load_adapters took 4.187822341918945 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 13 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5984306335449219 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 14 in total
Function load_lora_A took 1.8928050994873047 ms to run.
Function load_lora_B took 1.8694400787353516 ms to run.
cost realload: 4.174232482910156
Function load_adapters took 4.1961669921875 ms to run.
current batch size: 16 token used ratio: 0.08298461538461538
cost load scan: 0.015020370483398438
load 1 adapters, 15 in total
Function load_lora_A took 1.8994808197021484 ms to run.
Function load_lora_B took 1.9016265869140625 ms to run.
cost realload: 4.22215461730957
Function load_adapters took 4.245758056640625 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 16 in total
Function load_lora_A took 1.9021034240722656 ms to run.
Function load_lora_B took 1.9266605377197266 ms to run.
cost realload: 4.23741340637207
Function load_adapters took 4.258632659912109 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 15 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5826950073242188 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 16 in total
Function load_lora_A took 1.9135475158691406 ms to run.
Function load_lora_B took 1.9230842590332031 ms to run.
cost realload: 4.251003265380859
Function load_adapters took 4.2724609375 ms to run.
cost load scan: 0.012874603271484375
load 2 adapters, 18 in total
Function load_lora_A took 1.9214153289794922 ms to run.
Function load_lora_B took 1.8978118896484375 ms to run.
Function load_lora_A took 1.9004344940185547 ms to run.
Function load_lora_B took 1.8911361694335938 ms to run.
cost realload: 8.104801177978516
Function load_adapters took 8.126258850097656 ms to run.
current batch size: 20 token used ratio: 0.10664615384615385
cost offload scan: 0.08726119995117188
offload 1 adapters, 17 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.5924701690673828 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 18 in total
Function load_lora_A took 1.8777847290039062 ms to run.
Function load_lora_B took 1.8892288208007812 ms to run.
cost realload: 4.165172576904297
Function load_adapters took 4.185676574707031 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 19 in total
Function load_lora_A took 1.886606216430664 ms to run.
Function load_lora_B took 1.8808841705322266 ms to run.
cost realload: 4.166364669799805
Function load_adapters took 4.187822341918945 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 18 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5855560302734375 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 19 in total
Function load_lora_A took 1.889944076538086 ms to run.
Function load_lora_B took 1.8911361694335938 ms to run.
cost realload: 4.1866302490234375
Function load_adapters took 4.207372665405273 ms to run.
cost offload scan: 0.08559226989746094
offload 1 adapters, 18 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5795955657958984 ms to run.
cost load scan: 0.0095367431640625
load 4 adapters, 22 in total
Function load_lora_A took 1.918792724609375 ms to run.
Function load_lora_B took 1.9042491912841797 ms to run.
Function load_lora_A took 1.894235610961914 ms to run.
Function load_lora_B took 1.8749237060546875 ms to run.
Function load_lora_A took 1.8651485443115234 ms to run.
Function load_lora_B took 1.88446044921875 ms to run.
Function load_lora_A took 1.8801689147949219 ms to run.
Function load_lora_B took 1.9071102142333984 ms to run.
cost realload: 15.732526779174805
Function load_adapters took 15.753507614135742 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.013589859008789062 ms to run.
current batch size: 23 token used ratio: 0.1266923076923077
cost load scan: 0.009775161743164062
load 2 adapters, 24 in total
Function load_lora_A took 1.9176006317138672 ms to run.
Function load_lora_B took 1.9152164459228516 ms to run.
Function load_lora_A took 1.8901824951171875 ms to run.
Function load_lora_B took 1.9156932830810547 ms to run.
cost realload: 8.11624526977539
Function load_adapters took 8.14199447631836 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 25 in total
Function load_lora_A took 1.9028186798095703 ms to run.
Function load_lora_B took 1.8858909606933594 ms to run.
cost realload: 4.1942596435546875
Function load_adapters took 4.215240478515625 ms to run.
cost load scan: 0.01430511474609375
load 3 adapters, 28 in total
Function load_lora_A took 1.8928050994873047 ms to run.
Function load_lora_B took 1.8699169158935547 ms to run.
Function load_lora_A took 1.8963813781738281 ms to run.
Function load_lora_B took 1.8961429595947266 ms to run.
Function load_lora_A took 1.8990039825439453 ms to run.
Function load_lora_B took 1.8582344055175781 ms to run.
cost realload: 11.868953704833984
Function load_adapters took 11.890649795532227 ms to run.
cost load scan: 0.009059906005859375
load 3 adapters, 31 in total
Function load_lora_A took 1.8992424011230469 ms to run.
Function load_lora_B took 1.8930435180664062 ms to run.
Function load_lora_A took 1.9025802612304688 ms to run.
Function load_lora_B took 1.8832683563232422 ms to run.
Function load_lora_A took 1.8699169158935547 ms to run.
Function load_lora_B took 1.8842220306396484 ms to run.
cost realload: 11.872291564941406
Function load_adapters took 11.89422607421875 ms to run.
cost offload scan: 0.09822845458984375
offload 1 adapters, 30 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.6012916564941406 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 31 in total
Function load_lora_A took 1.8832683563232422 ms to run.
Function load_lora_B took 1.8839836120605469 ms to run.
cost realload: 4.167795181274414
Function load_adapters took 4.189014434814453 ms to run.
INFO:     127.0.0.1:44734 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44744 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44750 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44758 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44764 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44770 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44776 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44790 - "POST /generate_stream HTTP/1.1" 200 OK
Avg tokens(prompt+generate) throughput: 1761.613 tokens/s
Avg prompt tokens throughput:           1090.731 tokens/s
Avg generate tokens throughput:          670.881 tokens/s
current batch size: 32 token used ratio: 0.18096923076923077
cost offload scan: 0.09298324584960938
offload 1 adapters, 30 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02956390380859375
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.6062984466552734 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 31 in total
Function load_lora_A took 1.9202232360839844 ms to run.
Function load_lora_B took 1.8780231475830078 ms to run.
cost realload: 4.197597503662109
Function load_adapters took 4.219293594360352 ms to run.
cost offload scan: 0.09894371032714844
offload 1 adapters, 30 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.6062984466552734 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 29 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.6034374237060547 ms to run.
cost offload scan: 0.1316070556640625
offload 2 adapters, 27 remains
cost offload cat: 0.025272369384765625
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.6248950958251953 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 28 in total
Function load_lora_A took 1.8928050994873047 ms to run.
Function load_lora_B took 1.9009113311767578 ms to run.
cost realload: 4.183769226074219
Function load_adapters took 4.204988479614258 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 27 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.6043910980224609 ms to run.
cost offload scan: 0.102996826171875
offload 1 adapters, 26 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.6082057952880859 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 27 in total
Function load_lora_A took 1.8768310546875 ms to run.
Function load_lora_B took 1.9049644470214844 ms to run.
cost realload: 4.192113876342773
Function load_adapters took 4.2133331298828125 ms to run.
current batch size: 28 token used ratio: 0.16924615384615385
cost offload scan: 0.09465217590332031
offload 1 adapters, 26 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.6079673767089844 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 27 in total
Function load_lora_A took 1.8978118896484375 ms to run.
Function load_lora_B took 1.9023418426513672 ms to run.
cost realload: 4.200220108032227
Function load_adapters took 4.221916198730469 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 26 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5955696105957031 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 25 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5857944488525391 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 25 in total
cost realload: 0.2949237823486328
Function load_adapters took 0.31948089599609375 ms to run.
cost offload scan: 0.09846687316894531
offload 1 adapters, 24 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5998611450195312 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 25 in total
Function load_lora_A took 1.8994808197021484 ms to run.
Function load_lora_B took 1.9068717956542969 ms to run.
cost realload: 4.191875457763672
Function load_adapters took 4.211902618408203 ms to run.
cost offload scan: 0.091552734375
offload 1 adapters, 24 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.6041526794433594 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 23 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5991458892822266 ms to run.
offload 0 adapters, 23 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.10061264038085938
offload 1 adapters, 22 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5965232849121094 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 21 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5769729614257812 ms to run.
current batch size: 22 token used ratio: 0.1334
cost load scan: 0.008106231689453125
load 1 adapters, 22 in total
Function load_lora_A took 1.8839836120605469 ms to run.
Function load_lora_B took 1.9011497497558594 ms to run.
cost realload: 4.186868667602539
Function load_adapters took 4.208564758300781 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 21 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5986690521240234 ms to run.
cost offload scan: 0.09489059448242188
offload 1 adapters, 20 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.6053447723388672 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 19 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5981922149658203 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 19 in total
cost realload: 0.2923011779785156
Function load_adapters took 0.3161430358886719 ms to run.
cost offload scan: 0.09369850158691406
offload 1 adapters, 18 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5886554718017578 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 19 in total
Function load_lora_A took 1.905679702758789 ms to run.
Function load_lora_B took 1.920461654663086 ms to run.
cost realload: INFO:     127.0.0.1:44798 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44810 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44822 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44830 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44842 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44850 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44852 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44856 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44872 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44882 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44884 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44892 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44894 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44902 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44906 - "POST /generate_stream HTTP/1.1" 200 OK
4.234075546264648
Function load_adapters took 4.281282424926758 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 18 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5896091461181641 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 19 in total
Function load_lora_A took 1.893758773803711 ms to run.
Function load_lora_B took 1.8732547760009766 ms to run.
cost realload: 4.182338714599609
Function load_adapters took 4.204034805297852 ms to run.
cost load scan: 0.010728836059570312
load 3 adapters, 22 in total
Function load_lora_A took 1.8837451934814453 ms to run.
Function load_lora_B took 1.8928050994873047 ms to run.
Function load_lora_A took 1.8544197082519531 ms to run.
Function load_lora_B took 1.8949508666992188 ms to run.
Function load_lora_A took 1.8870830535888672 ms to run.
Function load_lora_B took 1.8894672393798828 ms to run.
cost realload: 11.84225082397461
Function load_adapters took 11.864185333251953 ms to run.
cost offload scan: 0.09799003601074219
offload 1 adapters, 21 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04792213439941406
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.6234645843505859 ms to run.
current batch size: 23 token used ratio: 0.13444615384615385
cost load scan: 0.010967254638671875
load 1 adapters, 22 in total
Function load_lora_A took 1.8887519836425781 ms to run.
Function load_lora_B took 1.9202232360839844 ms to run.
cost realload: 4.230737686157227
Function load_adapters took 4.25267219543457 ms to run.
cost load scan: 0.01239776611328125
load 1 adapters, 23 in total
Function load_lora_A took 1.890420913696289 ms to run.
Function load_lora_B took 1.89208984375 ms to run.
cost realload: 4.192352294921875
Function load_adapters took 4.21595573425293 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 22 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.6010532379150391 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 23 in total
Function load_lora_A took 1.9071102142333984 ms to run.
Function load_lora_B took 1.8963813781738281 ms to run.
cost realload: 4.206418991088867
Function load_adapters took 4.228115081787109 ms to run.
offload 0 adapters, 23 remains
Function offload_adapters took 0.0133514404296875 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 24 in total
Function load_lora_A took 1.89971923828125 ms to run.
Function load_lora_B took 1.8756389617919922 ms to run.
cost realload: 4.187583923339844
Function load_adapters took 4.2095184326171875 ms to run.
cost offload scan: 0.09560585021972656
offload 1 adapters, 23 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.6031990051269531 ms to run.
current batch size: 24 token used ratio: 0.14152307692307692
cost offload scan: 0.09083747863769531
offload 1 adapters, 22 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.12040138244628906
Function offload_adapters took 0.6084442138671875 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 21 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5962848663330078 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 20 remains
cost offload cat: 0.03600120544433594
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.6046295166015625 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 19 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04839897155761719
cost offload torch.empty: 0.030755996704101562
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.6115436553955078 ms to run.
cost load scan: 0.009775161743164062
load 1 adapters, 20 in total
Function load_lora_A took 1.898050308227539 ms to run.
Function load_lora_B took 1.9078254699707031 ms to run.
cost realload: 4.229545593261719
Function load_adapters took 4.252195358276367 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 19 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5943775177001953 ms to run.
current batch size: 19 token used ratio: 0.11566153846153847
cost load scan: 0.011205673217773438
load 1 adapters, 20 in total
Function load_lora_A took 1.9168853759765625 ms to run.
Function load_lora_B took 1.8990039825439453 ms to run.
cost realload: 4.226207733154297
Function load_adapters took 4.247188568115234 ms to run.
cost offload scan: 0.13256072998046875
offload 2 adapters, 18 remains
cost offload cat: 0.025272369384765625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.6320476531982422 ms to run.
cost offload scan: 0.09584426879882812
offload 1 adapters, 17 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11515617370605469
Function offload_adapters took 0.6060600280761719 ms to run.
cost load scan: 0.012874603271484375
load 2 adapters, 19 in total
Function load_lora_A took 1.926422119140625 ms to run.
Function load_lora_B took 1.880645751953125 ms to run.
Function load_lora_A took 1.9042491912841797 ms to run.
Function load_lora_B took 1.86920166015625 ms to run.
cost realload: 8.06283950805664
Function load_adapters took 8.083581924438477 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 18 remains
cost offload cat: 0.03814697265625
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.6232261657714844 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 17 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.024318695068359375
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5977153778076172 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 16 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5927085876464844 ms to run.
cost load scan: 0.010013580322265625
load 1 adapters, 17 in total
Function load_lora_A took 1.8968582153320312 ms to run.
Function load_lora_B took 1.8901824951171875 ms to run.
cost realload: 4.189729690551758
Function load_adapters took 4.210710525512695 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 16 remains
cost offload cat: 0.039577484130859375
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5908012390136719 ms to run.
cost load scan: 0.01049041748046875
INFO:     127.0.0.1:44918 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44926 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44928 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44940 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44952 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44966 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44980 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44986 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45000 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45010 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45012 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45018 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45026 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45030 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41794 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41802 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41806 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41816 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41830 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41846 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41856 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41862 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41866 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41874 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41888 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41902 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41910 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41914 - "POST /generate_stream HTTP/1.1" 200 OK
load 1 adapters, 17 in total
Function load_lora_A took 1.8968582153320312 ms to run.
Function load_lora_B took 1.9071102142333984 ms to run.
cost realload: 4.254579544067383
Function load_adapters took 4.27699089050293 ms to run.
cost offload scan: 0.13709068298339844
offload 2 adapters, 15 remains
cost offload cat: 0.025510787963867188
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.6308555603027344 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 16 in total
Function load_lora_A took 1.8982887268066406 ms to run.
Function load_lora_B took 1.8618106842041016 ms to run.
cost realload: 4.160165786743164
Function load_adapters took 4.181623458862305 ms to run.
current batch size: 17 token used ratio: 0.08949230769230769
cost offload scan: 0.08630752563476562
offload 1 adapters, 15 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5791187286376953 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 15 in total
cost realload: 0.2951622009277344
Function load_adapters took 0.3197193145751953 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 15 in total
cost realload: 0.2853870391845703
Function load_adapters took 0.30922889709472656 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 14 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5848407745361328 ms to run.
offload 0 adapters, 14 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.012874603271484375
load 2 adapters, 16 in total
Function load_lora_A took 1.9147396087646484 ms to run.
Function load_lora_B took 1.8765926361083984 ms to run.
Function load_lora_A took 1.8782615661621094 ms to run.
Function load_lora_B took 1.8978118896484375 ms to run.
cost realload: 8.045673370361328
Function load_adapters took 8.067131042480469 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 17 in total
Function load_lora_A took 1.9028186798095703 ms to run.
Function load_lora_B took 1.9016265869140625 ms to run.
cost realload: 4.211902618408203
Function load_adapters took 4.233360290527344 ms to run.
current batch size: 21 token used ratio: 0.11138461538461539
cost load scan: 0.012159347534179688
load 3 adapters, 20 in total
Function load_lora_A took 1.8668174743652344 ms to run.
Function load_lora_B took 1.8951892852783203 ms to run.
Function load_lora_A took 1.9037723541259766 ms to run.
Function load_lora_B took 1.8887519836425781 ms to run.
Function load_lora_A took 1.847982406616211 ms to run.
Function load_lora_B took 1.8868446350097656 ms to run.
cost realload: 11.841773986816406
Function load_adapters took 11.865377426147461 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 19 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5815029144287109 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 19 in total
cost realload: 0.2982616424560547
Function load_adapters took 0.3228187561035156 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.13065338134765625
offload 2 adapters, 17 remains
cost offload cat: 0.024557113647460938
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.6184577941894531 ms to run.
cost load scan: 0.013589859008789062
load 1 adapters, 18 in total
Function load_lora_A took 1.9235610961914062 ms to run.
Function load_lora_B took 1.9147396087646484 ms to run.
cost realload: 4.25267219543457
Function load_adapters took 4.274129867553711 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.018835067749023438
load 2 adapters, 20 in total
Function load_lora_A took 1.9152164459228516 ms to run.
Function load_lora_B took 1.8990039825439453 ms to run.
Function load_lora_A took 1.894235610961914 ms to run.
Function load_lora_B took 1.8906593322753906 ms to run.
cost realload: 8.077621459960938
Function load_adapters took 8.09931755065918 ms to run.
cost offload scan: 0.1289844512939453
offload 2 adapters, 18 remains
cost offload cat: 0.025033950805664062
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.6272792816162109 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 19 in total
Function load_lora_A took 1.8706321716308594 ms to run.
Function load_lora_B took 1.924753189086914 ms to run.
cost realload: 4.214286804199219
Function load_adapters took 4.235744476318359 ms to run.
current batch size: 21 token used ratio: 0.10487692307692308
cost load scan: 0.012159347534179688
load 2 adapters, 21 in total
Function load_lora_A took 1.901388168334961 ms to run.
Function load_lora_B took 1.8773078918457031 ms to run.
Function load_lora_A took 1.8782615661621094 ms to run.
Function load_lora_B took 1.8930435180664062 ms to run.
cost realload: 8.023738861083984
Function load_adapters took 8.045434951782227 ms to run.
Avg tokens(prompt+generate) throughput: 1924.970 tokens/s
Avg prompt tokens throughput:           1032.285 tokens/s
Avg generate tokens throughput:          892.685 tokens/s
cost load scan: 0.011205673217773438
load 2 adapters, 23 in total
Function load_lora_A took 1.8897056579589844 ms to run.
Function load_lora_B took 1.8982887268066406 ms to run.
Function load_lora_A took 1.875162124633789 ms to run.
Function load_lora_B took 1.8887519836425781 ms to run.
cost realload: 8.041620254516602
Function load_adapters took 8.063077926635742 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 22 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5884170532226562 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 23 in total
Function load_lora_A took 1.9037723541259766 ms to run.
Function load_lora_B took 1.894235610961914 ms to run.
cost realload: 4.202842712402344
Function load_adapters took 4.22358512878418 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 23 in total
cost realload: 0.2925395965576172
Function load_adapters took 0.31685829162597656 ms to run.
current batch size: 26 token used ratio: 0.13875384615384614
cost load scan: 0.010728836059570312
load 2 adapters, 25 in total
Function load_lora_A took 1.8706321716308594 ms to run.
Function load_lora_B took 1.890420913696289 ms to run.
Function load_lora_A took 1.8703937530517578 ms to run.
Function load_lora_B took 1.8868446350097656 ms to run.
cost realload: 7.9936981201171875
Function load_adapters took 8.014917373657227 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 24 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.6024837493896484 ms to run.
offload 0 adapters, 24 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 24 in total
cost realload: 0.28896331787109375
Function load_adapters took 0.3139972686767578 ms to run.
cost load scan: 0.012636184692382812
load 2 adapters, 26 in total
Function load_lora_A took 1.8913745880126953 ms to run.
INFO:     127.0.0.1:41930 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41938 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41944 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41954 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41966 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41978 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41986 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41992 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41998 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42014 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42030 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42042 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42052 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42068 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_B took 1.8956661224365234 ms to run.
Function load_lora_A took 1.9009113311767578 ms to run.
Function load_lora_B took 1.8839836120605469 ms to run.
cost realload: 8.08095932006836
Function load_adapters took 8.1024169921875 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 27 in total
Function load_lora_A took 1.8944740295410156 ms to run.
Function load_lora_B took 1.8742084503173828 ms to run.
cost realload: 4.179954528808594
Function load_adapters took 4.201650619506836 ms to run.
current batch size: 31 token used ratio: 0.17656923076923076
cost offload scan: 0.09822845458984375
offload 1 adapters, 26 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11777877807617188
Function offload_adapters took 0.6129741668701172 ms to run.
cost offload scan: 0.09703636169433594
offload 1 adapters, 25 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.053882598876953125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.6144046783447266 ms to run.
cost offload scan: 0.09417533874511719
offload 1 adapters, 24 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.6060600280761719 ms to run.
cost load scan: 0.013589859008789062
load 2 adapters, 26 in total
Function load_lora_A took 1.893758773803711 ms to run.
Function load_lora_B took 1.8908977508544922 ms to run.
Function load_lora_A took 1.8694400787353516 ms to run.
Function load_lora_B took 1.9061565399169922 ms to run.
cost realload: 8.051872253417969
Function load_adapters took 8.074045181274414 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 25 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.60272216796875 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 24 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5881786346435547 ms to run.
cost offload scan: 0.09632110595703125
offload 1 adapters, 23 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.6010532379150391 ms to run.
cost load scan: 0.008821487426757812
load 2 adapters, 25 in total
Function load_lora_A took 1.9125938415527344 ms to run.
Function load_lora_B took 1.9288063049316406 ms to run.
Function load_lora_A took 1.9023418426513672 ms to run.
Function load_lora_B took 1.8963813781738281 ms to run.
cost realload: 8.098363876342773
Function load_adapters took 8.117914199829102 ms to run.
cost offload scan: 0.09894371032714844
offload 1 adapters, 24 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5974769592285156 ms to run.
offload 0 adapters, 24 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost offload scan: 0.09560585021972656
offload 1 adapters, 23 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.6000995635986328 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 22 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5929470062255859 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 21 remains
cost offload cat: 0.04029273986816406
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.6034374237060547 ms to run.
current batch size: 24 token used ratio: 0.13438461538461538
cost load scan: 0.016927719116210938
load 1 adapters, 22 in total
Function load_lora_A took 1.8978118896484375 ms to run.
Function load_lora_B took 1.9078254699707031 ms to run.
cost realload: 4.230022430419922
Function load_adapters took 4.251241683959961 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 23 in total
Function load_lora_A took 1.863241195678711 ms to run.
Function load_lora_B took 1.901388168334961 ms to run.
cost realload: 4.196643829345703
Function load_adapters took 4.219293594360352 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 22 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.6005764007568359 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 23 in total
Function load_lora_A took 1.888275146484375 ms to run.
Function load_lora_B took 1.9073486328125 ms to run.
cost realload: 4.209041595458984
Function load_adapters took 4.230976104736328 ms to run.
cost offload scan: 0.09679794311523438
offload 1 adapters, 22 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.6206035614013672 ms to run.
cost load scan: 0.014543533325195312
load 2 adapters, 24 in total
Function load_lora_A took 1.928091049194336 ms to run.
Function load_lora_B took 1.9099712371826172 ms to run.
Function load_lora_A took 1.8875598907470703 ms to run.
Function load_lora_B took 1.8925666809082031 ms to run.
cost realload: 8.097648620605469
Function load_adapters took 8.121967315673828 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 23 remains
cost offload cat: 0.0362396240234375
cost offload free mem manager: 0.05364418029785156
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.6229877471923828 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 22 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.051021575927734375
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.6043910980224609 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 21 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5908012390136719 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.012874603271484375 ms to run.
current batch size: 25 token used ratio: 0.1358
cost load scan: 0.008344650268554688
load 1 adapters, 22 in total
Function load_lora_A took 1.8877983093261719 ms to run.
Function load_lora_B took 1.924276351928711 ms to run.
cost realload: 4.241704940795898
Function load_adapters took 4.263877868652344 ms to run.
cost offload scan: 0.10156631469726562
offload 1 adapters, 21 remains
cost offload cat: 0.04076957702636719
cost offload free mem manager: 0.04744529724121094
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11444091796875
Function offload_adapters took 0.6458759307861328 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 20 remains
cost offload cat: INFO:     127.0.0.1:42084 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42086 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42096 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42102 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42112 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42114 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42118 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42122 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42132 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42144 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42158 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42160 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42174 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42180 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42196 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42200 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42210 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42220 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42226 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42230 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42234 - "POST /generate_stream HTTP/1.1" 200 OK
0.03218650817871094
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.629425048828125 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 21 in total
Function load_lora_A took 1.893758773803711 ms to run.
Function load_lora_B took 1.9001960754394531 ms to run.
cost realload: 4.194736480712891
Function load_adapters took 4.215478897094727 ms to run.
cost offload scan: 0.1342296600341797
offload 2 adapters, 19 remains
cost offload cat: 0.025987625122070312
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.6372928619384766 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 20 in total
Function load_lora_A took 1.8913745880126953 ms to run.
Function load_lora_B took 1.9121170043945312 ms to run.
cost realload: 4.216432571411133
Function load_adapters took 4.238367080688477 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 21 in total
Function load_lora_A took 1.8591880798339844 ms to run.
Function load_lora_B took 1.8744468688964844 ms to run.
cost realload: 4.133701324462891
Function load_adapters took 4.155397415161133 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.09489059448242188
offload 1 adapters, 20 remains
cost offload cat: 0.045299530029296875
cost offload free mem manager: 0.057220458984375
cost offload torch.empty: 0.024318695068359375
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.6337165832519531 ms to run.
current batch size: 22 token used ratio: 0.12046153846153847
cost load scan: 0.008344650268554688
load 1 adapters, 21 in total
Function load_lora_A took 1.878499984741211 ms to run.
Function load_lora_B took 1.912832260131836 ms to run.
cost realload: 4.201173782348633
Function load_adapters took 4.22358512878418 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.09369850158691406
offload 1 adapters, 20 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.6115436553955078 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 21 in total
Function load_lora_A took 1.867532730102539 ms to run.
Function load_lora_B took 1.8973350524902344 ms to run.
cost realload: 4.173040390014648
Function load_adapters took 4.194498062133789 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 20 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11754035949707031
Function offload_adapters took 0.5998611450195312 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 19 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5888938903808594 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 18 remains
cost offload cat: 0.03695487976074219
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6134510040283203 ms to run.
current batch size: 19 token used ratio: 0.1079076923076923
cost load scan: 0.008344650268554688
load 1 adapters, 19 in total
Function load_lora_A took 1.9130706787109375 ms to run.
Function load_lora_B took 1.8796920776367188 ms to run.
cost realload: 4.205226898193359
Function load_adapters took 4.226922988891602 ms to run.
cost load scan: 0.012159347534179688
load 2 adapters, 21 in total
Function load_lora_A took 1.9021034240722656 ms to run.
Function load_lora_B took 1.901388168334961 ms to run.
Function load_lora_A took 1.8951892852783203 ms to run.
Function load_lora_B took 1.9004344940185547 ms to run.
cost realload: 8.079051971435547
Function load_adapters took 8.101224899291992 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 20 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.118255615234375
Function offload_adapters took 0.6008148193359375 ms to run.
cost offload scan: 0.09369850158691406
offload 1 adapters, 19 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.052928924560546875
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.6043910980224609 ms to run.
cost load scan: 0.016689300537109375
load 5 adapters, 24 in total
Function load_lora_A took 1.8775463104248047 ms to run.
Function load_lora_B took 1.8889904022216797 ms to run.
Function load_lora_A took 1.8837451934814453 ms to run.
Function load_lora_B took 1.901865005493164 ms to run.
Function load_lora_A took 1.89208984375 ms to run.
Function load_lora_B took 1.8849372863769531 ms to run.
Function load_lora_A took 1.8916130065917969 ms to run.
Function load_lora_B took 1.9011497497558594 ms to run.
Function load_lora_A took 1.8608570098876953 ms to run.
Function load_lora_B took 1.893758773803711 ms to run.
cost realload: 19.59228515625
Function load_adapters took 19.614696502685547 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 25 in total
Function load_lora_A took 1.9092559814453125 ms to run.
Function load_lora_B took 1.8587112426757812 ms to run.
cost realload: 4.170894622802734
Function load_adapters took 4.192352294921875 ms to run.
current batch size: 27 token used ratio: 0.14833846153846153
cost load scan: 0.007867813110351562
load 1 adapters, 26 in total
Function load_lora_A took 1.8994808197021484 ms to run.
Function load_lora_B took 1.9049644470214844 ms to run.
cost realload: 4.214763641357422
Function load_adapters took 4.235506057739258 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 25 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5896091461181641 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 25 in total
cost realload: 0.29397010803222656
Function load_adapters took 0.3209114074707031 ms to run.
cost offload scan: 0.09822845458984375
offload 1 adapters, 24 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5981922149658203 ms to run.
cost offload scan: 0.12946128845214844
offload 2 adapters, 22 remains
cost offload cat: 0.0247955322265625
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.6270408630371094 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 23 in total
Function load_lora_A took 1.882314682006836 ms to run.
Function load_lora_B took 1.8792152404785156 ms to run.
cost realload: 4.165410995483398
Function load_adapters took 4.191398620605469 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 24 in total
Function load_lora_A took 1.897573471069336 ms to run.
Function load_lora_B took 1.9030570983886719 ms to run.
cost realload: 4.200935363769531
Function load_adapters took 4.222393035888672 ms to run.
current batch size: 29 token used ratio: 0.16383076923076922
cost offload scan: 0.09107589721679688
offload 1 adapters, 23 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty:INFO:     127.0.0.1:47578 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47584 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47588 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47602 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47608 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47614 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47622 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47634 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47636 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47648 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47664 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47674 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47676 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47688 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47698 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47700 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47704 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47716 - "POST /generate_stream HTTP/1.1" 200 OK
 0.023365020751953125
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.6248950958251953 ms to run.
offload 0 adapters, 23 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.10943412780761719
offload 1 adapters, 22 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.6175041198730469 ms to run.
cost offload scan: 0.09393692016601562
offload 1 adapters, 21 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.58746337890625 ms to run.
cost offload scan: 0.09417533874511719
offload 1 adapters, 20 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5900859832763672 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 21 in total
Function load_lora_A took 1.890420913696289 ms to run.
Function load_lora_B took 1.8923282623291016 ms to run.
cost realload: 4.1713714599609375
Function load_adapters took 4.192352294921875 ms to run.
cost load scan: 0.014066696166992188
load 1 adapters, 22 in total
Function load_lora_A took 1.89208984375 ms to run.
Function load_lora_B took 1.9032955169677734 ms to run.
cost realload: 4.20832633972168
Function load_adapters took 4.230260848999023 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.012636184692382812 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 21 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11539459228515625
Function offload_adapters took 0.6017684936523438 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 20 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5924701690673828 ms to run.
cost load scan: 0.011205673217773438
load 2 adapters, 22 in total
Function load_lora_A took 1.8804073333740234 ms to run.
Function load_lora_B took 1.89971923828125 ms to run.
Function load_lora_A took 1.8763542175292969 ms to run.
Function load_lora_B took 1.8908977508544922 ms to run.
cost realload: 8.01396369934082
Function load_adapters took 8.03518295288086 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 21 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5822181701660156 ms to run.
Avg tokens(prompt+generate) throughput: 2246.687 tokens/s
Avg prompt tokens throughput:           1269.528 tokens/s
Avg generate tokens throughput:          977.159 tokens/s
cost offload scan: 0.08702278137207031
offload 1 adapters, 20 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11539459228515625
Function offload_adapters took 0.6008148193359375 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 21 in total
Function load_lora_A took 1.8744468688964844 ms to run.
Function load_lora_B took 1.8999576568603516 ms to run.
cost realload: 4.174947738647461
Function load_adapters took 4.196405410766602 ms to run.
cost offload scan: 0.09703636169433594
offload 1 adapters, 20 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5996227264404297 ms to run.
current batch size: 23 token used ratio: 0.12667692307692308
offload 0 adapters, 20 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.0095367431640625
load 2 adapters, 22 in total
Function load_lora_A took 1.8849372863769531 ms to run.
Function load_lora_B took 1.8892288208007812 ms to run.
Function load_lora_A took 1.8880367279052734 ms to run.
Function load_lora_B took 1.8858909606933594 ms to run.
cost realload: 8.030176162719727
Function load_adapters took 8.052587509155273 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.014066696166992188 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 21 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5946159362792969 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 21 in total
cost realload: 0.28705596923828125
Function load_adapters took 0.3120899200439453 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 20 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5838871002197266 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 21 in total
Function load_lora_A took 1.9185543060302734 ms to run.
Function load_lora_B took 1.9021034240722656 ms to run.
cost realload: 4.239797592163086
Function load_adapters took 4.262208938598633 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 20 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5900859832763672 ms to run.
current batch size: 23 token used ratio: 0.12838461538461537
cost load scan: 0.008821487426757812
load 2 adapters, 22 in total
Function load_lora_A took 1.9071102142333984 ms to run.
Function load_lora_B took 1.8849372863769531 ms to run.
Function load_lora_A took 1.8754005432128906 ms to run.
Function load_lora_B took 1.928567886352539 ms to run.
cost realload: 8.088350296020508
Function load_adapters took 8.11004638671875 ms to run.
cost load scan: 0.012874603271484375
load 2 adapters, 24 in total
Function load_lora_A took 1.897573471069336 ms to run.
Function load_lora_B took 1.89208984375 ms to run.
Function load_lora_A took 1.8680095672607422 ms to run.
Function load_lora_B took 1.9023418426513672 ms to run.
cost realload: 8.039236068725586
Function load_adapters took 8.061647415161133 ms to run.
cost offload scan: 0.09894371032714844
offload 1 adapters, 23 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5991458892822266 ms to run.
offload 0 adapters, 23 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 22 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11682510375976562
Function offload_adapters took 0.5986690521240234 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 22 in total
cost realload: 0.30231475830078125
Function load_adapters took 0.32711029052734375 ms to run.
current batch size: 26 token used ratio: 0.15212307692307692
cost offload scan: 0.09226799011230469
offload 1 adapters, 21 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: INFO:     127.0.0.1:47718 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47724 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47740 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47754 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47762 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47764 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47768 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47776 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47788 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47804 - "POST /generate_stream HTTP/1.1" 200 OK
0.023603439331054688
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.6244182586669922 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 20 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5960464477539062 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 21 in total
Function load_lora_A took 1.8949508666992188 ms to run.
Function load_lora_B took 1.890420913696289 ms to run.
cost realload: 4.184961318969727
Function load_adapters took 4.20689582824707 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 22 in total
Function load_lora_A took 1.905679702758789 ms to run.
Function load_lora_B took 1.8961429595947266 ms to run.
cost realload: 4.202365875244141
Function load_adapters took 4.223108291625977 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 21 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5967617034912109 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 20 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.5974769592285156 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 19 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5993843078613281 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 18 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5888938903808594 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 17 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.583648681640625 ms to run.
current batch size: 19 token used ratio: 0.10955384615384615
cost load scan: 0.008106231689453125
load 0 adapters, 17 in total
cost realload: 0.2913475036621094
Function load_adapters took 0.3161430358886719 ms to run.
cost offload scan: 0.095367431640625
offload 1 adapters, 16 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.6120204925537109 ms to run.
cost load scan: 0.01239776611328125
load 3 adapters, 19 in total
Function load_lora_A took 1.8930435180664062 ms to run.
Function load_lora_B took 1.8873214721679688 ms to run.
Function load_lora_A took 1.8885135650634766 ms to run.
Function load_lora_B took 1.8994808197021484 ms to run.
Function load_lora_A took 1.8737316131591797 ms to run.
Function load_lora_B took 1.918792724609375 ms to run.
cost realload: 11.920690536499023
Function load_adapters took 11.941909790039062 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 18 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.5846023559570312 ms to run.
cost load scan: 0.007867813110351562
load 1 adapters, 19 in total
Function load_lora_A took 1.8835067749023438 ms to run.
Function load_lora_B took 1.9073486328125 ms to run.
cost realload: 4.203081130981445
Function load_adapters took 4.2247772216796875 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 18 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.12350082397460938
Function offload_adapters took 0.6000995635986328 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 17 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5908012390136719 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 16 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5967617034912109 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 15 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5981922149658203 ms to run.
current batch size: 17 token used ratio: 0.09113846153846154
cost load scan: 0.008821487426757812
load 1 adapters, 16 in total
Function load_lora_A took 1.9176006317138672 ms to run.
Function load_lora_B took 1.8820762634277344 ms to run.
cost realload: 4.202365875244141
Function load_adapters took 4.2247772216796875 ms to run.
cost load scan: 0.007867813110351562
load 1 adapters, 17 in total
Function load_lora_A took 1.8877983093261719 ms to run.
Function load_lora_B took 1.9195079803466797 ms to run.
cost realload: 4.218101501464844
Function load_adapters took 4.239082336425781 ms to run.
cost offload scan: 0.09393692016601562
offload 1 adapters, 16 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5862712860107422 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 15 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.579833984375 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 16 in total
Function load_lora_A took 1.8939971923828125 ms to run.
Function load_lora_B took 1.928567886352539 ms to run.
cost realload: 4.218816757202148
Function load_adapters took 4.241228103637695 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 15 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02956390380859375
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5867481231689453 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 16 in total
Function load_lora_A took 1.901388168334961 ms to run.
Function load_lora_B took 1.8870830535888672 ms to run.
cost realload: 4.189252853393555
Function load_adapters took 4.210233688354492 ms to run.
current batch size: 18 token used ratio: 0.09801538461538462
cost offload scan: 0.09059906005859375
offload 1 adapters, 15 remains
cost offload cat: 0.03504753112792969
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5970001220703125 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 14 remains
INFO:     127.0.0.1:47814 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47820 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47826 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47832 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47836 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47850 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47852 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47862 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47876 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47882 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42424 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42434 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42442 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42456 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.06937980651855469
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.6432533264160156 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 13 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.11467933654785156
Function offload_adapters took 0.5962848663330078 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 14 in total
Function load_lora_A took 1.8954277038574219 ms to run.
Function load_lora_B took 1.9085407257080078 ms to run.
cost realload: 4.212141036987305
Function load_adapters took 4.23431396484375 ms to run.
offload 0 adapters, 14 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 15 in total
Function load_lora_A took 1.882314682006836 ms to run.
Function load_lora_B took 1.8765926361083984 ms to run.
cost realload: 4.170894622802734
Function load_adapters took 4.192113876342773 ms to run.
current batch size: 16 token used ratio: 0.09033846153846153
offload 0 adapters, 15 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.091552734375
offload 1 adapters, 14 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5872249603271484 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 13 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.05245208740234375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5998611450195312 ms to run.
cost load scan: 0.007867813110351562
load 1 adapters, 14 in total
Function load_lora_A took 1.8727779388427734 ms to run.
Function load_lora_B took 1.8987655639648438 ms to run.
cost realload: 4.16111946105957
Function load_adapters took 4.183769226074219 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 13 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5869865417480469 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 12 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.5896091461181641 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 13 in total
Function load_lora_A took 1.890420913696289 ms to run.
Function load_lora_B took 1.8956661224365234 ms to run.
cost realload: 4.195451736450195
Function load_adapters took 4.216194152832031 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 12 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.102996826171875
Function offload_adapters took 0.5772113800048828 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 13 in total
Function load_lora_A took 1.880645751953125 ms to run.
Function load_lora_B took 1.8990039825439453 ms to run.
cost realload: 4.188776016235352
Function load_adapters took 4.210472106933594 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 12 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5776882171630859 ms to run.
current batch size: 12 token used ratio: 0.05826153846153846
cost load scan: 0.008344650268554688
load 1 adapters, 13 in total
Function load_lora_A took 1.9030570983886719 ms to run.
Function load_lora_B took 1.9104480743408203 ms to run.
cost realload: 4.212379455566406
Function load_adapters took 4.233837127685547 ms to run.
cost offload scan: 0.08559226989746094
offload 1 adapters, 12 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5843639373779297 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 13 in total
Function load_lora_A took 1.9314289093017578 ms to run.
Function load_lora_B took 1.9075870513916016 ms to run.
cost realload: 4.238367080688477
Function load_adapters took 4.259586334228516 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 13 in total
cost realload: 0.2925395965576172
Function load_adapters took 0.3190040588378906 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 12 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5869865417480469 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 11 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5900859832763672 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 12 in total
Function load_lora_A took 1.8961429595947266 ms to run.
Function load_lora_B took 1.9071102142333984 ms to run.
cost realload: 4.1961669921875
Function load_adapters took 4.216670989990234 ms to run.
current batch size: 15 token used ratio: 0.07636923076923077
cost offload scan: 0.08487701416015625
offload 1 adapters, 11 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.5795955657958984 ms to run.
Avg tokens(prompt+generate) throughput: 1619.476 tokens/s
Avg prompt tokens throughput:            841.305 tokens/s
Avg generate tokens throughput:          778.172 tokens/s
cost offload scan: 0.08487701416015625
offload 1 adapters, 10 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5762577056884766 ms to run.
cost offload scan: 0.09584426879882812
offload 1 adapters, 9 remains
cost offload cat: 0.03790855407714844
cost offload free mem manager: 0.05316734313964844
cost offload torch.empty: 0.03147125244140625
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.6418228149414062 ms to run.
current batch size: 12 token used ratio: 0.06704615384615385
cost load scan: 0.008344650268554688
load 1 adapters, 10 in total
Function load_lora_A took 1.8701553344726562 ms to run.
Function load_lora_B took 1.920938491821289 ms to run.
cost realload: 4.209280014038086
Function load_adapters took 4.230260848999023 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 9 remains
cost offload cat: 0.03910064697265625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.6029605865478516 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 9 in total
cost realload: 0.30612945556640625
Function load_adapters took 0.3306865692138672 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 8 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11754035949707031
INFO:     127.0.0.1:42458 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42474 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42476 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42490 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42502 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42512 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42526 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42532 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42542 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42556 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42570 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42574 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42590 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42598 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42600 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42610 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42612 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42620 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42632 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42642 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42650 - "POST /generate_stream HTTP/1.1" 200 OK
Function offload_adapters took 0.6220340728759766 ms to run.
cost load scan: 0.009298324584960938
load 2 adapters, 10 in total
Function load_lora_A took 1.9123554229736328 ms to run.
Function load_lora_B took 1.8808841705322266 ms to run.
Function load_lora_A took 1.901865005493164 ms to run.
Function load_lora_B took 1.922607421875 ms to run.
cost realload: 8.105993270874023
Function load_adapters took 8.128166198730469 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 9 remains
cost offload cat: 0.03910064697265625
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.6017684936523438 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 10 in total
Function load_lora_A took 1.9254684448242188 ms to run.
Function load_lora_B took 1.9054412841796875 ms to run.
cost realload: 4.258871078491211
Function load_adapters took 4.28009033203125 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 9 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5741119384765625 ms to run.
offload 0 adapters, 9 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 8 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5812644958496094 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 8 in total
cost realload: 0.2815723419189453
Function load_adapters took 0.30493736267089844 ms to run.
current batch size: 13 token used ratio: 0.06287692307692308
cost load scan: 0.008106231689453125
load 0 adapters, 8 in total
cost realload: 0.2970695495605469
Function load_adapters took 0.32067298889160156 ms to run.
offload 0 adapters, 8 remains
Function offload_adapters took 0.01239776611328125 ms to run.
offload 0 adapters, 8 remains
Function offload_adapters took 0.011682510375976562 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 9 in total
Function load_lora_A took 1.8987655639648438 ms to run.
Function load_lora_B took 1.9137859344482422 ms to run.
cost realload: 4.203557968139648
Function load_adapters took 4.2247772216796875 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 8 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5843639373779297 ms to run.
current batch size: 11 token used ratio: 0.05721538461538461
cost load scan: 0.00858306884765625
load 1 adapters, 9 in total
Function load_lora_A took 1.9071102142333984 ms to run.
Function load_lora_B took 1.8820762634277344 ms to run.
cost realload: 4.191875457763672
Function load_adapters took 4.212856292724609 ms to run.
offload 0 adapters, 9 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 10 in total
Function load_lora_A took 1.890420913696289 ms to run.
Function load_lora_B took 1.882791519165039 ms to run.
cost realload: 4.172563552856445
Function load_adapters took 4.196405410766602 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 9 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5748271942138672 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 10 in total
Function load_lora_A took 1.890420913696289 ms to run.
Function load_lora_B took 1.9176006317138672 ms to run.
cost realload: 4.2133331298828125
Function load_adapters took 4.234552383422852 ms to run.
current batch size: 12 token used ratio: 0.06632307692307693
cost load scan: 0.008821487426757812
load 1 adapters, 11 in total
Function load_lora_A took 1.8992424011230469 ms to run.
Function load_lora_B took 1.9028186798095703 ms to run.
cost realload: 4.199504852294922
Function load_adapters took 4.2209625244140625 ms to run.
cost load scan: 0.008821487426757812
load 2 adapters, 13 in total
Function load_lora_A took 1.8546581268310547 ms to run.
Function load_lora_B took 1.9099712371826172 ms to run.
Function load_lora_A took 1.8925666809082031 ms to run.
Function load_lora_B took 1.9061565399169922 ms to run.
cost realload: 8.0413818359375
Function load_adapters took 8.06283950805664 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 14 in total
Function load_lora_A took 1.9054412841796875 ms to run.
Function load_lora_B took 1.9178390502929688 ms to run.
cost realload: 4.220008850097656
Function load_adapters took 4.241466522216797 ms to run.
offload 0 adapters, 14 remains
Function offload_adapters took 0.01239776611328125 ms to run.
offload 0 adapters, 14 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 15 in total
Function load_lora_A took 1.9032955169677734 ms to run.
Function load_lora_B took 1.905679702758789 ms to run.
cost realload: 4.217386245727539
Function load_adapters took 4.238128662109375 ms to run.
current batch size: 15 token used ratio: 0.07956923076923077
cost load scan: 0.00762939453125
load 0 adapters, 15 in total
cost realload: 0.2899169921875
Function load_adapters took 0.3139972686767578 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 14 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.5939006805419922 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 15 in total
Function load_lora_A took 1.8880367279052734 ms to run.
Function load_lora_B took 1.9159317016601562 ms to run.
cost realload: 4.216194152832031
Function load_adapters took 4.237174987792969 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 14 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5803108215332031 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 13 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.5908012390136719 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 14 in total
Function load_lora_A took 1.8930435180664062 ms to run.
Function load_lora_B took 1.894235610961914 ms to run.
cost realload: 4.193782806396484
Function load_adapters took 4.215478897094727 ms to run.
cost load scan: 0.008821487426757812
load 2 adapters, 16 in total
Function load_lora_A took 1.9059181213378906 ms to run.
Function load_lora_B took 1.8818378448486328 ms to run.
Function load_lora_A took 1.8939971923828125 ms to run.
Function load_lora_B took 1.8723011016845703 ms to run.
cost realload: 8.03828239440918
Function load_adapters took 8.060216903686523 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 15 remains
cost offload cat: 0.03552436828613281
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11467933654785156
Function offload_adapters took 0.6101131439208984 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 16 in total
Function load_lora_A took 1.8699169158935547 ms to run.
Function load_lora_B took 1.9135475158691406 ms to run.
cost realload: 4.194498062133789
INFO:     127.0.0.1:42652 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42654 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42664 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42666 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42672 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42674 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42690 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42704 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42720 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42734 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33314 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33330 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33338 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33346 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_adapters took 4.216432571411133 ms to run.
current batch size: 18 token used ratio: 0.08293846153846154
cost load scan: 0.011920928955078125
load 2 adapters, 18 in total
Function load_lora_A took 1.874685287475586 ms to run.
Function load_lora_B took 1.8687248229980469 ms to run.
Function load_lora_A took 1.9023418426513672 ms to run.
Function load_lora_B took 1.901388168334961 ms to run.
cost realload: 8.021831512451172
Function load_adapters took 8.043766021728516 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 17 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.051021575927734375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11038780212402344
Function offload_adapters took 0.5981922149658203 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 18 in total
Function load_lora_A took 1.9137859344482422 ms to run.
Function load_lora_B took 1.9083023071289062 ms to run.
cost realload: 4.229545593261719
Function load_adapters took 4.2514801025390625 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.0133514404296875 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 18 in total
cost realload: 0.3135204315185547
Function load_adapters took 0.3383159637451172 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 18 in total
cost realload: 0.2903938293457031
Function load_adapters took 0.31566619873046875 ms to run.
current batch size: 22 token used ratio: 0.11069230769230769
cost load scan: 0.008344650268554688
load 1 adapters, 19 in total
Function load_lora_A took 1.9104480743408203 ms to run.
Function load_lora_B took 1.8756389617919922 ms to run.
cost realload: 4.187107086181641
Function load_adapters took 4.20832633972168 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 18 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5967617034912109 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 17 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5865097045898438 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 18 in total
Function load_lora_A took 1.8820762634277344 ms to run.
Function load_lora_B took 1.8951892852783203 ms to run.
cost realload: 4.181385040283203
Function load_adapters took 4.203319549560547 ms to run.
cost load scan: 0.012159347534179688
load 1 adapters, 19 in total
Function load_lora_A took 1.8732547760009766 ms to run.
Function load_lora_B took 1.9032955169677734 ms to run.
cost realload: 4.180192947387695
Function load_adapters took 4.2018890380859375 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.012159347534179688 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost offload scan: 0.09417533874511719
offload 1 adapters, 18 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5924701690673828 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 17 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.5884170532226562 ms to run.
current batch size: 19 token used ratio: 0.1018
cost offload scan: 0.08630752563476562
offload 1 adapters, 16 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5838871002197266 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 17 in total
Function load_lora_A took 1.8916130065917969 ms to run.
Function load_lora_B took 1.8877983093261719 ms to run.
cost realload: 4.179716110229492
Function load_adapters took 4.200935363769531 ms to run.
cost offload scan: 0.09417533874511719
offload 1 adapters, 16 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5929470062255859 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 15 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5848407745361328 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 16 in total
Function load_lora_A took 1.8982887268066406 ms to run.
Function load_lora_B took 1.9130706787109375 ms to run.
cost realload: 4.211902618408203
Function load_adapters took 4.236698150634766 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 15 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.049591064453125
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5936622619628906 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 14 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5781650543212891 ms to run.
current batch size: 16 token used ratio: 0.09724615384615384
cost load scan: 0.008106231689453125
load 0 adapters, 14 in total
cost realload: 0.2956390380859375
Function load_adapters took 0.3197193145751953 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 13 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5862712860107422 ms to run.
Avg tokens(prompt+generate) throughput: 1522.328 tokens/s
Avg prompt tokens throughput:            880.385 tokens/s
Avg generate tokens throughput:          641.943 tokens/s
cost offload scan: 0.08487701416015625
offload 1 adapters, 12 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5853176116943359 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 12 in total
cost realload: 0.2892017364501953
Function load_adapters took 0.31256675720214844 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 11 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5776882171630859 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 10 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5810260772705078 ms to run.
cost offload scan: 0.08368492126464844
offload 1 adapters, 9 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.05173683166503906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5817413330078125 ms to run.
current batch size: 13 token used ratio: 0.07646153846153846
cost offload scan: 0.09441375732421875
offload 1 adapters, 8 remains
