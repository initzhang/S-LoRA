For some LLaMA-based models, initializing the fast tokenizer may take a long time. To eliminate the initialization time, consider using 'hf-internal-testing/llama-tokenizer' instead of the original tokenizer.
llama-7b: 12.06 GB
peak working mem for (bs=20, seqlen=512): 0.70 GB
peak working mem for (bs=100, seqlen=512): 3.52 GB
all adapters (101) estimated size: 1.58 GB
avg adapter estimated size: 16.00 MB
INFO:     127.0.0.1:35744 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35754 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35756 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35770 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35784 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35794 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35796 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35806 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35816 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35830 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35836 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35842 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35850 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35854 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35856 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35870 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35884 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35896 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35902 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35916 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35918 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35926 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35940 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35946 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35956 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35962 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35976 - "POST /generate_stream HTTP/1.1" 200 OK
cost load scan: 0.010728836059570312
load 2 adapters, 2 in total
Function load_lora_A took 1.497507095336914 ms to run.
Function load_lora_B took 1.2667179107666016 ms to run.
Function load_lora_A took 1.176595687866211 ms to run.
Function load_lora_B took 1.214742660522461 ms to run.
cost realload: 9.592771530151367
Function load_adapters took 9.620428085327148 ms to run.
Avg tokens(prompt+generate) throughput:   44.107 tokens/s
Avg prompt tokens throughput:             44.107 tokens/s
Avg generate tokens throughput:            0.000 tokens/s
cost load scan: 0.01049041748046875
load 3 adapters, 5 in total
Function load_lora_A took 1.1639595031738281 ms to run.
Function load_lora_B took 1.2416839599609375 ms to run.
Function load_lora_A took 1.2028217315673828 ms to run.
Function load_lora_B took 1.2578964233398438 ms to run.
Function load_lora_A took 1.1954307556152344 ms to run.
Function load_lora_B took 1.2309551239013672 ms to run.
cost realload: 7.947444915771484
Function load_adapters took 7.971525192260742 ms to run.
current batch size: 6 token used ratio: 0.022353846153846155
cost load scan: 0.01049041748046875
load 2 adapters, 7 in total
Function load_lora_A took 1.2288093566894531 ms to run.
Function load_lora_B took 1.2409687042236328 ms to run.
Function load_lora_A took 1.2135505676269531 ms to run.
Function load_lora_B took 1.1773109436035156 ms to run.
cost realload: 5.340337753295898
Function load_adapters took 5.362749099731445 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 8 in total
Function load_lora_A took 1.2013912200927734 ms to run.
Function load_lora_B took 1.220703125 ms to run.
cost realload: 2.8247833251953125
Function load_adapters took 2.8476715087890625 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 9 in total
Function load_lora_A took 1.1858940124511719 ms to run.
Function load_lora_B took 1.2021064758300781 ms to run.
cost realload: 2.7899742126464844
Function load_adapters took 2.8121471405029297 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 10 in total
Function load_lora_A took 1.1916160583496094 ms to run.
Function load_lora_B took 1.222372055053711 ms to run.
cost realload: 2.8018951416015625
Function load_adapters took 2.8235912322998047 ms to run.
current batch size: 11 token used ratio: 0.04566153846153846
cost load scan: 0.0095367431640625
load 2 adapters, 12 in total
Function load_lora_A took 1.2135505676269531 ms to run.
Function load_lora_B took 1.2171268463134766 ms to run.
Function load_lora_A took 1.2004375457763672 ms to run.
Function load_lora_B took 1.2044906616210938 ms to run.
cost realload: 5.311489105224609
Function load_adapters took 5.332708358764648 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 13 in total
Function load_lora_A took 1.256704330444336 ms to run.
Function load_lora_B took 1.2373924255371094 ms to run.
cost realload: 2.880573272705078
Function load_adapters took 2.901792526245117 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 14 in total
Function load_lora_A took 1.2116432189941406 ms to run.
Function load_lora_B took 1.1992454528808594 ms to run.
cost realload: 2.808809280395508
Function load_adapters took 2.83050537109375 ms to run.
cost load scan: 0.00858306884765625
load 0 adapters, 14 in total
cost realload: 0.2849102020263672
Function load_adapters took 0.3104209899902344 ms to run.
offload 0 adapters, 14 remains
Function offload_adapters took 0.0133514404296875 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 15 in total
Function load_lora_A took 1.2454986572265625 ms to run.
Function load_lora_B took 1.2543201446533203 ms to run.
cost realload: 2.9027462005615234
Function load_adapters took 2.9249191284179688 ms to run.
current batch size: 16 token used ratio: 0.07567692307692307
cost load scan: 0.0095367431640625
load 1 adapters, 16 in total
Function load_lora_A took 1.2445449829101562 ms to run.
Function load_lora_B took 1.2385845184326172 ms to run.
cost realload: 2.880096435546875
Function load_adapters took 2.904176712036133 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 17 in total
Function load_lora_A took 1.2545585632324219 ms to run.
Function load_lora_B took 1.2001991271972656 ms to run.
cost realload: 2.8510093688964844
Function load_adapters took 2.8722286224365234 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 18 in total
Function load_lora_A took 1.2769699096679688 ms to run.
Function load_lora_B took 1.194000244140625 ms to run.
cost realload: 2.8743743896484375
Function load_adapters took 2.895355224609375 ms to run.
cost offload scan: 0.1537799835205078
offload 1 adapters, 17 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 12.80069351196289
Function offload_adapters took 13.349771499633789 ms to run.
cost offload scan: 0.1308917999267578
offload 1 adapters, 16 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.6196498870849609 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 17 in total
Function load_lora_A took 1.245737075805664 ms to run.
Function load_lora_B took 1.1889934539794922 ms to run.
cost realload: 2.820253372192383
Function load_adapters took 2.841472625732422 ms to run.
current batch size: 18 token used ratio: 0.09343076923076923
cost load scan: 0.009298324584960938
load 1 adapters, 18 in total
Function load_lora_A took 1.222372055053711 ms to run.
Function load_lora_B took 1.2116432189941406 ms to run.
cost realload: 2.8285980224609375
Function load_adapters took 2.8519630432128906 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 17 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5800724029541016 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 17 in total
cost realload: 0.29015541076660156
Function load_adapters took 0.3178119659423828 ms to run.
cost offload scan: 0.15211105346679688
offload 1 adapters, 16 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.6477832794189453 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 15 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.560760498046875 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 14 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5736351013183594 ms to run.
offload 0 adapters, 14 remains
Function offload_adapters took 0.01239776611328125 ms to run.
current batch size: 15 token used ratio: 0.08724615384615385
cost offload scan: 0.08344650268554688
offload 1 adapters, 13 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5645751953125 ms to run.
cost load scan: 0.009775161743164062
load 2 adapters, 15 in total
Function load_lora_A took 1.2471675872802734 ms to run.
Function load_lora_B took 1.2118816375732422 ms to run.
Function load_lora_A took 1.2161731719970703 ms to run.
Function load_lora_B took 1.241922378540039 ms to run.
cost realload: 5.404949188232422
Function load_adapters took 5.425930023193359 ms to run.
cost load scan: 0.009059906005859375
load 2 adapters, 17 in total
INFO:     127.0.0.1:35990 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36002 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36016 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36020 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36022 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36026 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36042 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36048 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36052 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36062 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36072 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36084 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36100 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36102 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36104 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36108 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36110 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39676 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39684 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39694 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39706 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39722 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39728 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 1.2302398681640625 ms to run.
Function load_lora_B took 1.207590103149414 ms to run.
Function load_lora_A took 1.1992454528808594 ms to run.
Function load_lora_B took 1.2204647064208984 ms to run.
cost realload: 5.362033843994141
Function load_adapters took 5.383968353271484 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 16 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.5915164947509766 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 15 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5838871002197266 ms to run.
cost offload scan: 0.08249282836914062
offload 1 adapters, 14 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5714893341064453 ms to run.
offload 0 adapters, 14 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.08273124694824219
offload 1 adapters, 13 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.568389892578125 ms to run.
current batch size: 13 token used ratio: 0.0702923076923077
cost load scan: 0.009298324584960938
load 1 adapters, 14 in total
Function load_lora_A took 1.2340545654296875 ms to run.
Function load_lora_B took 1.1894702911376953 ms to run.
cost realload: 2.8290748596191406
Function load_adapters took 2.850055694580078 ms to run.
cost offload scan: 0.0820159912109375
offload 1 adapters, 13 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.05245208740234375
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5738735198974609 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 12 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.028848648071289062
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5800724029541016 ms to run.
cost offload scan: 0.08392333984375
offload 1 adapters, 11 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5741119384765625 ms to run.
cost load scan: 0.011682510375976562
load 6 adapters, 17 in total
Function load_lora_A took 1.2378692626953125 ms to run.
Function load_lora_B took 1.2292861938476562 ms to run.
Function load_lora_A took 1.2059211730957031 ms to run.
Function load_lora_B took 1.2197494506835938 ms to run.
Function load_lora_A took 1.2121200561523438 ms to run.
Function load_lora_B took 1.1949539184570312 ms to run.
Function load_lora_A took 1.2350082397460938 ms to run.
Function load_lora_B took 1.2485980987548828 ms to run.
Function load_lora_A took 1.1630058288574219 ms to run.
Function load_lora_B took 1.2362003326416016 ms to run.
Function load_lora_A took 1.199483871459961 ms to run.
Function load_lora_B took 1.2273788452148438 ms to run.
cost realload: 15.34581184387207
Function load_adapters took 15.36703109741211 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 16 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5743503570556641 ms to run.
cost load scan: 0.008821487426757812
load 2 adapters, 18 in total
Function load_lora_A took 1.2502670288085938 ms to run.
Function load_lora_B took 1.2145042419433594 ms to run.
Function load_lora_A took 1.2142658233642578 ms to run.
Function load_lora_B took 1.2230873107910156 ms to run.
cost realload: 5.368471145629883
Function load_adapters took 5.389690399169922 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 17 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10156631469726562
Function offload_adapters took 0.5693435668945312 ms to run.
cost load scan: 0.0095367431640625
load 3 adapters, 20 in total
Function load_lora_A took 1.2269020080566406 ms to run.
Function load_lora_B took 1.2297630310058594 ms to run.
Function load_lora_A took 1.237630844116211 ms to run.
Function load_lora_B took 1.232147216796875 ms to run.
Function load_lora_A took 1.15966796875 ms to run.
Function load_lora_B took 1.2242794036865234 ms to run.
cost realload: 7.835149765014648
Function load_adapters took 7.856130599975586 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 21 in total
Function load_lora_A took 1.238107681274414 ms to run.
Function load_lora_B took 1.2102127075195312 ms to run.
cost realload: 2.833127975463867
Function load_adapters took 2.8543472290039062 ms to run.
current batch size: 21 token used ratio: 0.10367692307692308
cost load scan: 0.0095367431640625
load 2 adapters, 23 in total
Function load_lora_A took 1.2333393096923828 ms to run.
Function load_lora_B took 1.1951923370361328 ms to run.
Function load_lora_A took 1.2450218200683594 ms to run.
Function load_lora_B took 1.2447834014892578 ms to run.
cost realload: 5.395412445068359
Function load_adapters took 5.416631698608398 ms to run.
cost load scan: 0.009298324584960938
load 2 adapters, 25 in total
Function load_lora_A took 1.2083053588867188 ms to run.
Function load_lora_B took 1.2192726135253906 ms to run.
Function load_lora_A took 1.1913776397705078 ms to run.
Function load_lora_B took 1.2519359588623047 ms to run.
cost realload: 5.338191986083984
Function load_adapters took 5.359888076782227 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 26 in total
Function load_lora_A took 1.1935234069824219 ms to run.
Function load_lora_B took 1.2080669403076172 ms to run.
cost realload: 2.8023719787597656
Function load_adapters took 2.8226375579833984 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 25 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5862712860107422 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 26 in total
Function load_lora_A took 1.2161731719970703 ms to run.
Function load_lora_B took 1.2018680572509766 ms to run.
cost realload: 2.8171539306640625
Function load_adapters took 2.8378963470458984 ms to run.
current batch size: 26 token used ratio: 0.14323076923076922
cost load scan: 0.008344650268554688
load 1 adapters, 27 in total
Function load_lora_A took 1.2292861938476562 ms to run.
Function load_lora_B took 1.22833251953125 ms to run.
cost realload: 2.851724624633789
Function load_adapters took 2.8727054595947266 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 26 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11944770812988281
Function offload_adapters took 0.5915164947509766 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 27 in total
Function load_lora_A took 1.2180805206298828 ms to run.
Function load_lora_B took 1.2295246124267578 ms to run.
cost realload: 2.8448104858398438
Function load_adapters took 2.865314483642578 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 28 in total
INFO:     127.0.0.1:39730 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39732 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39740 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39742 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39756 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39758 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39762 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39770 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 1.2507438659667969 ms to run.
Function load_lora_B took 1.2004375457763672 ms to run.
cost realload: 2.9211044311523438
Function load_adapters took 2.941131591796875 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 27 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.030517578125
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6029605865478516 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 26 remains
cost offload cat: 0.02956390380859375
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11777877807617188
Function offload_adapters took 0.5865097045898438 ms to run.
cost load scan: 0.010251998901367188
load 4 adapters, 30 in total
Function load_lora_A took 1.2218952178955078 ms to run.
Function load_lora_B took 1.2395381927490234 ms to run.
Function load_lora_A took 1.2199878692626953 ms to run.
Function load_lora_B took 1.2302398681640625 ms to run.
Function load_lora_A took 1.2383460998535156 ms to run.
Function load_lora_B took 1.2111663818359375 ms to run.
Function load_lora_A took 1.2035369873046875 ms to run.
Function load_lora_B took 1.19781494140625 ms to run.
cost realload: 10.357379913330078
Function load_adapters took 10.378599166870117 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 29 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5803108215332031 ms to run.
current batch size: 29 token used ratio: 0.16853846153846153
Avg tokens(prompt+generate) throughput: 2028.685 tokens/s
Avg prompt tokens throughput:           1357.412 tokens/s
Avg generate tokens throughput:          671.272 tokens/s
cost offload scan: 0.09489059448242188
offload 1 adapters, 28 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5850791931152344 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 27 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5888938903808594 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 26 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1163482666015625
Function offload_adapters took 0.5855560302734375 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 25 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5843639373779297 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 24 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5774497985839844 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 25 in total
Function load_lora_A took 1.1544227600097656 ms to run.
Function load_lora_B took 1.2154579162597656 ms to run.
cost realload: 2.7687549591064453
Function load_adapters took 2.7899742126464844 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 24 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.5822181701660156 ms to run.
cost offload scan: 0.091552734375
offload 1 adapters, 23 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5779266357421875 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 23 in total
cost realload: 0.29659271240234375
Function load_adapters took 0.3228187561035156 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 22 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04696846008300781
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11181831359863281
Function offload_adapters took 0.5931854248046875 ms to run.
current batch size: 23 token used ratio: 0.1406769230769231
cost load scan: 0.012159347534179688
load 1 adapters, 23 in total
Function load_lora_A took 1.2531280517578125 ms to run.
Function load_lora_B took 1.233816146850586 ms to run.
cost realload: 2.887725830078125
Function load_adapters took 2.912282943725586 ms to run.
offload 0 adapters, 23 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 24 in total
Function load_lora_A took 1.238107681274414 ms to run.
Function load_lora_B took 1.2323856353759766 ms to run.
cost realload: 2.872467041015625
Function load_adapters took 2.8939247131347656 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 23 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04887580871582031
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5853176116943359 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 22 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.05030632019042969
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5853176116943359 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 21 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.6070137023925781 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 20 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.576019287109375 ms to run.
current batch size: 20 token used ratio: 0.1301076923076923
cost load scan: 0.01049041748046875
load 1 adapters, 21 in total
Function load_lora_A took 1.2156963348388672 ms to run.
Function load_lora_B took 1.2345314025878906 ms to run.
cost realload: 2.861499786376953
Function load_adapters took 2.8841495513916016 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 20 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5867481231689453 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 19 remains
cost offload cat: 0.03838539123535156
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5862712860107422 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 18 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5779266357421875 ms to run.
cost offload scan: 0.09989738464355469
offload 1 adapters, 17 remains
INFO:     127.0.0.1:39778 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39780 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39786 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39788 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39798 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39810 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39814 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39826 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39830 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39832 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39844 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39854 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39856 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39862 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39872 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04792213439941406
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.6356239318847656 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 18 in total
Function load_lora_A took 1.2242794036865234 ms to run.
Function load_lora_B took 1.249074935913086 ms to run.
cost realload: 2.8722286224365234
Function load_adapters took 2.8934478759765625 ms to run.
cost load scan: 0.01430511474609375
load 1 adapters, 19 in total
Function load_lora_A took 1.2154579162597656 ms to run.
Function load_lora_B took 1.2309551239013672 ms to run.
cost realload: 2.843141555786133
Function load_adapters took 2.8641223907470703 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 18 remains
cost offload cat: 0.0362396240234375
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.102996826171875
Function offload_adapters took 0.5714893341064453 ms to run.
current batch size: 18 token used ratio: 0.12012307692307693
cost load scan: 0.013828277587890625
load 1 adapters, 19 in total
Function load_lora_A took 1.220703125 ms to run.
Function load_lora_B took 1.201629638671875 ms to run.
cost realload: 2.844572067260742
Function load_adapters took 2.866983413696289 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 18 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5879402160644531 ms to run.
cost offload scan: 0.08559226989746094
offload 1 adapters, 17 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.576019287109375 ms to run.
cost offload scan: 0.12874603271484375
offload 2 adapters, 15 remains
cost offload cat: 0.025272369384765625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.6067752838134766 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 14 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5717277526855469 ms to run.
cost offload scan: 0.08368492126464844
offload 1 adapters, 13 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5781650543212891 ms to run.
cost offload scan: 0.08249282836914062
offload 1 adapters, 12 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5743503570556641 ms to run.
current batch size: 12 token used ratio: 0.07716923076923077
cost offload scan: 0.08535385131835938
offload 1 adapters, 11 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5736351013183594 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 12 in total
Function load_lora_A took 1.2440681457519531 ms to run.
Function load_lora_B took 1.2392997741699219 ms to run.
cost realload: 2.9048919677734375
Function load_adapters took 2.9268264770507812 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 13 in total
Function load_lora_A took 1.2226104736328125 ms to run.
Function load_lora_B took 1.2159347534179688 ms to run.
cost realload: 2.835988998413086
Function load_adapters took 2.857208251953125 ms to run.
cost load scan: 0.01049041748046875
load 2 adapters, 15 in total
Function load_lora_A took 1.2149810791015625 ms to run.
Function load_lora_B took 1.2519359588623047 ms to run.
Function load_lora_A took 1.2111663818359375 ms to run.
Function load_lora_B took 1.2218952178955078 ms to run.
cost realload: 5.368232727050781
Function load_adapters took 5.3882598876953125 ms to run.
current batch size: 15 token used ratio: 0.09212307692307692
cost offload scan: 0.08368492126464844
offload 1 adapters, 14 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5733966827392578 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 15 in total
Function load_lora_A took 1.211404800415039 ms to run.
Function load_lora_B took 1.2269020080566406 ms to run.
cost realload: 2.8221607208251953
Function load_adapters took 2.8433799743652344 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 14 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5707740783691406 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 15 in total
Function load_lora_A took 1.2247562408447266 ms to run.
Function load_lora_B took 1.222848892211914 ms to run.
cost realload: 2.8307437896728516
Function load_adapters took 2.850770950317383 ms to run.
cost offload scan: 0.08273124694824219
offload 1 adapters, 14 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5767345428466797 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 15 in total
Function load_lora_A took 1.2199878692626953 ms to run.
Function load_lora_B took 1.2333393096923828 ms to run.
cost realload: 2.8471946716308594
Function load_adapters took 2.867460250854492 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 14 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5767345428466797 ms to run.
cost offload scan: 0.12636184692382812
offload 2 adapters, 12 remains
cost offload cat: 0.024318695068359375
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5998611450195312 ms to run.
cost load scan: 0.011444091796875
load 3 adapters, 15 in total
Function load_lora_A took 1.2042522430419922 ms to run.
Function load_lora_B took 1.2011528015136719 ms to run.
Function load_lora_A took 1.2204647064208984 ms to run.
Function load_lora_B took 1.1827945709228516 ms to run.
Function load_lora_A took 1.18255615234375 ms to run.
Function load_lora_B took 1.2443065643310547 ms to run.
cost realload: 7.7667236328125
Function load_adapters took 7.788658142089844 ms to run.
current batch size: 16 token used ratio: 0.08450769230769231
cost offload scan: 0.08511543273925781
offload 1 adapters, 14 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5676746368408203 ms to run.
cost offload scan: 0.08392333984375
offload 1 adapters, 13 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10251998901367188
Function offload_adapters took 0.5640983581542969 ms to run.
cost load scan: INFO:     127.0.0.1:39878 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39884 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51692 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51696 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51712 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51716 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51722 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51738 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51748 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51764 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51774 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51788 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51798 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51804 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51814 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51822 - "POST /generate_stream HTTP/1.1" 200 OK
0.008106231689453125
load 1 adapters, 14 in total
Function load_lora_A took 1.2288093566894531 ms to run.
Function load_lora_B took 1.2269020080566406 ms to run.
cost realload: 2.880096435546875
Function load_adapters took 2.90679931640625 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 15 in total
Function load_lora_A took 1.2137889862060547 ms to run.
Function load_lora_B took 1.2066364288330078 ms to run.
cost realload: 2.8100013732910156
Function load_adapters took 2.8314590454101562 ms to run.
current batch size: 16 token used ratio: 0.08687692307692307
cost offload scan: 0.08511543273925781
offload 1 adapters, 14 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5762577056884766 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 15 in total
Function load_lora_A took 1.2555122375488281 ms to run.
Function load_lora_B took 1.1818408966064453 ms to run.
cost realload: 2.8409957885742188
Function load_adapters took 2.8619766235351562 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 16 in total
Function load_lora_A took 1.2059211730957031 ms to run.
Function load_lora_B took 1.226663589477539 ms to run.
cost realload: 2.8302669525146484
Function load_adapters took 2.8510093688964844 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 15 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5762577056884766 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 15 in total
cost realload: 0.2810955047607422
Function load_adapters took 0.3039836883544922 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 16 in total
Function load_lora_A took 1.262664794921875 ms to run.
Function load_lora_B took 1.2173652648925781 ms to run.
cost realload: 2.891063690185547
Function load_adapters took 2.914905548095703 ms to run.
current batch size: 19 token used ratio: 0.11016923076923077
cost load scan: 0.014781951904296875
load 2 adapters, 18 in total
Function load_lora_A took 1.201629638671875 ms to run.
Function load_lora_B took 1.2199878692626953 ms to run.
Function load_lora_A took 1.2176036834716797 ms to run.
Function load_lora_B took 1.1975765228271484 ms to run.
cost realload: 5.291223526000977
Function load_adapters took 5.312442779541016 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 19 in total
Function load_lora_A took 1.2102127075195312 ms to run.
Function load_lora_B took 1.2047290802001953 ms to run.
cost realload: 2.8073787689208984
Function load_adapters took 2.8274059295654297 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost offload scan: 0.08392333984375
offload 1 adapters, 18 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5784034729003906 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 19 in total
Function load_lora_A took 1.241445541381836 ms to run.
Function load_lora_B took 1.2552738189697266 ms to run.
cost realload: 2.8743743896484375
Function load_adapters took 2.8939247131347656 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 18 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5774497985839844 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 17 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5729198455810547 ms to run.
current batch size: 19 token used ratio: 0.10252307692307693
Avg tokens(prompt+generate) throughput: 1517.962 tokens/s
Avg prompt tokens throughput:            758.032 tokens/s
Avg generate tokens throughput:          759.929 tokens/s
cost offload scan: 0.09202957153320312
offload 1 adapters, 16 remains
cost offload cat: 0.03719329833984375
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5881786346435547 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 17 in total
Function load_lora_A took 1.1906623840332031 ms to run.
Function load_lora_B took 1.224517822265625 ms to run.
cost realload: 2.83050537109375
Function load_adapters took 2.852201461791992 ms to run.
offload 0 adapters, 17 remains
Function offload_adapters took 0.01239776611328125 ms to run.
offload 0 adapters, 17 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 16 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.05125999450683594
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5943775177001953 ms to run.
current batch size: 16 token used ratio: 0.0977076923076923
cost offload scan: 0.08416175842285156
offload 1 adapters, 15 remains
cost offload cat: 0.029325485229492188
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10228157043457031
Function offload_adapters took 0.5681514739990234 ms to run.
cost offload scan: 0.08368492126464844
offload 1 adapters, 14 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5712509155273438 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 15 in total
Function load_lora_A took 1.2674331665039062 ms to run.
Function load_lora_B took 1.2326240539550781 ms to run.
cost realload: 2.8846263885498047
Function load_adapters took 2.9048919677734375 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 16 in total
Function load_lora_A took 1.2083053588867188 ms to run.
Function load_lora_B took 1.2426376342773438 ms to run.
cost realload: 2.8367042541503906
Function load_adapters took 2.8574466705322266 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 16 in total
cost realload: 0.2846717834472656
Function load_adapters took 0.30922889709472656 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 15 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11205673217773438
Function offload_adapters took 0.5719661712646484 ms to run.
cost offload scan: 0.08225440979003906
offload 1 adapters, 14 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5617141723632812 ms to run.
cost load scan: 0.011920928955078125
load 2 adapters, 16 in total
Function load_lora_A took 1.2362003326416016 ms to run.
Function load_lora_B took 1.2102127075195312 ms to run.
Function load_lora_A took 1.2357234954833984 ms to run.
Function load_lora_B took 1.2173652648925781 ms to run.
cost realload: 5.365610122680664
Function load_adapters took 5.386590957641602 ms to run.
offload 0 adapters, 16 remains
Function offload_adapters took 0.012159347534179688 ms to run.
current batch size: 16 token used ratio: 0.0886923076923077
cost offload scan: 0.08916854858398438
offload 1 adapters, 15 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04291534423828125
INFO:     127.0.0.1:51836 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51842 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51850 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51854 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51868 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51880 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51884 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51900 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51910 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51914 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51916 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51920 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51926 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51938 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51954 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51970 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51984 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51996 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52002 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52012 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.6022453308105469 ms to run.
cost offload scan: 0.08368492126464844
offload 1 adapters, 14 remains
cost offload cat: 0.02956390380859375
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10275840759277344
Function offload_adapters took 0.5581378936767578 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 13 remains
cost offload cat: 0.036716461181640625
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5791187286376953 ms to run.
cost load scan: 0.01239776611328125
load 1 adapters, 14 in total
Function load_lora_A took 1.256704330444336 ms to run.
Function load_lora_B took 1.2288093566894531 ms to run.
cost realload: 2.8786659240722656
Function load_adapters took 2.897977828979492 ms to run.
cost offload scan: 0.08392333984375
offload 1 adapters, 13 remains
cost offload cat: 0.02956390380859375
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5698204040527344 ms to run.
cost offload scan: 0.0820159912109375
offload 1 adapters, 12 remains
cost offload cat: 0.02956390380859375
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10085105895996094
Function offload_adapters took 0.5509853363037109 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 11 remains
cost offload cat: 0.02956390380859375
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10228157043457031
Function offload_adapters took 0.5662441253662109 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 12 in total
Function load_lora_A took 1.2242794036865234 ms to run.
Function load_lora_B took 1.2340545654296875 ms to run.
cost realload: 2.856016159057617
Function load_adapters took 2.8769969940185547 ms to run.
current batch size: 12 token used ratio: 0.06535384615384615
cost load scan: 0.008344650268554688
load 1 adapters, 13 in total
Function load_lora_A took 1.2159347534179688 ms to run.
Function load_lora_B took 1.2099742889404297 ms to run.
cost realload: 2.824544906616211
Function load_adapters took 2.844572067260742 ms to run.
cost offload scan: 0.0820159912109375
offload 1 adapters, 12 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.021457672119140625
cost offload a_loc update: 0.10251998901367188
Function offload_adapters took 0.5581378936767578 ms to run.
cost load scan: 0.016927719116210938
load 2 adapters, 14 in total
Function load_lora_A took 1.2772083282470703 ms to run.
Function load_lora_B took 1.256704330444336 ms to run.
Function load_lora_A took 1.2159347534179688 ms to run.
Function load_lora_B took 1.2252330780029297 ms to run.
cost realload: 5.44285774230957
Function load_adapters took 5.464076995849609 ms to run.
cost load scan: 0.013828277587890625
load 2 adapters, 16 in total
Function load_lora_A took 1.2314319610595703 ms to run.
Function load_lora_B took 1.2407302856445312 ms to run.
Function load_lora_A took 1.24359130859375 ms to run.
Function load_lora_B took 1.1758804321289062 ms to run.
cost realload: 5.368232727050781
Function load_adapters took 5.390405654907227 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 15 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11587142944335938
Function offload_adapters took 0.5862712860107422 ms to run.
cost load scan: 0.011920928955078125
load 2 adapters, 17 in total
Function load_lora_A took 1.2331008911132812 ms to run.
Function load_lora_B took 1.154184341430664 ms to run.
Function load_lora_A took 1.2013912200927734 ms to run.
Function load_lora_B took 1.2617111206054688 ms to run.
cost realload: 5.309581756591797
Function load_adapters took 5.330324172973633 ms to run.
cost offload scan: 0.08559226989746094
offload 1 adapters, 16 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11444091796875
Function offload_adapters took 0.5795955657958984 ms to run.
cost load scan: 0.013828277587890625
load 1 adapters, 17 in total
Function load_lora_A took 1.2176036834716797 ms to run.
Function load_lora_B took 1.230001449584961 ms to run.
cost realload: 2.8464794158935547
Function load_adapters took 2.866983413696289 ms to run.
current batch size: 17 token used ratio: 0.08709230769230769
cost offload scan: 0.0858306884765625
offload 1 adapters, 16 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11587142944335938
Function offload_adapters took 0.5898475646972656 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 17 in total
Function load_lora_A took 1.226186752319336 ms to run.
Function load_lora_B took 1.2116432189941406 ms to run.
cost realload: 2.839326858520508
Function load_adapters took 2.8600692749023438 ms to run.
cost offload scan: 0.08296966552734375
offload 1 adapters, 16 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5686283111572266 ms to run.
cost load scan: 0.012159347534179688
load 1 adapters, 17 in total
Function load_lora_A took 1.178741455078125 ms to run.
Function load_lora_B took 1.2552738189697266 ms to run.
cost realload: 2.8345584869384766
Function load_adapters took 2.856016159057617 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 16 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5776882171630859 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 17 in total
Function load_lora_A took 1.2347698211669922 ms to run.
Function load_lora_B took 1.222372055053711 ms to run.
cost realload: 2.8562545776367188
Function load_adapters took 2.8848648071289062 ms to run.
current batch size: 19 token used ratio: 0.10249230769230769
cost load scan: 0.014781951904296875
load 2 adapters, 19 in total
Function load_lora_A took 1.2271404266357422 ms to run.
Function load_lora_B took 1.2362003326416016 ms to run.
Function load_lora_A took 1.199483871459961 ms to run.
Function load_lora_B took 1.2292861938476562 ms to run.
cost realload: 5.385160446166992
Function load_adapters took 5.408048629760742 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 20 in total
Function load_lora_A took 1.2192726135253906 ms to run.
Function load_lora_B took 1.2362003326416016 ms to run.
cost realload: 2.8488636016845703
Function load_adapters took 2.8696060180664062 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 19 remains
cost offload cat: 0.04029273986816406
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.5939006805419922 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 18 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5676746368408203 ms to run.
current batch size: 20 token used ratio: 0.11403076923076923
cost load scan: 0.010013580322265625
load 1 adapters, 19 in total
INFO:     127.0.0.1:52014 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53382 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53392 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53394 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53396 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53404 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53418 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53428 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53436 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 1.2431144714355469 ms to run.
Function load_lora_B took 1.2524127960205078 ms to run.
cost realload: 2.9516220092773438
Function load_adapters took 2.973318099975586 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 18 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5800724029541016 ms to run.
cost load scan: 0.015974044799804688
load 1 adapters, 19 in total
Function load_lora_A took 1.2354850769042969 ms to run.
Function load_lora_B took 1.2345314025878906 ms to run.
cost realload: 2.8731822967529297
Function load_adapters took 2.893686294555664 ms to run.
cost load scan: 0.01239776611328125
load 1 adapters, 20 in total
Function load_lora_A took 1.2011528015136719 ms to run.
Function load_lora_B took 1.1968612670898438 ms to run.
cost realload: 2.7914047241210938
Function load_adapters took 2.8121471405029297 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 19 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.051021575927734375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5881786346435547 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.012874603271484375 ms to run.
current batch size: 20 token used ratio: 0.1206
cost offload scan: 0.08440017700195312
offload 1 adapters, 18 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5793571472167969 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 17 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5755424499511719 ms to run.
cost load scan: 0.01621246337890625
load 1 adapters, 18 in total
Function load_lora_A took 1.2235641479492188 ms to run.
Function load_lora_B took 1.2583732604980469 ms to run.
cost realload: 2.9087066650390625
Function load_adapters took 2.929210662841797 ms to run.
cost offload scan: 0.12159347534179688
offload 2 adapters, 16 remains
cost offload cat: 0.026702880859375
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6093978881835938 ms to run.
offload 0 adapters, 16 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.0171661376953125
load 1 adapters, 17 in total
Function load_lora_A took 1.1882781982421875 ms to run.
Function load_lora_B took 1.2192726135253906 ms to run.
cost realload: 2.816438674926758
Function load_adapters took 2.837657928466797 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 16 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5717277526855469 ms to run.
cost offload scan: 0.08296966552734375
offload 1 adapters, 15 remains
cost offload cat: 0.035762786865234375
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5698204040527344 ms to run.
current batch size: 15 token used ratio: 0.09172307692307692
cost offload scan: 0.08392333984375
offload 1 adapters, 14 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.041484832763671875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5619525909423828 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 13 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.102996826171875
Function offload_adapters took 0.5741119384765625 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 14 in total
Function load_lora_A took 1.2221336364746094 ms to run.
Function load_lora_B took 1.2192726135253906 ms to run.
cost realload: 2.8204917907714844
Function load_adapters took 2.8405189514160156 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 13 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5686283111572266 ms to run.
cost load scan: 0.012159347534179688
load 1 adapters, 14 in total
Function load_lora_A took 1.1930465698242188 ms to run.
Function load_lora_B took 1.222848892211914 ms to run.
cost realload: 2.814054489135742
Function load_adapters took 2.834796905517578 ms to run.
cost offload scan: 0.08296966552734375
offload 1 adapters, 13 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1163482666015625
Function offload_adapters took 0.5853176116943359 ms to run.
cost offload scan: 0.11992454528808594
offload 2 adapters, 11 remains
cost offload cat: 0.0247955322265625
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5908012390136719 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 10 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5660057067871094 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 10 in total
cost realload: 0.3006458282470703
Function load_adapters took 0.32520294189453125 ms to run.
current batch size: 11 token used ratio: 0.06703076923076923
cost load scan: 0.011682510375976562
load 1 adapters, 11 in total
Function load_lora_A took 1.2316703796386719 ms to run.
Function load_lora_B took 1.222372055053711 ms to run.
cost realload: 2.8476715087890625
Function load_adapters took 2.869129180908203 ms to run.
Avg tokens(prompt+generate) throughput: 1577.510 tokens/s
Avg prompt tokens throughput:            865.151 tokens/s
Avg generate tokens throughput:          712.359 tokens/s
cost load scan: 0.00858306884765625
load 0 adapters, 11 in total
cost realload: 0.2837181091308594
Function load_adapters took 0.30803680419921875 ms to run.
offload 0 adapters, 11 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.08273124694824219
offload 1 adapters, 10 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5624294281005859 ms to run.
cost load scan: 0.015497207641601562
load 1 adapters, 11 in total
Function load_lora_A took 1.2428760528564453 ms to run.
Function load_lora_B took 1.2023448944091797 ms to run.
cost realload: 2.8276443481445312
Function load_adapters took 2.8486251831054688 ms to run.
cost offload scan: 0.08273124694824219
offload 1 adapters, 10 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5602836608886719 ms to run.
cost offload scan: 0.08034706115722656
offload 1 adapters, 9 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022649765014648438
INFO:     127.0.0.1:53448 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53456 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53466 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53468 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53470 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53486 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53498 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53508 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53514 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53520 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53534 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53540 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53544 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53558 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53572 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53586 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53588 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53590 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53604 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53608 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53624 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53640 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53644 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5841255187988281 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 10 in total
Function load_lora_A took 1.2061595916748047 ms to run.
Function load_lora_B took 1.2633800506591797 ms to run.
cost realload: 2.8634071350097656
Function load_adapters took 2.8848648071289062 ms to run.
current batch size: 11 token used ratio: 0.06093846153846154
cost load scan: 0.010728836059570312
load 1 adapters, 11 in total
Function load_lora_A took 1.2214183807373047 ms to run.
Function load_lora_B took 1.2009143829345703 ms to run.
cost realload: 2.814054489135742
Function load_adapters took 2.8352737426757812 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 11 in total
cost realload: 0.2830028533935547
Function load_adapters took 0.3075599670410156 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 10 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5676746368408203 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 10 in total
cost realload: 0.2899169921875
Function load_adapters took 0.3132820129394531 ms to run.
current batch size: 13 token used ratio: 0.07150769230769231
cost offload scan: 0.08082389831542969
offload 1 adapters, 9 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5667209625244141 ms to run.
cost load scan: 0.010251998901367188
load 3 adapters, 12 in total
Function load_lora_A took 1.245260238647461 ms to run.
Function load_lora_B took 1.2171268463134766 ms to run.
Function load_lora_A took 1.2142658233642578 ms to run.
Function load_lora_B took 1.1899471282958984 ms to run.
Function load_lora_A took 1.2402534484863281 ms to run.
Function load_lora_B took 1.1935234069824219 ms to run.
cost realload: 7.833003997802734
Function load_adapters took 7.853269577026367 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 13 in total
Function load_lora_A took 1.230001449584961 ms to run.
Function load_lora_B took 1.2235641479492188 ms to run.
cost realload: 2.834320068359375
Function load_adapters took 2.854585647583008 ms to run.
cost offload scan: 0.0820159912109375
offload 1 adapters, 12 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5705356597900391 ms to run.
offload 0 adapters, 12 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost offload scan: 0.08153915405273438
offload 1 adapters, 11 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5655288696289062 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 12 in total
Function load_lora_A took 1.2202262878417969 ms to run.
Function load_lora_B took 1.2166500091552734 ms to run.
cost realload: 2.8336048126220703
Function load_adapters took 2.855062484741211 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 13 in total
Function load_lora_A took 1.2373924255371094 ms to run.
Function load_lora_B took 1.2309551239013672 ms to run.
cost realload: 2.859354019165039
Function load_adapters took 2.8808116912841797 ms to run.
current batch size: 16 token used ratio: 0.08226153846153846
cost load scan: 0.009298324584960938
load 2 adapters, 15 in total
Function load_lora_A took 1.194000244140625 ms to run.
Function load_lora_B took 1.2218952178955078 ms to run.
Function load_lora_A took 1.1997222900390625 ms to run.
Function load_lora_B took 1.239776611328125 ms to run.
cost realload: 5.310773849487305
Function load_adapters took 5.331993103027344 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 14 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5714893341064453 ms to run.
offload 0 adapters, 14 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.008821487426757812
load 0 adapters, 14 in total
cost realload: 0.28967857360839844
Function load_adapters took 0.3170967102050781 ms to run.
offload 0 adapters, 14 remains
Function offload_adapters took 0.012874603271484375 ms to run.
current batch size: 16 token used ratio: 0.08449230769230769
offload 0 adapters, 14 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 14 in total
cost realload: 0.3066062927246094
Function load_adapters took 0.33283233642578125 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 13 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5667209625244141 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 14 in total
Function load_lora_A took 1.2154579162597656 ms to run.
Function load_lora_B took 1.1930465698242188 ms to run.
cost realload: 2.8057098388671875
Function load_adapters took 2.8269290924072266 ms to run.
cost load scan: 0.012159347534179688
load 2 adapters, 16 in total
Function load_lora_A took 1.2331008911132812 ms to run.
Function load_lora_B took 1.2085437774658203 ms to run.
Function load_lora_A took 1.2004375457763672 ms to run.
Function load_lora_B took 1.2345314025878906 ms to run.
cost realload: 5.348443984985352
Function load_adapters took 5.371809005737305 ms to run.
current batch size: 18 token used ratio: 0.09713846153846153
cost load scan: 0.008344650268554688
load 0 adapters, 16 in total
cost realload: 0.28443336486816406
Function load_adapters took 0.30922889709472656 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 17 in total
Function load_lora_A took 1.249551773071289 ms to run.
Function load_lora_B took 1.2402534484863281 ms to run.
cost realload: 2.877950668334961
Function load_adapters took 2.8989315032958984 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 16 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5769729614257812 ms to run.
cost offload scan: 0.08392333984375
offload 1 adapters, 15 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.028848648071289062
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5714893341064453 ms to run.
cost load scan: 0.016689300537109375
load 2 adapters, 17 in total
Function load_lora_A took 1.2416839599609375 ms to run.
Function load_lora_B took 1.2128353118896484 ms to run.
Function load_lora_A took 1.1801719665527344 ms to run.
Function load_lora_B took 1.2063980102539062 ms to run.
cost realload: 5.324125289916992
Function load_adapters took 5.34510612487793 ms to run.
current batch size: 20 token used ratio: 0.11435384615384615
cost load scan: 0.010728836059570312
load 1 adapters, 18 in total
Function load_lora_A took 1.2433528900146484 ms to run.
Function load_lora_B took 1.2383460998535156 ms to run.
cost realload: 2.8908252716064453
Function load_adapters took 2.9120445251464844 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 17 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.028848648071289062
cost offload a_loc update: 0.1068115234375
INFO:     127.0.0.1:53656 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53658 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53664 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53676 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53678 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53690 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53698 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53710 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53714 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53724 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53734 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33408 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33418 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33430 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33442 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33446 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33462 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33466 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33480 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33490 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33494 - "POST /generate_stream HTTP/1.1" 200 OK
Function offload_adapters took 0.5805492401123047 ms to run.
cost offload scan: 0.12612342834472656
offload 2 adapters, 15 remains
cost offload cat: 0.025033950805664062
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.6022453308105469 ms to run.
cost load scan: 0.007867813110351562
load 1 adapters, 16 in total
Function load_lora_A took 1.2273788452148438 ms to run.
Function load_lora_B took 1.2247562408447266 ms to run.
cost realload: 2.8274059295654297
Function load_adapters took 2.846956253051758 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 15 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5669593811035156 ms to run.
offload 0 adapters, 15 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.013828277587890625
load 3 adapters, 18 in total
Function load_lora_A took 1.2536048889160156 ms to run.
Function load_lora_B took 1.2230873107910156 ms to run.
Function load_lora_A took 1.2469291687011719 ms to run.
Function load_lora_B took 1.190185546875 ms to run.
Function load_lora_A took 1.2073516845703125 ms to run.
Function load_lora_B took 1.1749267578125 ms to run.
cost realload: 7.83848762512207
Function load_adapters took 7.859945297241211 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.011205673217773438
load 3 adapters, 21 in total
Function load_lora_A took 1.2667179107666016 ms to run.
Function load_lora_B took 1.2202262878417969 ms to run.
Function load_lora_A took 1.1768341064453125 ms to run.
Function load_lora_B took 1.215219497680664 ms to run.
Function load_lora_A took 1.2125968933105469 ms to run.
Function load_lora_B took 1.1649131774902344 ms to run.
cost realload: 7.786035537719727
Function load_adapters took 7.807493209838867 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 20 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5886554718017578 ms to run.
current batch size: 21 token used ratio: 0.107
cost load scan: 0.014543533325195312
load 2 adapters, 22 in total
Function load_lora_A took 1.241922378540039 ms to run.
Function load_lora_B took 1.169443130493164 ms to run.
Function load_lora_A took 1.1892318725585938 ms to run.
Function load_lora_B took 1.1997222900390625 ms to run.
cost realload: 5.269289016723633
Function load_adapters took 5.290746688842773 ms to run.
cost offload scan: 0.08559226989746094
offload 1 adapters, 21 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5698204040527344 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost load scan: 0.009059906005859375
load 2 adapters, 23 in total
Function load_lora_A took 1.2352466583251953 ms to run.
Function load_lora_B took 1.2447834014892578 ms to run.
Function load_lora_A took 1.2311935424804688 ms to run.
Function load_lora_B took 1.2252330780029297 ms to run.
cost realload: 5.401134490966797
Function load_adapters took 5.422115325927734 ms to run.
cost load scan: 0.013589859008789062
load 3 adapters, 26 in total
Function load_lora_A took 1.2142658233642578 ms to run.
Function load_lora_B took 1.220703125 ms to run.
Function load_lora_A took 1.1837482452392578 ms to run.
Function load_lora_B took 1.1951923370361328 ms to run.
Function load_lora_A took 1.2056827545166016 ms to run.
Function load_lora_B took 1.1818408966064453 ms to run.
cost realload: 7.741689682006836
Function load_adapters took 7.763385772705078 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 27 in total
Function load_lora_A took 1.1837482452392578 ms to run.
Function load_lora_B took 1.2118816375732422 ms to run.
cost realload: 2.806425094604492
Function load_adapters took 2.828359603881836 ms to run.
current batch size: 27 token used ratio: 0.1486
cost load scan: 0.011205673217773438
load 2 adapters, 29 in total
Function load_lora_A took 1.237630844116211 ms to run.
Function load_lora_B took 1.2209415435791016 ms to run.
Function load_lora_A took 1.2106895446777344 ms to run.
Function load_lora_B took 1.2173652648925781 ms to run.
cost realload: 5.347490310668945
Function load_adapters took 5.368232727050781 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 28 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5881786346435547 ms to run.
cost offload scan: 0.13375282287597656
offload 2 adapters, 26 remains
cost offload cat: 0.0247955322265625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.6184577941894531 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 25 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.024318695068359375
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.6003379821777344 ms to run.
cost load scan: 0.009775161743164062
load 0 adapters, 25 in total
cost realload: 0.2894401550292969
Function load_adapters took 0.3142356872558594 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 24 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5674362182617188 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 23 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5743503570556641 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 24 in total
Function load_lora_A took 1.2218952178955078 ms to run.
Function load_lora_B took 1.2125968933105469 ms to run.
cost realload: 2.8259754180908203
Function load_adapters took 2.8476715087890625 ms to run.
cost load scan: 0.0095367431640625
load 0 adapters, 24 in total
cost realload: 0.29587745666503906
Function load_adapters took 0.32258033752441406 ms to run.
Avg tokens(prompt+generate) throughput: 1888.866 tokens/s
Avg prompt tokens throughput:           1156.487 tokens/s
Avg generate tokens throughput:          732.379 tokens/s
cost offload scan: 0.12540817260742188
offload 2 adapters, 22 remains
cost offload cat: 0.025987625122070312
cost offload free mem manager: 0.04744529724121094
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11873245239257812
Function offload_adapters took 0.6422996520996094 ms to run.
current batch size: 24 token used ratio: 0.13596923076923076
cost load scan: 0.010728836059570312
load 1 adapters, 23 in total
Function load_lora_A took 1.2552738189697266 ms to run.
Function load_lora_B took 1.2454986572265625 ms to run.
cost realload: 2.899169921875
Function load_adapters took 2.919912338256836 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 22 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5846023559570312 ms to run.
cost offload scan: 0.12469291687011719
offload 2 adapters, 20 remains
cost offload cat: INFO:     127.0.0.1:33508 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33518 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33520 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33524 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33526 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33536 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33542 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33550 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33552 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33568 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33576 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33578 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33584 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33598 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33604 - "POST /generate_stream HTTP/1.1" 200 OK
0.0247955322265625
cost offload free mem manager: 0.05555152893066406
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.6494522094726562 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 19 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10156631469726562
Function offload_adapters took 0.5638599395751953 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 18 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5693435668945312 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 17 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.5784034729003906 ms to run.
cost load scan: 0.00858306884765625
load 0 adapters, 17 in total
cost realload: 0.30875205993652344
Function load_adapters took 0.3399848937988281 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 16 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04696846008300781
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5745887756347656 ms to run.
cost load scan: 0.013828277587890625
load 1 adapters, 17 in total
Function load_lora_A took 1.2285709381103516 ms to run.
Function load_lora_B took 1.252889633178711 ms to run.
cost realload: 2.8917789459228516
Function load_adapters took 2.913236618041992 ms to run.
cost offload scan: 0.08463859558105469
offload 1 adapters, 16 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5681514739990234 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 15 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.5769729614257812 ms to run.
current batch size: 18 token used ratio: 0.10312307692307693
cost load scan: 0.010967254638671875
load 1 adapters, 16 in total
Function load_lora_A took 1.1830329895019531 ms to run.
Function load_lora_B took 1.230478286743164 ms to run.
cost realload: 2.8078556060791016
Function load_adapters took 2.828836441040039 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 17 in total
Function load_lora_A took 1.1761188507080078 ms to run.
Function load_lora_B took 1.2238025665283203 ms to run.
cost realload: 2.7844905853271484
Function load_adapters took 2.8052330017089844 ms to run.
cost load scan: 0.013828277587890625
load 3 adapters, 20 in total
Function load_lora_A took 1.203298568725586 ms to run.
Function load_lora_B took 1.2013912200927734 ms to run.
Function load_lora_A took 1.2288093566894531 ms to run.
Function load_lora_B took 1.1761188507080078 ms to run.
Function load_lora_A took 1.1906623840332031 ms to run.
Function load_lora_B took 1.2018680572509766 ms to run.
cost realload: 7.729530334472656
Function load_adapters took 7.750749588012695 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.09512901306152344
offload 1 adapters, 19 remains
cost offload cat: 0.0362396240234375
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.12087821960449219
Function offload_adapters took 0.6279945373535156 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 20 in total
Function load_lora_A took 1.2407302856445312 ms to run.
Function load_lora_B took 1.2094974517822266 ms to run.
cost realload: 2.8488636016845703
Function load_adapters took 2.870798110961914 ms to run.
current batch size: 22 token used ratio: 0.13155384615384616
cost offload scan: 0.08559226989746094
offload 1 adapters, 19 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5669593811035156 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 18 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5872249603271484 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 17 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5846023559570312 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 16 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5741119384765625 ms to run.
offload 0 adapters, 16 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost offload scan: 0.08368492126464844
offload 1 adapters, 15 remains
cost offload cat: 0.02956390380859375
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10251998901367188
Function offload_adapters took 0.5590915679931641 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 16 in total
Function load_lora_A took 1.1942386627197266 ms to run.
Function load_lora_B took 1.188516616821289 ms to run.
cost realload: 2.783060073852539
Function load_adapters took 2.804279327392578 ms to run.
current batch size: 17 token used ratio: 0.10836923076923077
cost offload scan: 0.09608268737792969
offload 1 adapters, 15 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5867481231689453 ms to run.
cost load scan: 0.013589859008789062
load 1 adapters, 16 in total
Function load_lora_A took 1.2319087982177734 ms to run.
Function load_lora_B took 1.2722015380859375 ms to run.
cost realload: 2.9153823852539062
Function load_adapters took 2.9363632202148438 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 15 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.5733966827392578 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 16 in total
Function load_lora_A took 1.2476444244384766 ms to run.
Function load_lora_B took 1.2106895446777344 ms to run.
cost realload: 2.8481483459472656
Function load_adapters took 2.8696060180664062 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 17 in total
Function load_lora_A took 1.2056827545166016 ms to run.
Function load_lora_B took 1.218557357788086 ms to run.
cost realload: 2.8150081634521484
Function load_adapters took 2.836465835571289 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 18 in total
Function load_lora_A took 1.241922378540039 ms to run.
Function load_lora_B took 1.22833251953125 ms to run.
cost realload: 2.872943878173828
Function load_adapters took 2.893686294555664 ms to run.
current batch size: 19 token used ratio: 0.11386153846153846
cost load scan: 0.01621246337890625
load 2 adapters, 20 in total
INFO:     127.0.0.1:33610 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33618 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33622 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33624 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33636 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33638 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33654 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33658 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33674 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33688 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33694 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33706 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33710 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33720 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 1.186370849609375 ms to run.
Function load_lora_B took 1.2476444244384766 ms to run.
Function load_lora_A took 1.2009143829345703 ms to run.
Function load_lora_B took 1.2159347534179688 ms to run.
cost realload: 5.356311798095703
Function load_adapters took 5.377054214477539 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 19 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5810260772705078 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 18 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5679130554199219 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 19 in total
Function load_lora_A took 1.1966228485107422 ms to run.
Function load_lora_B took 1.2462139129638672 ms to run.
cost realload: 2.852201461791992
Function load_adapters took 2.872467041015625 ms to run.
cost offload scan: 0.08368492126464844
offload 1 adapters, 18 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5681514739990234 ms to run.
cost offload scan: 0.08463859558105469
offload 1 adapters, 17 remains
cost offload cat: 0.029087066650390625
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5748271942138672 ms to run.
cost load scan: 0.012159347534179688
load 1 adapters, 18 in total
Function load_lora_A took 1.1982917785644531 ms to run.
Function load_lora_B took 1.238107681274414 ms to run.
cost realload: 2.8352737426757812
Function load_adapters took 2.8569698333740234 ms to run.
cost load scan: 0.01430511474609375
load 1 adapters, 19 in total
Function load_lora_A took 1.1904239654541016 ms to run.
Function load_lora_B took 1.2087821960449219 ms to run.
cost realload: 2.801179885864258
Function load_adapters took 2.8226375579833984 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 18 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5745887756347656 ms to run.
cost load scan: 0.014781951904296875
load 3 adapters, 21 in total
Function load_lora_A took 1.155853271484375 ms to run.
Function load_lora_B took 1.2390613555908203 ms to run.
Function load_lora_A took 1.2047290802001953 ms to run.
Function load_lora_B took 1.2006759643554688 ms to run.
Function load_lora_A took 1.1744499206542969 ms to run.
Function load_lora_B took 1.2309551239013672 ms to run.
cost realload: 7.750749588012695
Function load_adapters took 7.773399353027344 ms to run.
current batch size: 22 token used ratio: 0.12621538461538462
cost offload scan: 0.087738037109375
offload 1 adapters, 20 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5817413330078125 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 21 in total
Function load_lora_A took 1.2171268463134766 ms to run.
Function load_lora_B took 1.224517822265625 ms to run.
cost realload: 2.8290748596191406
Function load_adapters took 2.8498172760009766 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.09751319885253906
offload 1 adapters, 20 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11658668518066406
Function offload_adapters took 0.6067752838134766 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 21 in total
Function load_lora_A took 1.1670589447021484 ms to run.
Function load_lora_B took 1.1723041534423828 ms to run.
cost realload: 2.7332305908203125
Function load_adapters took 2.7532577514648438 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 22 in total
Function load_lora_A took 1.2450218200683594 ms to run.
Function load_lora_B took 1.2619495391845703 ms to run.
cost realload: 2.908468246459961
Function load_adapters took 2.9382705688476562 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 21 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5929470062255859 ms to run.
current batch size: 21 token used ratio: 0.12086153846153846
cost load scan: 0.010251998901367188
load 1 adapters, 22 in total
Function load_lora_A took 1.2385845184326172 ms to run.
Function load_lora_B took 1.2118816375732422 ms to run.
cost realload: 2.833843231201172
Function load_adapters took 2.8533935546875 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 21 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.102996826171875
Function offload_adapters took 0.5650520324707031 ms to run.
cost offload scan: 0.08559226989746094
offload 1 adapters, 20 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.102996826171875
Function offload_adapters took 0.5660057067871094 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 21 in total
Function load_lora_A took 1.255035400390625 ms to run.
Function load_lora_B took 1.1894702911376953 ms to run.
cost realload: 2.8319358825683594
Function load_adapters took 2.8531551361083984 ms to run.
cost offload scan: 0.08368492126464844
offload 1 adapters, 20 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04935264587402344
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5753040313720703 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 19 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.0514984130859375
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5812644958496094 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 20 in total
Function load_lora_A took 1.249074935913086 ms to run.
Function load_lora_B took 1.2412071228027344 ms to run.
cost realload: 2.883434295654297
Function load_adapters took 2.9039382934570312 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 19 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.5710124969482422 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 20 in total
Function load_lora_A took 1.2218952178955078 ms to run.
Function load_lora_B took 1.2271404266357422 ms to run.
cost realload: 2.8531551361083984
Function load_adapters took 2.874135971069336 ms to run.
cost offload scan: 0.08273124694824219
offload 1 adapters, 19 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5655288696289062 ms to run.
current batch size: 19 token used ratio: 0.11295384615384615
cost offload scan: 0.08916854858398438
INFO:     127.0.0.1:58868 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58878 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58884 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58886 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58892 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58894 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58898 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58906 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58916 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58930 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58944 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58956 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58968 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58974 - "POST /generate_stream HTTP/1.1" 200 OK
offload 1 adapters, 18 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.6051063537597656 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 19 in total
Function load_lora_A took 1.2524127960205078 ms to run.
Function load_lora_B took 1.1982917785644531 ms to run.
cost realload: 2.822399139404297
Function load_adapters took 2.8421878814697266 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 18 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5731582641601562 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 19 in total
Function load_lora_A took 1.2054443359375 ms to run.
Function load_lora_B took 1.2326240539550781 ms to run.
cost realload: 2.8307437896728516
Function load_adapters took 2.8510093688964844 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 18 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5750656127929688 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 17 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5738735198974609 ms to run.
cost load scan: 0.009059906005859375
load 2 adapters, 19 in total
Function load_lora_A took 1.2145042419433594 ms to run.
Function load_lora_B took 1.2314319610595703 ms to run.
Function load_lora_A took 1.1997222900390625 ms to run.
Function load_lora_B took 1.2502670288085938 ms to run.
cost realload: 5.368471145629883
Function load_adapters took 5.390405654907227 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 18 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.024318695068359375
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5691051483154297 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 17 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04935264587402344
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10251998901367188
Function offload_adapters took 0.5702972412109375 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 18 in total
Function load_lora_A took 1.1897087097167969 ms to run.
Function load_lora_B took 1.2233257293701172 ms to run.
cost realload: 2.8061866760253906
Function load_adapters took 2.826690673828125 ms to run.
current batch size: 18 token used ratio: 0.1007076923076923
cost offload scan: 0.09107589721679688
offload 1 adapters, 17 remains
cost offload cat: 0.03838539123535156
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11515617370605469
Function offload_adapters took 0.6058216094970703 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 18 in total
Function load_lora_A took 1.2116432189941406 ms to run.
Function load_lora_B took 1.2252330780029297 ms to run.
cost realload: 2.8333663940429688
Function load_adapters took 2.8541088104248047 ms to run.
Avg tokens(prompt+generate) throughput: 1759.409 tokens/s
Avg prompt tokens throughput:            947.443 tokens/s
Avg generate tokens throughput:          811.966 tokens/s
offload 0 adapters, 18 remains
Function offload_adapters took 0.012874603271484375 ms to run.
current batch size: 18 token used ratio: 0.10678461538461538
cost load scan: 0.008344650268554688
load 0 adapters, 18 in total
cost realload: 0.2868175506591797
Function load_adapters took 0.3101825714111328 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 17 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04124641418457031
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5645751953125 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 16 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5650520324707031 ms to run.
cost offload scan: 0.08368492126464844
offload 1 adapters, 15 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5645751953125 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 16 in total
Function load_lora_A took 1.226663589477539 ms to run.
Function load_lora_B took 1.2493133544921875 ms to run.
cost realload: 2.8650760650634766
Function load_adapters took 2.886056900024414 ms to run.
cost offload scan: 0.08463859558105469
offload 1 adapters, 15 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5810260772705078 ms to run.
current batch size: 16 token used ratio: 0.09838461538461539
cost load scan: 0.014066696166992188
load 1 adapters, 16 in total
Function load_lora_A took 1.216888427734375 ms to run.
Function load_lora_B took 1.1980533599853516 ms to run.
cost realload: 2.816915512084961
Function load_adapters took 2.8378963470458984 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 15 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.5843639373779297 ms to run.
cost offload scan: 0.08296966552734375
offload 1 adapters, 14 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.5762577056884766 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 15 in total
Function load_lora_A took 1.2614727020263672 ms to run.
Function load_lora_B took 1.2025833129882812 ms to run.
cost realload: 2.86865234375
Function load_adapters took 2.890348434448242 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 14 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5738735198974609 ms to run.
current batch size: 15 token used ratio: 0.09563076923076923
cost load scan: 0.015497207641601562
load 1 adapters, 15 in total
Function load_lora_A took 1.201629638671875 ms to run.
Function load_lora_B took 1.2054443359375 ms to run.
cost realload: 2.805471420288086
Function load_adapters took 2.8269290924072266 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 16 in total
Function load_lora_A took 1.1970996856689453 ms to run.
Function load_lora_B took 1.2431144714355469 ms to run.
cost realload: 2.834320068359375
Function load_adapters took 2.8562545776367188 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 15 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5681514739990234 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 14 remains
cost offload cat: INFO:     127.0.0.1:58982 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58988 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58990 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59006 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59012 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59014 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59028 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59042 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59052 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59064 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59072 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59084 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59098 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59112 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59122 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59136 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59140 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59148 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59164 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59168 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59178 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59184 - "POST /generate_stream HTTP/1.1" 200 OK
0.030517578125
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5965232849121094 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 15 in total
Function load_lora_A took 1.2240409851074219 ms to run.
Function load_lora_B took 1.2323856353759766 ms to run.
cost realload: 2.854585647583008
Function load_adapters took 2.878427505493164 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 14 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5598068237304688 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 15 in total
Function load_lora_A took 1.2454986572265625 ms to run.
Function load_lora_B took 1.2137889862060547 ms to run.
cost realload: 2.8531551361083984
Function load_adapters took 2.875089645385742 ms to run.
cost offload scan: 0.11849403381347656
offload 2 adapters, 13 remains
cost offload cat: 0.025033950805664062
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10204315185546875
Function offload_adapters took 0.5986690521240234 ms to run.
current batch size: 15 token used ratio: 0.08352307692307692
cost load scan: 0.010967254638671875
load 1 adapters, 14 in total
Function load_lora_A took 1.2052059173583984 ms to run.
Function load_lora_B took 1.2018680572509766 ms to run.
cost realload: 2.795696258544922
Function load_adapters took 2.8162002563476562 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 13 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5669593811035156 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 14 in total
Function load_lora_A took 1.2576580047607422 ms to run.
Function load_lora_B took 1.21307373046875 ms to run.
cost realload: 2.8557777404785156
Function load_adapters took 2.876758575439453 ms to run.
offload 0 adapters, 14 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 14 in total
cost realload: 0.28061866760253906
Function load_adapters took 0.30612945556640625 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 14 in total
cost realload: 0.2849102020263672
Function load_adapters took 0.3085136413574219 ms to run.
current batch size: 17 token used ratio: 0.09958461538461538
cost load scan: 0.00858306884765625
load 1 adapters, 15 in total
Function load_lora_A took 1.2574195861816406 ms to run.
Function load_lora_B took 1.1930465698242188 ms to run.
cost realload: 2.8352737426757812
Function load_adapters took 2.856016159057617 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 16 in total
Function load_lora_A took 1.2631416320800781 ms to run.
Function load_lora_B took 1.2383460998535156 ms to run.
cost realload: 2.898693084716797
Function load_adapters took 2.9196739196777344 ms to run.
offload 0 adapters, 16 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost offload scan: 0.09679794311523438
offload 1 adapters, 15 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.5896091461181641 ms to run.
cost offload scan: 0.08559226989746094
offload 1 adapters, 14 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11610984802246094
Function offload_adapters took 0.5781650543212891 ms to run.
cost load scan: 0.016927719116210938
load 5 adapters, 19 in total
Function load_lora_A took 1.2669563293457031 ms to run.
Function load_lora_B took 1.1928081512451172 ms to run.
Function load_lora_A took 1.2164115905761719 ms to run.
Function load_lora_B took 1.2049674987792969 ms to run.
Function load_lora_A took 1.2497901916503906 ms to run.
Function load_lora_B took 1.2412071228027344 ms to run.
Function load_lora_A took 1.2054443359375 ms to run.
Function load_lora_B took 1.1816024780273438 ms to run.
Function load_lora_A took 1.2354850769042969 ms to run.
Function load_lora_B took 1.226663589477539 ms to run.
cost realload: 12.87221908569336
Function load_adapters took 12.894392013549805 ms to run.
cost load scan: 0.011682510375976562
load 2 adapters, 21 in total
Function load_lora_A took 1.2216567993164062 ms to run.
Function load_lora_B took 1.2254714965820312 ms to run.
Function load_lora_A took 1.2099742889404297 ms to run.
Function load_lora_B took 1.2047290802001953 ms to run.
cost realload: 5.327463150024414
Function load_adapters took 5.348443984985352 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 20 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5891323089599609 ms to run.
current batch size: 23 token used ratio: 0.12653846153846154
cost load scan: 0.008106231689453125
load 0 adapters, 20 in total
cost realload: 0.27871131896972656
Function load_adapters took 0.3027915954589844 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 21 in total
Function load_lora_A took 1.2242794036865234 ms to run.
Function load_lora_B took 1.1975765228271484 ms to run.
cost realload: 2.8104782104492188
Function load_adapters took 2.837657928466797 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 20 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5774497985839844 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 21 in total
Function load_lora_A took 1.2087821960449219 ms to run.
Function load_lora_B took 1.2049674987792969 ms to run.
cost realload: 2.8111934661865234
Function load_adapters took 2.8328895568847656 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 20 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.579833984375 ms to run.
current batch size: 23 token used ratio: 0.1312
cost offload scan: 0.12540817260742188
offload 2 adapters, 18 remains
cost offload cat: 0.028371810913085938
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.030040740966796875
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.6291866302490234 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 19 in total
Function load_lora_A took 1.2106895446777344 ms to run.
Function load_lora_B took 1.2521743774414062 ms to run.
cost realload: 2.8672218322753906
Function load_adapters took 2.8886795043945312 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 18 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5772113800048828 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 17 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10251998901367188
Function offload_adapters took 0.5655288696289062 ms to run.
cost load scan: 0.009059906005859375
INFO:     127.0.0.1:59188 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59194 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59196 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51716 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51732 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51734 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51748 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51758 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51774 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51780 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51792 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51806 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51820 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51826 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51834 - "POST /generate_stream HTTP/1.1" 200 OK
load 3 adapters, 20 in total
Function load_lora_A took 1.1982917785644531 ms to run.
Function load_lora_B took 1.230478286743164 ms to run.
Function load_lora_A took 1.2204647064208984 ms to run.
Function load_lora_B took 1.2240409851074219 ms to run.
Function load_lora_A took 1.210927963256836 ms to run.
Function load_lora_B took 1.2311935424804688 ms to run.
cost realload: 7.847785949707031
Function load_adapters took 7.867336273193359 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 21 in total
Function load_lora_A took 1.2273788452148438 ms to run.
Function load_lora_B took 1.2285709381103516 ms to run.
cost realload: 2.842426300048828
Function load_adapters took 2.8641223907470703 ms to run.
current batch size: 23 token used ratio: 0.13303076923076923
cost load scan: 0.008821487426757812
load 1 adapters, 22 in total
Function load_lora_A took 1.2326240539550781 ms to run.
Function load_lora_B took 1.2440681457519531 ms to run.
cost realload: 2.8676986694335938
Function load_adapters took 2.8886795043945312 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.012636184692382812
load 3 adapters, 25 in total
Function load_lora_A took 1.2125968933105469 ms to run.
Function load_lora_B took 1.215219497680664 ms to run.
Function load_lora_A took 1.194000244140625 ms to run.
Function load_lora_B took 1.1868476867675781 ms to run.
Function load_lora_A took 1.2319087982177734 ms to run.
Function load_lora_B took 1.2133121490478516 ms to run.
cost realload: 7.784605026245117
Function load_adapters took 7.805347442626953 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 24 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11444091796875
Function offload_adapters took 0.5838871002197266 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 25 in total
Function load_lora_A took 1.2409687042236328 ms to run.
Function load_lora_B took 1.218557357788086 ms to run.
cost realload: 2.8543472290039062
Function load_adapters took 2.8753280639648438 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 24 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5872249603271484 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 23 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5750656127929688 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 24 in total
Function load_lora_A took 1.2080669403076172 ms to run.
Function load_lora_B took 1.2056827545166016 ms to run.
cost realload: 2.8076171875
Function load_adapters took 2.8285980224609375 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 23 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5855560302734375 ms to run.
cost load scan: 0.009775161743164062
load 2 adapters, 25 in total
Function load_lora_A took 1.1949539184570312 ms to run.
Function load_lora_B took 1.2240409851074219 ms to run.
Function load_lora_A took 1.191854476928711 ms to run.
Function load_lora_B took 1.1968612670898438 ms to run.
cost realload: 5.268096923828125
Function load_adapters took 5.292177200317383 ms to run.
current batch size: 27 token used ratio: 0.14616923076923077
cost offload scan: 0.08749961853027344
offload 1 adapters, 24 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5838871002197266 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 23 remains
cost offload cat: 0.03910064697265625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.12087821960449219
Function offload_adapters took 0.6098747253417969 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 22 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.5958080291748047 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 21 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.5764961242675781 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.012636184692382812 ms to run.
Avg tokens(prompt+generate) throughput: 1877.390 tokens/s
Avg prompt tokens throughput:           1041.540 tokens/s
Avg generate tokens throughput:          835.850 tokens/s
cost offload scan: 0.08606910705566406
offload 1 adapters, 20 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.5810260772705078 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 19 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5843639373779297 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 20 in total
Function load_lora_A took 1.2230873107910156 ms to run.
Function load_lora_B took 1.2314319610595703 ms to run.
cost realload: 2.8727054595947266
Function load_adapters took 2.8934478759765625 ms to run.
current batch size: 21 token used ratio: 0.1204
cost load scan: 0.009059906005859375
load 1 adapters, 21 in total
Function load_lora_A took 1.220703125 ms to run.
Function load_lora_B took 1.2073516845703125 ms to run.
cost realload: 2.827167510986328
Function load_adapters took 2.847909927368164 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 20 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5667209625244141 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 21 in total
Function load_lora_A took 1.2390613555908203 ms to run.
Function load_lora_B took 1.203775405883789 ms to run.
cost realload: 2.827882766723633
Function load_adapters took 2.849102020263672 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 20 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04863739013671875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.1163482666015625
Function offload_adapters took 0.6034374237060547 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 19 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5779266357421875 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 18 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5674362182617188 ms to run.
cost load scan: 0.009775161743164062
load 1 adapters, 19 in total
INFO:     127.0.0.1:51840 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51852 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51868 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51876 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51886 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51900 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51910 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51924 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51932 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51948 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51950 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51966 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51974 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51980 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51982 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 1.2400150299072266 ms to run.
Function load_lora_B took 1.1937618255615234 ms to run.
cost realload: 2.8603076934814453
Function load_adapters took 2.8810501098632812 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 18 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.5743503570556641 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 17 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.5717277526855469 ms to run.
cost offload scan: 0.08296966552734375
offload 1 adapters, 16 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5640983581542969 ms to run.
cost offload scan: 0.12564659118652344
offload 2 adapters, 14 remains
cost offload cat: 0.024557113647460938
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.60272216796875 ms to run.
current batch size: 16 token used ratio: 0.09107692307692308
cost load scan: 0.011444091796875
load 1 adapters, 15 in total
Function load_lora_A took 1.207590103149414 ms to run.
Function load_lora_B took 1.2307167053222656 ms to run.
cost realload: 2.8405189514160156
Function load_adapters took 2.861499786376953 ms to run.
cost load scan: 0.013828277587890625
load 1 adapters, 16 in total
Function load_lora_A took 1.2133121490478516 ms to run.
Function load_lora_B took 1.2035369873046875 ms to run.
cost realload: 2.816915512084961
Function load_adapters took 2.8371810913085938 ms to run.
offload 0 adapters, 16 remains
Function offload_adapters took 0.015974044799804688 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 17 in total
Function load_lora_A took 1.245737075805664 ms to run.
Function load_lora_B took 1.215219497680664 ms to run.
cost realload: 2.8684139251708984
Function load_adapters took 2.889871597290039 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 16 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.5719661712646484 ms to run.
current batch size: 16 token used ratio: 0.08998461538461539
cost load scan: 0.00858306884765625
load 1 adapters, 17 in total
Function load_lora_A took 1.214742660522461 ms to run.
Function load_lora_B took 1.2218952178955078 ms to run.
cost realload: 2.824544906616211
Function load_adapters took 2.8450489044189453 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 16 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5733966827392578 ms to run.
cost load scan: 0.0152587890625
load 1 adapters, 17 in total
Function load_lora_A took 1.2555122375488281 ms to run.
Function load_lora_B took 1.2285709381103516 ms to run.
cost realload: 2.8862953186035156
Function load_adapters took 2.9075145721435547 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 16 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5717277526855469 ms to run.
current batch size: 16 token used ratio: 0.09352307692307692
cost offload scan: 0.08511543273925781
offload 1 adapters, 15 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5919933319091797 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 14 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5707740783691406 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 15 in total
Function load_lora_A took 1.2285709381103516 ms to run.
Function load_lora_B took 1.2252330780029297 ms to run.
cost realload: 2.858877182006836
Function load_adapters took 2.8824806213378906 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 14 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5764961242675781 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 14 in total
cost realload: 0.2865791320800781
Function load_adapters took 0.31065940856933594 ms to run.
cost offload scan: 0.08392333984375
offload 1 adapters, 13 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5712509155273438 ms to run.
cost offload scan: 0.08177757263183594
offload 1 adapters, 12 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5674362182617188 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 13 in total
Function load_lora_A took 1.1911392211914062 ms to run.
Function load_lora_B took 1.2085437774658203 ms to run.
cost realload: 2.7997493743896484
Function load_adapters took 2.821683883666992 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 12 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5705356597900391 ms to run.
current batch size: 13 token used ratio: 0.06764615384615384
cost load scan: 0.015497207641601562
load 2 adapters, 14 in total
Function load_lora_A took 1.2085437774658203 ms to run.
Function load_lora_B took 1.207590103149414 ms to run.
Function load_lora_A took 1.1658668518066406 ms to run.
Function load_lora_B took 1.247406005859375 ms to run.
cost realload: 5.294084548950195
Function load_adapters took 5.315303802490234 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 13 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5879402160644531 ms to run.
cost load scan: 0.01430511474609375
load 3 adapters, 16 in total
Function load_lora_A took 1.2135505676269531 ms to run.
Function load_lora_B took 1.1870861053466797 ms to run.
Function load_lora_A took 1.1909008026123047 ms to run.
Function load_lora_B took 1.2326240539550781 ms to run.
Function load_lora_A took 1.1870861053466797 ms to run.
Function load_lora_B took 1.2221336364746094 ms to run.
cost realload: 7.7667236328125
Function load_adapters took 7.788419723510742 ms to run.
cost offload scan: 0.0820159912109375
offload 1 adapters, 15 remains
cost offload cat: 0.037670135498046875
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5719661712646484 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 16 in total
INFO:     127.0.0.1:51992 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52008 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52016 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52024 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52040 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52048 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52050 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52056 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52060 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37968 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37974 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37984 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37990 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38004 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38020 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 1.2164115905761719 ms to run.
Function load_lora_B took 1.2285709381103516 ms to run.
cost realload: 2.8679370880126953
Function load_adapters took 2.8896331787109375 ms to run.
cost offload scan: 0.09560585021972656
offload 1 adapters, 15 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.583648681640625 ms to run.
cost load scan: 0.01430511474609375
load 1 adapters, 16 in total
Function load_lora_A took 1.255035400390625 ms to run.
Function load_lora_B took 1.2650489807128906 ms to run.
cost realload: 2.923727035522461
Function load_adapters took 2.9442310333251953 ms to run.
current batch size: 18 token used ratio: 0.08818461538461539
cost offload scan: 0.08511543273925781
offload 1 adapters, 15 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10251998901367188
Function offload_adapters took 0.5581378936767578 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 16 in total
Function load_lora_A took 1.2488365173339844 ms to run.
Function load_lora_B took 1.2538433074951172 ms to run.
cost realload: 2.8972625732421875
Function load_adapters took 2.920389175415039 ms to run.
cost load scan: 0.013589859008789062
load 2 adapters, 18 in total
Function load_lora_A took 1.1949539184570312 ms to run.
Function load_lora_B took 1.224517822265625 ms to run.
Function load_lora_A took 1.1777877807617188 ms to run.
Function load_lora_B took 1.2140274047851562 ms to run.
cost realload: 5.293369293212891
Function load_adapters took 5.31458854675293 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 17 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5691051483154297 ms to run.
current batch size: 19 token used ratio: 0.09706153846153846
cost offload scan: 0.08821487426757812
offload 1 adapters, 16 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5753040313720703 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 17 in total
Function load_lora_A took 1.1866092681884766 ms to run.
Function load_lora_B took 1.2466907501220703 ms to run.
cost realload: 2.8231143951416016
Function load_adapters took 2.8426647186279297 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 16 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5772113800048828 ms to run.
cost offload scan: 0.08392333984375
offload 1 adapters, 15 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.102996826171875
Function offload_adapters took 0.5674362182617188 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 16 in total
Function load_lora_A took 1.2094974517822266 ms to run.
Function load_lora_B took 1.2125968933105469 ms to run.
cost realload: 2.826213836669922
Function load_adapters took 2.846956253051758 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 15 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.030517578125
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.583648681640625 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 14 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5617141723632812 ms to run.
cost load scan: 0.01239776611328125
load 1 adapters, 15 in total
Function load_lora_A took 1.230478286743164 ms to run.
Function load_lora_B took 1.2183189392089844 ms to run.
cost realload: 2.837657928466797
Function load_adapters took 2.8569698333740234 ms to run.
cost load scan: 0.01239776611328125
load 2 adapters, 17 in total
Function load_lora_A took 1.2335777282714844 ms to run.
Function load_lora_B took 1.220703125 ms to run.
Function load_lora_A took 1.2087821960449219 ms to run.
Function load_lora_B took 1.2111663818359375 ms to run.
cost realload: 5.331277847290039
Function load_adapters took 5.352020263671875 ms to run.
offload 0 adapters, 17 remains
Function offload_adapters took 0.012636184692382812 ms to run.
current batch size: 18 token used ratio: 0.08836923076923077
cost offload scan: 0.08344650268554688
offload 1 adapters, 16 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.12040138244628906
Function offload_adapters took 0.5879402160644531 ms to run.
cost offload scan: 0.08559226989746094
offload 1 adapters, 15 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.5781650543212891 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 15 in total
cost realload: 0.30493736267089844
Function load_adapters took 0.33020973205566406 ms to run.
offload 0 adapters, 15 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 14 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5662441253662109 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 15 in total
Function load_lora_A took 1.2290477752685547 ms to run.
Function load_lora_B took 1.2540817260742188 ms to run.
cost realload: 2.874612808227539
Function load_adapters took 2.8951168060302734 ms to run.
cost offload scan: 0.08225440979003906
offload 1 adapters, 14 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.05030632019042969
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5700588226318359 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 15 in total
Function load_lora_A took 1.2478828430175781 ms to run.
Function load_lora_B took 1.2052059173583984 ms to run.
cost realload: 2.8557777404785156
Function load_adapters took 2.877950668334961 ms to run.
current batch size: 16 token used ratio: 0.08301538461538462
cost load scan: 0.012874603271484375
load 2 adapters, 17 in total
Function load_lora_A took 1.2121200561523438 ms to run.
Function load_lora_B took 1.2204647064208984 ms to run.
Function load_lora_A took 1.2454986572265625 ms to run.
Function load_lora_B took 1.2135505676269531 ms to run.
cost realload: 5.368232727050781
Function load_adapters took 5.389690399169922 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 16 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5657672882080078 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 17 in total
Function load_lora_A took 1.2679100036621094 ms to run.
Function load_lora_B took 1.2373924255371094 ms to run.
cost realload: 2.8891563415527344
Function load_adapters took 2.9098987579345703 ms to run.
cost offload scan: 0.09036064147949219
INFO:     127.0.0.1:38028 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38042 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38050 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38062 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38076 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38078 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38080 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38092 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38106 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38116 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38132 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38142 - "POST /generate_stream HTTP/1.1" 200 OK
offload 1 adapters, 16 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04887580871582031
cost offload torch.empty: 0.03337860107421875
cost offload a_loc update: 0.14352798461914062
Function offload_adapters took 0.7143020629882812 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 15 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.102996826171875
Function offload_adapters took 0.5574226379394531 ms to run.
Avg tokens(prompt+generate) throughput: 1529.656 tokens/s
Avg prompt tokens throughput:            806.175 tokens/s
Avg generate tokens throughput:          723.481 tokens/s
current batch size: 16 token used ratio: 0.0882923076923077
cost offload scan: 0.08511543273925781
offload 1 adapters, 14 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5729198455810547 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 15 in total
Function load_lora_A took 1.2447834014892578 ms to run.
Function load_lora_B took 1.2364387512207031 ms to run.
cost realload: 2.8777122497558594
Function load_adapters took 2.8989315032958984 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 16 in total
Function load_lora_A took 1.2052059173583984 ms to run.
Function load_lora_B took 1.1818408966064453 ms to run.
cost realload: 2.7785301208496094
Function load_adapters took 2.799510955810547 ms to run.
cost offload scan: 0.08368492126464844
offload 1 adapters, 15 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5638599395751953 ms to run.
cost offload scan: 0.08249282836914062
offload 1 adapters, 14 remains
cost offload cat: 0.029325485229492188
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10180473327636719
Function offload_adapters took 0.5538463592529297 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 13 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5645751953125 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 13 in total
cost realload: 0.2815723419189453
Function load_adapters took 0.30541419982910156 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 12 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5588531494140625 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 13 in total
Function load_lora_A took 1.2145042419433594 ms to run.
Function load_lora_B took 1.2178421020507812 ms to run.
cost realload: 2.8197765350341797
Function load_adapters took 2.8405189514160156 ms to run.
offload 0 adapters, 13 remains
Function offload_adapters took 0.011920928955078125 ms to run.
current batch size: 14 token used ratio: 0.0712
cost load scan: 0.008344650268554688
load 1 adapters, 14 in total
Function load_lora_A took 1.1868476867675781 ms to run.
Function load_lora_B took 1.21307373046875 ms to run.
cost realload: 2.7894973754882812
Function load_adapters took 2.810955047607422 ms to run.
cost offload scan: 0.08225440979003906
offload 1 adapters, 13 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11038780212402344
Function offload_adapters took 0.5698204040527344 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 12 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10251998901367188
Function offload_adapters took 0.5559921264648438 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 13 in total
Function load_lora_A took 1.2280941009521484 ms to run.
Function load_lora_B took 1.2445449829101562 ms to run.
cost realload: 2.852201461791992
Function load_adapters took 2.872467041015625 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 13 in total
cost realload: 0.27561187744140625
Function load_adapters took 0.2999305725097656 ms to run.
offload 0 adapters, 13 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 12 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.5729198455810547 ms to run.
cost offload scan: 0.07963180541992188
offload 1 adapters, 11 remains
cost offload cat: 0.02956390380859375
cost offload free mem manager: 0.04124641418457031
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5538463592529297 ms to run.
current batch size: 12 token used ratio: 0.05286153846153846
cost load scan: 0.008344650268554688
load 0 adapters, 11 in total
cost realload: 0.2865791320800781
Function load_adapters took 0.3204345703125 ms to run.
cost offload scan: 0.08249282836914062
offload 1 adapters, 10 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.029802322387695312
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5702972412109375 ms to run.
offload 0 adapters, 10 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 11 in total
Function load_lora_A took 1.1997222900390625 ms to run.
Function load_lora_B took 1.188516616821289 ms to run.
cost realload: 2.784252166748047
Function load_adapters took 2.804994583129883 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 12 in total
Function load_lora_A took 1.2400150299072266 ms to run.
Function load_lora_B took 1.245737075805664 ms to run.
cost realload: 2.8858184814453125
Function load_adapters took 2.9087066650390625 ms to run.
current batch size: 13 token used ratio: 0.06427692307692308
cost offload scan: 0.0820159912109375
offload 1 adapters, 11 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5636215209960938 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 10 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10275840759277344
Function offload_adapters took 0.5657672882080078 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 11 in total
Function load_lora_A took 1.224517822265625 ms to run.
Function load_lora_B took 1.2764930725097656 ms to run.
cost realload: 2.889871597290039
Function load_adapters took 2.9108524322509766 ms to run.
cost offload scan: 0.08296966552734375
offload 1 adapters, 10 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5598068237304688 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 11 in total
Function load_lora_A took 1.2021064758300781 ms to run.
Function load_lora_B took 1.2369155883789062 ms to run.
cost realload: 2.8345584869384766
INFO:     127.0.0.1:38144 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38160 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38162 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38176 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38186 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38202 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38208 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38210 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38224 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38232 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38242 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38244 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38254 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38266 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38270 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38274 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38282 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54916 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54930 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54946 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54950 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54962 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54978 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54984 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_adapters took 2.8553009033203125 ms to run.
cost offload scan: 0.08225440979003906
offload 1 adapters, 10 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10228157043457031
Function offload_adapters took 0.5574226379394531 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 11 in total
Function load_lora_A took 1.2564659118652344 ms to run.
Function load_lora_B took 1.2216567993164062 ms to run.
cost realload: 2.851247787475586
Function load_adapters took 2.8715133666992188 ms to run.
cost load scan: 0.015735626220703125
load 1 adapters, 12 in total
Function load_lora_A took 1.1839866638183594 ms to run.
Function load_lora_B took 1.2154579162597656 ms to run.
cost realload: 2.7894973754882812
Function load_adapters took 2.8104782104492188 ms to run.
current batch size: 13 token used ratio: 0.06143076923076923
cost offload scan: 0.08130073547363281
offload 1 adapters, 11 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5662441253662109 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 12 in total
Function load_lora_A took 1.2187957763671875 ms to run.
Function load_lora_B took 1.2440681457519531 ms to run.
cost realload: 2.851247787475586
Function load_adapters took 2.872467041015625 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 13 in total
Function load_lora_A took 1.2540817260742188 ms to run.
Function load_lora_B took 1.168966293334961 ms to run.
cost realload: 2.816438674926758
Function load_adapters took 2.836942672729492 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 14 in total
Function load_lora_A took 1.2345314025878906 ms to run.
Function load_lora_B took 1.2459754943847656 ms to run.
cost realload: 2.8650760650634766
Function load_adapters took 2.8862953186035156 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 15 in total
Function load_lora_A took 1.2559890747070312 ms to run.
Function load_lora_B took 1.180887222290039 ms to run.
cost realload: 2.8350353240966797
Function load_adapters took 2.8564929962158203 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 14 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5846023559570312 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 13 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5710124969482422 ms to run.
current batch size: 15 token used ratio: 0.07549230769230769
cost load scan: 0.009059906005859375
load 1 adapters, 14 in total
Function load_lora_A took 1.1904239654541016 ms to run.
Function load_lora_B took 1.2164115905761719 ms to run.
cost realload: 2.791881561279297
Function load_adapters took 2.8121471405029297 ms to run.
cost offload scan: 0.08225440979003906
offload 1 adapters, 13 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5691051483154297 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 14 in total
Function load_lora_A took 1.2493133544921875 ms to run.
Function load_lora_B took 1.2257099151611328 ms to run.
cost realload: 2.86102294921875
Function load_adapters took 2.882242202758789 ms to run.
cost load scan: 0.01430511474609375
load 1 adapters, 15 in total
Function load_lora_A took 1.2314319610595703 ms to run.
Function load_lora_B took 1.22833251953125 ms to run.
cost realload: 2.848386764526367
Function load_adapters took 2.868175506591797 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 16 in total
Function load_lora_A took 1.2352466583251953 ms to run.
Function load_lora_B took 1.2252330780029297 ms to run.
cost realload: 2.8548240661621094
Function load_adapters took 2.875804901123047 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 15 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5681514739990234 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 16 in total
Function load_lora_A took 1.2211799621582031 ms to run.
Function load_lora_B took 1.2278556823730469 ms to run.
cost realload: 2.8390884399414062
Function load_adapters took 2.8591156005859375 ms to run.
current batch size: 18 token used ratio: 0.09363076923076923
cost load scan: 0.012636184692382812
load 2 adapters, 18 in total
Function load_lora_A took 1.211404800415039 ms to run.
Function load_lora_B took 1.2421607971191406 ms to run.
Function load_lora_A took 1.2125968933105469 ms to run.
Function load_lora_B took 1.21307373046875 ms to run.
cost realload: 5.348682403564453
Function load_adapters took 5.3691864013671875 ms to run.
cost offload scan: 0.08296966552734375
offload 1 adapters, 17 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5698204040527344 ms to run.
cost load scan: 0.01430511474609375
load 1 adapters, 18 in total
Function load_lora_A took 1.1878013610839844 ms to run.
Function load_lora_B took 1.22833251953125 ms to run.
cost realload: 2.8073787689208984
Function load_adapters took 2.83050537109375 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 19 in total
Function load_lora_A took 1.2099742889404297 ms to run.
Function load_lora_B took 1.1963844299316406 ms to run.
cost realload: 2.804994583129883
Function load_adapters took 2.8281211853027344 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 18 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5698204040527344 ms to run.
current batch size: 20 token used ratio: 0.11046153846153846
cost load scan: 0.014781951904296875
load 1 adapters, 19 in total
Function load_lora_A took 1.2331008911132812 ms to run.
Function load_lora_B took 1.2035369873046875 ms to run.
cost realload: 2.835512161254883
Function load_adapters took 2.855539321899414 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 18 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5702972412109375 ms to run.
cost load scan: 0.010967254638671875
load 4 adapters, 22 in total
Function load_lora_A took 1.226186752319336 ms to run.
Function load_lora_B took 1.2545585632324219 ms to run.
Function load_lora_A took 1.21307373046875 ms to run.
Function load_lora_B took 1.2011528015136719 ms to run.
Function load_lora_A took 1.2142658233642578 ms to run.
Function load_lora_B took 1.2288093566894531 ms to run.
Function load_lora_A took 1.173257827758789 ms to run.
Function load_lora_B took 1.2445449829101562 ms to run.
cost realload: 10.35618782043457
Function load_adapters took 10.37740707397461 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost load scan: 0.008821487426757812
load 2 adapters, 24 in total
Function load_lora_A took 1.2371540069580078 ms to run.
Function load_lora_B took 1.2297630310058594 ms to run.
Function load_lora_A took 1.2285709381103516 ms to run.
INFO:     127.0.0.1:54988 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55000 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55006 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55014 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55022 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55026 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55028 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55036 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55040 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55044 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55048 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55060 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55064 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55074 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_B took 1.2035369873046875 ms to run.
cost realload: 5.385160446166992
Function load_adapters took 5.4073333740234375 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 25 in total
Function load_lora_A took 1.1785030364990234 ms to run.
Function load_lora_B took 1.2161731719970703 ms to run.
cost realload: 2.7828216552734375
Function load_adapters took 2.803325653076172 ms to run.
cost load scan: 0.011444091796875
load 3 adapters, 28 in total
Function load_lora_A took 1.2400150299072266 ms to run.
Function load_lora_B took 1.2166500091552734 ms to run.
Function load_lora_A took 1.2710094451904297 ms to run.
Function load_lora_B took 1.2378692626953125 ms to run.
Function load_lora_A took 1.2028217315673828 ms to run.
Function load_lora_B took 1.207590103149414 ms to run.
cost realload: 7.904052734375
Function load_adapters took 7.925748825073242 ms to run.
current batch size: 29 token used ratio: 0.16504615384615384
cost offload scan: 0.09036064147949219
offload 1 adapters, 27 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5879402160644531 ms to run.
cost load scan: 0.009298324584960938
load 3 adapters, 30 in total
Function load_lora_A took 1.238107681274414 ms to run.
Function load_lora_B took 1.2426376342773438 ms to run.
Function load_lora_A took 1.218557357788086 ms to run.
Function load_lora_B took 1.2004375457763672 ms to run.
Function load_lora_A took 1.186370849609375 ms to run.
Function load_lora_B took 1.2269020080566406 ms to run.
cost realload: 7.841587066650391
Function load_adapters took 7.867574691772461 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 29 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5898475646972656 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 30 in total
Function load_lora_A took 1.245260238647461 ms to run.
Function load_lora_B took 1.169443130493164 ms to run.
cost realload: 2.7976036071777344
Function load_adapters took 2.818584442138672 ms to run.
Avg tokens(prompt+generate) throughput: 1776.706 tokens/s
Avg prompt tokens throughput:           1089.818 tokens/s
Avg generate tokens throughput:          686.888 tokens/s
cost load scan: 0.01239776611328125
load 1 adapters, 31 in total
Function load_lora_A took 1.1851787567138672 ms to run.
Function load_lora_B took 1.192331314086914 ms to run.
cost realload: 2.7709007263183594
Function load_adapters took 2.7914047241210938 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 30 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5800724029541016 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 29 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11038780212402344
Function offload_adapters took 0.5829334259033203 ms to run.
current batch size: 30 token used ratio: 0.179
cost offload scan: 0.08821487426757812
offload 1 adapters, 28 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5817413330078125 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 27 remains
cost offload cat: 0.029087066650390625
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5807876586914062 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 26 remains
cost offload cat: 0.02956390380859375
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5755424499511719 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 25 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5846023559570312 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 26 in total
Function load_lora_A took 1.2052059173583984 ms to run.
Function load_lora_B took 1.211404800415039 ms to run.
cost realload: 2.8142929077148438
Function load_adapters took 2.835512161254883 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 25 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5681514739990234 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 26 in total
Function load_lora_A took 1.2159347534179688 ms to run.
Function load_lora_B took 1.2328624725341797 ms to run.
cost realload: 2.8395652770996094
Function load_adapters took 2.859830856323242 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 25 remains
cost offload cat: 0.036716461181640625
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10275840759277344
Function offload_adapters took 0.5767345428466797 ms to run.
cost load scan: 0.012159347534179688
load 1 adapters, 26 in total
Function load_lora_A took 1.2209415435791016 ms to run.
Function load_lora_B took 1.1966228485107422 ms to run.
cost realload: 2.821683883666992
Function load_adapters took 2.8421878814697266 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 25 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5831718444824219 ms to run.
current batch size: 26 token used ratio: 0.15855384615384616
cost load scan: 0.008344650268554688
load 0 adapters, 25 in total
cost realload: 0.2923011779785156
Function load_adapters took 0.31638145446777344 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 24 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5800724029541016 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 23 remains
cost offload cat: 0.02956390380859375
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5645751953125 ms to run.
offload 0 adapters, 23 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 24 in total
Function load_lora_A took 1.1973381042480469 ms to run.
Function load_lora_B took 1.2352466583251953 ms to run.
cost realload: 2.828359603881836
Function load_adapters took 2.8486251831054688 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 23 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.583648681640625 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 22 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
INFO:     127.0.0.1:55080 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55094 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55104 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55120 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55132 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55142 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55154 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55156 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55160 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55174 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55180 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55192 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55200 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55210 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5986690521240234 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 21 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.029325485229492188
cost offload a_loc update: 0.10204315185546875
Function offload_adapters took 0.57220458984375 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 20 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5755424499511719 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 19 remains
cost offload cat: 0.02956390380859375
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10275840759277344
Function offload_adapters took 0.5624294281005859 ms to run.
cost offload scan: 0.08463859558105469
offload 1 adapters, 18 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.05054473876953125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5733966827392578 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 17 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5762577056884766 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 18 in total
Function load_lora_A took 1.2111663818359375 ms to run.
Function load_lora_B took 1.2280941009521484 ms to run.
cost realload: 2.8362274169921875
Function load_adapters took 2.856731414794922 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 18 in total
cost realload: 0.28896331787109375
Function load_adapters took 0.31566619873046875 ms to run.
current batch size: 20 token used ratio: 0.11781538461538461
cost offload scan: 0.08487701416015625
offload 1 adapters, 17 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5695819854736328 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 18 in total
Function load_lora_A took 1.2083053588867188 ms to run.
Function load_lora_B took 1.2314319610595703 ms to run.
cost realload: 2.8383731842041016
Function load_adapters took 2.8600692749023438 ms to run.
cost offload scan: 0.08559226989746094
offload 1 adapters, 17 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10132789611816406
Function offload_adapters took 0.5650520324707031 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 18 in total
Function load_lora_A took 1.2340545654296875 ms to run.
Function load_lora_B took 1.2326240539550781 ms to run.
cost realload: 2.844572067260742
Function load_adapters took 2.864837646484375 ms to run.
cost load scan: 0.013113021850585938
load 3 adapters, 21 in total
Function load_lora_A took 1.2507438659667969 ms to run.
Function load_lora_B took 1.2085437774658203 ms to run.
Function load_lora_A took 1.2481212615966797 ms to run.
Function load_lora_B took 1.2257099151611328 ms to run.
Function load_lora_A took 1.2116432189941406 ms to run.
Function load_lora_B took 1.2209415435791016 ms to run.
cost realload: 7.902622222900391
Function load_adapters took 7.923603057861328 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 22 in total
Function load_lora_A took 1.2464523315429688 ms to run.
Function load_lora_B took 1.2149810791015625 ms to run.
cost realload: 2.8562545776367188
Function load_adapters took 2.8769969940185547 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 23 in total
Function load_lora_A took 1.2302398681640625 ms to run.
Function load_lora_B took 1.1897087097167969 ms to run.
cost realload: 2.808094024658203
Function load_adapters took 2.8290748596191406 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 22 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5755424499511719 ms to run.
current batch size: 24 token used ratio: 0.14084615384615384
offload 0 adapters, 22 remains
Function offload_adapters took 0.0133514404296875 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 23 in total
Function load_lora_A took 1.2063980102539062 ms to run.
Function load_lora_B took 1.1799335479736328 ms to run.
cost realload: 2.7713775634765625
Function load_adapters took 2.7925968170166016 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 22 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.5869865417480469 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 23 in total
Function load_lora_A took 1.2331008911132812 ms to run.
Function load_lora_B took 1.1899471282958984 ms to run.
cost realload: 2.8047561645507812
Function load_adapters took 2.825021743774414 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 22 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5719661712646484 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 21 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5772113800048828 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 20 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5822181701660156 ms to run.
current batch size: 20 token used ratio: 0.12283076923076923
cost offload scan: 0.08535385131835938
offload 1 adapters, 19 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5733966827392578 ms to run.
cost offload scan: 0.10037422180175781
offload 1 adapters, 18 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.05364418029785156
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.6158351898193359 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 19 in total
Function load_lora_A took 1.2049674987792969 ms to run.
Function load_lora_B took 1.2173652648925781 ms to run.
cost realload: 2.831697463989258
Function load_adapters took 2.8548240661621094 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 18 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.583648681640625 ms to run.
cost offload scan: 0.10538101196289062
offload 1 adapters, 17 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5929470062255859 ms to run.
INFO:     127.0.0.1:55224 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55236 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55252 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55258 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55264 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55272 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55276 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55280 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55286 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55288 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55304 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55310 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46002 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46016 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46028 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46032 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46046 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46056 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46066 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload scan: 0.08916854858398438
offload 1 adapters, 16 remains
cost offload cat: 0.03910064697265625
cost offload free mem manager: 0.057220458984375
cost offload torch.empty: 0.03266334533691406
cost offload a_loc update: 0.14066696166992188
Function offload_adapters took 0.7314682006835938 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 17 in total
Function load_lora_A took 1.1780261993408203 ms to run.
Function load_lora_B took 1.2323856353759766 ms to run.
cost realload: 2.7892589569091797
Function load_adapters took 2.8095245361328125 ms to run.
cost offload scan: 0.08463859558105469
offload 1 adapters, 16 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5657672882080078 ms to run.
cost load scan: 0.009059906005859375
load 2 adapters, 18 in total
Function load_lora_A took 1.21307373046875 ms to run.
Function load_lora_B took 1.1882781982421875 ms to run.
Function load_lora_A took 1.222372055053711 ms to run.
Function load_lora_B took 1.2180805206298828 ms to run.
cost realload: 5.301952362060547
Function load_adapters took 5.322456359863281 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 17 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5750656127929688 ms to run.
current batch size: 18 token used ratio: 0.09581538461538462
cost offload scan: 0.08392333984375
offload 1 adapters, 16 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5621910095214844 ms to run.
cost offload scan: 0.08082389831542969
offload 1 adapters, 15 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5660057067871094 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 16 in total
Function load_lora_A took 1.2111663818359375 ms to run.
Function load_lora_B took 1.2195110321044922 ms to run.
cost realload: 2.830028533935547
Function load_adapters took 2.8502941131591797 ms to run.
cost offload scan: 0.08392333984375
offload 1 adapters, 15 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5750656127929688 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 14 remains
cost offload cat: 0.029325485229492188
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5633831024169922 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 15 in total
Function load_lora_A took 1.2333393096923828 ms to run.
Function load_lora_B took 1.2395381927490234 ms to run.
cost realload: 2.863168716430664
Function load_adapters took 2.8848648071289062 ms to run.
cost offload scan: 0.08177757263183594
offload 1 adapters, 14 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.5652904510498047 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 15 in total
Function load_lora_A took 1.21307373046875 ms to run.
Function load_lora_B took 1.2106895446777344 ms to run.
cost realload: 2.810239791870117
Function load_adapters took 2.8312206268310547 ms to run.
current batch size: 16 token used ratio: 0.08747692307692308
cost load scan: 0.008106231689453125
load 0 adapters, 15 in total
cost realload: 0.2849102020263672
Function load_adapters took 0.3082752227783203 ms to run.
cost offload scan: 0.08463859558105469
offload 1 adapters, 14 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.568389892578125 ms to run.
cost offload scan: 0.08225440979003906
offload 1 adapters, 13 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5548000335693359 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 14 in total
Function load_lora_A took 1.2133121490478516 ms to run.
Function load_lora_B took 1.2121200561523438 ms to run.
cost realload: 2.820730209350586
Function load_adapters took 2.841949462890625 ms to run.
cost load scan: 0.00858306884765625
load 2 adapters, 16 in total
Function load_lora_A took 1.1928081512451172 ms to run.
Function load_lora_B took 1.19781494140625 ms to run.
Function load_lora_A took 1.2450218200683594 ms to run.
Function load_lora_B took 1.2383460998535156 ms to run.
cost realload: 5.3272247314453125
Function load_adapters took 5.347251892089844 ms to run.
cost load scan: 0.01621246337890625
load 1 adapters, 17 in total
Function load_lora_A took 1.2400150299072266 ms to run.
Function load_lora_B took 1.230478286743164 ms to run.
cost realload: 2.8831958770751953
Function load_adapters took 2.907991409301758 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 16 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.024557113647460938
cost offload a_loc update: 0.118255615234375
Function offload_adapters took 0.6077289581298828 ms to run.
cost load scan: 0.015020370483398438
load 2 adapters, 18 in total
Function load_lora_A took 1.214742660522461 ms to run.
Function load_lora_B took 1.2292861938476562 ms to run.
Function load_lora_A took 1.2042522430419922 ms to run.
Function load_lora_B took 1.207113265991211 ms to run.
cost realload: 5.322694778442383
Function load_adapters took 5.343914031982422 ms to run.
current batch size: 22 token used ratio: 0.11543076923076923
offload 0 adapters, 18 remains
Function offload_adapters took 0.013828277587890625 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 17 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.579833984375 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 18 in total
Function load_lora_A took 1.194000244140625 ms to run.
Function load_lora_B took 1.2173652648925781 ms to run.
cost realload: 2.799510955810547
Function load_adapters took 2.8197765350341797 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost offload scan: 0.09560585021972656
offload 1 adapters, 17 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5872249603271484 ms to run.
cost load scan: 0.012159347534179688
load 1 adapters, 18 in total
Function load_lora_A took 1.2202262878417969 ms to run.
Function load_lora_B took 1.1935234069824219 ms to run.
cost realload: 2.8014183044433594
Function load_adapters took 2.822399139404297 ms to run.
cost offload scan: 0.12278556823730469
offload 2 adapters, 16 remains
cost offload cat: 0.023603439331054688
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.6053447723388672 ms to run.
INFO:     127.0.0.1:46074 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46078 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46082 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46084 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46090 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46096 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46100 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46104 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46114 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46126 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46142 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46152 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46162 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46172 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46188 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46204 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46210 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46214 - "POST /generate_stream HTTP/1.1" 200 OK
cost load scan: 0.014543533325195312
load 2 adapters, 18 in total
Function load_lora_A took 1.2104511260986328 ms to run.
Function load_lora_B took 1.209259033203125 ms to run.
Function load_lora_A took 1.2142658233642578 ms to run.
Function load_lora_B took 1.1928081512451172 ms to run.
cost realload: 5.39851188659668
Function load_adapters took 5.419254302978516 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 19 in total
Function load_lora_A took 1.1992454528808594 ms to run.
Function load_lora_B took 1.2366771697998047 ms to run.
cost realload: 2.8231143951416016
Function load_adapters took 2.8486251831054688 ms to run.
current batch size: 21 token used ratio: 0.1076
cost load scan: 0.014781951904296875
load 2 adapters, 21 in total
Function load_lora_A took 1.1746883392333984 ms to run.
Function load_lora_B took 1.2297630310058594 ms to run.
Function load_lora_A took 1.1744499206542969 ms to run.
Function load_lora_B took 1.2116432189941406 ms to run.
cost realload: 5.255699157714844
Function load_adapters took 5.275964736938477 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 20 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.6034374237060547 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 21 in total
Function load_lora_A took 1.2569427490234375 ms to run.
Function load_lora_B took 1.2028217315673828 ms to run.
cost realload: 2.8696060180664062
Function load_adapters took 2.8905868530273438 ms to run.
Avg tokens(prompt+generate) throughput: 1943.258 tokens/s
Avg prompt tokens throughput:           1068.163 tokens/s
Avg generate tokens throughput:          875.095 tokens/s
cost load scan: 0.012159347534179688
load 2 adapters, 23 in total
Function load_lora_A took 1.2121200561523438 ms to run.
Function load_lora_B took 1.2111663818359375 ms to run.
Function load_lora_A took 1.1794567108154297 ms to run.
Function load_lora_B took 1.1875629425048828 ms to run.
cost realload: 5.252361297607422
Function load_adapters took 5.273103713989258 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 23 in total
cost realload: 0.28228759765625
Function load_adapters took 0.3066062927246094 ms to run.
current batch size: 26 token used ratio: 0.14175384615384615
cost load scan: 0.011682510375976562
load 2 adapters, 25 in total
Function load_lora_A took 1.2059211730957031 ms to run.
Function load_lora_B took 1.1932849884033203 ms to run.
Function load_lora_A took 1.1730194091796875 ms to run.
Function load_lora_B took 1.2044906616210938 ms to run.
cost realload: 5.239725112915039
Function load_adapters took 5.260229110717773 ms to run.
offload 0 adapters, 25 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 24 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.583648681640625 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 24 in total
cost realload: 0.2868175506591797
Function load_adapters took 0.31304359436035156 ms to run.
cost load scan: 0.012636184692382812
load 2 adapters, 26 in total
Function load_lora_A took 1.2273788452148438 ms to run.
Function load_lora_B took 1.2428760528564453 ms to run.
Function load_lora_A took 1.2288093566894531 ms to run.
Function load_lora_B took 1.2102127075195312 ms to run.
cost realload: 5.373239517211914
Function load_adapters took 5.393505096435547 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 25 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5841255187988281 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 26 in total
Function load_lora_A took 1.1796951293945312 ms to run.
Function load_lora_B took 1.2269020080566406 ms to run.
cost realload: 2.8018951416015625
Function load_adapters took 2.8231143951416016 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 25 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.11444091796875
Function offload_adapters took 0.5810260772705078 ms to run.
current batch size: 29 token used ratio: 0.1637846153846154
cost offload scan: 0.08821487426757812
offload 1 adapters, 24 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04792213439941406
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.6048679351806641 ms to run.
cost load scan: 0.01239776611328125
load 2 adapters, 26 in total
Function load_lora_A took 1.2340545654296875 ms to run.
Function load_lora_B took 1.2073516845703125 ms to run.
Function load_lora_A took 1.2159347534179688 ms to run.
Function load_lora_B took 1.1615753173828125 ms to run.
cost realload: 5.291223526000977
Function load_adapters took 5.312919616699219 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 25 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.591278076171875 ms to run.
cost offload scan: 0.091552734375
offload 1 adapters, 24 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5803108215332031 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 23 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.57220458984375 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 22 remains
cost offload cat: 0.02956390380859375
cost offload free mem manager: 0.04887580871582031
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5838871002197266 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 21 remains
cost offload cat: 0.02956390380859375
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5710124969482422 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 22 in total
Function load_lora_A took 1.2001991271972656 ms to run.
Function load_lora_B took 1.219034194946289 ms to run.
cost realload: 2.7954578399658203
Function load_adapters took 2.8159618377685547 ms to run.
cost offload scan: 0.08463859558105469
offload 1 adapters, 21 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5667209625244141 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 22 in total
Function load_lora_A took 1.1970996856689453 ms to run.
Function load_lora_B took 1.199960708618164 ms to run.
cost realload: 2.7875900268554688
Function load_adapters took 2.8085708618164062 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 21 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10752677917480469
INFO:     127.0.0.1:46228 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46230 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46244 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46248 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46264 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46266 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46268 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46270 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46276 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46282 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46298 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46310 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46318 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46334 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46342 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46358 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46370 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46384 - "POST /generate_stream HTTP/1.1" 200 OK
Function offload_adapters took 0.5819797515869141 ms to run.
current batch size: 24 token used ratio: 0.13572307692307692
cost load scan: 0.013113021850585938
load 1 adapters, 22 in total
Function load_lora_A took 1.2025833129882812 ms to run.
Function load_lora_B took 1.2125968933105469 ms to run.
cost realload: 2.8200149536132812
Function load_adapters took 2.8412342071533203 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 21 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5738735198974609 ms to run.
cost load scan: 0.012159347534179688
load 1 adapters, 22 in total
Function load_lora_A took 1.2090206146240234 ms to run.
Function load_lora_B took 1.1603832244873047 ms to run.
cost realload: 2.7599334716796875
Function load_adapters took 2.7811527252197266 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 23 in total
Function load_lora_A took 1.2063980102539062 ms to run.
Function load_lora_B took 1.1909008026123047 ms to run.
cost realload: 2.795696258544922
Function load_adapters took 2.817392349243164 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 22 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5764961242675781 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 21 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.579833984375 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 22 in total
Function load_lora_A took 1.2209415435791016 ms to run.
Function load_lora_B took 1.2226104736328125 ms to run.
cost realload: 2.8395652770996094
Function load_adapters took 2.861499786376953 ms to run.
cost offload scan: 0.12326240539550781
offload 2 adapters, 20 remains
cost offload cat: 0.02384185791015625
cost offload free mem manager: 0.05054473876953125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.6129741668701172 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost load scan: 0.009775161743164062
load 1 adapters, 21 in total
Function load_lora_A took 1.2323856353759766 ms to run.
Function load_lora_B took 1.2476444244384766 ms to run.
cost realload: 2.87628173828125
Function load_adapters took 2.8967857360839844 ms to run.
cost offload scan: 0.09512901306152344
offload 1 adapters, 20 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5772113800048828 ms to run.
current batch size: 24 token used ratio: 0.12853846153846155
cost load scan: 0.00858306884765625
load 1 adapters, 21 in total
Function load_lora_A took 1.2192726135253906 ms to run.
Function load_lora_B took 1.22833251953125 ms to run.
cost realload: 2.8460025787353516
Function load_adapters took 2.8688907623291016 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 20 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5776882171630859 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 21 in total
Function load_lora_A took 1.2164115905761719 ms to run.
Function load_lora_B took 1.2288093566894531 ms to run.
cost realload: 2.8333663940429688
Function load_adapters took 2.854585647583008 ms to run.
cost offload scan: 0.13017654418945312
offload 2 adapters, 19 remains
cost offload cat: 0.02956390380859375
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.6151199340820312 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 20 in total
Function load_lora_A took 1.2178421020507812 ms to run.
Function load_lora_B took 1.1556148529052734 ms to run.
cost realload: 2.7620792388916016
Function load_adapters took 2.782583236694336 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.012636184692382812 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 19 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5846023559570312 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 20 in total
Function load_lora_A took 1.1894702911376953 ms to run.
Function load_lora_B took 1.2121200561523438 ms to run.
cost realload: 2.793550491333008
Function load_adapters took 2.820730209350586 ms to run.
current batch size: 22 token used ratio: 0.12006153846153846
offload 0 adapters, 20 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 21 in total
Function load_lora_A took 1.2264251708984375 ms to run.
Function load_lora_B took 1.2431144714355469 ms to run.
cost realload: 2.860546112060547
Function load_adapters took 2.881288528442383 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 20 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.5843639373779297 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 19 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5834102630615234 ms to run.
cost load scan: 0.012159347534179688
load 1 adapters, 20 in total
Function load_lora_A took 1.215219497680664 ms to run.
Function load_lora_B took 1.2235641479492188 ms to run.
cost realload: 2.827882766723633
Function load_adapters took 2.8502941131591797 ms to run.
cost offload scan: 0.08392333984375
offload 1 adapters, 19 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5731582641601562 ms to run.
cost offload scan: 0.08463859558105469
offload 1 adapters, 18 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5769729614257812 ms to run.
current batch size: 19 token used ratio: 0.10721538461538462
cost load scan: 0.008821487426757812
load 1 adapters, 19 in total
Function load_lora_A took 1.1970996856689453 ms to run.
Function load_lora_B took 1.219034194946289 ms to run.
cost realload: 2.8460025787353516
Function load_adapters took 2.866983413696289 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 18 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5855560302734375 ms to run.
cost load scan: 0.014543533325195312
load 2 adapters, 20 in total
Function load_lora_A took 1.2054443359375 ms to run.
INFO:     127.0.0.1:46400 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46408 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46418 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46422 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46432 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46444 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46450 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46452 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46454 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53154 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53158 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53160 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53162 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53166 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53170 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53182 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53188 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53200 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53214 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53230 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53240 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_B took 1.2409687042236328 ms to run.
Function load_lora_A took 1.194000244140625 ms to run.
Function load_lora_B took 1.21307373046875 ms to run.
cost realload: 5.347490310668945
Function load_adapters took 5.3691864013671875 ms to run.
cost load scan: 0.015974044799804688
load 5 adapters, 25 in total
Function load_lora_A took 1.2164115905761719 ms to run.
Function load_lora_B took 1.2013912200927734 ms to run.
Function load_lora_A took 1.2590885162353516 ms to run.
Function load_lora_B took 1.241445541381836 ms to run.
Function load_lora_A took 1.2078285217285156 ms to run.
Function load_lora_B took 1.215219497680664 ms to run.
Function load_lora_A took 1.1925697326660156 ms to run.
Function load_lora_B took 1.2345314025878906 ms to run.
Function load_lora_A took 1.2459754943847656 ms to run.
Function load_lora_B took 1.1932849884033203 ms to run.
cost realload: 12.882471084594727
Function load_adapters took 12.90440559387207 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 24 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5807876586914062 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 25 in total
Function load_lora_A took 1.203298568725586 ms to run.
Function load_lora_B took 1.2249946594238281 ms to run.
cost realload: 2.8204917907714844
Function load_adapters took 2.840757369995117 ms to run.
current batch size: 27 token used ratio: 0.14686153846153846
cost load scan: 0.008106231689453125
load 1 adapters, 26 in total
Function load_lora_A took 1.220703125 ms to run.
Function load_lora_B took 1.230001449584961 ms to run.
cost realload: 2.8467178344726562
Function load_adapters took 2.8679370880126953 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 25 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.12803077697753906
Function offload_adapters took 0.5970001220703125 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 25 in total
cost realload: 0.2903938293457031
Function load_adapters took 0.3147125244140625 ms to run.
cost offload scan: 0.09393692016601562
offload 1 adapters, 24 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.5824565887451172 ms to run.
cost offload scan: 0.1277923583984375
offload 2 adapters, 22 remains
cost offload cat: 0.025033950805664062
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.6182193756103516 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 23 in total
Function load_lora_A took 1.1823177337646484 ms to run.
Function load_lora_B took 1.1692047119140625 ms to run.
cost realload: 2.7451515197753906
Function load_adapters took 2.7658939361572266 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 24 in total
Function load_lora_A took 1.222372055053711 ms to run.
Function load_lora_B took 1.306772232055664 ms to run.
cost realload: 2.9273033142089844
Function load_adapters took 2.9485225677490234 ms to run.
current batch size: 29 token used ratio: 0.16183076923076922
cost offload scan: 0.08726119995117188
offload 1 adapters, 23 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11610984802246094
Function offload_adapters took 0.5939006805419922 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 22 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5838871002197266 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.011682510375976562 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 21 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5779266357421875 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 20 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5776882171630859 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 21 in total
Function load_lora_A took 1.2123584747314453 ms to run.
Function load_lora_B took 1.2154579162597656 ms to run.
cost realload: 2.8150081634521484
Function load_adapters took 2.8352737426757812 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 20 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.58746337890625 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 21 in total
Function load_lora_A took 1.2218952178955078 ms to run.
Function load_lora_B took 1.2316703796386719 ms to run.
cost realload: 2.8426647186279297
Function load_adapters took 2.8638839721679688 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 20 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5805492401123047 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 19 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5688667297363281 ms to run.
cost load scan: 0.011920928955078125
load 2 adapters, 21 in total
Function load_lora_A took 1.2559890747070312 ms to run.
Function load_lora_B took 1.2326240539550781 ms to run.
Function load_lora_A took 1.2176036834716797 ms to run.
Function load_lora_B took 1.1932849884033203 ms to run.
cost realload: 5.365610122680664
Function load_adapters took 5.386114120483398 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 20 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5698204040527344 ms to run.
current batch size: 22 token used ratio: 0.12416923076923077
cost offload scan: 0.08440017700195312
offload 1 adapters, 19 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5702972412109375 ms to run.
Avg tokens(prompt+generate) throughput: 2220.225 tokens/s
Avg prompt tokens throughput:           1234.857 tokens/s
Avg generate tokens throughput:          985.368 tokens/s
cost load scan: 0.009059906005859375
load 1 adapters, 20 in total
Function load_lora_A took 1.2280941009521484 ms to run.
Function load_lora_B took 1.2159347534179688 ms to run.
cost realload: 2.838611602783203
Function load_adapters took 2.859830856323242 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.009298324584960938
INFO:     127.0.0.1:53244 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53246 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53252 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53256 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53270 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53282 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53286 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53294 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53308 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53310 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53326 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53336 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53348 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53360 - "POST /generate_stream HTTP/1.1" 200 OK
load 2 adapters, 22 in total
Function load_lora_A took 1.2395381927490234 ms to run.
Function load_lora_B took 1.2125968933105469 ms to run.
Function load_lora_A took 1.2128353118896484 ms to run.
Function load_lora_B took 1.1887550354003906 ms to run.
cost realload: 5.404233932495117
Function load_adapters took 5.424737930297852 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.08559226989746094
offload 1 adapters, 21 remains
cost offload cat: 0.037670135498046875
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.5867481231689453 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 21 in total
cost realload: 0.28324127197265625
Function load_adapters took 0.30803680419921875 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 20 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.5810260772705078 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 19 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5762577056884766 ms to run.
current batch size: 22 token used ratio: 0.1235076923076923
cost load scan: 0.008821487426757812
load 1 adapters, 20 in total
Function load_lora_A took 1.210927963256836 ms to run.
Function load_lora_B took 1.2054443359375 ms to run.
cost realload: 2.811431884765625
Function load_adapters took 2.832651138305664 ms to run.
cost load scan: 0.01239776611328125
load 2 adapters, 22 in total
Function load_lora_A took 1.2145042419433594 ms to run.
Function load_lora_B took 1.2247562408447266 ms to run.
Function load_lora_A took 1.2290477752685547 ms to run.
Function load_lora_B took 1.2295246124267578 ms to run.
cost realload: 5.365610122680664
Function load_adapters took 5.386590957641602 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 21 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.5800724029541016 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 22 in total
Function load_lora_A took 1.2366771697998047 ms to run.
Function load_lora_B took 1.207590103149414 ms to run.
cost realload: 2.841949462890625
Function load_adapters took 2.862691879272461 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 23 in total
Function load_lora_A took 1.2011528015136719 ms to run.
Function load_lora_B took 1.1990070343017578 ms to run.
cost realload: 2.790212631225586
Function load_adapters took 2.811431884765625 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 22 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.051021575927734375
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.5898475646972656 ms to run.
current batch size: 25 token used ratio: 0.14390769230769232
cost offload scan: 0.08726119995117188
offload 1 adapters, 21 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5741119384765625 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 20 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5815029144287109 ms to run.
cost load scan: 0.008821487426757812
load 0 adapters, 20 in total
cost realload: 0.2899169921875
Function load_adapters took 0.31495094299316406 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 21 in total
Function load_lora_A took 1.218557357788086 ms to run.
Function load_lora_B took 1.2102127075195312 ms to run.
cost realload: 2.8243064880371094
Function load_adapters took 2.8450489044189453 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 22 in total
Function load_lora_A took 1.2001991271972656 ms to run.
Function load_lora_B took 1.2373924255371094 ms to run.
cost realload: 2.8357505798339844
Function load_adapters took 2.8564929962158203 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 21 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5755424499511719 ms to run.
cost offload scan: 0.12445449829101562
offload 2 adapters, 19 remains
cost offload cat: 0.0247955322265625
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.6017684936523438 ms to run.
current batch size: 22 token used ratio: 0.12721538461538462
offload 0 adapters, 19 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.08463859558105469
offload 1 adapters, 18 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5640983581542969 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 17 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5784034729003906 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 16 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5733966827392578 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 16 in total
cost realload: 0.2913475036621094
Function load_adapters took 0.3159046173095703 ms to run.
cost load scan: 0.012636184692382812
load 3 adapters, 19 in total
Function load_lora_A took 1.2674331665039062 ms to run.
Function load_lora_B took 1.2531280517578125 ms to run.
Function load_lora_A took 1.1892318725585938 ms to run.
Function load_lora_B took 1.192331314086914 ms to run.
Function load_lora_A took 1.2154579162597656 ms to run.
Function load_lora_B took 1.222372055053711 ms to run.
cost realload: 7.891178131103516
Function load_adapters took 7.912874221801758 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 18 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5702972412109375 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 17 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10275840759277344
Function offload_adapters took 0.5738735198974609 ms to run.
offload 0 adapters, 17 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.08463859558105469
offload 1 adapters, 16 remains
cost offload cat: 0.029802322387695312
INFO:     127.0.0.1:53374 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53382 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53384 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53388 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53390 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53396 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53410 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53424 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53436 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34906 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34916 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34920 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34934 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.030040740966796875
cost offload a_loc update: 0.14209747314453125
Function offload_adapters took 0.6933212280273438 ms to run.
current batch size: 18 token used ratio: 0.09787692307692308
cost load scan: 0.008344650268554688
load 1 adapters, 17 in total
Function load_lora_A took 1.2395381927490234 ms to run.
Function load_lora_B took 1.2264251708984375 ms to run.
cost realload: 2.864837646484375
Function load_adapters took 2.885580062866211 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 16 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5667209625244141 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 15 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5702972412109375 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 16 in total
Function load_lora_A took 1.1932849884033203 ms to run.
Function load_lora_B took 1.2347698211669922 ms to run.
cost realload: 2.8238296508789062
Function load_adapters took 2.8443336486816406 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 15 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5714893341064453 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 14 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5774497985839844 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 15 in total
Function load_lora_A took 1.2493133544921875 ms to run.
Function load_lora_B took 1.2347698211669922 ms to run.
cost realload: 2.8870105743408203
Function load_adapters took 2.9077529907226562 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 14 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5645751953125 ms to run.
current batch size: 16 token used ratio: 0.08878461538461538
cost load scan: 0.007867813110351562
load 1 adapters, 15 in total
Function load_lora_A took 1.1758804321289062 ms to run.
Function load_lora_B took 1.2392997741699219 ms to run.
cost realload: 2.816438674926758
Function load_adapters took 2.8378963470458984 ms to run.
cost load scan: 0.015974044799804688
load 1 adapters, 16 in total
Function load_lora_A took 1.2164115905761719 ms to run.
Function load_lora_B took 1.2290477752685547 ms to run.
cost realload: 2.8400421142578125
Function load_adapters took 2.860546112060547 ms to run.
cost offload scan: 0.08463859558105469
offload 1 adapters, 15 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5686283111572266 ms to run.
cost offload scan: 0.08368492126464844
offload 1 adapters, 14 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5612373352050781 ms to run.
cost offload scan: 0.08225440979003906
offload 1 adapters, 13 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10228157043457031
Function offload_adapters took 0.5643367767333984 ms to run.
offload 0 adapters, 13 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 14 in total
Function load_lora_A took 1.211404800415039 ms to run.
Function load_lora_B took 1.2319087982177734 ms to run.
cost realload: 2.849102020263672
Function load_adapters took 2.870321273803711 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 15 in total
Function load_lora_A took 1.1904239654541016 ms to run.
Function load_lora_B took 1.2195110321044922 ms to run.
cost realload: 2.8069019317626953
Function load_adapters took 2.829313278198242 ms to run.
current batch size: 16 token used ratio: 0.08595384615384616
cost offload scan: 0.08606910705566406
offload 1 adapters, 14 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.57220458984375 ms to run.
offload 0 adapters, 14 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 13 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5688667297363281 ms to run.
cost offload scan: 0.0820159912109375
offload 1 adapters, 12 remains
cost offload cat: 0.029325485229492188
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10251998901367188
Function offload_adapters took 0.5538463592529297 ms to run.
cost offload scan: 0.08249282836914062
offload 1 adapters, 11 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5652904510498047 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 12 in total
Function load_lora_A took 1.194000244140625 ms to run.
Function load_lora_B took 1.2209415435791016 ms to run.
cost realload: 2.8076171875
Function load_adapters took 2.8302669525146484 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 11 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.5824565887451172 ms to run.
current batch size: 11 token used ratio: 0.055553846153846155
cost load scan: 0.008344650268554688
load 1 adapters, 12 in total
Function load_lora_A took 1.1966228485107422 ms to run.
Function load_lora_B took 1.2416839599609375 ms to run.
cost realload: 2.832651138305664
Function load_adapters took 2.8524398803710938 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 13 in total
Function load_lora_A took 1.2428760528564453 ms to run.
Function load_lora_B took 1.2123584747314453 ms to run.
cost realload: 2.847433090209961
Function load_adapters took 2.870798110961914 ms to run.
cost offload scan: 0.08296966552734375
offload 1 adapters, 12 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.0286102294921875
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5714893341064453 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 13 in total
Function load_lora_A took 1.2238025665283203 ms to run.
Function load_lora_B took 1.2562274932861328 ms to run.
cost realload: 2.8684139251708984
Function load_adapters took 2.8896331787109375 ms to run.
cost offload scan: 0.08463859558105469
offload 1 adapters, 12 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022172927856445312
INFO:     127.0.0.1:34950 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34960 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34964 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34974 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34986 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35000 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35010 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35018 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35032 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35040 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35046 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35048 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35050 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35062 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35068 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35070 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35086 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35088 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5888938903808594 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 13 in total
Function load_lora_A took 1.1949539184570312 ms to run.
Function load_lora_B took 1.2388229370117188 ms to run.
cost realload: 2.8226375579833984
Function load_adapters took 2.8433799743652344 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 13 in total
cost realload: 0.27823448181152344
Function load_adapters took 0.30231475830078125 ms to run.
current batch size: 16 token used ratio: 0.08116923076923077
cost offload scan: 0.08344650268554688
offload 1 adapters, 12 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5629062652587891 ms to run.
cost offload scan: 0.0820159912109375
offload 1 adapters, 11 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5707740783691406 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 12 in total
Function load_lora_A took 1.2247562408447266 ms to run.
Function load_lora_B took 1.2063980102539062 ms to run.
cost realload: 2.8285980224609375
Function load_adapters took 2.8498172760009766 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 11 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5662441253662109 ms to run.
Avg tokens(prompt+generate) throughput: 1609.983 tokens/s
Avg prompt tokens throughput:            841.407 tokens/s
Avg generate tokens throughput:          768.576 tokens/s
current batch size: 14 token used ratio: 0.0738
cost offload scan: 0.08440017700195312
offload 1 adapters, 10 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10228157043457031
Function offload_adapters took 0.5643367767333984 ms to run.
cost offload scan: 0.0820159912109375
offload 1 adapters, 9 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5621910095214844 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 10 in total
Function load_lora_A took 1.2178421020507812 ms to run.
Function load_lora_B took 1.215219497680664 ms to run.
cost realload: 2.838134765625
Function load_adapters took 2.8641223907470703 ms to run.
cost offload scan: 0.08153915405273438
offload 1 adapters, 9 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5598068237304688 ms to run.
cost offload scan: 0.08225440979003906
offload 1 adapters, 8 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10085105895996094
Function offload_adapters took 0.5519390106201172 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 8 in total
cost realload: 0.2868175506591797
Function load_adapters took 0.31113624572753906 ms to run.
current batch size: 12 token used ratio: 0.06787692307692307
cost load scan: 0.0095367431640625
load 2 adapters, 10 in total
Function load_lora_A took 1.1947154998779297 ms to run.
Function load_lora_B took 1.2145042419433594 ms to run.
Function load_lora_A took 1.2288093566894531 ms to run.
Function load_lora_B took 1.2409687042236328 ms to run.
cost realload: 5.356311798095703
Function load_adapters took 5.377292633056641 ms to run.
cost offload scan: 0.08177757263183594
offload 1 adapters, 9 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5550384521484375 ms to run.
cost offload scan: 0.08296966552734375
offload 1 adapters, 8 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.5702972412109375 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 9 in total
Function load_lora_A took 1.211404800415039 ms to run.
Function load_lora_B took 1.1889934539794922 ms to run.
cost realload: 2.789735794067383
Function load_adapters took 2.813100814819336 ms to run.
cost offload scan: 0.08225440979003906
offload 1 adapters, 8 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5712509155273438 ms to run.
offload 0 adapters, 8 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 8 in total
cost realload: 0.2772808074951172
Function load_adapters took 0.30159950256347656 ms to run.
current batch size: 13 token used ratio: 0.06826153846153846
cost load scan: 0.008344650268554688
load 0 adapters, 8 in total
cost realload: 0.3001689910888672
Function load_adapters took 0.3247261047363281 ms to run.
offload 0 adapters, 8 remains
Function offload_adapters took 0.012636184692382812 ms to run.
offload 0 adapters, 8 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 9 in total
Function load_lora_A took 1.2290477752685547 ms to run.
Function load_lora_B took 1.2428760528564453 ms to run.
cost realload: 2.8705596923828125
Function load_adapters took 2.8917789459228516 ms to run.
cost offload scan: 0.0820159912109375
offload 1 adapters, 8 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.0286102294921875
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5817413330078125 ms to run.
offload 0 adapters, 8 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 9 in total
Function load_lora_A took 1.2671947479248047 ms to run.
Function load_lora_B took 1.2290477752685547 ms to run.
cost realload: 2.8836727142333984
Function load_adapters took 2.904176712036133 ms to run.
offload 0 adapters, 9 remains
Function offload_adapters took 0.013113021850585938 ms to run.
current batch size: 11 token used ratio: 0.0594
cost load scan: 0.008821487426757812
load 1 adapters, 10 in total
Function load_lora_A took 1.2311935424804688 ms to run.
Function load_lora_B took 1.230478286743164 ms to run.
cost realload: 2.849578857421875
Function load_adapters took 2.870798110961914 ms to run.
cost offload scan: 0.08082389831542969
offload 1 adapters, 9 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5593299865722656 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 10 in total
Function load_lora_A took 1.218557357788086 ms to run.
Function load_lora_B took 1.2104511260986328 ms to run.
cost realload: 2.8133392333984375
Function load_adapters took 2.8345584869384766 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 11 in total
Function load_lora_A took 1.1975765228271484 ms to run.
Function load_lora_B took 1.1990070343017578 ms to run.
cost realload: 2.788543701171875
Function load_adapters took 2.809762954711914 ms to run.
INFO:     127.0.0.1:35090 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35100 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35110 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35114 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35116 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35118 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35132 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35140 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35152 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35154 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35166 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35170 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35180 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35186 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35200 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35204 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35214 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57554 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57556 - "POST /generate_stream HTTP/1.1" 200 OK
cost load scan: 0.008821487426757812
load 2 adapters, 13 in total
Function load_lora_A took 1.2810230255126953 ms to run.
Function load_lora_B took 1.1875629425048828 ms to run.
Function load_lora_A took 1.1973381042480469 ms to run.
Function load_lora_B took 1.2142658233642578 ms to run.
cost realload: 5.4931640625
Function load_adapters took 5.5141448974609375 ms to run.
current batch size: 15 token used ratio: 0.08126153846153847
offload 0 adapters, 13 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 14 in total
Function load_lora_A took 1.2423992156982422 ms to run.
Function load_lora_B took 1.226663589477539 ms to run.
cost realload: 2.8684139251708984
Function load_adapters took 2.8896331787109375 ms to run.
offload 0 adapters, 14 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 15 in total
Function load_lora_A took 1.2443065643310547 ms to run.
Function load_lora_B took 1.245260238647461 ms to run.
cost realload: 2.8808116912841797
Function load_adapters took 2.9022693634033203 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 14 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.049591064453125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5865097045898438 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 14 in total
cost realload: 0.2834796905517578
Function load_adapters took 0.30684471130371094 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 14 in total
cost realload: 0.286102294921875
Function load_adapters took 0.31065940856933594 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 13 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5724430084228516 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 12 remains
cost offload cat: 0.03838539123535156
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.025510787963867188
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5893707275390625 ms to run.
current batch size: 14 token used ratio: 0.06544615384615385
cost load scan: 0.0095367431640625
load 2 adapters, 14 in total
Function load_lora_A took 1.245260238647461 ms to run.
Function load_lora_B took 1.2297630310058594 ms to run.
Function load_lora_A took 1.2078285217285156 ms to run.
Function load_lora_B took 1.2385845184326172 ms to run.
cost realload: 5.382061004638672
Function load_adapters took 5.402803421020508 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 15 in total
Function load_lora_A took 1.2145042419433594 ms to run.
Function load_lora_B took 1.2302398681640625 ms to run.
cost realload: 2.8362274169921875
Function load_adapters took 2.8569698333740234 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 14 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5617141723632812 ms to run.
cost load scan: 0.009298324584960938
load 2 adapters, 16 in total
Function load_lora_A took 1.1818408966064453 ms to run.
Function load_lora_B took 1.2323856353759766 ms to run.
Function load_lora_A took 1.2004375457763672 ms to run.
Function load_lora_B took 1.2252330780029297 ms to run.
cost realload: 5.305290222167969
Function load_adapters took 5.326509475708008 ms to run.
cost load scan: 0.009298324584960938
load 2 adapters, 18 in total
Function load_lora_A took 1.2383460998535156 ms to run.
Function load_lora_B took 1.2671947479248047 ms to run.
Function load_lora_A took 1.2199878692626953 ms to run.
Function load_lora_B took 1.2862682342529297 ms to run.
cost realload: 5.474090576171875
Function load_adapters took 5.497455596923828 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 17 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5843639373779297 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 18 in total
Function load_lora_A took 1.2183189392089844 ms to run.
Function load_lora_B took 1.2593269348144531 ms to run.
cost realload: 2.8679370880126953
Function load_adapters took 2.888202667236328 ms to run.
current batch size: 21 token used ratio: 0.10215384615384615
offload 0 adapters, 18 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 18 in total
cost realload: 0.2760887145996094
Function load_adapters took 0.2999305725097656 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 18 in total
cost realload: 0.2865791320800781
Function load_adapters took 0.3101825714111328 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 17 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5769729614257812 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 18 in total
Function load_lora_A took 1.2454986572265625 ms to run.
Function load_lora_B took 1.2388229370117188 ms to run.
cost realload: 2.858877182006836
Function load_adapters took 2.8786659240722656 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 17 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5757808685302734 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 18 in total
Function load_lora_A took 1.2369155883789062 ms to run.
Function load_lora_B took 1.2166500091552734 ms to run.
cost realload: 2.8486251831054688
Function load_adapters took 2.8696060180664062 ms to run.
current batch size: 22 token used ratio: 0.11209230769230769
offload 0 adapters, 18 remains
Function offload_adapters took 0.012874603271484375 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 19 in total
Function load_lora_A took 1.2178421020507812 ms to run.
Function load_lora_B took 1.2145042419433594 ms to run.
cost realload: 2.8257369995117188
Function load_adapters took 2.8502941131591797 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 18 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5803108215332031 ms to run.
cost offload scan: 0.08559226989746094
offload 1 adapters, 17 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5712509155273438 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 16 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5733966827392578 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 17 in total
Function load_lora_A took 1.2395381927490234 ms to run.
Function load_lora_B took 1.2001991271972656 ms to run.
cost realload: 2.839326858520508
Function load_adapters took 2.8603076934814453 ms to run.
cost offload scan: 0.08273124694824219
INFO:     127.0.0.1:57570 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57586 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57592 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57600 - "POST /generate_stream HTTP/1.1" 200 OK
