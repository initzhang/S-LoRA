For some LLaMA-based models, initializing the fast tokenizer may take a long time. To eliminate the initialization time, consider using 'hf-internal-testing/llama-tokenizer' instead of the original tokenizer.
llama-7b: 12.06 GB
peak working mem for (bs=20, seqlen=512): 0.70 GB
peak working mem for (bs=100, seqlen=512): 3.52 GB
all adapters (101) estimated size: 25.25 GB
avg adapter estimated size: 256.00 MB
INFO:     127.0.0.1:33130 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33138 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33154 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33162 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33172 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33188 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33192 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33196 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33210 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33218 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33224 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33232 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33236 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58908 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58918 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58934 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58948 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58954 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58970 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58972 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58978 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58994 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58996 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59012 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59028 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59030 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59038 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59042 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59044 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59054 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59056 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59068 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59082 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59094 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59098 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59102 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59114 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59118 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59122 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59134 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59136 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59152 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59164 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59168 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59184 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59192 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59202 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59212 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59214 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59222 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59230 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59234 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59244 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59258 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59274 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59276 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59292 - "POST /generate_stream HTTP/1.1" 200 OK
cost load scan: 0.010728836059570312
load 2 adapters, 2 in total
Function load_lora_A took 11.761903762817383 ms to run.
Function load_lora_B took 11.635303497314453 ms to run.
Function load_lora_A took 11.739730834960938 ms to run.
Function load_lora_B took 11.617422103881836 ms to run.
cost realload: 54.355621337890625
Function load_adapters took 54.388999938964844 ms to run.
Avg tokens(prompt+generate) throughput:    6.711 tokens/s
Avg prompt tokens throughput:              6.711 tokens/s
Avg generate tokens throughput:            0.000 tokens/s
cost load scan: 0.04649162292480469
load 13 adapters, 15 in total
Function load_lora_A took 11.592626571655273 ms to run.
Function load_lora_B took 11.50202751159668 ms to run.
Function load_lora_A took 11.6729736328125 ms to run.
Function load_lora_B took 11.572837829589844 ms to run.
Function load_lora_A took 11.723756790161133 ms to run.
Function load_lora_B took 11.605024337768555 ms to run.
Function load_lora_A took 11.590242385864258 ms to run.
Function load_lora_B took 11.499881744384766 ms to run.
Function load_lora_A took 11.765241622924805 ms to run.
Function load_lora_B took 11.636018753051758 ms to run.
Function load_lora_A took 11.740922927856445 ms to run.
Function load_lora_B took 11.593341827392578 ms to run.
Function load_lora_A took 11.618375778198242 ms to run.
Function load_lora_B took 11.526823043823242 ms to run.
Function load_lora_A took 11.629104614257812 ms to run.
Function load_lora_B took 11.55233383178711 ms to run.
Function load_lora_A took 11.664152145385742 ms to run.
Function load_lora_B took 11.566877365112305 ms to run.
Function load_lora_A took 11.663436889648438 ms to run.
Function load_lora_B took 11.547088623046875 ms to run.
Function load_lora_A took 11.606216430664062 ms to run.
Function load_lora_B took 11.517763137817383 ms to run.
Function load_lora_A took 11.65914535522461 ms to run.
Function load_lora_B took 11.541366577148438 ms to run.
Function load_lora_A took 11.631250381469727 ms to run.
Function load_lora_B took 11.569023132324219 ms to run.
cost realload: 303.8372993469238
Function load_adapters took 303.8651943206787 ms to run.
current batch size: 17 token used ratio: 0.06636923076923076
cost load scan: 0.028371810913085938
load 9 adapters, 24 in total
Function load_lora_A took 11.628389358520508 ms to run.
Function load_lora_B took 11.552572250366211 ms to run.
Function load_lora_A took 11.59811019897461 ms to run.
Function load_lora_B took 11.519193649291992 ms to run.
Function load_lora_A took 11.596202850341797 ms to run.
Function load_lora_B took 11.501312255859375 ms to run.
Function load_lora_A took 11.638879776000977 ms to run.
Function load_lora_B took 11.57832145690918 ms to run.
Function load_lora_A took 11.642694473266602 ms to run.
Function load_lora_B took 11.543750762939453 ms to run.
Function load_lora_A took 11.616230010986328 ms to run.
Function load_lora_B took 11.52348518371582 ms to run.
Function load_lora_A took 11.629819869995117 ms to run.
Function load_lora_B took 11.550664901733398 ms to run.
Function load_lora_A took 11.648416519165039 ms to run.
Function load_lora_B took 11.548280715942383 ms to run.
Function load_lora_A took 11.664152145385742 ms to run.
Function load_lora_B took 11.548042297363281 ms to run.
cost realload: 209.61427688598633
Function load_adapters took 209.6405029296875 ms to run.
cost load scan: 0.017404556274414062
load 4 adapters, 28 in total
Function load_lora_A took 11.618375778198242 ms to run.
Function load_lora_B took 11.527776718139648 ms to run.
Function load_lora_A took 11.569023132324219 ms to run.
Function load_lora_B took 11.464595794677734 ms to run.
Function load_lora_A took 11.625289916992188 ms to run.
Function load_lora_B took 11.562108993530273 ms to run.
Function load_lora_A took 11.546850204467773 ms to run.
Function load_lora_B took 11.451005935668945 ms to run.
cost realload: 93.03665161132812
Function load_adapters took 93.0633544921875 ms to run.
cost load scan: 0.019550323486328125
load 3 adapters, 31 in total
Function load_lora_A took 11.576414108276367 ms to run.
Function load_lora_B took 11.518001556396484 ms to run.
Function load_lora_A took 11.640787124633789 ms to run.
Function load_lora_B took 11.544227600097656 ms to run.
Function load_lora_A took 11.646032333374023 ms to run.
Function load_lora_B took 11.54470443725586 ms to run.
cost realload: 70.06430625915527
Function load_adapters took 70.08910179138184 ms to run.
cost load scan: 0.015020370483398438
load 2 adapters, 33 in total
Function load_lora_A took 11.63625717163086 ms to run.
Function load_lora_B took 11.575460433959961 ms to run.
Function load_lora_A took 11.644840240478516 ms to run.
Function load_lora_B took 11.51728630065918 ms to run.
cost realload: 46.90408706665039
Function load_adapters took 46.92721366882324 ms to run.
cost load scan: 0.019788742065429688
load 4 adapters, 37 in total
Function load_lora_A took 11.635780334472656 ms to run.
Function load_lora_B took 11.566400527954102 ms to run.
Function load_lora_A took 11.601924896240234 ms to run.
Function load_lora_B took 11.482715606689453 ms to run.
Function load_lora_A took 11.563301086425781 ms to run.
Function load_lora_B took 11.499404907226562 ms to run.
Function load_lora_A took 11.65318489074707 ms to run.
Function load_lora_B took 11.561870574951172 ms to run.
cost realload: 93.25408935546875
Function load_adapters took 93.2774543762207 ms to run.
current batch size: 44 token used ratio: 0.20155384615384617
cost load scan: 0.014543533325195312
load 1 adapters, 38 in total
Function load_lora_A took 11.651992797851562 ms to run.
Function load_lora_B took 11.537790298461914 ms to run.
cost realload: 23.62799644470215
Function load_adapters took 23.650407791137695 ms to run.
cost load scan: 0.013589859008789062
load 1 adapters, 39 in total
Function load_lora_A took 11.649608612060547 ms to run.
Function load_lora_B took 11.560678482055664 ms to run.
cost realload: 23.668289184570312
Function load_adapters took 23.690223693847656 ms to run.
cost load scan: 0.015974044799804688
load 1 adapters, 40 in total
Function load_lora_A took 11.643648147583008 ms to run.
Function load_lora_B took 11.553049087524414 ms to run.
cost realload: 23.637056350708008
Function load_adapters took 23.659944534301758 ms to run.
cost load scan: 0.016927719116210938
load 1 adapters, 41 in total
Function load_lora_A took 11.636495590209961 ms to run.
Function load_lora_B took 11.548042297363281 ms to run.
cost realload: 23.631811141967773
Function load_adapters took 23.65732192993164 ms to run.
offload 0 adapters, 41 remains
Function offload_adapters took 0.022411346435546875 ms to run.
current batch size: 50 token used ratio: 0.26492307692307693
cost load scan: 0.0171661376953125
load 2 adapters, 43 in total
Function load_lora_A took 11.635065078735352 ms to run.
Function load_lora_B took 11.537313461303711 ms to run.
Function load_lora_A took 11.630535125732422 ms to run.
Function load_lora_B took 11.535882949829102 ms to run.
cost realload: 46.86737060546875
Function load_adapters took 46.89192771911621 ms to run.
cost offload scan: 0.18835067749023438
offload 1 adapters, 42 remains
cost offload cat: 0.03981590270996094
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 11.990785598754883
Function offload_adapters took 12.609481811523438 ms to run.
cost load scan: 0.0152587890625
load 1 adapters, 43 in total
Function load_lora_A took 11.652708053588867 ms to run.
Function load_lora_B took 11.528730392456055 ms to run.
cost realload: 23.622751235961914
Function load_adapters took 23.645401000976562 ms to run.
offload 0 adapters, 43 remains
Function offload_adapters took 0.011920928955078125 ms to run.
offload 0 adapters, 43 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.014066696166992188
load 1 adapters, 44 in total
Function load_lora_A took 11.630773544311523 ms to run.
Function load_lora_B took 11.586666107177734 ms to run.
cost realload: 23.665428161621094
Function load_adapters took 23.688077926635742 ms to run.
INFO:     127.0.0.1:48858 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48860 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48868 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48872 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48876 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48882 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48892 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48900 - "POST /generate_stream HTTP/1.1" 200 OK
offload 0 adapters, 44 remains
Function offload_adapters took 0.03719329833984375 ms to run.
cost load scan: 0.014781951904296875
load 1 adapters, 45 in total
Function load_lora_A took 11.546611785888672 ms to run.
Function load_lora_B took 11.504888534545898 ms to run.
cost realload: 23.494482040405273
Function load_adapters took 23.517608642578125 ms to run.
offload 0 adapters, 45 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.16498565673828125
offload 1 adapters, 44 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.6966590881347656 ms to run.
offload 0 adapters, 44 remains
Function offload_adapters took 0.012636184692382812 ms to run.
offload 0 adapters, 44 remains
Function offload_adapters took 0.012636184692382812 ms to run.
current batch size: 48 token used ratio: 0.2788923076923077
cost load scan: 0.008344650268554688
load 0 adapters, 44 in total
cost realload: 0.32401084899902344
Function load_adapters took 0.3502368927001953 ms to run.
cost offload scan: 0.09822845458984375
offload 1 adapters, 43 remains
cost offload cat: 0.035762786865234375
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.12421607971191406
Function offload_adapters took 0.6372928619384766 ms to run.
cost offload scan: 0.16951560974121094
offload 1 adapters, 42 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11181831359863281
Function offload_adapters took 0.6890296936035156 ms to run.
cost offload scan: 0.1366138458251953
offload 2 adapters, 40 remains
cost offload cat: 0.026941299438476562
cost offload free mem manager: 0.047206878662109375
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.6570816040039062 ms to run.
cost offload scan: 0.13494491577148438
offload 2 adapters, 38 remains
cost offload cat: 0.026464462280273438
cost offload free mem manager: 0.0476837158203125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.6513595581054688 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 38 in total
cost realload: 0.3085136413574219
Function load_adapters took 0.3330707550048828 ms to run.
cost offload scan: 0.09560585021972656
offload 1 adapters, 37 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.11467933654785156
Function offload_adapters took 0.6322860717773438 ms to run.
cost offload scan: 0.0972747802734375
offload 1 adapters, 36 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.6208419799804688 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 35 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.6070137023925781 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 36 in total
Function load_lora_A took 11.634588241577148 ms to run.
Function load_lora_B took 11.545181274414062 ms to run.
cost realload: 23.601770401000977
Function load_adapters took 23.629426956176758 ms to run.
cost offload scan: 0.09512901306152344
offload 1 adapters, 35 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.1201629638671875
Function offload_adapters took 0.6260871887207031 ms to run.
cost load scan: 0.016927719116210938
load 1 adapters, 36 in total
Function load_lora_A took 11.61503791809082 ms to run.
Function load_lora_B took 11.549949645996094 ms to run.
cost realload: 23.596763610839844
Function load_adapters took 23.621797561645508 ms to run.
cost offload scan: 0.10323524475097656
offload 1 adapters, 35 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.6227493286132812 ms to run.
cost offload scan: 0.14638900756835938
offload 2 adapters, 33 remains
cost offload cat: 0.025510787963867188
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.6582736968994141 ms to run.
current batch size: 36 token used ratio: 0.22495384615384614
offload 0 adapters, 33 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost offload scan: 0.09417533874511719
offload 1 adapters, 32 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.1163482666015625
Function offload_adapters took 0.6248950958251953 ms to run.
offload 0 adapters, 32 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.09393692016601562
offload 1 adapters, 31 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.6272792816162109 ms to run.
Avg tokens(prompt+generate) throughput: 2486.208 tokens/s
Avg prompt tokens throughput:           1575.152 tokens/s
Avg generate tokens throughput:          911.056 tokens/s
cost load scan: 0.0152587890625
load 1 adapters, 32 in total
Function load_lora_A took 11.635065078735352 ms to run.
Function load_lora_B took 11.53874397277832 ms to run.
cost realload: 23.62799644470215
Function load_adapters took 23.650646209716797 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 31 remains
cost offload cat: 0.03504753112792969
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.6296634674072266 ms to run.
cost offload scan: 0.095367431640625
offload 1 adapters, 30 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.6167888641357422 ms to run.
cost offload scan: 0.1361370086669922
offload 2 adapters, 28 remains
cost offload cat: 0.0286102294921875
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.6573200225830078 ms to run.
cost offload scan: 0.09560585021972656
offload 1 adapters, 27 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11897087097167969
Function offload_adapters took 0.6186962127685547 ms to run.
cost load scan: 0.019073486328125
load 2 adapters, 29 in total
Function load_lora_A took 11.655807495117188 ms to run.
Function load_lora_B took 11.571168899536133 ms to run.
Function load_lora_A took 11.609077453613281 ms to run.
Function load_lora_B took 11.536598205566406 ms to run.
cost realload: 46.89812660217285
Function load_adapters took 46.921491622924805 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 28 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11467933654785156
INFO:     127.0.0.1:48914 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48918 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48922 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48930 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48942 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48944 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48946 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48962 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48964 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48974 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48978 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48990 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48992 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49006 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49020 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49026 - "POST /generate_stream HTTP/1.1" 200 OK
Function offload_adapters took 0.6194114685058594 ms to run.
current batch size: 29 token used ratio: 0.18833846153846154
cost offload scan: 0.09274482727050781
offload 1 adapters, 27 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.6046295166015625 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 28 in total
Function load_lora_A took 11.667728424072266 ms to run.
Function load_lora_B took 11.57069206237793 ms to run.
cost realload: 23.676395416259766
Function load_adapters took 23.699045181274414 ms to run.
cost offload scan: 0.09775161743164062
offload 1 adapters, 27 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.6136894226074219 ms to run.
cost offload scan: 0.09512901306152344
offload 1 adapters, 26 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11444091796875
Function offload_adapters took 0.6341934204101562 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 25 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.025987625122070312
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.6284713745117188 ms to run.
cost load scan: 0.012159347534179688
load 1 adapters, 26 in total
Function load_lora_A took 11.594057083129883 ms to run.
Function load_lora_B took 11.517763137817383 ms to run.
cost realload: 23.53835105895996
Function load_adapters took 23.56410026550293 ms to run.
cost offload scan: 0.09870529174804688
offload 1 adapters, 25 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.6253719329833984 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 26 in total
Function load_lora_A took 11.616706848144531 ms to run.
Function load_lora_B took 11.549949645996094 ms to run.
cost realload: 23.594141006469727
Function load_adapters took 23.618221282958984 ms to run.
offload 0 adapters, 26 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.09489059448242188
offload 1 adapters, 25 remains
cost offload cat: 0.03600120544433594
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.12254714965820312
Function offload_adapters took 0.6308555603027344 ms to run.
cost load scan: 0.018596649169921875
load 2 adapters, 27 in total
Function load_lora_A took 11.6424560546875 ms to run.
Function load_lora_B took 11.553049087524414 ms to run.
Function load_lora_A took 11.571645736694336 ms to run.
Function load_lora_B took 11.472940444946289 ms to run.
cost realload: 46.74887657165527
Function load_adapters took 46.76961898803711 ms to run.
cost offload scan: 0.09369850158691406
offload 1 adapters, 26 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.6246566772460938 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 25 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.6086826324462891 ms to run.
current batch size: 28 token used ratio: 0.1695846153846154
cost load scan: 0.00858306884765625
load 1 adapters, 26 in total
Function load_lora_A took 11.560201644897461 ms to run.
Function load_lora_B took 11.488199234008789 ms to run.
cost realload: 23.482561111450195
Function load_adapters took 23.505210876464844 ms to run.
cost offload scan: 0.09441375732421875
offload 1 adapters, 25 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11038780212402344
Function offload_adapters took 0.6072521209716797 ms to run.
offload 0 adapters, 25 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 24 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6210803985595703 ms to run.
cost offload scan: 0.09417533874511719
offload 1 adapters, 23 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.12040138244628906
Function offload_adapters took 0.6206035614013672 ms to run.
cost offload scan: 0.09751319885253906
offload 1 adapters, 22 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.6151199340820312 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 23 in total
Function load_lora_A took 11.64698600769043 ms to run.
Function load_lora_B took 11.564970016479492 ms to run.
cost realload: 23.62680435180664
Function load_adapters took 23.647308349609375 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 22 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.6120204925537109 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 21 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.6036758422851562 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 20 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.6051063537597656 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 21 in total
Function load_lora_A took 11.634349822998047 ms to run.
Function load_lora_B took 11.559724807739258 ms to run.
cost realload: 23.628711700439453
Function load_adapters took 23.6513614654541 ms to run.
cost load scan: 0.01430511474609375
load 1 adapters, 22 in total
Function load_lora_A took 11.634111404418945 ms to run.
Function load_lora_B took 11.553525924682617 ms to run.
cost realload: 23.616552352905273
Function load_adapters took 23.638486862182617 ms to run.
current batch size: 25 token used ratio: 0.14398461538461538
cost load scan: 0.00858306884765625
load 0 adapters, 22 in total
cost realload: 0.30922889709472656
Function load_adapters took 0.3342628479003906 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 21 remains
cost offload cat: 0.035762786865234375
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.6146430969238281 ms to run.
cost load scan: 0.015735626220703125
load 2 adapters, 23 in total
Function load_lora_A took 11.626958847045898 ms to run.
Function load_lora_B took 11.602401733398438 ms to run.
Function load_lora_A took 11.594295501708984 ms to run.
Function load_lora_B took 11.517047882080078 ms to run.
cost realload: 46.87905311584473
INFO:     127.0.0.1:49038 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49040 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49042 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49052 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49058 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49068 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58472 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58478 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58486 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58502 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58508 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58514 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58524 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58532 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58538 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_adapters took 46.90122604370117 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 22 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11181831359863281
Function offload_adapters took 0.6060600280761719 ms to run.
cost load scan: 0.0095367431640625
load 2 adapters, 24 in total
Function load_lora_A took 11.640787124633789 ms to run.
Function load_lora_B took 11.539220809936523 ms to run.
Function load_lora_A took 11.64388656616211 ms to run.
Function load_lora_B took 11.562824249267578 ms to run.
cost realload: 46.89192771911621
Function load_adapters took 46.91457748413086 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 23 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.1220703125
Function offload_adapters took 0.6196498870849609 ms to run.
offload 0 adapters, 23 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost offload scan: 0.091552734375
offload 1 adapters, 22 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.6144046783447266 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.012874603271484375 ms to run.
current batch size: 25 token used ratio: 0.13786153846153845
cost offload scan: 0.09369850158691406
offload 1 adapters, 21 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.6210803985595703 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 20 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.11444091796875
Function offload_adapters took 0.6163120269775391 ms to run.
cost offload scan: 0.09608268737792969
offload 1 adapters, 19 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11444091796875
Function offload_adapters took 0.6234645843505859 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 20 in total
Function load_lora_A took 11.558055877685547 ms to run.
Function load_lora_B took 11.513233184814453 ms to run.
cost realload: 23.50616455078125
Function load_adapters took 23.527860641479492 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 19 remains
cost offload cat: 0.03647804260253906
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.6060600280761719 ms to run.
current batch size: 22 token used ratio: 0.1337846153846154
cost load scan: 0.008821487426757812
load 1 adapters, 20 in total
Function load_lora_A took 11.627435684204102 ms to run.
Function load_lora_B took 11.55233383178711 ms to run.
cost realload: 23.607254028320312
Function load_adapters took 23.62966537475586 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 19 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.6058216094970703 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 19 in total
cost realload: 0.30612945556640625
Function load_adapters took 0.3311634063720703 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 19 in total
cost realload: 0.30112266540527344
Function load_adapters took 0.3256797790527344 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.016927719116210938
load 2 adapters, 21 in total
Function load_lora_A took 11.628866195678711 ms to run.
Function load_lora_B took 11.521577835083008 ms to run.
Function load_lora_A took 11.615991592407227 ms to run.
Function load_lora_B took 11.565685272216797 ms to run.
cost realload: 46.85044288635254
Function load_adapters took 46.872854232788086 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.013828277587890625 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 20 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11181831359863281
Function offload_adapters took 0.6103515625 ms to run.
cost load scan: 0.021219253540039062
load 1 adapters, 21 in total
Function load_lora_A took 11.636972427368164 ms to run.
Function load_lora_B took 11.521577835083008 ms to run.
cost realload: 23.59795570373535
Function load_adapters took 23.619890213012695 ms to run.
current batch size: 22 token used ratio: 0.1269846153846154
cost offload scan: 0.09202957153320312
offload 1 adapters, 20 remains
cost offload cat: 0.03647804260253906
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11539459228515625
Function offload_adapters took 0.6167888641357422 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 20 in total
cost realload: 0.2968311309814453
Function load_adapters took 0.3199577331542969 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 19 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.6055831909179688 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 18 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.0476837158203125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.6093978881835938 ms to run.
cost load scan: 0.014781951904296875
load 2 adapters, 20 in total
Function load_lora_A took 11.633872985839844 ms to run.
Function load_lora_B took 11.566400527954102 ms to run.
Function load_lora_A took 11.583328247070312 ms to run.
Function load_lora_B took 11.545658111572266 ms to run.
cost realload: 46.83685302734375
Function load_adapters took 46.85807228088379 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 19 remains
cost offload cat: 0.03504753112792969
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.12254714965820312
Function offload_adapters took 0.6184577941894531 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 18 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.6120204925537109 ms to run.
cost load scan: 0.0152587890625
load 2 adapters, 20 in total
Function load_lora_A took 11.627912521362305 ms to run.
Function load_lora_B took 11.526823043823242 ms to run.
Function load_lora_A took 11.610984802246094 ms to run.
Function load_lora_B took 11.541128158569336 ms to run.
cost realload: 46.79536819458008
Function load_adapters took 46.81682586669922 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 19 remains
cost offload cat: 0.03552436828613281
cost offload free mem manager: INFO:     127.0.0.1:58554 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58558 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58568 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58574 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58578 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58594 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58596 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58600 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58610 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58622 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58630 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58642 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58652 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58664 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58680 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58692 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58706 - "POST /generate_stream HTTP/1.1" 200 OK
0.04696846008300781
cost offload torch.empty: 0.0247955322265625
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.6406307220458984 ms to run.
cost load scan: 0.015735626220703125
load 2 adapters, 21 in total
Function load_lora_A took 11.625528335571289 ms to run.
Function load_lora_B took 11.536598205566406 ms to run.
Function load_lora_A took 11.623859405517578 ms to run.
Function load_lora_B took 11.548042297363281 ms to run.
cost realload: 46.85258865356445
Function load_adapters took 46.8745231628418 ms to run.
current batch size: 23 token used ratio: 0.12595384615384617
offload 0 adapters, 21 remains
Function offload_adapters took 0.012874603271484375 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 22 in total
Function load_lora_A took 11.555910110473633 ms to run.
Function load_lora_B took 11.49129867553711 ms to run.
cost realload: 23.47111701965332
Function load_adapters took 23.49376678466797 ms to run.
Avg tokens(prompt+generate) throughput: 1730.463 tokens/s
Avg prompt tokens throughput:            955.392 tokens/s
Avg generate tokens throughput:          775.071 tokens/s
cost offload scan: 0.09322166442871094
offload 1 adapters, 21 remains
cost offload cat: 0.0362396240234375
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11587142944335938
Function offload_adapters took 0.6184577941894531 ms to run.
cost load scan: 0.014543533325195312
load 1 adapters, 22 in total
Function load_lora_A took 11.550426483154297 ms to run.
Function load_lora_B took 11.483430862426758 ms to run.
cost realload: 23.479938507080078
Function load_adapters took 23.501157760620117 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 23 in total
Function load_lora_A took 11.558055877685547 ms to run.
Function load_lora_B took 11.483430862426758 ms to run.
cost realload: 23.468494415283203
Function load_adapters took 23.490428924560547 ms to run.
cost offload scan: 0.09679794311523438
offload 1 adapters, 22 remains
cost offload cat: 0.04363059997558594
cost offload free mem manager: 0.049114227294921875
cost offload torch.empty: 0.024318695068359375
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.6384849548339844 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 21 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.0247955322265625
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.6222724914550781 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 22 in total
Function load_lora_A took 11.642694473266602 ms to run.
Function load_lora_B took 11.543512344360352 ms to run.
cost realload: 23.633956909179688
Function load_adapters took 23.656129837036133 ms to run.
current batch size: 24 token used ratio: 0.12964615384615386
cost offload scan: 0.09584426879882812
offload 1 adapters, 21 remains
cost offload cat: 0.04172325134277344
cost offload free mem manager: 0.04935264587402344
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.6392002105712891 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 20 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.6139278411865234 ms to run.
cost load scan: 0.015735626220703125
load 3 adapters, 23 in total
Function load_lora_A took 11.637449264526367 ms to run.
Function load_lora_B took 11.525869369506836 ms to run.
Function load_lora_A took 11.628389358520508 ms to run.
Function load_lora_B took 11.568307876586914 ms to run.
Function load_lora_A took 11.618614196777344 ms to run.
Function load_lora_B took 11.542320251464844 ms to run.
cost realload: 70.08075714111328
Function load_adapters took 70.10269165039062 ms to run.
cost offload scan: 0.09751319885253906
offload 1 adapters, 22 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.6184577941894531 ms to run.
cost offload scan: 0.09989738464355469
offload 1 adapters, 21 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.6265640258789062 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 20 remains
cost offload cat: 0.03743171691894531
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.11467933654785156
Function offload_adapters took 0.6244182586669922 ms to run.
cost load scan: 0.013828277587890625
load 1 adapters, 21 in total
Function load_lora_A took 11.637210845947266 ms to run.
Function load_lora_B took 11.565446853637695 ms to run.
cost realload: 23.645877838134766
Function load_adapters took 23.667573928833008 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 20 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6029605865478516 ms to run.
cost load scan: 0.014066696166992188
load 1 adapters, 21 in total
Function load_lora_A took 11.610746383666992 ms to run.
Function load_lora_B took 11.55710220336914 ms to run.
cost realload: 23.611068725585938
Function load_adapters took 23.633480072021484 ms to run.
current batch size: 23 token used ratio: 0.1261076923076923
cost load scan: 0.008344650268554688
load 1 adapters, 22 in total
Function load_lora_A took 11.574983596801758 ms to run.
Function load_lora_B took 11.481285095214844 ms to run.
cost realload: 23.477554321289062
Function load_adapters took 23.49996566772461 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 21 remains
cost offload cat: 0.04172325134277344
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11682510375976562
Function offload_adapters took 0.6322860717773438 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 20 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.12063980102539062
Function offload_adapters took 0.6148815155029297 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 19 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.5965232849121094 ms to run.
current batch size: 21 token used ratio: 0.12564615384615385
cost load scan: 0.008821487426757812
load 1 adapters, 20 in total
Function load_lora_A took 11.61646842956543 ms to run.
Function load_lora_B took 11.53707504272461 ms to run.
cost realload: 23.59771728515625
Function load_adapters took 23.6203670501709 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 19 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.12063980102539062
Function offload_adapters took 0.6158351898193359 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 20 in total
Function load_lora_A took 11.637449264526367 ms to run.
Function load_lora_B took 11.54947280883789 ms to run.
cost realload: 23.620128631591797
Function load_adapters took 23.642539978027344 ms to run.
cost load scan: 0.009059906005859375
INFO:     127.0.0.1:58718 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58724 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58734 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58748 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58764 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58766 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58776 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58780 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53002 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53012 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53014 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53018 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53022 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53032 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53038 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53042 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53046 - "POST /generate_stream HTTP/1.1" 200 OK
load 1 adapters, 21 in total
Function load_lora_A took 11.623859405517578 ms to run.
Function load_lora_B took 11.538505554199219 ms to run.
cost realload: 23.622989654541016
Function load_adapters took 23.645877838134766 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 20 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.05459785461425781
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.6244182586669922 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 21 in total
Function load_lora_A took 11.644363403320312 ms to run.
Function load_lora_B took 11.551141738891602 ms to run.
cost realload: 23.63109588623047
Function load_adapters took 23.653507232666016 ms to run.
cost offload scan: 0.1354217529296875
offload 2 adapters, 19 remains
cost offload cat: 0.026702880859375
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.6418228149414062 ms to run.
cost offload scan: 0.09441375732421875
offload 1 adapters, 18 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.6067752838134766 ms to run.
cost load scan: 0.0073909759521484375
load 0 adapters, 18 in total
cost realload: 0.3151893615722656
Function load_adapters took 0.34046173095703125 ms to run.
current batch size: 20 token used ratio: 0.12193846153846154
cost offload scan: 0.08821487426757812
offload 1 adapters, 17 remains
cost offload cat: 0.03695487976074219
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11563301086425781
Function offload_adapters took 0.6206035614013672 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 18 in total
Function load_lora_A took 11.626482009887695 ms to run.
Function load_lora_B took 11.554718017578125 ms to run.
cost realload: 23.60224723815918
Function load_adapters took 23.62346649169922 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 18 in total
cost realload: 0.2982616424560547
Function load_adapters took 0.3247261047363281 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 17 remains
cost offload cat: 0.037670135498046875
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.6132125854492188 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 16 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11968612670898438
Function offload_adapters took 0.6070137023925781 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 17 in total
Function load_lora_A took 11.597394943237305 ms to run.
Function load_lora_B took 11.50822639465332 ms to run.
cost realload: 23.535490036010742
Function load_adapters took 23.557662963867188 ms to run.
offload 0 adapters, 17 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 16 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.6074905395507812 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 15 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.60272216796875 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 16 in total
Function load_lora_A took 11.63792610168457 ms to run.
Function load_lora_B took 11.572599411010742 ms to run.
cost realload: 23.65422248840332
Function load_adapters took 23.67687225341797 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 15 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5984306335449219 ms to run.
current batch size: 17 token used ratio: 0.10090769230769231
cost load scan: 0.009059906005859375
load 1 adapters, 16 in total
Function load_lora_A took 11.635303497314453 ms to run.
Function load_lora_B took 11.539697647094727 ms to run.
cost realload: 23.616790771484375
Function load_adapters took 23.645401000976562 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 15 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.6113052368164062 ms to run.
cost offload scan: 0.095367431640625
offload 1 adapters, 14 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.6010532379150391 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 14 in total
cost realload: 0.308990478515625
Function load_adapters took 0.33354759216308594 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 13 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04696846008300781
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5984306335449219 ms to run.
offload 0 adapters, 13 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 13 in total
cost realload: 0.30803680419921875
Function load_adapters took 0.3333091735839844 ms to run.
cost offload scan: 0.09751319885253906
offload 1 adapters, 12 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.6041526794433594 ms to run.
cost load scan: 0.0095367431640625
load 3 adapters, 15 in total
Function load_lora_A took 11.606454849243164 ms to run.
Function load_lora_B took 11.536598205566406 ms to run.
Function load_lora_A took 11.63029670715332 ms to run.
Function load_lora_B took 11.556863784790039 ms to run.
Function load_lora_A took 11.59358024597168 ms to run.
Function load_lora_B took 11.484146118164062 ms to run.
cost realload: 69.96512413024902
Function load_adapters took 69.98658180236816 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 14 remains
cost offload cat: 0.03719329833984375
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11038780212402344
Function offload_adapters took 0.6113052368164062 ms to run.
current batch size: 19 token used ratio: 0.09826153846153846
cost load scan: 0.00858306884765625
load 1 adapters, 15 in total
Function load_lora_A took 11.634349822998047 ms to run.
Function load_lora_B took 11.551856994628906 ms to run.
cost realload: 23.64063262939453
Function load_adapters took 23.66328239440918 ms to run.
cost offload scan: 0.09441375732421875
offload 1 adapters, 14 remains
cost offload cat: 0.035762786865234375
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.6134510040283203 ms to run.
cost load scan: 0.009298324584960938
load 2 adapters, 16 in total
INFO:     127.0.0.1:53054 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53070 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53072 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53076 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53088 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53100 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53116 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53132 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53138 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53150 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53152 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53166 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53182 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53198 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53200 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53216 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53224 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53240 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53244 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53248 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53250 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53254 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53264 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53266 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53282 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53298 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53304 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 11.551380157470703 ms to run.
Function load_lora_B took 11.478662490844727 ms to run.
Function load_lora_A took 11.644840240478516 ms to run.
Function load_lora_B took 11.527538299560547 ms to run.
cost realload: 46.738386154174805
Function load_adapters took 46.75936698913574 ms to run.
offload 0 adapters, 16 remains
Function offload_adapters took 0.013589859008789062 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 17 in total
Function load_lora_A took 11.63172721862793 ms to run.
Function load_lora_B took 11.562824249267578 ms to run.
cost realload: 23.622989654541016
Function load_adapters took 23.646831512451172 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 16 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11610984802246094
Function offload_adapters took 0.6132125854492188 ms to run.
cost offload scan: 0.09441375732421875
offload 1 adapters, 15 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.6091594696044922 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 15 in total
cost realload: 0.31447410583496094
Function load_adapters took 0.33926963806152344 ms to run.
current batch size: 20 token used ratio: 0.10264615384615385
offload 0 adapters, 15 remains
Function offload_adapters took 0.012636184692382812 ms to run.
offload 0 adapters, 15 remains
Function offload_adapters took 0.0133514404296875 ms to run.
Avg tokens(prompt+generate) throughput: 1532.706 tokens/s
Avg prompt tokens throughput:            838.749 tokens/s
Avg generate tokens throughput:          693.958 tokens/s
cost load scan: 0.00858306884765625
load 0 adapters, 15 in total
cost realload: 0.31828880310058594
Function load_adapters took 0.34356117248535156 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 14 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11754035949707031
Function offload_adapters took 0.6182193756103516 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 15 in total
Function load_lora_A took 11.62862777709961 ms to run.
Function load_lora_B took 11.520147323608398 ms to run.
cost realload: 23.59628677368164
Function load_adapters took 23.61917495727539 ms to run.
offload 0 adapters, 15 remains
Function offload_adapters took 0.011920928955078125 ms to run.
current batch size: 18 token used ratio: 0.09353846153846154
cost load scan: 0.010013580322265625
load 2 adapters, 17 in total
Function load_lora_A took 11.628150939941406 ms to run.
Function load_lora_B took 11.565446853637695 ms to run.
Function load_lora_A took 11.63625717163086 ms to run.
Function load_lora_B took 11.566877365112305 ms to run.
cost realload: 46.89669609069824
Function load_adapters took 46.918630599975586 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 17 in total
cost realload: 0.3132820129394531
Function load_adapters took 0.33783912658691406 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 18 in total
Function load_lora_A took 11.642217636108398 ms to run.
Function load_lora_B took 11.555671691894531 ms to run.
cost realload: 23.6361026763916
Function load_adapters took 23.658037185668945 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 17 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11539459228515625
Function offload_adapters took 0.6155967712402344 ms to run.
offload 0 adapters, 17 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost load scan: 0.010251998901367188
load 2 adapters, 19 in total
Function load_lora_A took 11.622190475463867 ms to run.
Function load_lora_B took 11.526107788085938 ms to run.
Function load_lora_A took 11.63029670715332 ms to run.
Function load_lora_B took 11.57689094543457 ms to run.
cost realload: 46.865224838256836
Function load_adapters took 46.8900203704834 ms to run.
current batch size: 22 token used ratio: 0.11841538461538462
cost load scan: 0.009059906005859375
load 1 adapters, 20 in total
Function load_lora_A took 11.652469635009766 ms to run.
Function load_lora_B took 11.518001556396484 ms to run.
cost realload: 23.593664169311523
Function load_adapters took 23.615360260009766 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 19 remains
cost offload cat: 0.0362396240234375
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11968612670898438
Function offload_adapters took 0.6175041198730469 ms to run.
cost load scan: 0.0095367431640625
load 2 adapters, 21 in total
Function load_lora_A took 11.61956787109375 ms to run.
Function load_lora_B took 11.489391326904297 ms to run.
Function load_lora_A took 11.607646942138672 ms to run.
Function load_lora_B took 11.525869369506836 ms to run.
cost realload: 46.74816131591797
Function load_adapters took 46.770334243774414 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 20 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.6191730499267578 ms to run.
cost load scan: 0.01049041748046875
load 4 adapters, 24 in total
Function load_lora_A took 11.568546295166016 ms to run.
Function load_lora_B took 11.487245559692383 ms to run.
Function load_lora_A took 11.62266731262207 ms to run.
Function load_lora_B took 11.557817459106445 ms to run.
Function load_lora_A took 11.634111404418945 ms to run.
Function load_lora_B took 11.553287506103516 ms to run.
Function load_lora_A took 11.634111404418945 ms to run.
Function load_lora_B took 11.524200439453125 ms to run.
cost realload: 93.24908256530762
Function load_adapters took 93.27101707458496 ms to run.
cost load scan: 0.009775161743164062
load 3 adapters, 27 in total
Function load_lora_A took 11.562347412109375 ms to run.
Function load_lora_B took 11.458635330200195 ms to run.
Function load_lora_A took 11.619806289672852 ms to run.
Function load_lora_B took 11.550664901733398 ms to run.
Function load_lora_A took 11.627197265625 ms to run.
Function load_lora_B took 11.535406112670898 ms to run.
cost realload: 69.93770599365234
Function load_adapters took 69.95987892150879 ms to run.
current batch size: 30 token used ratio: 0.16796923076923076
cost load scan: 0.02002716064453125
load 5 adapters, 32 in total
Function load_lora_A took 11.656999588012695 ms to run.
Function load_lora_B took 11.552810668945312 ms to run.
Function load_lora_A took 11.633634567260742 ms to run.
Function load_lora_B took 11.551141738891602 ms to run.
Function load_lora_A took 11.625051498413086 ms to run.
Function load_lora_B took 11.534452438354492 ms to run.
Function load_lora_A took 11.593341827392578 ms to run.
Function load_lora_B took 11.498212814331055 ms to run.
Function load_lora_A took 11.624574661254883 ms to run.
Function load_lora_B took 11.568784713745117 ms to run.
cost realload: 116.57595634460449
Function load_adapters took 116.60170555114746 ms to run.
offload 0 adapters, 32 remains
Function offload_adapters took 0.019788742065429688 ms to run.
cost offload scan: 0.13899803161621094
offload 2 adapters, 30 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04696846008300781
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.12683868408203125
Function offload_adapters took 0.6880760192871094 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 31 in total
Function load_lora_A took 11.639118194580078 ms to run.
Function load_lora_B took 11.516571044921875 ms to run.
cost realload: INFO:     127.0.0.1:53310 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53316 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53330 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53338 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53348 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53360 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53364 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53378 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53394 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53406 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53422 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51778 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51790 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51796 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51798 - "POST /generate_stream HTTP/1.1" 200 OK
23.59175682067871
Function load_adapters took 23.657560348510742 ms to run.
offload 0 adapters, 31 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost offload scan: 0.1430511474609375
offload 2 adapters, 29 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04792213439941406
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11515617370605469
Function offload_adapters took 0.67138671875 ms to run.
cost load scan: 0.012636184692382812
load 2 adapters, 31 in total
Function load_lora_A took 11.630773544311523 ms to run.
Function load_lora_B took 11.541366577148438 ms to run.
Function load_lora_A took 11.632680892944336 ms to run.
Function load_lora_B took 11.595964431762695 ms to run.
cost realload: 46.90122604370117
Function load_adapters took 46.92363739013672 ms to run.
offload 0 adapters, 31 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 31 in total
cost realload: 0.3237724304199219
Function load_adapters took 0.3490447998046875 ms to run.
cost offload scan: 0.09989738464355469
offload 1 adapters, 30 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.12087821960449219
Function offload_adapters took 0.6320476531982422 ms to run.
cost offload scan: 0.09870529174804688
offload 1 adapters, 29 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11205673217773438
Function offload_adapters took 0.6163120269775391 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 30 in total
Function load_lora_A took 11.632680892944336 ms to run.
Function load_lora_B took 11.538982391357422 ms to run.
cost realload: 23.609638214111328
Function load_adapters took 23.633956909179688 ms to run.
current batch size: 32 token used ratio: 0.17138461538461539
cost load scan: 0.009059906005859375
load 1 adapters, 31 in total
Function load_lora_A took 11.649131774902344 ms to run.
Function load_lora_B took 11.56759262084961 ms to run.
cost realload: 23.634672164916992
Function load_adapters took 23.656368255615234 ms to run.
cost offload scan: 0.10371208190917969
offload 1 adapters, 30 remains
cost offload cat: 0.03814697265625
cost offload free mem manager: 0.04696846008300781
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.1251697540283203
Function offload_adapters took 0.6544589996337891 ms to run.
cost load scan: 0.015020370483398438
load 1 adapters, 31 in total
Function load_lora_A took 11.658191680908203 ms to run.
Function load_lora_B took 11.555910110473633 ms to run.
cost realload: 23.642301559448242
Function load_adapters took 23.662805557250977 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 30 remains
cost offload cat: 0.0362396240234375
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6265640258789062 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 29 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.614166259765625 ms to run.
cost load scan: 0.014543533325195312
load 1 adapters, 30 in total
Function load_lora_A took 11.595964431762695 ms to run.
Function load_lora_B took 11.487722396850586 ms to run.
cost realload: 23.52452278137207
Function load_adapters took 23.54717254638672 ms to run.
cost offload scan: 0.13065338134765625
offload 2 adapters, 28 remains
cost offload cat: 0.026702880859375
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.12111663818359375
Function offload_adapters took 0.6518363952636719 ms to run.
cost load scan: 0.016450881958007812
load 1 adapters, 29 in total
Function load_lora_A took 11.651039123535156 ms to run.
Function load_lora_B took 11.574745178222656 ms to run.
cost realload: 23.66161346435547
Function load_adapters took 23.683786392211914 ms to run.
cost offload scan: 0.09989738464355469
offload 1 adapters, 28 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.1163482666015625
Function offload_adapters took 0.6394386291503906 ms to run.
current batch size: 31 token used ratio: 0.17944615384615384
cost offload scan: 0.1010894775390625
offload 1 adapters, 27 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.6182193756103516 ms to run.
cost offload scan: 0.12993812561035156
offload 2 adapters, 25 remains
cost offload cat: 0.028133392333984375
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.6413459777832031 ms to run.
cost load scan: 0.017642974853515625
load 2 adapters, 27 in total
Function load_lora_A took 11.579036712646484 ms to run.
Function load_lora_B took 11.488914489746094 ms to run.
Function load_lora_A took 11.598348617553711 ms to run.
Function load_lora_B took 11.5509033203125 ms to run.
cost realload: 46.73171043395996
Function load_adapters took 46.75459861755371 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 26 remains
cost offload cat: 0.03838539123535156
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.61798095703125 ms to run.
cost load scan: 0.01430511474609375
load 1 adapters, 27 in total
Function load_lora_A took 11.63792610168457 ms to run.
Function load_lora_B took 11.538505554199219 ms to run.
cost realload: 23.590803146362305
Function load_adapters took 23.612260818481445 ms to run.
cost offload scan: 0.1304149627685547
offload 2 adapters, 25 remains
cost offload cat: 0.026941299438476562
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.6504058837890625 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 24 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.6103515625 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 23 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.6089210510253906 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 22 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.6225109100341797 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 21 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.6000995635986328 ms to run.
current batch size: 24 token used ratio: 0.14076923076923076
cost load scan: 0.007867813110351562
load 0 adapters, 21 in total
cost realload: 0.32639503479003906
Function load_adapters took 0.3516674041748047 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 20 remains
INFO:     127.0.0.1:51806 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51810 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51816 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51818 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51820 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51826 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51834 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51848 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51854 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51860 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51868 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51882 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51890 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51896 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51908 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51914 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51918 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51930 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51946 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51950 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload cat: 0.0362396240234375
cost offload free mem manager: 0.049114227294921875
cost offload torch.empty: 0.024318695068359375
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.6394386291503906 ms to run.
cost load scan: 0.016689300537109375
load 1 adapters, 21 in total
Function load_lora_A took 11.57522201538086 ms to run.
Function load_lora_B took 11.470556259155273 ms to run.
cost realload: 23.478269577026367
Function load_adapters took 23.499488830566406 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 22 in total
Function load_lora_A took 11.611700057983398 ms to run.
Function load_lora_B took 11.543035507202148 ms to run.
cost realload: 23.58722686767578
Function load_adapters took 23.60987663269043 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.0133514404296875 ms to run.
cost load scan: 0.010013580322265625
load 2 adapters, 24 in total
Function load_lora_A took 11.649370193481445 ms to run.
Function load_lora_B took 11.517524719238281 ms to run.
Function load_lora_A took 11.612176895141602 ms to run.
Function load_lora_B took 11.533260345458984 ms to run.
cost realload: 46.82326316833496
Function load_adapters took 46.846628189086914 ms to run.
offload 0 adapters, 24 remains
Function offload_adapters took 0.0133514404296875 ms to run.
Avg tokens(prompt+generate) throughput: 1904.421 tokens/s
Avg prompt tokens throughput:           1117.074 tokens/s
Avg generate tokens throughput:          787.347 tokens/s
offload 0 adapters, 24 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost offload scan: 0.09608268737792969
offload 1 adapters, 23 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.6136894226074219 ms to run.
current batch size: 24 token used ratio: 0.1432153846153846
cost load scan: 0.017404556274414062
load 2 adapters, 25 in total
Function load_lora_A took 11.59214973449707 ms to run.
Function load_lora_B took 11.52181625366211 ms to run.
Function load_lora_A took 11.636972427368164 ms to run.
Function load_lora_B took 11.539459228515625 ms to run.
cost realload: 46.785831451416016
Function load_adapters took 46.807050704956055 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 24 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.6220340728759766 ms to run.
cost offload scan: 0.09560585021972656
offload 1 adapters, 23 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.052928924560546875
cost offload torch.empty: 0.030517578125
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.629425048828125 ms to run.
cost load scan: 0.014066696166992188
load 2 adapters, 25 in total
Function load_lora_A took 11.632680892944336 ms to run.
Function load_lora_B took 11.556148529052734 ms to run.
Function load_lora_A took 11.623859405517578 ms to run.
Function load_lora_B took 11.54470443725586 ms to run.
cost realload: 46.881914138793945
Function load_adapters took 46.9057559967041 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 26 in total
Function load_lora_A took 11.593103408813477 ms to run.
Function load_lora_B took 11.519670486450195 ms to run.
cost realload: 23.5445499420166
Function load_adapters took 23.56719970703125 ms to run.
cost offload scan: 0.09417533874511719
offload 1 adapters, 25 remains
cost offload cat: 0.03695487976074219
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11610984802246094
Function offload_adapters took 0.6198883056640625 ms to run.
cost load scan: 0.0171661376953125
load 4 adapters, 29 in total
Function load_lora_A took 11.633634567260742 ms to run.
Function load_lora_B took 11.548280715942383 ms to run.
Function load_lora_A took 11.636734008789062 ms to run.
Function load_lora_B took 11.551618576049805 ms to run.
Function load_lora_A took 11.648893356323242 ms to run.
Function load_lora_B took 11.507272720336914 ms to run.
Function load_lora_A took 11.608362197875977 ms to run.
Function load_lora_B took 11.515617370605469 ms to run.
cost realload: 93.29605102539062
Function load_adapters took 93.32132339477539 ms to run.
cost offload scan: 0.13375282287597656
offload 2 adapters, 27 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.118255615234375
Function offload_adapters took 0.6687641143798828 ms to run.
current batch size: 28 token used ratio: 0.16672307692307692
cost load scan: 0.00858306884765625
load 1 adapters, 28 in total
Function load_lora_A took 11.61956787109375 ms to run.
Function load_lora_B took 11.527299880981445 ms to run.
cost realload: 23.602008819580078
Function load_adapters took 23.627281188964844 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 27 remains
cost offload cat: 0.03600120544433594
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.6096363067626953 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 28 in total
Function load_lora_A took 11.660099029541016 ms to run.
Function load_lora_B took 11.530876159667969 ms to run.
cost realload: 23.619413375854492
Function load_adapters took 23.64182472229004 ms to run.
cost load scan: 0.018358230590820312
load 2 adapters, 30 in total
Function load_lora_A took 11.656522750854492 ms to run.
Function load_lora_B took 11.52181625366211 ms to run.
Function load_lora_A took 11.657953262329102 ms to run.
Function load_lora_B took 11.535882949829102 ms to run.
cost realload: 46.89645767211914
Function load_adapters took 46.918392181396484 ms to run.
cost offload scan: 0.1323223114013672
offload 2 adapters, 28 remains
cost offload cat: 0.027179718017578125
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11682510375976562
Function offload_adapters took 0.6644725799560547 ms to run.
cost offload scan: 0.09751319885253906
offload 1 adapters, 27 remains
cost offload cat: 0.0362396240234375
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6327629089355469 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 28 in total
Function load_lora_A took 11.636734008789062 ms to run.
Function load_lora_B took 11.544227600097656 ms to run.
cost realload: 23.59771728515625
Function load_adapters took 23.619413375854492 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 29 in total
Function load_lora_A took 11.614561080932617 ms to run.
Function load_lora_B took 11.549711227416992 ms to run.
cost realload: 23.585081100463867
Function load_adapters took 23.61154556274414 ms to run.
current batch size: 30 token used ratio: 0.17786153846153846
cost offload scan: 0.09369850158691406
offload 1 adapters, 28 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.051975250244140625
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11730194091796875
Function offload_adapters took 0.6279945373535156 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 29 in total
Function load_lora_A took 11.563539505004883 ms to run.
Function load_lora_B took 11.472702026367188 ms to run.
cost realload: 23.47087860107422
Function load_adapters took 23.492813110351562 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 28 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.04696846008300781
cost offload torch.empty: 0.023365020751953125
INFO:     127.0.0.1:51958 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51964 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51976 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51978 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51986 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51994 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52000 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52008 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42312 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42314 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42318 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42332 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42334 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload a_loc update: 0.125885009765625
Function offload_adapters took 0.6537437438964844 ms to run.
offload 0 adapters, 28 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.010013580322265625
load 2 adapters, 30 in total
Function load_lora_A took 11.652231216430664 ms to run.
Function load_lora_B took 11.531591415405273 ms to run.
Function load_lora_A took 11.63625717163086 ms to run.
Function load_lora_B took 11.557817459106445 ms to run.
cost realload: 46.88405990600586
Function load_adapters took 46.90718650817871 ms to run.
cost offload scan: 0.10251998901367188
offload 1 adapters, 29 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04839897155761719
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11444091796875
Function offload_adapters took 0.6260871887207031 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 28 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.6163120269775391 ms to run.
cost offload scan: 0.09822845458984375
offload 1 adapters, 27 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11610984802246094
Function offload_adapters took 0.6322860717773438 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 28 in total
Function load_lora_A took 11.640071868896484 ms to run.
Function load_lora_B took 11.55400276184082 ms to run.
cost realload: 23.622751235961914
Function load_adapters took 23.64492416381836 ms to run.
cost offload scan: 0.09989738464355469
offload 1 adapters, 27 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.6239414215087891 ms to run.
offload 0 adapters, 27 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 26 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11801719665527344
Function offload_adapters took 0.6136894226074219 ms to run.
cost offload scan: 0.09775161743164062
offload 1 adapters, 25 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6122589111328125 ms to run.
current batch size: 25 token used ratio: 0.14384615384615385
cost offload scan: 0.09107589721679688
offload 1 adapters, 24 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11563301086425781
Function offload_adapters took 0.6120204925537109 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 23 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11205673217773438
Function offload_adapters took 0.6148815155029297 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 24 in total
Function load_lora_A took 11.631965637207031 ms to run.
Function load_lora_B took 11.533260345458984 ms to run.
cost realload: 23.60248565673828
Function load_adapters took 23.624897003173828 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 23 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6120204925537109 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 23 in total
cost realload: 0.3032684326171875
Function load_adapters took 0.32806396484375 ms to run.
cost offload scan: 0.10514259338378906
offload 1 adapters, 22 remains
cost offload cat: 0.0362396240234375
cost offload free mem manager: 0.051021575927734375
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.12683868408203125
Function offload_adapters took 0.6570816040039062 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 21 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.05340576171875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.6129741668701172 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 20 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.118255615234375
Function offload_adapters took 0.6177425384521484 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 21 in total
Function load_lora_A took 11.63792610168457 ms to run.
Function load_lora_B took 11.574983596801758 ms to run.
cost realload: 23.7276554107666
Function load_adapters took 23.75626564025879 ms to run.
current batch size: 23 token used ratio: 0.1364
cost offload scan: 0.09918212890625
offload 1 adapters, 20 remains
cost offload cat: 0.03838539123535156
cost offload free mem manager: 0.04887580871582031
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11968612670898438
Function offload_adapters took 0.6511211395263672 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 21 in total
Function load_lora_A took 11.66391372680664 ms to run.
Function load_lora_B took 11.548280715942383 ms to run.
cost realload: 23.667097091674805
Function load_adapters took 23.690462112426758 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 20 remains
cost offload cat: 0.03695487976074219
cost offload free mem manager: 0.04792213439941406
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.1251697540283203
Function offload_adapters took 0.6372928619384766 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.09417533874511719
offload 1 adapters, 19 remains
cost offload cat: 0.035762786865234375
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.6306171417236328 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 20 in total
Function load_lora_A took 11.621475219726562 ms to run.
Function load_lora_B took 11.530399322509766 ms to run.
cost realload: 23.617029190063477
Function load_adapters took 23.639917373657227 ms to run.
current batch size: 21 token used ratio: 0.1309076923076923
cost offload scan: 0.09465217590332031
offload 1 adapters, 19 remains
cost offload cat: 0.035762786865234375
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.12111663818359375
Function offload_adapters took 0.6246566772460938 ms to run.
cost load scan: 0.01239776611328125
load 1 adapters, 20 in total
Function load_lora_A took 11.566877365112305 ms to run.
Function load_lora_B took 11.48080825805664 ms to run.
cost realload: 23.48494529724121
Function load_adapters took 23.507118225097656 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 19 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.6206035614013672 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 20 in total
Function load_lora_A took 11.636734008789062 ms to run.
INFO:     127.0.0.1:42346 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42358 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42362 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42368 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42378 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42386 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42400 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42410 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42422 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42426 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42440 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42448 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42450 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42452 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42460 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42468 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42480 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42486 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42498 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42508 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42510 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42526 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42528 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_B took 11.517047882080078 ms to run.
cost realload: 23.621082305908203
Function load_adapters took 23.643970489501953 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 19 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.051975250244140625
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.6146430969238281 ms to run.
cost load scan: 0.014781951904296875
load 2 adapters, 21 in total
Function load_lora_A took 11.564970016479492 ms to run.
Function load_lora_B took 11.47603988647461 ms to run.
Function load_lora_A took 11.619329452514648 ms to run.
Function load_lora_B took 11.56473159790039 ms to run.
cost realload: 46.74029350280762
Function load_adapters took 46.76318168640137 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 20 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.6084442138671875 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 21 in total
Function load_lora_A took 11.571407318115234 ms to run.
Function load_lora_B took 11.489152908325195 ms to run.
cost realload: 23.497581481933594
Function load_adapters took 23.520469665527344 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 20 remains
cost offload cat: 0.041961669921875
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.6158351898193359 ms to run.
current batch size: 22 token used ratio: 0.1318153846153846
cost offload scan: 0.08869171142578125
offload 1 adapters, 19 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.6005764007568359 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 20 in total
Function load_lora_A took 11.633634567260742 ms to run.
Function load_lora_B took 11.530160903930664 ms to run.
cost realload: 23.595571517944336
Function load_adapters took 23.617982864379883 ms to run.
cost load scan: 0.00858306884765625
load 0 adapters, 20 in total
cost realload: 0.3261566162109375
Function load_adapters took 0.35381317138671875 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 19 remains
cost offload cat: 0.03600120544433594
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11563301086425781
Function offload_adapters took 0.6139278411865234 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 18 remains
cost offload cat: 0.03719329833984375
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11682510375976562
Function offload_adapters took 0.6203651428222656 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 18 in total
cost realload: 0.316619873046875
Function load_adapters took 0.34356117248535156 ms to run.
Avg tokens(prompt+generate) throughput: 1696.027 tokens/s
Avg prompt tokens throughput:            921.784 tokens/s
Avg generate tokens throughput:          774.243 tokens/s
cost load scan: 0.013113021850585938
load 2 adapters, 20 in total
Function load_lora_A took 11.629581451416016 ms to run.
Function load_lora_B took 11.576652526855469 ms to run.
Function load_lora_A took 11.635541915893555 ms to run.
Function load_lora_B took 11.528491973876953 ms to run.
cost realload: 46.875715255737305
Function load_adapters took 46.89812660217285 ms to run.
cost load scan: 0.019073486328125
load 5 adapters, 25 in total
Function load_lora_A took 11.656522750854492 ms to run.
Function load_lora_B took 11.556148529052734 ms to run.
Function load_lora_A took 11.61646842956543 ms to run.
Function load_lora_B took 11.537551879882812 ms to run.
Function load_lora_A took 11.62099838256836 ms to run.
Function load_lora_B took 11.512279510498047 ms to run.
Function load_lora_A took 11.605978012084961 ms to run.
Function load_lora_B took 11.554956436157227 ms to run.
Function load_lora_A took 11.619806289672852 ms to run.
Function load_lora_B took 11.562108993530273 ms to run.
cost realload: 116.59431457519531
Function load_adapters took 116.61815643310547 ms to run.
offload 0 adapters, 25 remains
Function offload_adapters took 0.01239776611328125 ms to run.
current batch size: 28 token used ratio: 0.1642
cost offload scan: 0.09441375732421875
offload 1 adapters, 24 remains
cost offload cat: 0.043392181396484375
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11539459228515625
Function offload_adapters took 0.6420612335205078 ms to run.
cost load scan: 0.014543533325195312
load 2 adapters, 26 in total
Function load_lora_A took 11.664628982543945 ms to run.
Function load_lora_B took 11.551141738891602 ms to run.
Function load_lora_A took 11.630535125732422 ms to run.
Function load_lora_B took 11.557817459106445 ms to run.
cost realload: 46.91362380981445
Function load_adapters took 46.941518783569336 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 25 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1201629638671875
Function offload_adapters took 0.6122589111328125 ms to run.
cost load scan: 0.009775161743164062
load 1 adapters, 26 in total
Function load_lora_A took 11.642932891845703 ms to run.
Function load_lora_B took 11.528253555297852 ms to run.
cost realload: 23.61011505126953
Function load_adapters took 23.63300323486328 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 25 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.6117820739746094 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 24 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11205673217773438
Function offload_adapters took 0.6074905395507812 ms to run.
cost load scan: 0.00858306884765625
load 0 adapters, 24 in total
cost realload: 0.3211498260498047
Function load_adapters took 0.347137451171875 ms to run.
current batch size: 30 token used ratio: 0.1724153846153846
cost offload scan: 0.09131431579589844
offload 1 adapters, 23 remains
cost offload cat: 0.03719329833984375
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11730194091796875
Function offload_adapters took 0.621795654296875 ms to run.
offload 0 adapters, 23 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.016450881958007812
load 1 adapters, 24 in total
Function load_lora_A took 11.653661727905273 ms to run.
Function load_lora_B took 11.552810668945312 ms to run.
cost realload: 23.6661434173584
Function load_adapters took 23.689746856689453 ms to run.
offload 0 adapters, 24 remains
Function offload_adapters took 0.01239776611328125 ms to run.
offload 0 adapters, 24 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.015497207641601562
load 3 adapters, 27 in total
Function load_lora_A took 11.60740852355957 ms to run.
Function load_lora_B took 11.564254760742188 ms to run.
Function load_lora_A took 11.614084243774414 ms to run.
Function load_lora_B took 11.54184341430664 ms to run.
Function load_lora_A took 11.634111404418945 ms to run.
Function load_lora_B took 11.535882949829102 ms to run.
cost realload: 70.08624076843262
INFO:     127.0.0.1:42532 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42542 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42558 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42562 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42568 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42570 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42584 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42590 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42592 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42596 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42600 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42610 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42624 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42626 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57810 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_adapters took 70.10865211486816 ms to run.
cost offload scan: 0.09512901306152344
offload 1 adapters, 26 remains
cost offload cat: 0.035762786865234375
cost offload free mem manager: 0.051975250244140625
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11968612670898438
Function offload_adapters took 0.6389617919921875 ms to run.
cost load scan: 0.011682510375976562
load 2 adapters, 28 in total
Function load_lora_A took 11.640787124633789 ms to run.
Function load_lora_B took 11.550664901733398 ms to run.
Function load_lora_A took 11.642694473266602 ms to run.
Function load_lora_B took 11.547565460205078 ms to run.
cost realload: 46.89955711364746
Function load_adapters took 46.92220687866211 ms to run.
current batch size: 32 token used ratio: 0.18356923076923076
cost offload scan: 0.09369850158691406
offload 1 adapters, 27 remains
cost offload cat: 0.03719329833984375
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11849403381347656
Function offload_adapters took 0.637054443359375 ms to run.
cost load scan: 0.014781951904296875
load 3 adapters, 30 in total
Function load_lora_A took 11.664867401123047 ms to run.
Function load_lora_B took 11.564016342163086 ms to run.
Function load_lora_A took 11.631250381469727 ms to run.
Function load_lora_B took 11.56759262084961 ms to run.
Function load_lora_A took 11.627197265625 ms to run.
Function load_lora_B took 11.513948440551758 ms to run.
cost realload: 70.14679908752441
Function load_adapters took 70.16921043395996 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 29 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11563301086425781
Function offload_adapters took 0.6234645843505859 ms to run.
cost load scan: 0.0171661376953125
load 2 adapters, 31 in total
Function load_lora_A took 11.634588241577148 ms to run.
Function load_lora_B took 11.5203857421875 ms to run.
Function load_lora_A took 11.63339614868164 ms to run.
Function load_lora_B took 11.553525924682617 ms to run.
cost realload: 46.86999320983887
Function load_adapters took 46.89335823059082 ms to run.
cost offload scan: 0.09751319885253906
offload 1 adapters, 30 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11610984802246094
Function offload_adapters took 0.6351470947265625 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 29 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11920928955078125
Function offload_adapters took 0.6256103515625 ms to run.
cost load scan: 0.015020370483398438
load 2 adapters, 31 in total
Function load_lora_A took 11.649608612060547 ms to run.
Function load_lora_B took 11.548757553100586 ms to run.
Function load_lora_A took 11.631250381469727 ms to run.
Function load_lora_B took 11.530637741088867 ms to run.
cost realload: 46.86927795410156
Function load_adapters took 46.8900203704834 ms to run.
offload 0 adapters, 31 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.09369850158691406
offload 1 adapters, 30 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.6182193756103516 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 29 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04696846008300781
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.6206035614013672 ms to run.
current batch size: 32 token used ratio: 0.18515384615384614
cost load scan: 0.013113021850585938
load 1 adapters, 30 in total
Function load_lora_A took 11.546611785888672 ms to run.
Function load_lora_B took 11.461973190307617 ms to run.
cost realload: 23.448467254638672
Function load_adapters took 23.47087860107422 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 29 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.12302398681640625
Function offload_adapters took 0.6227493286132812 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 28 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11706352233886719
Function offload_adapters took 0.6163120269775391 ms to run.
cost offload scan: 0.09894371032714844
offload 1 adapters, 27 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.11801719665527344
Function offload_adapters took 0.6308555603027344 ms to run.
cost load scan: 0.013589859008789062
load 1 adapters, 28 in total
Function load_lora_A took 11.61503791809082 ms to run.
Function load_lora_B took 11.531352996826172 ms to run.
cost realload: 23.584604263305664
Function load_adapters took 23.607730865478516 ms to run.
offload 0 adapters, 28 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.015735626220703125
load 2 adapters, 30 in total
Function load_lora_A took 11.625289916992188 ms to run.
Function load_lora_B took 11.564254760742188 ms to run.
Function load_lora_A took 11.730670928955078 ms to run.
Function load_lora_B took 11.57689094543457 ms to run.
cost realload: 47.01733589172363
Function load_adapters took 47.04093933105469 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 29 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1220703125
Function offload_adapters took 0.6196498870849609 ms to run.
cost offload scan: 0.09703636169433594
offload 1 adapters, 28 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11563301086425781
Function offload_adapters took 0.6284713745117188 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 27 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.6010532379150391 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 26 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.5996227264404297 ms to run.
current batch size: 29 token used ratio: 0.16463076923076922
cost load scan: 0.01430511474609375
load 1 adapters, 27 in total
Function load_lora_A took 11.636495590209961 ms to run.
Function load_lora_B took 11.546134948730469 ms to run.
cost realload: 23.624181747436523
Function load_adapters took 23.648977279663086 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 26 remains
cost offload cat: 0.0362396240234375
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.6160736083984375 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 25 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10991096496582031
INFO:     127.0.0.1:57824 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57830 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57844 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57850 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57860 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57864 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57876 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57888 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57904 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57908 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57914 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57924 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57926 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57928 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57944 - "POST /generate_stream HTTP/1.1" 200 OK
Function offload_adapters took 0.60272216796875 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 24 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11587142944335938
Function offload_adapters took 0.6206035614013672 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 25 in total
Function load_lora_A took 11.637210845947266 ms to run.
Function load_lora_B took 11.54780387878418 ms to run.
cost realload: 23.62799644470215
Function load_adapters took 23.650169372558594 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 24 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11610984802246094
Function offload_adapters took 0.6091594696044922 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 25 in total
Function load_lora_A took 11.54947280883789 ms to run.
Function load_lora_B took 11.472702026367188 ms to run.
cost realload: 23.45752716064453
Function load_adapters took 23.479700088500977 ms to run.
cost offload scan: 0.09918212890625
offload 1 adapters, 24 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11563301086425781
Function offload_adapters took 0.6215572357177734 ms to run.
cost offload scan: 0.13780593872070312
offload 2 adapters, 22 remains
cost offload cat: 0.028371810913085938
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11515617370605469
Function offload_adapters took 0.6613731384277344 ms to run.
cost offload scan: 0.09465217590332031
offload 1 adapters, 21 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.6058216094970703 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 22 in total
Function load_lora_A took 11.647701263427734 ms to run.
Function load_lora_B took 11.551380157470703 ms to run.
cost realload: 23.618698120117188
Function load_adapters took 23.641109466552734 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 21 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04696846008300781
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.12087821960449219
Function offload_adapters took 0.6155967712402344 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.01811981201171875 ms to run.
cost offload scan: 0.09584426879882812
offload 1 adapters, 20 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11992454528808594
Function offload_adapters took 0.6339550018310547 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 19 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.029325485229492188
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.6079673767089844 ms to run.
current batch size: 21 token used ratio: 0.11658461538461538
cost load scan: 0.01239776611328125
load 1 adapters, 20 in total
Function load_lora_A took 11.645078659057617 ms to run.
Function load_lora_B took 11.524677276611328 ms to run.
cost realload: 23.63300323486328
Function load_adapters took 23.658037185668945 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 19 remains
cost offload cat: 0.043392181396484375
cost offload free mem manager: 0.04696846008300781
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11730194091796875
Function offload_adapters took 0.6318092346191406 ms to run.
cost load scan: 0.014543533325195312
load 1 adapters, 20 in total
Function load_lora_A took 11.621713638305664 ms to run.
Function load_lora_B took 11.536598205566406 ms to run.
cost realload: 23.644447326660156
Function load_adapters took 23.667097091674805 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 20 in total
cost realload: 0.30732154846191406
Function load_adapters took 0.33283233642578125 ms to run.
current batch size: 23 token used ratio: 0.13455384615384616
cost offload scan: 0.095367431640625
offload 1 adapters, 19 remains
cost offload cat: 0.03743171691894531
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.12135505676269531
Function offload_adapters took 0.6265640258789062 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.012159347534179688 ms to run.
Avg tokens(prompt+generate) throughput: 1827.574 tokens/s
Avg prompt tokens throughput:            975.225 tokens/s
Avg generate tokens throughput:          852.348 tokens/s
cost load scan: 0.013113021850585938
load 1 adapters, 20 in total
Function load_lora_A took 11.64102554321289 ms to run.
Function load_lora_B took 11.544227600097656 ms to run.
cost realload: 23.641109466552734
Function load_adapters took 23.664236068725586 ms to run.
cost offload scan: 0.09393692016601562
offload 1 adapters, 19 remains
cost offload cat: 0.03743171691894531
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11849403381347656
Function offload_adapters took 0.6320476531982422 ms to run.
cost load scan: 0.0209808349609375
load 3 adapters, 22 in total
Function load_lora_A took 11.61813735961914 ms to run.
Function load_lora_B took 11.535167694091797 ms to run.
Function load_lora_A took 11.60573959350586 ms to run.
Function load_lora_B took 11.546134948730469 ms to run.
Function load_lora_A took 11.61646842956543 ms to run.
Function load_lora_B took 11.536121368408203 ms to run.
cost realload: 70.06239891052246
Function load_adapters took 70.08576393127441 ms to run.
cost load scan: 0.015735626220703125
load 3 adapters, 25 in total
Function load_lora_A took 11.624813079833984 ms to run.
Function load_lora_B took 11.536836624145508 ms to run.
Function load_lora_A took 11.623144149780273 ms to run.
Function load_lora_B took 11.550426483154297 ms to run.
Function load_lora_A took 11.655569076538086 ms to run.
Function load_lora_B took 11.53421401977539 ms to run.
cost realload: 70.12081146240234
Function load_adapters took 70.14346122741699 ms to run.
cost offload scan: 0.095367431640625
offload 1 adapters, 24 remains
cost offload cat: 0.03600120544433594
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11515617370605469
Function offload_adapters took 0.621795654296875 ms to run.
cost offload scan: 0.09369850158691406
offload 1 adapters, 23 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.6277561187744141 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 24 in total
Function load_lora_A took 11.656045913696289 ms to run.
Function load_lora_B took 11.538267135620117 ms to run.
cost realload: 23.624181747436523
Function load_adapters took 23.646831512451172 ms to run.
cost offload scan: 0.09489059448242188
offload 1 adapters, 23 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6148815155029297 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 22 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11229515075683594
INFO:     127.0.0.1:57960 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57962 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57968 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57978 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57982 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57998 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58004 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58018 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58032 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58048 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58056 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58060 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58066 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58074 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58076 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58078 - "POST /generate_stream HTTP/1.1" 200 OK
Function offload_adapters took 0.6124973297119141 ms to run.
current batch size: 24 token used ratio: 0.12530769230769231
cost offload scan: 0.09489059448242188
offload 1 adapters, 21 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.6074905395507812 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 22 in total
Function load_lora_A took 11.629581451416016 ms to run.
Function load_lora_B took 11.541128158569336 ms to run.
cost realload: 23.613691329956055
Function load_adapters took 23.63729476928711 ms to run.
cost offload scan: 0.09560585021972656
offload 1 adapters, 21 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.6122589111328125 ms to run.
cost load scan: 0.017404556274414062
load 2 adapters, 23 in total
Function load_lora_A took 11.636734008789062 ms to run.
Function load_lora_B took 11.530876159667969 ms to run.
Function load_lora_A took 11.55400276184082 ms to run.
Function load_lora_B took 11.495590209960938 ms to run.
cost realload: 46.72527313232422
Function load_adapters took 46.747684478759766 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 22 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.6077289581298828 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 21 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6120204925537109 ms to run.
cost load scan: 0.017642974853515625
load 2 adapters, 23 in total
Function load_lora_A took 11.633634567260742 ms to run.
Function load_lora_B took 11.551141738891602 ms to run.
Function load_lora_A took 11.579513549804688 ms to run.
Function load_lora_B took 11.494874954223633 ms to run.
cost realload: 46.78606986999512
Function load_adapters took 46.808481216430664 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 22 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.024318695068359375
cost offload a_loc update: 0.11920928955078125
Function offload_adapters took 0.6144046783447266 ms to run.
current batch size: 24 token used ratio: 0.12198461538461539
cost load scan: 0.010967254638671875
load 1 adapters, 23 in total
Function load_lora_A took 11.636495590209961 ms to run.
Function load_lora_B took 11.539697647094727 ms to run.
cost realload: 23.647069931030273
Function load_adapters took 23.67115020751953 ms to run.
cost load scan: 0.0133514404296875
load 2 adapters, 25 in total
Function load_lora_A took 11.632680892944336 ms to run.
Function load_lora_B took 11.540412902832031 ms to run.
Function load_lora_A took 11.619091033935547 ms to run.
Function load_lora_B took 11.577606201171875 ms to run.
cost realload: 46.89455032348633
Function load_adapters took 46.91767692565918 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 24 remains
cost offload cat: 0.04076957702636719
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.6268024444580078 ms to run.
cost offload scan: 0.091552734375
offload 1 adapters, 23 remains
cost offload cat: 0.03552436828613281
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11515617370605469
Function offload_adapters took 0.6186962127685547 ms to run.
cost offload scan: 0.13327598571777344
offload 2 adapters, 21 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.047206878662109375
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.1163482666015625
Function offload_adapters took 0.6754398345947266 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 20 remains
cost offload cat: 0.03552436828613281
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11706352233886719
Function offload_adapters took 0.6194114685058594 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 20 in total
cost realload: 0.32067298889160156
Function load_adapters took 0.3452301025390625 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 19 remains
cost offload cat: 0.03790855407714844
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.12302398681640625
Function offload_adapters took 0.6291866302490234 ms to run.
current batch size: 21 token used ratio: 0.10855384615384615
cost offload scan: 0.09012222290039062
offload 1 adapters, 18 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.12040138244628906
Function offload_adapters took 0.6139278411865234 ms to run.
cost load scan: 0.0152587890625
load 1 adapters, 19 in total
Function load_lora_A took 11.665821075439453 ms to run.
Function load_lora_B took 11.524438858032227 ms to run.
cost realload: 23.619413375854492
Function load_adapters took 23.640871047973633 ms to run.
cost load scan: 0.01430511474609375
load 1 adapters, 20 in total
Function load_lora_A took 11.643409729003906 ms to run.
Function load_lora_B took 11.536836624145508 ms to run.
cost realload: 23.631811141967773
Function load_adapters took 23.655176162719727 ms to run.
cost offload scan: 0.13709068298339844
offload 2 adapters, 18 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.05054473876953125
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11706352233886719
Function offload_adapters took 0.6804466247558594 ms to run.
cost load scan: 0.01430511474609375
load 2 adapters, 20 in total
Function load_lora_A took 11.625051498413086 ms to run.
Function load_lora_B took 11.550426483154297 ms to run.
Function load_lora_A took 11.626005172729492 ms to run.
Function load_lora_B took 11.525630950927734 ms to run.
cost realload: 46.84948921203613
Function load_adapters took 46.87190055847168 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 19 remains
cost offload cat: 0.03790855407714844
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11467933654785156
Function offload_adapters took 0.6215572357177734 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 20 in total
Function load_lora_A took 11.653661727905273 ms to run.
Function load_lora_B took 11.569023132324219 ms to run.
cost realload: 23.653030395507812
Function load_adapters took 23.675203323364258 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 19 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.6034374237060547 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.012636184692382812 ms to run.
current batch size: 20 token used ratio: 0.10158461538461538
cost offload scan: 0.08893013000488281
offload 1 adapters, 18 remains
cost offload cat: 0.0362396240234375
cost offload free mem manager: 0.04696846008300781
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.6155967712402344 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 19 in total
INFO:     127.0.0.1:58092 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58108 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58120 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59078 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59082 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59096 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59110 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59116 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59120 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59122 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59124 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59140 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59150 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 11.635541915893555 ms to run.
Function load_lora_B took 11.567354202270508 ms to run.
cost realload: 23.674726486206055
Function load_adapters took 23.699045181274414 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 20 in total
Function load_lora_A took 11.612653732299805 ms to run.
Function load_lora_B took 11.536359786987305 ms to run.
cost realload: 23.57006072998047
Function load_adapters took 23.591995239257812 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 19 remains
cost offload cat: 0.04076957702636719
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.12326240539550781
Function offload_adapters took 0.6322860717773438 ms to run.
cost load scan: 0.008821487426757812
load 0 adapters, 19 in total
cost realload: 0.31566619873046875
Function load_adapters took 0.3402233123779297 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 18 remains
cost offload cat: 0.03695487976074219
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11849403381347656
Function offload_adapters took 0.6258487701416016 ms to run.
cost offload scan: 0.09703636169433594
offload 1 adapters, 17 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.6129741668701172 ms to run.
cost load scan: 0.01430511474609375
load 1 adapters, 18 in total
Function load_lora_A took 11.647224426269531 ms to run.
Function load_lora_B took 11.503458023071289 ms to run.
cost realload: 23.59628677368164
Function load_adapters took 23.619413375854492 ms to run.
current batch size: 20 token used ratio: 0.10444615384615384
cost offload scan: 0.08916854858398438
offload 1 adapters, 17 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6175041198730469 ms to run.
cost load scan: 0.013589859008789062
load 1 adapters, 18 in total
Function load_lora_A took 11.640310287475586 ms to run.
Function load_lora_B took 11.550664901733398 ms to run.
cost realload: 23.613929748535156
Function load_adapters took 23.6361026763916 ms to run.
cost offload scan: 0.091552734375
offload 1 adapters, 17 remains
cost offload cat: 0.03552436828613281
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.1220703125
Function offload_adapters took 0.6237030029296875 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 16 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.6012916564941406 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 17 in total
Function load_lora_A took 11.623859405517578 ms to run.
Function load_lora_B took 11.566162109375 ms to run.
cost realload: 23.61774444580078
Function load_adapters took 23.641586303710938 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 16 remains
cost offload cat: 0.03719329833984375
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.6082057952880859 ms to run.
offload 0 adapters, 16 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 16 in total
cost realload: 0.3132820129394531
Function load_adapters took 0.3376007080078125 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 15 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11444091796875
Function offload_adapters took 0.6034374237060547 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 14 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.118255615234375
Function offload_adapters took 0.6036758422851562 ms to run.
current batch size: 17 token used ratio: 0.08250769230769231
cost offload scan: 0.09131431579589844
offload 1 adapters, 13 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5941390991210938 ms to run.
offload 0 adapters, 13 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 12 remains
cost offload cat: 0.03647804260253906
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.60272216796875 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 13 in total
Function load_lora_A took 11.644124984741211 ms to run.
Function load_lora_B took 11.539459228515625 ms to run.
cost realload: 23.625850677490234
Function load_adapters took 23.648738861083984 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 12 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.614166259765625 ms to run.
offload 0 adapters, 12 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 13 in total
Function load_lora_A took 11.648416519165039 ms to run.
Function load_lora_B took 11.533021926879883 ms to run.
cost realload: 23.613929748535156
Function load_adapters took 23.6356258392334 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 12 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11515617370605469
Function offload_adapters took 0.6082057952880859 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 13 in total
Function load_lora_A took 11.622428894042969 ms to run.
Function load_lora_B took 11.52944564819336 ms to run.
cost realload: 23.581743240356445
Function load_adapters took 23.604393005371094 ms to run.
current batch size: 14 token used ratio: 0.06936923076923077
cost load scan: 0.009059906005859375
load 1 adapters, 14 in total
Function load_lora_A took 11.562585830688477 ms to run.
Function load_lora_B took 11.493921279907227 ms to run.
cost realload: 23.487567901611328
Function load_adapters took 23.508787155151367 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 13 remains
cost offload cat: 0.036716461181640625
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.6077289581298828 ms to run.
Avg tokens(prompt+generate) throughput: 1507.223 tokens/s
Avg prompt tokens throughput:            817.157 tokens/s
Avg generate tokens throughput:          690.066 tokens/s
cost load scan: 0.008821487426757812
load 1 adapters, 14 in total
Function load_lora_A took 11.625528335571289 ms to run.
Function load_lora_B took 11.552095413208008 ms to run.
cost realload: 23.607254028320312
Function load_adapters took 23.628950119018555 ms to run.
cost load scan: 0.016927719116210938
load 2 adapters, 16 in total
Function load_lora_A took 11.63935661315918 ms to run.
Function load_lora_B took 11.578083038330078 ms to run.
Function load_lora_A took 11.57236099243164 ms to run.
INFO:     127.0.0.1:59158 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59164 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59172 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59180 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59196 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59206 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59208 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59218 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59234 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59238 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59254 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59270 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59286 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59290 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59300 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59312 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59322 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59332 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59334 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59336 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59346 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59358 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59360 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59372 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59380 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59394 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59400 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59410 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_B took 11.487245559692383 ms to run.
cost realload: 46.86141014099121
Function load_adapters took 46.884775161743164 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 15 remains
cost offload cat: 0.03790855407714844
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.6082057952880859 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 14 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5962848663330078 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 15 in total
Function load_lora_A took 11.631488800048828 ms to run.
Function load_lora_B took 11.531591415405273 ms to run.
cost realload: 23.593664169311523
Function load_adapters took 23.615121841430664 ms to run.
current batch size: 16 token used ratio: 0.07944615384615385
cost load scan: 0.009059906005859375
load 1 adapters, 16 in total
Function load_lora_A took 11.627197265625 ms to run.
Function load_lora_B took 11.533498764038086 ms to run.
cost realload: 23.583650588989258
Function load_adapters took 23.606300354003906 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 15 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.12326240539550781
Function offload_adapters took 0.6203651428222656 ms to run.
cost load scan: 0.016927719116210938
load 2 adapters, 17 in total
Function load_lora_A took 11.638879776000977 ms to run.
Function load_lora_B took 11.55400276184082 ms to run.
Function load_lora_A took 11.637210845947266 ms to run.
Function load_lora_B took 11.545896530151367 ms to run.
cost realload: 46.8904972076416
Function load_adapters took 46.91267013549805 ms to run.
cost offload scan: 0.09465217590332031
offload 1 adapters, 16 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.04792213439941406
cost offload torch.empty: 0.027894973754882812
cost offload a_loc update: 0.11467933654785156
Function offload_adapters took 0.6299018859863281 ms to run.
cost load scan: 0.009775161743164062
load 1 adapters, 17 in total
Function load_lora_A took 11.634588241577148 ms to run.
Function load_lora_B took 11.55543327331543 ms to run.
cost realload: 23.627042770385742
Function load_adapters took 23.651123046875 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 18 in total
Function load_lora_A took 11.606454849243164 ms to run.
Function load_lora_B took 11.530637741088867 ms to run.
cost realload: 23.649215698242188
Function load_adapters took 23.674964904785156 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 17 remains
cost offload cat: 0.040531158447265625
cost offload free mem manager: 0.047206878662109375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.12373924255371094
Function offload_adapters took 0.6337165832519531 ms to run.
cost load scan: 0.0133514404296875
load 2 adapters, 19 in total
Function load_lora_A took 11.640071868896484 ms to run.
Function load_lora_B took 11.513471603393555 ms to run.
Function load_lora_A took 11.610984802246094 ms to run.
Function load_lora_B took 11.556863784790039 ms to run.
cost realload: 46.82207107543945
Function load_adapters took 46.8447208404541 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 18 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.11515617370605469
Function offload_adapters took 0.6198883056640625 ms to run.
cost offload scan: 0.09393692016601562
offload 1 adapters, 17 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.024318695068359375
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.6170272827148438 ms to run.
current batch size: 19 token used ratio: 0.09518461538461538
cost load scan: 0.015020370483398438
load 2 adapters, 19 in total
Function load_lora_A took 11.632919311523438 ms to run.
Function load_lora_B took 11.52944564819336 ms to run.
Function load_lora_A took 11.59214973449707 ms to run.
Function load_lora_B took 11.560201644897461 ms to run.
cost realload: 46.839237213134766
Function load_adapters took 46.8599796295166 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 20 in total
Function load_lora_A took 11.562824249267578 ms to run.
Function load_lora_B took 11.47603988647461 ms to run.
cost realload: 23.490190505981445
Function load_adapters took 23.5135555267334 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 21 in total
Function load_lora_A took 11.550188064575195 ms to run.
Function load_lora_B took 11.446952819824219 ms to run.
cost realload: 23.437976837158203
Function load_adapters took 23.461580276489258 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 22 in total
Function load_lora_A took 11.60883903503418 ms to run.
Function load_lora_B took 11.551380157470703 ms to run.
cost realload: 23.58555793762207
Function load_adapters took 23.610830307006836 ms to run.
cost offload scan: 0.0972747802734375
offload 1 adapters, 21 remains
cost offload cat: 0.039577484130859375
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11610984802246094
Function offload_adapters took 0.6365776062011719 ms to run.
cost load scan: 0.014543533325195312
load 3 adapters, 24 in total
Function load_lora_A took 11.64865493774414 ms to run.
Function load_lora_B took 11.533021926879883 ms to run.
Function load_lora_A took 11.611700057983398 ms to run.
Function load_lora_B took 11.565923690795898 ms to run.
Function load_lora_A took 11.638879776000977 ms to run.
Function load_lora_B took 11.543035507202148 ms to run.
cost realload: 70.13082504272461
Function load_adapters took 70.15323638916016 ms to run.
current batch size: 27 token used ratio: 0.1364923076923077
cost offload scan: 0.09703636169433594
offload 1 adapters, 23 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11539459228515625
Function offload_adapters took 0.6213188171386719 ms to run.
offload 0 adapters, 23 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.016450881958007812
load 3 adapters, 26 in total
Function load_lora_A took 11.629581451416016 ms to run.
Function load_lora_B took 11.53564453125 ms to run.
Function load_lora_A took 11.640071868896484 ms to run.
Function load_lora_B took 11.512041091918945 ms to run.
Function load_lora_A took 11.621236801147461 ms to run.
Function load_lora_B took 11.545419692993164 ms to run.
cost realload: 70.07575035095215
Function load_adapters took 70.0981616973877 ms to run.
cost load scan: 0.018358230590820312
load 4 adapters, 30 in total
Function load_lora_A took 11.644124984741211 ms to run.
Function load_lora_B took 11.551856994628906 ms to run.
Function load_lora_A took 11.556625366210938 ms to run.
Function load_lora_B took 11.485099792480469 ms to run.
Function load_lora_A took 11.637210845947266 ms to run.
Function load_lora_B took 11.573553085327148 ms to run.
Function load_lora_A took 11.583328247070312 ms to run.
Function load_lora_B took 11.496305465698242 ms to run.
cost realload: 93.18923950195312
Function load_adapters took 93.21212768554688 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 29 remains
cost offload cat: 0.039577484130859375
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.621795654296875 ms to run.
cost load scan: 0.01239776611328125
INFO:     127.0.0.1:59414 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59424 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59430 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59446 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59458 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59474 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48060 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48068 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48070 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48084 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48092 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48098 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48110 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48114 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48120 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48126 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48140 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48144 - "POST /generate_stream HTTP/1.1" 200 OK
load 2 adapters, 31 in total
Function load_lora_A took 11.644363403320312 ms to run.
Function load_lora_B took 11.550426483154297 ms to run.
Function load_lora_A took 11.623859405517578 ms to run.
Function load_lora_B took 11.528730392456055 ms to run.
cost realload: 46.88382148742676
Function load_adapters took 46.9059944152832 ms to run.
cost load scan: 0.016689300537109375
load 2 adapters, 33 in total
Function load_lora_A took 11.657476425170898 ms to run.
Function load_lora_B took 11.478662490844727 ms to run.
Function load_lora_A took 11.648893356323242 ms to run.
Function load_lora_B took 11.507987976074219 ms to run.
cost realload: 46.819448471069336
Function load_adapters took 46.84185981750488 ms to run.
offload 0 adapters, 33 remains
Function offload_adapters took 0.012874603271484375 ms to run.
current batch size: 34 token used ratio: 0.1874
cost load scan: 0.015974044799804688
load 1 adapters, 34 in total
Function load_lora_A took 11.610984802246094 ms to run.
Function load_lora_B took 11.53421401977539 ms to run.
cost realload: 23.587703704833984
Function load_adapters took 23.610353469848633 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 35 in total
Function load_lora_A took 11.626482009887695 ms to run.
Function load_lora_B took 11.507749557495117 ms to run.
cost realload: 23.566722869873047
Function load_adapters took 23.590087890625 ms to run.
cost load scan: 0.014066696166992188
load 1 adapters, 36 in total
Function load_lora_A took 11.638402938842773 ms to run.
Function load_lora_B took 11.542320251464844 ms to run.
cost realload: 23.62966537475586
Function load_adapters took 23.653507232666016 ms to run.
cost offload scan: 0.13518333435058594
offload 2 adapters, 34 remains
cost offload cat: 0.02956390380859375
cost offload free mem manager: 0.05316734313964844
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11515617370605469
Function offload_adapters took 0.6654262542724609 ms to run.
cost offload scan: 0.10156631469726562
offload 1 adapters, 33 remains
cost offload cat: 0.035762786865234375
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11038780212402344
Function offload_adapters took 0.6215572357177734 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 33 in total
cost realload: 0.3204345703125
Function load_adapters took 0.34546852111816406 ms to run.
cost offload scan: 0.09417533874511719
offload 1 adapters, 32 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.6251335144042969 ms to run.
current batch size: 34 token used ratio: 0.20303076923076924
cost offload scan: 0.09107589721679688
offload 1 adapters, 31 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11515617370605469
Function offload_adapters took 0.6239414215087891 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 32 in total
Function load_lora_A took 11.634111404418945 ms to run.
Function load_lora_B took 11.516809463500977 ms to run.
cost realload: 23.57935905456543
Function load_adapters took 23.601531982421875 ms to run.
cost offload scan: 0.09560585021972656
offload 1 adapters, 31 remains
cost offload cat: 0.04363059997558594
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.6320476531982422 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 32 in total
Function load_lora_A took 11.63625717163086 ms to run.
Function load_lora_B took 11.529684066772461 ms to run.
cost realload: 23.60391616821289
Function load_adapters took 23.626327514648438 ms to run.
cost offload scan: 0.09608268737792969
offload 1 adapters, 31 remains
cost offload cat: 0.036716461181640625
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.6325244903564453 ms to run.
cost load scan: 0.013113021850585938
load 2 adapters, 33 in total
Function load_lora_A took 11.651754379272461 ms to run.
Function load_lora_B took 11.529922485351562 ms to run.
Function load_lora_A took 11.615514755249023 ms to run.
Function load_lora_B took 11.53111457824707 ms to run.
cost realload: 46.822547912597656
Function load_adapters took 46.8440055847168 ms to run.
cost offload scan: 0.09965896606445312
offload 1 adapters, 32 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11181831359863281
Function offload_adapters took 0.6132125854492188 ms to run.
cost offload scan: 0.14019012451171875
offload 2 adapters, 30 remains
cost offload cat: 0.028133392333984375
cost offload free mem manager: 0.047206878662109375
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11444091796875
Function offload_adapters took 0.6618499755859375 ms to run.
cost load scan: 0.01811981201171875
load 3 adapters, 33 in total
Function load_lora_A took 11.663198471069336 ms to run.
Function load_lora_B took 11.574268341064453 ms to run.
Function load_lora_A took 11.626958847045898 ms to run.
Function load_lora_B took 11.562824249267578 ms to run.
Function load_lora_A took 11.635541915893555 ms to run.
Function load_lora_B took 11.52181625366211 ms to run.
cost realload: 70.18303871154785
Function load_adapters took 70.2052116394043 ms to run.
cost offload scan: 0.09465217590332031
offload 1 adapters, 32 remains
cost offload cat: 0.03504753112792969
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.1220703125
Function offload_adapters took 0.6392002105712891 ms to run.
current batch size: 35 token used ratio: 0.2071076923076923
cost load scan: 0.015735626220703125
load 2 adapters, 34 in total
Function load_lora_A took 11.604785919189453 ms to run.
Function load_lora_B took 11.507987976074219 ms to run.
Function load_lora_A took 11.633872985839844 ms to run.
Function load_lora_B took 11.509180068969727 ms to run.
cost realload: 46.769142150878906
Function load_adapters took 46.79155349731445 ms to run.
cost offload scan: 0.09942054748535156
offload 1 adapters, 33 remains
cost offload cat: 0.03552436828613281
cost offload free mem manager: 0.05316734313964844
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11444091796875
Function offload_adapters took 0.6411075592041016 ms to run.
cost offload scan: 0.09679794311523438
offload 1 adapters, 32 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.030517578125
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.6265640258789062 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 33 in total
Function load_lora_A took 11.645793914794922 ms to run.
Function load_lora_B took 11.555910110473633 ms to run.
cost realload: 23.644447326660156
Function load_adapters took 23.667573928833008 ms to run.
cost offload scan: 0.13780593872070312
offload 2 adapters, 31 remains
cost offload cat: 0.027894973754882812
cost offload free mem manager: 0.047206878662109375
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.6656646728515625 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 32 in total
Function load_lora_A took 11.54947280883789 ms to run.
Function load_lora_B took 11.494159698486328 ms to run.
cost realload: 23.48470687866211
Function load_adapters took 23.50759506225586 ms to run.
INFO:     127.0.0.1:48152 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48160 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48172 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48182 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48184 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48186 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48190 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48196 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48200 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48216 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48224 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48230 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48244 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48252 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48256 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48264 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48266 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48280 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48292 - "POST /generate_stream HTTP/1.1" 200 OK
Avg tokens(prompt+generate) throughput: 2007.390 tokens/s
Avg prompt tokens throughput:           1247.176 tokens/s
Avg generate tokens throughput:          760.215 tokens/s
cost offload scan: 0.09322166442871094
offload 1 adapters, 31 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11539459228515625
Function offload_adapters took 0.621795654296875 ms to run.
cost offload scan: 0.09393692016601562
offload 1 adapters, 30 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.05316734313964844
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.6320476531982422 ms to run.
cost offload scan: 0.09822845458984375
offload 1 adapters, 29 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.6206035614013672 ms to run.
offload 0 adapters, 29 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 28 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11515617370605469
Function offload_adapters took 0.6232261657714844 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 27 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.12135505676269531
Function offload_adapters took 0.6144046783447266 ms to run.
cost offload scan: 0.09655952453613281
offload 1 adapters, 26 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.04792213439941406
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.6284713745117188 ms to run.
current batch size: 28 token used ratio: 0.16293846153846153
cost offload scan: 0.09703636169433594
offload 1 adapters, 25 remains
cost offload cat: 0.03790855407714844
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11205673217773438
Function offload_adapters took 0.63323974609375 ms to run.
cost load scan: 0.0152587890625
load 1 adapters, 26 in total
Function load_lora_A took 11.6119384765625 ms to run.
Function load_lora_B took 11.550188064575195 ms to run.
cost realload: 23.600339889526367
Function load_adapters took 23.622512817382812 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 25 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.029802322387695312
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.6074905395507812 ms to run.
cost load scan: 0.012159347534179688
load 1 adapters, 26 in total
Function load_lora_A took 11.567115783691406 ms to run.
Function load_lora_B took 11.451482772827148 ms to run.
cost realload: 23.452281951904297
Function load_adapters took 23.47707748413086 ms to run.
cost load scan: 0.013589859008789062
load 2 adapters, 28 in total
Function load_lora_A took 11.637449264526367 ms to run.
Function load_lora_B took 11.54184341430664 ms to run.
Function load_lora_A took 11.628866195678711 ms to run.
Function load_lora_B took 11.54780387878418 ms to run.
cost realload: 46.864986419677734
Function load_adapters took 46.88835144042969 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 27 remains
cost offload cat: 0.03719329833984375
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.12040138244628906
Function offload_adapters took 0.6287097930908203 ms to run.
cost load scan: 0.013589859008789062
load 2 adapters, 29 in total
Function load_lora_A took 11.651039123535156 ms to run.
Function load_lora_B took 11.557340621948242 ms to run.
Function load_lora_A took 11.570215225219727 ms to run.
Function load_lora_B took 11.467933654785156 ms to run.
cost realload: 46.73647880554199
Function load_adapters took 46.75793647766113 ms to run.
offload 0 adapters, 29 remains
Function offload_adapters took 0.013113021850585938 ms to run.
current batch size: 31 token used ratio: 0.1846
cost load scan: 0.013589859008789062
load 1 adapters, 30 in total
Function load_lora_A took 11.648178100585938 ms to run.
Function load_lora_B took 11.521100997924805 ms to run.
cost realload: 23.603200912475586
Function load_adapters took 23.62537384033203 ms to run.
offload 0 adapters, 30 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost offload scan: 0.09846687316894531
offload 1 adapters, 29 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11610984802246094
Function offload_adapters took 0.6384849548339844 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 29 in total
cost realload: 0.3058910369873047
Function load_adapters took 0.3306865692138672 ms to run.
cost offload scan: 0.1392364501953125
offload 2 adapters, 27 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.048160552978515625
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.11682510375976562
Function offload_adapters took 0.6802082061767578 ms to run.
cost offload scan: 0.09846687316894531
offload 1 adapters, 26 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.6375312805175781 ms to run.
cost load scan: 0.013828277587890625
load 1 adapters, 27 in total
Function load_lora_A took 11.63172721862793 ms to run.
Function load_lora_B took 11.534929275512695 ms to run.
cost realload: 23.589372634887695
Function load_adapters took 23.610830307006836 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 26 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.6186962127685547 ms to run.
offload 0 adapters, 26 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 27 in total
Function load_lora_A took 11.642932891845703 ms to run.
Function load_lora_B took 11.535406112670898 ms to run.
cost realload: 23.61154556274414
Function load_adapters took 23.633956909179688 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 26 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.6117820739746094 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 25 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.12159347534179688
Function offload_adapters took 0.6170272827148438 ms to run.
cost load scan: 0.009775161743164062
load 3 adapters, 28 in total
Function load_lora_A took 11.634349822998047 ms to run.
Function load_lora_B took 11.559724807739258 ms to run.
Function load_lora_A took 11.632919311523438 ms to run.
Function load_lora_B took 11.537551879882812 ms to run.
Function load_lora_A took 11.628389358520508 ms to run.
Function load_lora_B took 11.552572250366211 ms to run.
cost realload: 70.12391090393066
Function load_adapters took 70.14656066894531 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 27 remains
INFO:     127.0.0.1:48296 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48312 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48324 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48326 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48328 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48332 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48334 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48346 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48354 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48364 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48368 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48378 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48394 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48402 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48418 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48422 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39284 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39300 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39314 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39330 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39334 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.049591064453125
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11610984802246094
Function offload_adapters took 0.6501674652099609 ms to run.
cost offload scan: 0.09965896606445312
offload 1 adapters, 26 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04982948303222656
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.11658668518066406
Function offload_adapters took 0.637054443359375 ms to run.
current batch size: 31 token used ratio: 0.17166153846153845
cost load scan: 0.009775161743164062
load 1 adapters, 27 in total
Function load_lora_A took 11.627912521362305 ms to run.
Function load_lora_B took 11.548280715942383 ms to run.
cost realload: 23.601055145263672
Function load_adapters took 23.624658584594727 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 26 remains
cost offload cat: 0.036716461181640625
cost offload free mem manager: 0.0476837158203125
cost offload torch.empty: 0.029802322387695312
cost offload a_loc update: 0.11944770812988281
Function offload_adapters took 0.6413459777832031 ms to run.
cost offload scan: 0.09655952453613281
offload 1 adapters, 25 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.6272792816162109 ms to run.
cost load scan: 0.011920928955078125
load 2 adapters, 27 in total
Function load_lora_A took 11.618375778198242 ms to run.
Function load_lora_B took 11.53254508972168 ms to run.
Function load_lora_A took 11.589288711547852 ms to run.
Function load_lora_B took 11.549234390258789 ms to run.
cost realload: 46.851158142089844
Function load_adapters took 46.87786102294922 ms to run.
cost offload scan: 0.10347366333007812
offload 1 adapters, 26 remains
cost offload cat: 0.03600120544433594
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11539459228515625
Function offload_adapters took 0.637054443359375 ms to run.
cost offload scan: 0.1366138458251953
offload 2 adapters, 24 remains
cost offload cat: 0.027894973754882812
cost offload free mem manager: 0.05364418029785156
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.6656646728515625 ms to run.
cost load scan: 0.018358230590820312
load 3 adapters, 27 in total
Function load_lora_A took 11.638641357421875 ms to run.
Function load_lora_B took 11.546850204467773 ms to run.
Function load_lora_A took 11.634111404418945 ms to run.
Function load_lora_B took 11.521577835083008 ms to run.
Function load_lora_A took 11.539459228515625 ms to run.
Function load_lora_B took 11.456966400146484 ms to run.
cost realload: 69.91791725158691
Function load_adapters took 69.96560096740723 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 26 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11444091796875
Function offload_adapters took 0.6208419799804688 ms to run.
offload 0 adapters, 26 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.014066696166992188
load 2 adapters, 28 in total
Function load_lora_A took 11.63029670715332 ms to run.
Function load_lora_B took 11.52181625366211 ms to run.
Function load_lora_A took 11.653661727905273 ms to run.
Function load_lora_B took 11.53254508972168 ms to run.
cost realload: 46.86427116394043
Function load_adapters took 46.88692092895508 ms to run.
cost offload scan: 0.10323524475097656
offload 1 adapters, 27 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.6241798400878906 ms to run.
offload 0 adapters, 27 remains
Function offload_adapters took 0.01239776611328125 ms to run.
current batch size: 31 token used ratio: 0.1658769230769231
cost load scan: 0.012636184692382812
load 1 adapters, 28 in total
Function load_lora_A took 11.620044708251953 ms to run.
Function load_lora_B took 11.515617370605469 ms to run.
cost realload: 23.566722869873047
Function load_adapters took 23.589611053466797 ms to run.
offload 0 adapters, 28 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.014066696166992188
load 2 adapters, 30 in total
Function load_lora_A took 11.643409729003906 ms to run.
Function load_lora_B took 11.546850204467773 ms to run.
Function load_lora_A took 11.621236801147461 ms to run.
Function load_lora_B took 11.514902114868164 ms to run.
cost realload: 46.8287467956543
Function load_adapters took 46.85163497924805 ms to run.
cost offload scan: 0.09918212890625
offload 1 adapters, 29 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.047206878662109375
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.12421607971191406
Function offload_adapters took 0.6375312805175781 ms to run.
offload 0 adapters, 29 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.09846687316894531
offload 1 adapters, 28 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04696846008300781
cost offload torch.empty: 0.0247955322265625
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.6337165832519531 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 28 in total
cost realload: 0.3132820129394531
Function load_adapters took 0.3376007080078125 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 27 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6160736083984375 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 26 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11205673217773438
Function offload_adapters took 0.6062984466552734 ms to run.
cost load scan: 0.013828277587890625
load 2 adapters, 28 in total
Function load_lora_A took 11.623382568359375 ms to run.
Function load_lora_B took 11.530876159667969 ms to run.
Function load_lora_A took 11.61813735961914 ms to run.
Function load_lora_B took 11.553764343261719 ms to run.
cost realload: 46.83351516723633
Function load_adapters took 46.85854911804199 ms to run.
cost offload scan: 0.09799003601074219
offload 1 adapters, 27 remains
cost offload cat: 0.037670135498046875
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.6277561187744141 ms to run.
cost load scan: 0.015735626220703125
load 3 adapters, 30 in total
Function load_lora_A took 11.569738388061523 ms to run.
Function load_lora_B took 11.482000350952148 ms to run.
Function load_lora_A took 11.590242385864258 ms to run.
Function load_lora_B took 11.529684066772461 ms to run.
Function load_lora_A took 11.511802673339844 ms to run.
Function load_lora_B took 11.503219604492188 ms to run.
cost realload: 69.77200508117676
Function load_adapters took 69.79513168334961 ms to run.
current batch size: 35 token used ratio: 0.1819230769230769
cost offload scan: 0.09250640869140625
offload 1 adapters, 29 remains
cost offload cat: 0.03552436828613281
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6246566772460938 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 30 in total
Function load_lora_A took 11.573314666748047 ms to run.
INFO:     127.0.0.1:39336 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39344 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39354 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39364 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39368 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39374 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39384 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39394 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39398 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39408 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39410 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39416 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39426 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39434 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39442 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39450 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_B took 11.473894119262695 ms to run.
cost realload: 23.524045944213867
Function load_adapters took 23.546218872070312 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 31 in total
Function load_lora_A took 11.652231216430664 ms to run.
Function load_lora_B took 11.559247970581055 ms to run.
cost realload: 23.652315139770508
Function load_adapters took 23.674488067626953 ms to run.
offload 0 adapters, 31 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.09608268737792969
offload 1 adapters, 30 remains
cost offload cat: 0.03695487976074219
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.024318695068359375
cost offload a_loc update: 0.11968612670898438
Function offload_adapters took 0.6406307220458984 ms to run.
cost load scan: 0.01811981201171875
load 2 adapters, 32 in total
Function load_lora_A took 11.649608612060547 ms to run.
Function load_lora_B took 11.537790298461914 ms to run.
Function load_lora_A took 11.643409729003906 ms to run.
Function load_lora_B took 11.563777923583984 ms to run.
cost realload: 46.91171646118164
Function load_adapters took 46.935081481933594 ms to run.
cost offload scan: 0.10371208190917969
offload 1 adapters, 31 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.6306171417236328 ms to run.
cost offload scan: 0.09751319885253906
offload 1 adapters, 30 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.6277561187744141 ms to run.
cost offload scan: 0.09846687316894531
offload 1 adapters, 29 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.6225109100341797 ms to run.
current batch size: 35 token used ratio: 0.1938923076923077
cost offload scan: 0.09250640869140625
offload 1 adapters, 28 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.6303787231445312 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 29 in total
Function load_lora_A took 11.623382568359375 ms to run.
Function load_lora_B took 11.552095413208008 ms to run.
cost realload: 23.600339889526367
Function load_adapters took 23.62227439880371 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 28 remains
cost offload cat: 0.03504753112792969
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.6239414215087891 ms to run.
cost load scan: 0.014066696166992188
load 1 adapters, 29 in total
Function load_lora_A took 11.63792610168457 ms to run.
Function load_lora_B took 11.523723602294922 ms to run.
cost realload: 23.5903263092041
Function load_adapters took 23.612499237060547 ms to run.
offload 0 adapters, 29 remains
Function offload_adapters took 0.013828277587890625 ms to run.
cost offload scan: 0.09870529174804688
offload 1 adapters, 28 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11563301086425781
Function offload_adapters took 0.6308555603027344 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 29 in total
Function load_lora_A took 11.589765548706055 ms to run.
Function load_lora_B took 11.53421401977539 ms to run.
cost realload: 23.556947708129883
Function load_adapters took 23.579120635986328 ms to run.
Avg tokens(prompt+generate) throughput: 2097.309 tokens/s
Avg prompt tokens throughput:           1190.275 tokens/s
Avg generate tokens throughput:          907.033 tokens/s
cost offload scan: 0.09989738464355469
offload 1 adapters, 28 remains
cost offload cat: 0.042438507080078125
cost offload free mem manager: 0.06079673767089844
cost offload torch.empty: 0.025272369384765625
cost offload a_loc update: 0.11849403381347656
Function offload_adapters took 0.9160041809082031 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 29 in total
Function load_lora_A took 11.649370193481445 ms to run.
Function load_lora_B took 11.534452438354492 ms to run.
cost realload: 23.61440658569336
Function load_adapters took 23.636341094970703 ms to run.
offload 0 adapters, 29 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 28 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11444091796875
Function offload_adapters took 0.6134510040283203 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 29 in total
Function load_lora_A took 11.655092239379883 ms to run.
Function load_lora_B took 11.530160903930664 ms to run.
cost realload: 23.607254028320312
Function load_adapters took 23.629188537597656 ms to run.
current batch size: 35 token used ratio: 0.1930923076923077
offload 0 adapters, 29 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.10371208190917969
offload 1 adapters, 28 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.6239414215087891 ms to run.
offload 0 adapters, 28 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.01621246337890625
load 2 adapters, 30 in total
Function load_lora_A took 11.655330657958984 ms to run.
Function load_lora_B took 11.547088623046875 ms to run.
Function load_lora_A took 11.629819869995117 ms to run.
Function load_lora_B took 11.561155319213867 ms to run.
cost realload: 46.884775161743164
Function load_adapters took 46.90670967102051 ms to run.
cost offload scan: 0.09822845458984375
offload 1 adapters, 29 remains
cost offload cat: 0.03504753112792969
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.11587142944335938
Function offload_adapters took 0.6313323974609375 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 28 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.05125999450683594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.6201267242431641 ms to run.
cost offload scan: 0.09608268737792969
offload 1 adapters, 27 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.6165504455566406 ms to run.
cost offload scan: 0.09775161743164062
offload 1 adapters, 26 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.6139278411865234 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 25 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6272792816162109 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 26 in total
Function load_lora_A took 11.608600616455078 ms to run.
Function load_lora_B took 11.540412902832031 ms to run.
cost realload: INFO:     127.0.0.1:39456 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39470 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39480 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39482 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39486 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39496 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39506 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39508 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39520 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39536 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39538 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39540 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39542 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39550 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39560 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39572 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39578 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39580 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39590 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39604 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39616 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39628 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39644 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39648 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39660 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39666 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39676 - "POST /generate_stream HTTP/1.1" 200 OK
23.58388900756836
Function load_adapters took 23.633956909179688 ms to run.
cost offload scan: 0.1308917999267578
offload 2 adapters, 24 remains
cost offload cat: 0.028848648071289062
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11539459228515625
Function offload_adapters took 0.6451606750488281 ms to run.
current batch size: 29 token used ratio: 0.1609076923076923
cost load scan: 0.01430511474609375
load 2 adapters, 26 in total
Function load_lora_A took 11.635303497314453 ms to run.
Function load_lora_B took 11.54947280883789 ms to run.
Function load_lora_A took 11.620283126831055 ms to run.
Function load_lora_B took 11.541604995727539 ms to run.
cost realload: 46.86760902404785
Function load_adapters took 46.889543533325195 ms to run.
offload 0 adapters, 26 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.09799003601074219
offload 1 adapters, 25 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.0476837158203125
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.118255615234375
Function offload_adapters took 0.6320476531982422 ms to run.
offload 0 adapters, 25 remains
Function offload_adapters took 0.018835067749023438 ms to run.
cost load scan: 0.022172927856445312
load 5 adapters, 30 in total
Function load_lora_A took 11.623382568359375 ms to run.
Function load_lora_B took 11.564970016479492 ms to run.
Function load_lora_A took 11.62099838256836 ms to run.
Function load_lora_B took 11.554718017578125 ms to run.
Function load_lora_A took 11.626243591308594 ms to run.
Function load_lora_B took 11.528491973876953 ms to run.
Function load_lora_A took 11.626243591308594 ms to run.
Function load_lora_B took 11.562108993530273 ms to run.
Function load_lora_A took 11.618614196777344 ms to run.
Function load_lora_B took 11.566638946533203 ms to run.
cost realload: 116.64342880249023
Function load_adapters took 116.66679382324219 ms to run.
offload 0 adapters, 30 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.09775161743164062
offload 1 adapters, 29 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.6222724914550781 ms to run.
cost load scan: 0.009775161743164062
load 1 adapters, 30 in total
Function load_lora_A took 11.644124984741211 ms to run.
Function load_lora_B took 11.558294296264648 ms to run.
cost realload: 23.645401000976562
Function load_adapters took 23.668289184570312 ms to run.
cost load scan: 0.008821487426757812
load 0 adapters, 30 in total
cost realload: 0.31566619873046875
Function load_adapters took 0.34236907958984375 ms to run.
offload 0 adapters, 30 remains
Function offload_adapters took 0.0133514404296875 ms to run.
cost offload scan: 0.10156631469726562
offload 1 adapters, 29 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11658668518066406
Function offload_adapters took 0.6315708160400391 ms to run.
offload 0 adapters, 29 remains
Function offload_adapters took 0.01239776611328125 ms to run.
current batch size: 35 token used ratio: 0.18152307692307693
cost load scan: 0.008106231689453125
load 1 adapters, 30 in total
Function load_lora_A took 11.62409782409668 ms to run.
Function load_lora_B took 11.547327041625977 ms to run.
cost realload: 23.593902587890625
Function load_adapters took 23.615598678588867 ms to run.
offload 0 adapters, 30 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 29 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.030755996704101562
cost offload a_loc update: 0.11777877807617188
Function offload_adapters took 0.6399154663085938 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 30 in total
Function load_lora_A took 11.61646842956543 ms to run.
Function load_lora_B took 11.550426483154297 ms to run.
cost realload: 23.611068725585938
Function load_adapters took 23.633718490600586 ms to run.
cost offload scan: 0.09369850158691406
offload 1 adapters, 29 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.6172657012939453 ms to run.
cost offload scan: 0.09703636169433594
offload 1 adapters, 28 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11563301086425781
Function offload_adapters took 0.6270408630371094 ms to run.
cost load scan: 0.014066696166992188
load 2 adapters, 30 in total
Function load_lora_A took 11.633634567260742 ms to run.
Function load_lora_B took 11.54780387878418 ms to run.
Function load_lora_A took 11.631965637207031 ms to run.
Function load_lora_B took 11.537551879882812 ms to run.
cost realload: 46.85258865356445
Function load_adapters took 46.875 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 29 remains
cost offload cat: 0.03743171691894531
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.1201629638671875
Function offload_adapters took 0.6320476531982422 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 30 in total
Function load_lora_A took 11.602640151977539 ms to run.
Function load_lora_B took 11.542320251464844 ms to run.
cost realload: 23.57792854309082
Function load_adapters took 23.599863052368164 ms to run.
current batch size: 36 token used ratio: 0.2004153846153846
offload 0 adapters, 30 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.009775161743164062
load 1 adapters, 31 in total
Function load_lora_A took 11.639595031738281 ms to run.
Function load_lora_B took 11.542558670043945 ms to run.
cost realload: 23.608922958374023
Function load_adapters took 23.630857467651367 ms to run.
cost offload scan: 0.09465217590332031
offload 1 adapters, 30 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.6191730499267578 ms to run.
offload 0 adapters, 30 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 30 in total
cost realload: 0.3161430358886719
Function load_adapters took 0.3409385681152344 ms to run.
cost offload scan: 0.09369850158691406
offload 1 adapters, 29 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11849403381347656
Function offload_adapters took 0.6210803985595703 ms to run.
cost offload scan: 0.09679794311523438
offload 1 adapters, 28 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.621795654296875 ms to run.
cost load scan: 0.009059906005859375
load 2 adapters, 30 in total
Function load_lora_A took 11.640787124633789 ms to run.
Function load_lora_B took 11.54637336730957 ms to run.
Function load_lora_A took 11.637687683105469 ms to run.
Function load_lora_B took 11.56473159790039 ms to run.
cost realload: 46.884775161743164
Function load_adapters took 46.90742492675781 ms to run.
cost offload scan: 0.09441375732421875
offload 1 adapters, 29 remains
cost offload cat: 0.036716461181640625
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: INFO:     127.0.0.1:49078 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49082 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49092 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49108 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49122 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49128 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49140 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49154 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49162 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49178 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49182 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49196 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49200 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49216 - "POST /generate_stream HTTP/1.1" 200 OK
0.12302398681640625
Function offload_adapters took 0.6549358367919922 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 28 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6122589111328125 ms to run.
cost offload scan: 0.09870529174804688
offload 1 adapters, 27 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11944770812988281
Function offload_adapters took 0.6234645843505859 ms to run.
cost load scan: 0.017404556274414062
load 2 adapters, 29 in total
Function load_lora_A took 11.643409729003906 ms to run.
Function load_lora_B took 11.552810668945312 ms to run.
Function load_lora_A took 11.631488800048828 ms to run.
Function load_lora_B took 11.560916900634766 ms to run.
cost realload: 46.89812660217285
Function load_adapters took 46.92721366882324 ms to run.
offload 0 adapters, 29 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.09489059448242188
offload 1 adapters, 28 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11682510375976562
Function offload_adapters took 0.6189346313476562 ms to run.
current batch size: 35 token used ratio: 0.2032923076923077
cost load scan: 0.01239776611328125
load 1 adapters, 29 in total
Function load_lora_A took 11.656761169433594 ms to run.
Function load_lora_B took 11.529207229614258 ms to run.
cost realload: 23.62799644470215
Function load_adapters took 23.652315139770508 ms to run.
offload 0 adapters, 29 remains
Function offload_adapters took 0.015497207641601562 ms to run.
cost offload scan: 0.09584426879882812
offload 1 adapters, 28 remains
cost offload cat: 0.036716461181640625
cost offload free mem manager: 0.048160552978515625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11873245239257812
Function offload_adapters took 0.6451606750488281 ms to run.
offload 0 adapters, 28 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.13566017150878906
offload 2 adapters, 26 remains
cost offload cat: 0.02956390380859375
cost offload free mem manager: 0.048160552978515625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.6685256958007812 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 26 in total
cost realload: 0.3237724304199219
Function load_adapters took 0.354766845703125 ms to run.
offload 0 adapters, 26 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost offload scan: 0.10609626770019531
offload 1 adapters, 25 remains
cost offload cat: 0.03647804260253906
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.11444091796875
Function offload_adapters took 0.6361007690429688 ms to run.
cost load scan: 0.015020370483398438
load 2 adapters, 27 in total
Function load_lora_A took 11.65914535522461 ms to run.
Function load_lora_B took 11.536836624145508 ms to run.
Function load_lora_A took 11.646747589111328 ms to run.
Function load_lora_B took 11.52801513671875 ms to run.
cost realload: 46.915292739868164
Function load_adapters took 46.93746566772461 ms to run.
cost offload scan: 0.09393692016601562
offload 1 adapters, 26 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.6251335144042969 ms to run.
cost offload scan: 0.0972747802734375
offload 1 adapters, 25 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.6320476531982422 ms to run.
current batch size: 31 token used ratio: 0.1773076923076923
offload 0 adapters, 25 remains
Function offload_adapters took 0.012874603271484375 ms to run.
offload 0 adapters, 25 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 25 in total
cost realload: 0.32782554626464844
Function load_adapters took 0.35309791564941406 ms to run.
cost load scan: 0.015735626220703125
load 3 adapters, 28 in total
Function load_lora_A took 11.534452438354492 ms to run.
Function load_lora_B took 11.487960815429688 ms to run.
Function load_lora_A took 11.618852615356445 ms to run.
Function load_lora_B took 11.52348518371582 ms to run.
Function load_lora_A took 11.638641357421875 ms to run.
Function load_lora_B took 11.520147323608398 ms to run.
cost realload: 69.9167251586914
Function load_adapters took 69.93937492370605 ms to run.
cost offload scan: 0.10395050048828125
offload 1 adapters, 27 remains
cost offload cat: 0.03647804260253906
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11587142944335938
Function offload_adapters took 0.6382465362548828 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 27 in total
cost realload: 0.3032684326171875
Function load_adapters took 0.32782554626464844 ms to run.
Avg tokens(prompt+generate) throughput: 2126.785 tokens/s
Avg prompt tokens throughput:           1174.624 tokens/s
Avg generate tokens throughput:          952.161 tokens/s
cost offload scan: 0.09894371032714844
offload 1 adapters, 26 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.052928924560546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.6310939788818359 ms to run.
offload 0 adapters, 26 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.09751319885253906
offload 1 adapters, 25 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6153583526611328 ms to run.
cost load scan: 0.014781951904296875
load 1 adapters, 26 in total
Function load_lora_A took 11.626482009887695 ms to run.
Function load_lora_B took 11.539936065673828 ms to run.
cost realload: 23.583412170410156
Function load_adapters took 23.6051082611084 ms to run.
offload 0 adapters, 26 remains
Function offload_adapters took 0.012159347534179688 ms to run.
current batch size: 30 token used ratio: 0.17507692307692307
cost offload scan: 0.13303756713867188
offload 2 adapters, 24 remains
cost offload cat: 0.02765655517578125
cost offload free mem manager: 0.0476837158203125
cost offload torch.empty: 0.030040740966796875
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.659942626953125 ms to run.
cost load scan: 0.016927719116210938
load 1 adapters, 25 in total
Function load_lora_A took 11.635541915893555 ms to run.
Function load_lora_B took 11.554718017578125 ms to run.
cost realload: 23.645401000976562
Function load_adapters took 23.66805076599121 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 24 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11205673217773438
Function offload_adapters took 0.6077289581298828 ms to run.
offload 0 adapters, 24 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 23 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.6015300750732422 ms to run.
INFO:     127.0.0.1:49218 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49228 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49242 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49252 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49256 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49270 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49280 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49282 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49294 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49310 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49326 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49334 - "POST /generate_stream HTTP/1.1" 200 OK
cost load scan: 0.011920928955078125
load 1 adapters, 24 in total
Function load_lora_A took 11.609077453613281 ms to run.
Function load_lora_B took 11.513233184814453 ms to run.
cost realload: 23.578882217407227
Function load_adapters took 23.601055145263672 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 23 remains
cost offload cat: 0.03647804260253906
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11467933654785156
Function offload_adapters took 0.6136894226074219 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 22 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.6029605865478516 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 23 in total
Function load_lora_A took 11.57999038696289 ms to run.
Function load_lora_B took 11.474132537841797 ms to run.
cost realload: 23.480892181396484
Function load_adapters took 23.503780364990234 ms to run.
cost load scan: 0.015974044799804688
load 1 adapters, 24 in total
Function load_lora_A took 11.623620986938477 ms to run.
Function load_lora_B took 11.523008346557617 ms to run.
cost realload: 23.57959747314453
Function load_adapters took 23.60248565673828 ms to run.
offload 0 adapters, 24 remains
Function offload_adapters took 0.01239776611328125 ms to run.
current batch size: 26 token used ratio: 0.1454
cost offload scan: 0.09059906005859375
offload 1 adapters, 23 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1220703125
Function offload_adapters took 0.6198883056640625 ms to run.
cost load scan: 0.015735626220703125
load 1 adapters, 24 in total
Function load_lora_A took 11.639833450317383 ms to run.
Function load_lora_B took 11.547565460205078 ms to run.
cost realload: 23.616552352905273
Function load_adapters took 23.639202117919922 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 23 remains
cost offload cat: 0.03695487976074219
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.6220340728759766 ms to run.
cost offload scan: 0.09489059448242188
offload 1 adapters, 22 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.6158351898193359 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 21 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.60272216796875 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 20 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.606536865234375 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 19 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.051021575927734375
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5941390991210938 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 18 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.1201629638671875
Function offload_adapters took 0.6244182586669922 ms to run.
cost offload scan: 0.09369850158691406
offload 1 adapters, 17 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.6144046783447266 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 18 in total
Function load_lora_A took 11.556625366210938 ms to run.
Function load_lora_B took 11.523962020874023 ms to run.
cost realload: 23.50616455078125
Function load_adapters took 23.52762222290039 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 17 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.5948543548583984 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 18 in total
Function load_lora_A took 11.555194854736328 ms to run.
Function load_lora_B took 11.481761932373047 ms to run.
cost realload: 23.473739624023438
Function load_adapters took 23.496627807617188 ms to run.
current batch size: 20 token used ratio: 0.10930769230769231
cost load scan: 0.013113021850585938
load 1 adapters, 19 in total
Function load_lora_A took 11.644840240478516 ms to run.
Function load_lora_B took 11.552810668945312 ms to run.
cost realload: 23.62680435180664
Function load_adapters took 23.648977279663086 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 18 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.6067752838134766 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 17 remains
cost offload cat: 0.036716461181640625
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.02956390380859375
cost offload a_loc update: 0.1163482666015625
Function offload_adapters took 0.6253719329833984 ms to run.
cost load scan: 0.009298324584960938
load 2 adapters, 19 in total
Function load_lora_A took 11.63482666015625 ms to run.
Function load_lora_B took 11.525869369506836 ms to run.
Function load_lora_A took 11.566162109375 ms to run.
Function load_lora_B took 11.475324630737305 ms to run.
cost realload: 46.698808670043945
Function load_adapters took 46.71978950500488 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 19 in total
cost realload: 0.30493736267089844
Function load_adapters took 0.3299713134765625 ms to run.
cost offload scan: 0.09560585021972656
offload 1 adapters, 18 remains
cost offload cat: 0.03552436828613281
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11038780212402344
Function offload_adapters took 0.614166259765625 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 17 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6189346313476562 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 17 in total
cost realload: 0.30684471130371094
Function load_adapters took 0.33164024353027344 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 16 remains
cost offload cat: 0.03504753112792969
cost offload free mem manager: 0.0514984130859375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11849403381347656
Function offload_adapters took 0.6170272827148438 ms to run.
cost load scan: 0.012159347534179688
load 1 adapters, 17 in total
Function load_lora_A took 11.63792610168457 ms to run.
Function load_lora_B took 11.564254760742188 ms to run.
cost realload: 23.618459701538086
INFO:     127.0.0.1:49348 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49356 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49372 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49382 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49392 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49402 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34290 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34292 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34302 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34310 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34316 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34318 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34328 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34340 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34344 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34356 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34366 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_adapters took 23.64063262939453 ms to run.
current batch size: 20 token used ratio: 0.10535384615384616
cost offload scan: 0.08869171142578125
offload 1 adapters, 16 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.047206878662109375
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.6115436553955078 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 15 remains
cost offload cat: 0.0362396240234375
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.6089210510253906 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 14 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11181831359863281
Function offload_adapters took 0.6053447723388672 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 13 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11587142944335938
Function offload_adapters took 0.6213188171386719 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 12 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.6127357482910156 ms to run.
current batch size: 15 token used ratio: 0.08247692307692307
cost load scan: 0.014066696166992188
load 1 adapters, 13 in total
Function load_lora_A took 11.612653732299805 ms to run.
Function load_lora_B took 11.54327392578125 ms to run.
cost realload: 23.596763610839844
Function load_adapters took 23.621797561645508 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 13 in total
cost realload: 0.31280517578125
Function load_adapters took 0.33855438232421875 ms to run.
cost offload scan: 0.09465217590332031
offload 1 adapters, 12 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04744529724121094
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.6077289581298828 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 11 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.05602836608886719
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.6053447723388672 ms to run.
cost load scan: 0.016927719116210938
load 2 adapters, 13 in total
Function load_lora_A took 11.634111404418945 ms to run.
Function load_lora_B took 11.544466018676758 ms to run.
Function load_lora_A took 11.652469635009766 ms to run.
Function load_lora_B took 11.551618576049805 ms to run.
cost realload: 46.8902587890625
Function load_adapters took 46.91195487976074 ms to run.
cost offload scan: 0.1277923583984375
offload 2 adapters, 11 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04744529724121094
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11658668518066406
Function offload_adapters took 0.6518363952636719 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 12 in total
Function load_lora_A took 11.632919311523438 ms to run.
Function load_lora_B took 11.540412902832031 ms to run.
cost realload: 23.612260818481445
Function load_adapters took 23.636341094970703 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 11 remains
cost offload cat: 0.04124641418457031
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.6000995635986328 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 11 in total
cost realload: 0.3006458282470703
Function load_adapters took 0.3247261047363281 ms to run.
current batch size: 17 token used ratio: 0.08926153846153846
offload 0 adapters, 11 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 11 in total
cost realload: 0.3046989440917969
Function load_adapters took 0.3294944763183594 ms to run.
cost offload scan: 0.09894371032714844
offload 1 adapters, 10 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.024318695068359375
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.6184577941894531 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 9 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.5953311920166016 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 10 in total
Function load_lora_A took 11.66844367980957 ms to run.
Function load_lora_B took 11.601448059082031 ms to run.
cost realload: 23.68927001953125
Function load_adapters took 23.711204528808594 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 9 remains
cost offload cat: 0.04100799560546875
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1277923583984375
Function offload_adapters took 0.6358623504638672 ms to run.
cost load scan: 0.01430511474609375
load 1 adapters, 10 in total
Function load_lora_A took 11.625051498413086 ms to run.
Function load_lora_B took 11.530637741088867 ms to run.
cost realload: 23.598432540893555
Function load_adapters took 23.619651794433594 ms to run.
current batch size: 15 token used ratio: 0.07953846153846154
offload 0 adapters, 10 remains
Function offload_adapters took 0.013113021850585938 ms to run.
offload 0 adapters, 10 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 9 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.05507469177246094
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.11205673217773438
Function offload_adapters took 0.6191730499267578 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 10 in total
Function load_lora_A took 11.629819869995117 ms to run.
Function load_lora_B took 11.549711227416992 ms to run.
cost realload: 23.62370491027832
Function load_adapters took 23.645639419555664 ms to run.
offload 0 adapters, 10 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 11 in total
Function load_lora_A took 11.628389358520508 ms to run.
Function load_lora_B took 11.563301086425781 ms to run.
cost realload: 23.628711700439453
Function load_adapters took 23.653030395507812 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 12 in total
Function load_lora_A took 11.6119384765625 ms to run.
Function load_lora_B took 11.506319046020508 ms to run.
cost realload: 23.58388900756836
Function load_adapters took 23.60987663269043 ms to run.
cost offload scan: 0.095367431640625
offload 1 adapters, 11 remains
cost offload cat: 0.04315376281738281
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.12254714965820312
Function offload_adapters took 0.6444454193115234 ms to run.
cost load scan: 0.010013580322265625
load 2 adapters, 13 in total
Function load_lora_A took 11.577367782592773 ms to run.
Function load_lora_B took 11.483907699584961 ms to run.
Function load_lora_A took 11.673927307128906 ms to run.
Function load_lora_B took 11.606454849243164 ms to run.
cost realload: 47.07169532775879
Function load_adapters took 47.10888862609863 ms to run.
current batch size: 15INFO:     127.0.0.1:34376 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34382 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34386 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34400 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34414 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34422 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34426 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34436 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34444 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34448 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34454 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34462 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34470 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34474 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34484 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34496 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34508 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34524 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34538 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34542 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34544 - "POST /generate_stream HTTP/1.1" 200 OK
 token used ratio: 0.07756923076923077
Avg tokens(prompt+generate) throughput: 1375.178 tokens/s
Avg prompt tokens throughput:            714.102 tokens/s
Avg generate tokens throughput:          661.076 tokens/s
cost load scan: 0.013589859008789062
load 2 adapters, 15 in total
Function load_lora_A took 11.54017448425293 ms to run.
Function load_lora_B took 11.492729187011719 ms to run.
Function load_lora_A took 11.632919311523438 ms to run.
Function load_lora_B took 11.523962020874023 ms to run.
cost realload: 46.75626754760742
Function load_adapters took 46.78082466125488 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 15 in total
cost realload: 0.3192424774169922
Function load_adapters took 0.3445148468017578 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 16 in total
Function load_lora_A took 11.631011962890625 ms to run.
Function load_lora_B took 11.587142944335938 ms to run.
cost realload: 23.778915405273438
Function load_adapters took 23.808717727661133 ms to run.
offload 0 adapters, 16 remains
Function offload_adapters took 0.016689300537109375 ms to run.
cost load scan: 0.013828277587890625
load 2 adapters, 18 in total
Function load_lora_A took 11.635065078735352 ms to run.
Function load_lora_B took 11.576414108276367 ms to run.
Function load_lora_A took 11.621952056884766 ms to run.
Function load_lora_B took 11.535167694091797 ms to run.
cost realload: 46.918392181396484
Function load_adapters took 46.94342613220215 ms to run.
current batch size: 21 token used ratio: 0.10744615384615384
cost load scan: 0.013828277587890625
load 1 adapters, 19 in total
Function load_lora_A took 11.637210845947266 ms to run.
Function load_lora_B took 11.563301086425781 ms to run.
cost realload: 23.646831512451172
Function load_adapters took 23.66924285888672 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.013828277587890625 ms to run.
cost load scan: 0.016450881958007812
load 2 adapters, 21 in total
Function load_lora_A took 11.620283126831055 ms to run.
Function load_lora_B took 11.522293090820312 ms to run.
Function load_lora_A took 11.63792610168457 ms to run.
Function load_lora_B took 11.54470443725586 ms to run.
cost realload: 46.86713218688965
Function load_adapters took 46.8897819519043 ms to run.
cost offload scan: 0.09512901306152344
offload 1 adapters, 20 remains
cost offload cat: 0.04267692565917969
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.13113021850585938
Function offload_adapters took 0.6656646728515625 ms to run.
cost offload scan: 0.10061264038085938
offload 1 adapters, 19 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.6213188171386719 ms to run.
cost load scan: 0.0152587890625
load 1 adapters, 20 in total
Function load_lora_A took 11.623382568359375 ms to run.
Function load_lora_B took 11.54470443725586 ms to run.
cost realload: 23.624181747436523
Function load_adapters took 23.64802360534668 ms to run.
cost offload scan: 0.0972747802734375
offload 1 adapters, 19 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.6165504455566406 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 19 in total
cost realload: 0.3123283386230469
Function load_adapters took 0.33736228942871094 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost load scan: 0.012159347534179688
load 1 adapters, 20 in total
Function load_lora_A took 11.540651321411133 ms to run.
Function load_lora_B took 11.475086212158203 ms to run.
cost realload: 23.46324920654297
Function load_adapters took 23.48637580871582 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 19 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.05173683166503906
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11467933654785156
Function offload_adapters took 0.6153583526611328 ms to run.
current batch size: 24 token used ratio: 0.11353846153846153
offload 0 adapters, 19 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.014066696166992188
load 1 adapters, 20 in total
Function load_lora_A took 11.63172721862793 ms to run.
Function load_lora_B took 11.527776718139648 ms to run.
cost realload: 23.587703704833984
Function load_adapters took 23.610591888427734 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 21 in total
Function load_lora_A took 11.61336898803711 ms to run.
Function load_lora_B took 11.532068252563477 ms to run.
cost realload: 23.59175682067871
Function load_adapters took 23.616790771484375 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 22 in total
Function load_lora_A took 11.61503791809082 ms to run.
Function load_lora_B took 11.55233383178711 ms to run.
cost realload: 23.60677719116211
Function load_adapters took 23.62966537475586 ms to run.
cost offload scan: 0.0972747802734375
offload 1 adapters, 21 remains
cost offload cat: 0.041961669921875
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.6341934204101562 ms to run.
current batch size: 25 token used ratio: 0.13346153846153846
cost offload scan: 0.091552734375
offload 1 adapters, 20 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11205673217773438
Function offload_adapters took 0.6077289581298828 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 19 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11205673217773438
Function offload_adapters took 0.6055831909179688 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 18 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.6113052368164062 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 19 in total
Function load_lora_A took 11.580944061279297 ms to run.
Function load_lora_B took 11.503934860229492 ms to run.
cost realload: 23.528575897216797
Function load_adapters took 23.550748825073242 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 18 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11754035949707031
Function offload_adapters took 0.6048679351806641 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 17 remains
cost offload cat: 0.03695487976074219
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.030040740966796875
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.6072521209716797 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 17 in total
cost realload: 0.3173351287841797
Function load_adapters took 0.3421306610107422 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 16 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11897087097167969
Function offload_adapters took 0.6098747253417969 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 16 in total
cost realload: 0.3123283386230469
Function load_adapters took 0.33664703369140625 ms to run.
