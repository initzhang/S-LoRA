You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama_fast.LlamaTokenizerFast'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565 - if you loaded a llama tokenizer from a GGUF file you can ignore this message.
For some LLaMA-based models, initializing the fast tokenizer may take a long time. To eliminate the initialization time, consider using 'hf-internal-testing/llama-tokenizer' instead of the original tokenizer.
You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama_fast.LlamaTokenizerFast'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565 - if you loaded a llama tokenizer from a GGUF file you can ignore this message.
load model llama-7b:   0%|          | 0/32 [00:00<?, ?it/s]load model llama-7b: 100%|██████████| 32/32 [00:00<00:00, 740.94it/s]
load adapters:   0%|          | 0/2 [00:00<?, ?it/s]load adapters: 100%|██████████| 2/2 [00:00<00:00, 25.67it/s]
Fetching 9 files:   0%|          | 0/9 [00:00<?, ?it/s]Fetching 9 files: 100%|██████████| 9/9 [00:00<00:00, 99600.89it/s]
INFO:     Started server process [927635]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://127.0.0.1:8089 (Press CTRL+C to quit)
llama-7b: 12.06 GB
peak working mem for (bs=20, seqlen=512): 0.70 GB
peak working mem for (bs=100, seqlen=512): 3.52 GB
all adapters (2) estimated size: 0.03 GB
avg adapter estimated size: 16.00 MB
INFO:     127.0.0.1:35416 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35422 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35438 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35440 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35446 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35456 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35464 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35474 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41746 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41750 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41764 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41778 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41784 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41794 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41800 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41802 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41816 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58730 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58734 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58738 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58740 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58754 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58764 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58770 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58778 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58786 - "POST /generate_stream HTTP/1.1" 200 OK
cost load scan: 0.010013580322265625
load 1 adapters, 1 in total
Function load_lora_A took 1.3246536254882812 ms to run.
Function load_lora_B took 1.2624263763427734 ms to run.
cost realload: 6.531953811645508
Function load_adapters took 6.557464599609375 ms to run.
Avg tokens(prompt+generate) throughput:    6.277 tokens/s
Avg prompt tokens throughput:              6.277 tokens/s
Avg generate tokens throughput:            0.000 tokens/s
cost load scan: 0.012874603271484375
load 0 adapters, 1 in total
cost realload: 0.335693359375
Function load_adapters took 0.3707408905029297 ms to run.
current batch size: 2 token used ratio: 0.004725
cost load scan: 0.013589859008789062
load 0 adapters, 1 in total
cost realload: 0.3952980041503906
Function load_adapters took 0.42700767517089844 ms to run.
cost load scan: 0.011444091796875
load 0 adapters, 1 in total
cost realload: 0.4055500030517578
Function load_adapters took 0.4334449768066406 ms to run.
current batch size: 4 token used ratio: 0.009683333333333334
cost load scan: 0.009059906005859375
load 0 adapters, 1 in total
cost realload: 0.3452301025390625
Function load_adapters took 0.37479400634765625 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 1 in total
cost realload: 0.2932548522949219
Function load_adapters took 0.31948089599609375 ms to run.
current batch size: 6 token used ratio: 0.016083333333333335
cost load scan: 0.008344650268554688
load 0 adapters, 1 in total
cost realload: 0.308990478515625
Function load_adapters took 0.3361701965332031 ms to run.
current batch size: 7 token used ratio: 0.020633333333333333
offload 0 adapters, 1 remains
Function offload_adapters took 0.01430511474609375 ms to run.
current batch size: 6 token used ratio: 0.019408333333333333
offload 0 adapters, 1 remains
Function offload_adapters took 0.013828277587890625 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.014066696166992188 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.0133514404296875 ms to run.
current batch size: 3 token used ratio: 0.010216666666666667
cost load scan: 0.00858306884765625
load 0 adapters, 1 in total
cost realload: 0.3228187561035156
Function load_adapters took 0.3495216369628906 ms to run.
current batch size: 4 token used ratio: 0.013791666666666667
offload 0 adapters, 1 remains
Function offload_adapters took 0.013589859008789062 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.01430511474609375 ms to run.
current batch size: 2 token used ratio: 0.006525
offload 0 adapters, 1 remains
Function offload_adapters took 0.013828277587890625 ms to run.
cost load scan: 0.008821487426757812
load 0 adapters, 1 in total
cost realload: 0.31948089599609375
Function load_adapters took 0.34809112548828125 ms to run.
current batch size: 2 token used ratio: 0.00565
current batch size: 2 token used ratio: 0.006483333333333333
Avg tokens(prompt+generate) throughput:  380.128 tokens/s
Avg prompt tokens throughput:            197.850 tokens/s
Avg generate tokens throughput:          182.278 tokens/s
cost load scan: 0.00858306884765625
load 0 adapters, 1 in total
cost realload: 0.32806396484375
Function load_adapters took 0.3561973571777344 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 1 in total
cost realload: 0.3058910369873047
Function load_adapters took 0.3325939178466797 ms to run.
cost load scan: 0.00858306884765625
load 0 adapters, 1 in total
cost realload: 0.2853870391845703
Function load_adapters took 0.3108978271484375 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.01621246337890625 ms to run.
current batch size: 4 token used ratio: 0.0095
cost load scan: 0.008106231689453125
load 0 adapters, 1 in total
cost realload: 0.2906322479248047
Function load_adapters took 0.3159046173095703 ms to run.
cost load scan: 0.009298324584960938
load 0 adapters, 1 in total
cost realload: 0.3056526184082031
Function load_adapters took 0.331878662109375 ms to run.
current batch size: 6 token used ratio: 0.015625
cost load scan: 0.008344650268554688
load 0 adapters, 1 in total
cost realload: 0.3001689910888672
Function load_adapters took 0.3273487091064453 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.019311904907226562 ms to run.
current batch size: 6 token used ratio: 0.016383333333333333
cost load scan: 0.008106231689453125
load 0 adapters, 1 in total
cost realload: 0.33402442932128906
Function load_adapters took 0.36144256591796875 ms to run.
current batch size: 7 token used ratio: 0.020775
cost load scan: 0.008106231689453125
load 0 adapters, 1 in total
cost realload: 0.2894401550292969
Function load_adapters took 0.3142356872558594 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.0133514404296875 ms to run.
current batch size: 7 token used ratio: 0.022583333333333334
offload 0 adapters, 1 remains
Function offload_adapters took 0.012874603271484375 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.0133514404296875 ms to run.
current batch size: 5 token used ratio: 0.017325
offload 0 adapters, 1 remains
Function offload_adapters took 0.012636184692382812 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.01239776611328125 ms to run.
current batch size: 3 token used ratio: 0.010766666666666667
offload 0 adapters, 1 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 1 in total
cost realload: 0.31304359436035156
Function load_adapters took 0.3383159637451172 ms to run.
cost load scan: 0.00858306884765625
load 0 adapters, 1 in total
cost realload: 0.30231475830078125
Function load_adapters took 0.32830238342285156 ms to run.
current batch size: 4 token used ratio: 0.011916666666666667
offload 0 adapters, 1 remains
Function offload_adapters took 0.0133514404296875 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.01430511474609375 ms to run.
current batch size: 2 token used ratio: 0.005233333333333334
Avg tokens(prompt+generate) throughput:  462.914 tokens/s
Avg prompt tokens throughput:            243.302 tokens/s
Avg generate tokens throughput:          219.612 tokens/s
cost load scan: 0.009059906005859375
load 0 adapters, 1 in total
cost realload: 0.32401084899902344
Function load_adapters took 0.3514289855957031 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 1 in total
cost realload: 0.286102294921875
Function load_adapters took 0.3108978271484375 ms to run.
current batch size: 4 token used ratio: 0.010666666666666666
cost load scan: 0.008821487426757812
load 0 adapters, 1 in total
cost realload: 0.3046989440917969
Function load_adapters took 0.3349781036376953 ms to run.
current batch size: 5 token used ratio: 0.014733333333333333
cost load scan: 0.007867813110351562
load 0 adapters, 1 in total
cost realload: 0.3426074981689453
Function load_adapters took 0.3705024719238281 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 1 in total
cost realload: 0.2853870391845703
Function load_adapters took 0.3104209899902344 ms to run.
current batch size: 7 token used ratio: 0.021266666666666666
cost load scan: 0.007867813110351562
load 0 adapters, 1 in total
cost realload: 0.286102294921875
Function load_adapters took 0.3104209899902344 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.016927719116210938 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.012874603271484375 ms to run.
current batch size: 6 token used ratio: 0.01785
current batch size: 6 token used ratio: 0.02035
offload 0 adapters, 1 remains
Function offload_adapters took 0.013828277587890625 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.012874603271484375 ms to run.
current batch size: 4 token used ratio: 0.014116666666666666
cost load scan: 0.00858306884765625
load 0 adapters, 1 in total
cost realload: 0.32711029052734375
Function load_adapters took 0.35309791564941406 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.012874603271484375 ms to run.
current batch size: 4 INFO:     127.0.0.1:40658 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40670 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40678 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40688 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40698 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40710 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40716 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40720 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40726 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40728 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40730 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40744 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40754 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40764 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40768 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40784 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34738 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34752 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34760 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34768 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34776 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34782 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34790 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34792 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34794 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34798 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34804 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34810 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34812 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34826 - "POST /generate_stream HTTP/1.1" 200 OK
token used ratio: 0.0136
offload 0 adapters, 1 remains
Function offload_adapters took 0.0133514404296875 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 1 in total
cost realload: 0.301361083984375
Function load_adapters took 0.3266334533691406 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 1 in total
cost realload: 0.27823448181152344
Function load_adapters took 0.3032684326171875 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 1 in total
cost realload: 0.29969215393066406
Function load_adapters took 0.32448768615722656 ms to run.
current batch size: 5 token used ratio: 0.01255
offload 0 adapters, 1 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 1 in total
cost realload: 0.29087066650390625
Function load_adapters took 0.3154277801513672 ms to run.
current batch size: 5 token used ratio: 0.01295
cost load scan: 0.008106231689453125
load 0 adapters, 1 in total
cost realload: 0.31256675720214844
Function load_adapters took 0.3387928009033203 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 1 in total
cost realload: 0.2865791320800781
Function load_adapters took 0.31185150146484375 ms to run.
current batch size: 7 token used ratio: 0.018925
Avg tokens(prompt+generate) throughput:  555.757 tokens/s
Avg prompt tokens throughput:            317.875 tokens/s
Avg generate tokens throughput:          237.882 tokens/s
cost load scan: 0.008106231689453125
load 0 adapters, 1 in total
cost realload: 0.2930164337158203
Function load_adapters took 0.31757354736328125 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 1 in total
cost realload: 0.2818107604980469
Function load_adapters took 0.30612945556640625 ms to run.
cost load scan: 0.008821487426757812
load 0 adapters, 1 in total
cost realload: 0.2918243408203125
Function load_adapters took 0.3180503845214844 ms to run.
current batch size: 10 token used ratio: 0.028533333333333334
offload 0 adapters, 1 remains
Function offload_adapters took 0.014781951904296875 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.015974044799804688 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 1 in total
cost realload: 0.2989768981933594
Function load_adapters took 0.3261566162109375 ms to run.
current batch size: 9 token used ratio: 0.026475
cost load scan: 0.008106231689453125
load 0 adapters, 1 in total
cost realload: 0.293731689453125
Function load_adapters took 0.31828880310058594 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.012874603271484375 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.013113021850585938 ms to run.
current batch size: 8 token used ratio: 0.024275
offload 0 adapters, 1 remains
Function offload_adapters took 0.0133514404296875 ms to run.
current batch size: 7 token used ratio: 0.022991666666666667
offload 0 adapters, 1 remains
Function offload_adapters took 0.0133514404296875 ms to run.
cost load scan: 0.00858306884765625
load 0 adapters, 1 in total
cost realload: 0.31876564025878906
Function load_adapters took 0.3447532653808594 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.013589859008789062 ms to run.
cost load scan: 0.008821487426757812
load 0 adapters, 1 in total
cost realload: 0.30684471130371094
Function load_adapters took 0.3325939178466797 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.013113021850585938 ms to run.
current batch size: 6 token used ratio: 0.018325
offload 0 adapters, 1 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.00858306884765625
load 0 adapters, 1 in total
cost realload: 0.27632713317871094
Function load_adapters took 0.3008842468261719 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 1 in total
cost realload: 0.27871131896972656
Function load_adapters took 0.3037452697753906 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 1 in total
cost realload: 0.28228759765625
Function load_adapters took 0.3070831298828125 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.012636184692382812 ms to run.
current batch size: 7 token used ratio: 0.01905
offload 0 adapters, 1 remains
Function offload_adapters took 0.012636184692382812 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.012636184692382812 ms to run.
current batch size: 5 token used ratio: 0.01435
cost load scan: 0.008344650268554688
load 0 adapters, 1 in total
cost realload: 0.3256797790527344
Function load_adapters took 0.3521442413330078 ms to run.
current batch size: 6 token used ratio: 0.018666666666666668
cost load scan: 0.008106231689453125
load 0 adapters, 1 in total
cost realload: 0.31638145446777344
Function load_adapters took 0.3428459167480469 ms to run.
current batch size: 7 token used ratio: 0.023091666666666667
offload 0 adapters, 1 remains
Function offload_adapters took 0.0133514404296875 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.012636184692382812 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 1 in total
cost realload: 0.29540061950683594
Function load_adapters took 0.3211498260498047 ms to run.
Avg tokens(prompt+generate) throughput:  643.521 tokens/s
Avg prompt tokens throughput:            316.023 tokens/s
Avg generate tokens throughput:          327.498 tokens/s
offload 0 adapters, 1 remains
Function offload_adapters took 0.01239776611328125 ms to run.
current batch size: 4 token used ratio: 0.011666666666666667
offload 0 adapters, 1 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 1 in total
cost realload: 0.30422210693359375
Function load_adapters took 0.3299713134765625 ms to run.
current batch size: 4 token used ratio: 0.011383333333333334
cost load scan: 0.008106231689453125
load 0 adapters, 1 in total
cost realload: 0.29969215393066406
Function load_adapters took 0.32520294189453125 ms to run.
current batch size: 5 token used ratio: 0.01565
cost load scan: 0.00858306884765625
load 0 adapters, 1 in total
cost realload: 0.31065940856933594
Function load_adapters took 0.33593177795410156 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 1 in total
cost realload: 0.29087066650390625
Function load_adapters took 0.31566619873046875 ms to run.
current batch size: 7 token used ratio: 0.021975
offload 0 adapters, 1 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 1 in total
cost realload: 0.28824806213378906
Function load_adapters took 0.31280517578125 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.01621246337890625 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 1 in total
cost realload: 0.29778480529785156
Function load_adapters took 0.3228187561035156 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 1 in total
cost realload: 0.2849102020263672
Function load_adapters took 0.3159046173095703 ms to run.
cost load scan: 0.009059906005859375
load 0 adapters, 1 in total
cost realload: 0.29730796813964844
Function load_adapters took 0.3237724304199219 ms to run.
current batch size: 9 token used ratio: 0.024958333333333332
cost load scan: 0.00762939453125
load 0 adapters, 1 in total
cost realload: 0.2930164337158203
Function load_adapters took 0.316619873046875 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 1 in total
cost realload: 0.3066062927246094
Function load_adapters took 0.3323554992675781 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.015974044799804688 ms to run.
current batch size: 11 token used ratio: 0.031041666666666665
offload 0 adapters, 1 remains
Function offload_adapters took 0.016927719116210938 ms to run.
offload 0 adapters, 1 remains
INFO:     127.0.0.1:37906 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37922 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37924 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37936 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37948 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37952 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37968 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37972 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37988 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59316 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59324 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59338 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59340 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59348 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59354 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59370 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59378 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59380 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45934 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45946 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45952 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45964 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45978 - "POST /generate_stream HTTP/1.1" 200 OK
Function offload_adapters took 0.01430511474609375 ms to run.
current batch size: 9 token used ratio: 0.0271
current batch size: 9 token used ratio: 0.03085
offload 0 adapters, 1 remains
Function offload_adapters took 0.01430511474609375 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.013589859008789062 ms to run.
current batch size: 6 token used ratio: 0.022491666666666667
cost load scan: 0.00858306884765625
load 0 adapters, 1 in total
cost realload: 0.32806396484375
Function load_adapters took 0.3552436828613281 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 1 in total
cost realload: 0.30541419982910156
Function load_adapters took 0.33283233642578125 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.012636184692382812 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.012874603271484375 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.012636184692382812 ms to run.
current batch size: 5 token used ratio: 0.01633333333333333
offload 0 adapters, 1 remains
Function offload_adapters took 0.013589859008789062 ms to run.
Avg tokens(prompt+generate) throughput:  682.928 tokens/s
Avg prompt tokens throughput:            352.643 tokens/s
Avg generate tokens throughput:          330.285 tokens/s
offload 0 adapters, 1 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.008821487426757812
load 0 adapters, 1 in total
cost realload: 0.30350685119628906
Function load_adapters took 0.3292560577392578 ms to run.
current batch size: 4 token used ratio: 0.011325
current batch size: 4 token used ratio: 0.012991666666666667
cost load scan: 0.008344650268554688
load 0 adapters, 1 in total
cost realload: 0.3204345703125
Function load_adapters took 0.3459453582763672 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 1 in total
cost realload: 0.3001689910888672
Function load_adapters took 0.3254413604736328 ms to run.
current batch size: 6 token used ratio: 0.018591666666666666
cost load scan: 0.007867813110351562
load 0 adapters, 1 in total
cost realload: 0.3039836883544922
Function load_adapters took 0.32901763916015625 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.01239776611328125 ms to run.
current batch size: 6 token used ratio: 0.01925
cost load scan: 0.008344650268554688
load 0 adapters, 1 in total
cost realload: 0.3046989440917969
Function load_adapters took 0.3299713134765625 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.0133514404296875 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 1 in total
cost realload: 0.29015541076660156
Function load_adapters took 0.3170967102050781 ms to run.
current batch size: 6 token used ratio: 0.016966666666666668
offload 0 adapters, 1 remains
Function offload_adapters took 0.01430511474609375 ms to run.
current batch size: 5 token used ratio: 0.014941666666666667
offload 0 adapters, 1 remains
Function offload_adapters took 0.014066696166992188 ms to run.
current batch size: 4 token used ratio: 0.013375
cost load scan: 0.008106231689453125
load 0 adapters, 1 in total
cost realload: 0.3001689910888672
Function load_adapters took 0.32591819763183594 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.013113021850585938 ms to run.
current batch size: 4 token used ratio: 0.01375
offload 0 adapters, 1 remains
Function offload_adapters took 0.013589859008789062 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.014543533325195312 ms to run.
current batch size: 2 token used ratio: 0.006925
cost load scan: 0.008106231689453125
load 0 adapters, 1 in total
cost realload: 0.30493736267089844
Function load_adapters took 0.33211708068847656 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.013828277587890625 ms to run.
cost load scan: 0.00858306884765625
load 0 adapters, 1 in total
cost realload: 0.29277801513671875
Function load_adapters took 0.3178119659423828 ms to run.
Avg tokens(prompt+generate) throughput:  440.682 tokens/s
Avg prompt tokens throughput:            220.191 tokens/s
Avg generate tokens throughput:          220.491 tokens/s
cost load scan: 0.008344650268554688
load 0 adapters, 1 in total
cost realload: 0.286102294921875
Function load_adapters took 0.31113624572753906 ms to run.
current batch size: 4 token used ratio: 0.010091666666666667
current batch size: 4 token used ratio: 0.011758333333333334
offload 0 adapters, 1 remains
Function offload_adapters took 0.014543533325195312 ms to run.
current batch size: 3 token used ratio: 0.009
cost load scan: 0.008344650268554688
load 0 adapters, 1 in total
cost realload: 0.30493736267089844
Function load_adapters took 0.3330707550048828 ms to run.
cost load scan: 0.009059906005859375
load 0 adapters, 1 in total
cost realload: 0.31280517578125
Function load_adapters took 0.339508056640625 ms to run.
current batch size: 5 token used ratio: 0.014975
cost load scan: 0.008344650268554688
load 0 adapters, 1 in total
cost realload: 0.3178119659423828
Function load_adapters took 0.34356117248535156 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.018835067749023438 ms to run.
current batch size: 5 token used ratio: 0.014983333333333333
offload 0 adapters, 1 remains
Function offload_adapters took 0.013113021850585938 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.013828277587890625 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 1 in total
cost realload: 0.29754638671875
Function load_adapters took 0.32329559326171875 ms to run.
current batch size: 4 token used ratio: 0.011091666666666666
cost load scan: 0.00858306884765625
load 0 adapters, 1 in total
cost realload: 0.3082752227783203
Function load_adapters took 0.3414154052734375 ms to run.
current batch size: 5 token used ratio: 0.014891666666666666
offload 0 adapters, 1 remains
Function offload_adapters took 0.013828277587890625 ms to run.
current batch size: 4 token used ratio: 0.012733333333333333
offload 0 adapters, 1 remains
Function offload_adapters took 0.014066696166992188 ms to run.
current batch size: 3 token used ratio: 0.010166666666666666
offload 0 adapters, 1 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost load scan: 0.00858306884765625
load 0 adapters, 1 in total
cost realload: 0.3418922424316406
Function load_adapters took 0.3688335418701172 ms to run.
current batch size: 3 token used ratio: 0.009808333333333334
Avg tokens(prompt+generate) throughput:  358.992 tokens/s
Avg prompt tokens throughput:            174.105 tokens/s
Avg generate tokens throughput:          184.887 tokens/s
offload 0 adapters, 1 remains
Function offload_adapters took 0.013828277587890625 ms to run.
current batch size: 2 token used ratio: 0.00685
offload 0 adapters, 1 remains
Function offload_adapters took 0.0133514404296875 ms to run.
current batch size: 1 token used ratio: 0.0034416666666666667
cost load scan: 0.00858306884765625
load 0 adapters, 1 in total
cost realload: 0.31185150146484375
Function load_adapters took 0.3376007080078125 ms to run.
current batch size: 2 token used ratio: 0.00585
current batch size: 2 token used ratio: 0.006683333333333334
cost load scan: 0.008344650268554688
load 0 adapters, 1 in total
cost realload: 0.31280517578125
Function load_adapters took 0.3402233123779297 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.012874603271484375 ms to run.
current batch size: 2 token used ratio: 0.004925
cost load scan: 0.007867813110351562
load 0 adapters, 1 in total
cost realload: 0.31876564025878906
Function load_adapters took 0.3445148468017578 ms to run.
current batch size: 3 token used ratio: 0.008233333333333334
cost load scan: 0.008106231689453125
load 0 adapters, 1 in total
cost realload: 0.3132820129394531
Function load_adapters took 0.3387928009033203 ms to run.
current batch size: 4 token used ratio: 0.012
offload 0 adapters, 1 remains
INFO:     127.0.0.1:54756 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54770 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54782 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54784 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54792 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54806 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54820 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54832 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54846 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54848 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54860 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34206 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34222 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34238 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34246 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34254 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34270 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34286 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34300 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34312 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34320 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34326 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34342 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56886 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56900 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56908 - "POST /generate_stream HTTP/1.1" 200 OK
Function offload_adapters took 0.013113021850585938 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 1 in total
cost realload: 0.3135204315185547
Function load_adapters took 0.33926963806152344 ms to run.
current batch size: 4 token used ratio: 0.011766666666666667
offload 0 adapters, 1 remains
Function offload_adapters took 0.0133514404296875 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 1 in total
cost realload: 0.3063678741455078
Function load_adapters took 0.3325939178466797 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 1 in total
cost realload: 0.28324127197265625
Function load_adapters took 0.3085136413574219 ms to run.
current batch size: 5 token used ratio: 0.013675
current batch size: 5 token used ratio: 0.015758333333333333
Avg tokens(prompt+generate) throughput:  301.963 tokens/s
Avg prompt tokens throughput:            166.604 tokens/s
Avg generate tokens throughput:          135.359 tokens/s
offload 0 adapters, 1 remains
Function offload_adapters took 0.0133514404296875 ms to run.
cost load scan: 0.009298324584960938
load 0 adapters, 1 in total
cost realload: 0.30684471130371094
Function load_adapters took 0.3325939178466797 ms to run.
current batch size: 5 token used ratio: 0.015566666666666666
offload 0 adapters, 1 remains
Function offload_adapters took 0.014543533325195312 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 1 in total
cost realload: 0.3094673156738281
Function load_adapters took 0.3349781036376953 ms to run.
current batch size: 5 token used ratio: 0.014766666666666668
offload 0 adapters, 1 remains
Function offload_adapters took 0.013589859008789062 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 1 in total
cost realload: 0.308990478515625
Function load_adapters took 0.3376007080078125 ms to run.
current batch size: 5 token used ratio: 0.014416666666666666
offload 0 adapters, 1 remains
Function offload_adapters took 0.013828277587890625 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.0133514404296875 ms to run.
current batch size: 3 token used ratio: 0.00835
cost load scan: 0.008106231689453125
load 0 adapters, 1 in total
cost realload: 0.3161430358886719
Function load_adapters took 0.34928321838378906 ms to run.
current batch size: 4 token used ratio: 0.012175
offload 0 adapters, 1 remains
Function offload_adapters took 0.013828277587890625 ms to run.
cost load scan: 0.009298324584960938
load 0 adapters, 1 in total
cost realload: 0.3006458282470703
Function load_adapters took 0.3261566162109375 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 1 in total
cost realload: 0.2894401550292969
Function load_adapters took 0.31447410583496094 ms to run.
current batch size: 5 token used ratio: 0.013533333333333333
cost load scan: 0.00858306884765625
load 0 adapters, 1 in total
cost realload: 0.2994537353515625
Function load_adapters took 0.3254413604736328 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 1 in total
cost realload: 0.2944469451904297
Function load_adapters took 0.3209114074707031 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.016450881958007812 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 1 in total
cost realload: 0.29468536376953125
Function load_adapters took 0.3192424774169922 ms to run.
current batch size: 7 token used ratio: 0.017966666666666666
cost load scan: 0.008106231689453125
load 0 adapters, 1 in total
cost realload: 0.2875328063964844
Function load_adapters took 0.31304359436035156 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.013589859008789062 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 1 in total
cost realload: 0.29921531677246094
Function load_adapters took 0.324249267578125 ms to run.
current batch size: 8 token used ratio: 0.021675
cost load scan: 0.008344650268554688
load 0 adapters, 1 in total
cost realload: 0.2956390380859375
Function load_adapters took 0.32138824462890625 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.019073486328125 ms to run.
current batch size: 8 token used ratio: 0.023058333333333333
cost load scan: 0.008344650268554688
load 0 adapters, 1 in total
cost realload: 0.3132820129394531
Function load_adapters took 0.339508056640625 ms to run.
Avg tokens(prompt+generate) throughput:  558.055 tokens/s
Avg prompt tokens throughput:            303.341 tokens/s
Avg generate tokens throughput:          254.714 tokens/s
cost load scan: 0.009059906005859375
load 0 adapters, 1 in total
cost realload: 0.29921531677246094
Function load_adapters took 0.3249645233154297 ms to run.
current batch size: 10 token used ratio: 0.030391666666666668
offload 0 adapters, 1 remains
Function offload_adapters took 0.013828277587890625 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 1 in total
cost realload: 0.2961158752441406
Function load_adapters took 0.3216266632080078 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.012874603271484375 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.01239776611328125 ms to run.
current batch size: 7 token used ratio: 0.020975
cost load scan: 0.00858306884765625
load 0 adapters, 1 in total
cost realload: 0.2989768981933594
Function load_adapters took 0.32401084899902344 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.009059906005859375
load 0 adapters, 1 in total
cost realload: 0.33783912658691406
Function load_adapters took 0.36454200744628906 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.013589859008789062 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 1 in total
cost realload: 0.28514862060546875
Function load_adapters took 0.3108978271484375 ms to run.
current batch size: 8 token used ratio: 0.022166666666666668
offload 0 adapters, 1 remains
Function offload_adapters took 0.012874603271484375 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.012636184692382812 ms to run.
current batch size: 6 token used ratio: 0.017441666666666668
cost load scan: 0.007867813110351562
load 0 adapters, 1 in total
cost realload: 0.30994415283203125
Function load_adapters took 0.33473968505859375 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 1 in total
cost realload: 0.2899169921875
Function load_adapters took 0.3161430358886719 ms to run.
current batch size: 8 token used ratio: 0.02445
offload 0 adapters, 1 remains
Function offload_adapters took 0.012636184692382812 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.013589859008789062 ms to run.
current batch size: 6 token used ratio: 0.019583333333333335
offload 0 adapters, 1 remains
Function offload_adapters took 0.014066696166992188 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.012636184692382812 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.012636184692382812 ms to run.
current batch size: 3 token used ratio: 0.0098
cost load scan: 0.008106231689453125
load 0 adapters, 1 in total
cost realload: 0.3039836883544922
Function load_adapters took 0.32901763916015625 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 1 in total
cost realload: 0.2894401550292969
Function load_adapters took 0.31447410583496094 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 1 in total
cost realload: 0.2949237823486328
Function load_adapters took 0.3190040588378906 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.012874603271484375 ms to run.
current batch size: 5 token used ratio: 0.013941666666666666
current batch size: 5 token used ratio: 0.016025
offload 0 adapters, 1 remains
Function offload_adapters took 0.013589859008789062 ms to run.
offload 0 adapters, 1 remains
Function offload_adapters took 0.014066696166992188 ms to run.
current batch size: 3 token used ratio: 0.009383333333333334
INFO:     127.0.0.1:56918 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56924 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56930 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56940 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56942 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56950 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56960 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56974 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56122 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56134 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56146 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56158 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56162 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56168 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56180 - "POST /generate_stream HTTP/1.1" 200 OK
