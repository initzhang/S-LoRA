For some LLaMA-based models, initializing the fast tokenizer may take a long time. To eliminate the initialization time, consider using 'hf-internal-testing/llama-tokenizer' instead of the original tokenizer.
llama-13b: 23.63 GB
peak working mem for (bs=20, seqlen=512): 0.88 GB
peak working mem for (bs=100, seqlen=512): 4.39 GB
all adapters (102) estimated size: 11.62 GB
avg adapter estimated size: 116.67 MB
INFO:     127.0.0.1:46288 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45744 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45746 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45762 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45766 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45768 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45780 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45786 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45790 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45794 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45808 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45810 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45826 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45838 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45846 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45852 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45866 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53026 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53038 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53040 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53044 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53046 - "POST /generate_stream HTTP/1.1" 200 OK
cost load scan: 0.009775161743164062
load 1 adapters, 1 in total
Function load_lora_A took 5.0640106201171875 ms to run.
Function load_lora_B took 4.959344863891602 ms to run.
cost realload: 20.962238311767578
Function load_adapters took 20.99013328552246 ms to run.
Avg tokens(prompt+generate) throughput:    3.588 tokens/s
Avg prompt tokens throughput:              3.588 tokens/s
Avg generate tokens throughput:            0.000 tokens/s
cost load scan: 0.01049041748046875
load 1 adapters, 2 in total
Function load_lora_A took 2.789020538330078 ms to run.
Function load_lora_B took 2.8166770935058594 ms to run.
cost realload: 6.308078765869141
Function load_adapters took 6.333351135253906 ms to run.
cost load scan: 0.010013580322265625
load 1 adapters, 3 in total
Function load_lora_A took 4.949808120727539 ms to run.
Function load_lora_B took 4.954814910888672 ms to run.
cost realload: 10.404586791992188
Function load_adapters took 10.429859161376953 ms to run.
current batch size: 3 token used ratio: 0.015984615384615385
cost load scan: 0.010251998901367188
load 1 adapters, 4 in total
Function load_lora_A took 2.8083324432373047 ms to run.
Function load_lora_B took 2.741098403930664 ms to run.
cost realload: 6.060600280761719
Function load_adapters took 6.084918975830078 ms to run.
cost load scan: 0.009775161743164062
load 1 adapters, 5 in total
Function load_lora_A took 9.315013885498047 ms to run.
Function load_lora_B took 9.279012680053711 ms to run.
cost realload: 19.09923553466797
Function load_adapters took 19.124269485473633 ms to run.
cost load scan: 0.009298324584960938
load 0 adapters, 5 in total
cost realload: 0.3960132598876953
Function load_adapters took 0.42319297790527344 ms to run.
cost load scan: 0.009775161743164062
load 1 adapters, 6 in total
Function load_lora_A took 2.821207046508789 ms to run.
Function load_lora_B took 2.8002262115478516 ms to run.
cost realload: 6.119489669799805
Function load_adapters took 6.142139434814453 ms to run.
current batch size: 7 token used ratio: 0.04129230769230769
cost load scan: 0.0095367431640625
load 1 adapters, 7 in total
Function load_lora_A took 2.797365188598633 ms to run.
Function load_lora_B took 2.7663707733154297 ms to run.
cost realload: 6.074428558349609
Function load_adapters took 6.098031997680664 ms to run.
current batch size: 8 token used ratio: 0.05067692307692308
cost load scan: 0.0095367431640625
load 1 adapters, 8 in total
Function load_lora_A took 9.314298629760742 ms to run.
Function load_lora_B took 9.231090545654297 ms to run.
cost realload: 19.08254623413086
Function load_adapters took 19.108057022094727 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 9 in total
Function load_lora_A took 4.877567291259766 ms to run.
Function load_lora_B took 4.933834075927734 ms to run.
cost realload: 10.323762893676758
Function load_adapters took 10.353565216064453 ms to run.
cost offload scan: 0.19168853759765625
offload 1 adapters, 8 remains
cost offload cat: 0.04458427429199219
cost offload free mem manager: 0.051975250244140625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 21.19755744934082
Function offload_adapters took 21.88730239868164 ms to run.
current batch size: 9 token used ratio: 0.05656923076923077
offload 0 adapters, 8 remains
Function offload_adapters took 0.015735626220703125 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 9 in total
Function load_lora_A took 2.838134765625 ms to run.
Function load_lora_B took 2.7954578399658203 ms to run.
cost realload: 6.122589111328125
Function load_adapters took 6.147623062133789 ms to run.
cost load scan: 0.009775161743164062
load 1 adapters, 10 in total
Function load_lora_A took 9.332656860351562 ms to run.
Function load_lora_B took 9.28640365600586 ms to run.
cost realload: 19.103288650512695
Function load_adapters took 19.132614135742188 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 11 in total
Function load_lora_A took 2.8145313262939453 ms to run.
Function load_lora_B took 2.7735233306884766 ms to run.
cost realload: 6.03795051574707
Function load_adapters took 6.06083869934082 ms to run.
current batch size: 11 token used ratio: 0.0684
cost load scan: 0.009775161743164062
load 1 adapters, 12 in total
Function load_lora_A took 9.27424430847168 ms to run.
Function load_lora_B took 9.215593338012695 ms to run.
cost realload: 18.96190643310547
Function load_adapters took 18.98503303527832 ms to run.
cost offload scan: 0.21719932556152344
offload 1 adapters, 11 remains
cost offload cat: 0.04792213439941406
cost offload free mem manager: 0.04744529724121094
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11706352233886719
Function offload_adapters took 0.7796287536621094 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 12 in total
Function load_lora_A took 9.335994720458984 ms to run.
Function load_lora_B took 9.293794631958008 ms to run.
cost realload: 19.06275749206543
Function load_adapters took 19.08421516418457 ms to run.
cost load scan: 0.009775161743164062
load 1 adapters, 13 in total
Function load_lora_A took 9.323835372924805 ms to run.
Function load_lora_B took 9.221076965332031 ms to run.
cost realload: 19.010305404663086
Function load_adapters took 19.035816192626953 ms to run.
current batch size: 14 token used ratio: 0.0858
cost offload scan: 0.1842975616455078
offload 1 adapters, 12 remains
cost offload cat: 0.046253204345703125
cost offload free mem manager: 0.04935264587402344
cost offload torch.empty: 0.0247955322265625
cost offload a_loc update: 0.11968612670898438
Function offload_adapters took 0.7658004760742188 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 13 in total
Function load_lora_A took 4.8999786376953125 ms to run.
Function load_lora_B took 4.949331283569336 ms to run.
cost realload: 10.292768478393555
Function load_adapters took 10.315656661987305 ms to run.
cost load scan: 0.011205673217773438
load 2 adapters, 15 in total
Function load_lora_A took 2.8204917907714844 ms to run.
Function load_lora_B took 2.744436264038086 ms to run.
Function load_lora_A took 4.957675933837891 ms to run.
Function load_lora_B took 4.937410354614258 ms to run.
cost realload: 16.009807586669922
Function load_adapters took 16.032934188842773 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 14 remains
cost offload cat: 0.043392181396484375
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.12636184692382812
Function offload_adapters took 0.6427764892578125 ms to run.
Avg tokens(prompt+generate) throughput:  782.734 tokens/s
Avg prompt tokens throughput:            545.145 tokens/s
Avg generate tokens throughput:          237.589 tokens/s
cost offload scan: 0.09179115295410156
offload 1 adapters, 13 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11515617370605469
Function offload_adapters took 0.6146430969238281 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 12 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.6105899810791016 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 13 in total
Function load_lora_A took 4.9839019775390625 ms to run.
Function load_lora_B took 4.923820495605469 ms to run.
cost realload: 10.354042053222656
Function load_adapters took 10.377645492553711 ms to run.
cost load scan: 0.017642974853515625
load 1 adapters, 14 in total
Function load_lora_A took 5.019187927246094 ms to run.
Function load_lora_B took 4.907369613647461 ms to run.
cost realload: 10.47062873840332
Function load_adapters took 10.499238967895508 ms to run.
cost offload scan: 0.09655952453613281
offload 1 adapters, 13 remains
cost offload cat: 0.0476837158203125
cost offload free mem manager: 0.06341934204101562
cost offload torch.empty: 0.02384185791015625
INFO:     127.0.0.1:53058 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53062 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53072 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53088 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53104 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53112 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53124 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33338 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33350 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload a_loc update: 0.12230873107910156
Function offload_adapters took 0.7610321044921875 ms to run.
current batch size: 14 token used ratio: 0.07547692307692308
cost offload scan: 0.09608268737792969
offload 1 adapters, 12 remains
cost offload cat: 0.04291534423828125
cost offload free mem manager: 0.04863739013671875
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.12540817260742188
Function offload_adapters took 0.659942626953125 ms to run.
cost offload scan: 0.095367431640625
offload 1 adapters, 11 remains
cost offload cat: 0.039577484130859375
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.6165504455566406 ms to run.
cost offload scan: 0.10538101196289062
offload 1 adapters, 10 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.6041526794433594 ms to run.
cost load scan: 0.01811981201171875
load 1 adapters, 11 in total
Function load_lora_A took 9.294509887695312 ms to run.
Function load_lora_B took 9.282112121582031 ms to run.
cost realload: 19.020795822143555
Function load_adapters took 19.041776657104492 ms to run.
current batch size: 13 token used ratio: 0.07324615384615385
cost offload scan: 0.09369850158691406
offload 1 adapters, 10 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.5924701690673828 ms to run.
cost load scan: 0.022649765014648438
load 1 adapters, 11 in total
Function load_lora_A took 9.336471557617188 ms to run.
Function load_lora_B took 9.260892868041992 ms to run.
cost realload: 19.045352935791016
Function load_adapters took 19.069671630859375 ms to run.
offload 0 adapters, 11 remains
Function offload_adapters took 0.01239776611328125 ms to run.
offload 0 adapters, 11 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.017881393432617188
load 1 adapters, 12 in total
Function load_lora_A took 9.347677230834961 ms to run.
Function load_lora_B took 9.244441986083984 ms to run.
cost realload: 19.018173217773438
Function load_adapters took 19.040584564208984 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 11 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11920928955078125
Function offload_adapters took 0.5936622619628906 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 10 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5655288696289062 ms to run.
current batch size: 10 token used ratio: 0.056584615384615386
cost load scan: 0.012159347534179688
load 1 adapters, 11 in total
Function load_lora_A took 5.012989044189453 ms to run.
Function load_lora_B took 4.9285888671875 ms to run.
cost realload: 10.366678237915039
Function load_adapters took 10.390520095825195 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 10 remains
cost offload cat: 0.03719329833984375
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.6039142608642578 ms to run.
cost load scan: 0.01811981201171875
load 1 adapters, 11 in total
Function load_lora_A took 9.300708770751953 ms to run.
Function load_lora_B took 9.273052215576172 ms to run.
cost realload: 18.993854522705078
Function load_adapters took 19.025087356567383 ms to run.
current batch size: 11 token used ratio: 0.0646
cost load scan: 0.019073486328125
load 1 adapters, 12 in total
Function load_lora_A took 2.868175506591797 ms to run.
Function load_lora_B took 2.7642250061035156 ms to run.
cost realload: 6.074666976928711
Function load_adapters took 6.104230880737305 ms to run.
cost offload scan: 0.09918212890625
offload 1 adapters, 11 remains
cost offload cat: 0.05626678466796875
cost offload free mem manager: 0.06866455078125
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.14257431030273438
Function offload_adapters took 0.7879734039306641 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 10 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5736351013183594 ms to run.
cost offload scan: 0.09751319885253906
offload 1 adapters, 9 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10132789611816406
Function offload_adapters took 0.5807876586914062 ms to run.
current batch size: 9 token used ratio: 0.05866153846153846
cost offload scan: 0.08654594421386719
offload 1 adapters, 8 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11873245239257812
Function offload_adapters took 0.6010532379150391 ms to run.
cost offload scan: 0.08273124694824219
offload 1 adapters, 7 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5748271942138672 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 6 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10228157043457031
Function offload_adapters took 0.5784034729003906 ms to run.
current batch size: 6 token used ratio: 0.04110769230769231
cost offload scan: 0.08726119995117188
offload 1 adapters, 5 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5853176116943359 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 6 in total
Function load_lora_A took 4.994869232177734 ms to run.
Function load_lora_B took 4.9381256103515625 ms to run.
cost realload: 10.84446907043457
Function load_adapters took 10.870933532714844 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 5 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5841255187988281 ms to run.
Avg tokens(prompt+generate) throughput:  608.804 tokens/s
Avg prompt tokens throughput:            274.815 tokens/s
Avg generate tokens throughput:          333.989 tokens/s
current batch size: 5 token used ratio: 0.03232307692307692
cost offload scan: 0.08177757263183594
offload 1 adapters, 4 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.021457672119140625
cost offload a_loc update: 0.10156631469726562
Function offload_adapters took 0.5702972412109375 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 3 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10204315185546875
Function offload_adapters took 0.5631446838378906 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 4 in total
Function load_lora_A took 9.326457977294922 ms to run.
INFO:     127.0.0.1:33358 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33362 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33376 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33380 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33396 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33406 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33408 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33420 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44896 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44900 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44912 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44922 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44938 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44942 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_B took 9.26971435546875 ms to run.
cost realload: 19.052982330322266
Function load_adapters took 19.077062606811523 ms to run.
current batch size: 4 token used ratio: 0.02349230769230769
cost offload scan: 0.08344650268554688
offload 1 adapters, 3 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.5779266357421875 ms to run.
current batch size: 3 token used ratio: 0.018276923076923076
cost offload scan: 0.08559226989746094
offload 1 adapters, 2 remains
cost offload cat: 0.03552436828613281
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11849403381347656
Function offload_adapters took 0.6020069122314453 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 3 in total
Function load_lora_A took 2.804279327392578 ms to run.
Function load_lora_B took 2.8009414672851562 ms to run.
cost realload: 6.0405731201171875
Function load_adapters took 6.065845489501953 ms to run.
cost load scan: 0.017881393432617188
load 2 adapters, 5 in total
Function load_lora_A took 9.311676025390625 ms to run.
Function load_lora_B took 9.284257888793945 ms to run.
Function load_lora_A took 4.986047744750977 ms to run.
Function load_lora_B took 4.924535751342773 ms to run.
cost realload: 28.99312973022461
Function load_adapters took 29.014110565185547 ms to run.
cost load scan: 0.01621246337890625
load 1 adapters, 6 in total
Function load_lora_A took 9.28950309753418 ms to run.
Function load_lora_B took 9.259939193725586 ms to run.
cost realload: 19.047260284423828
Function load_adapters took 19.06871795654297 ms to run.
current batch size: 6 token used ratio: 0.03050769230769231
cost load scan: 0.015974044799804688
load 1 adapters, 7 in total
Function load_lora_A took 2.8238296508789062 ms to run.
Function load_lora_B took 2.8181076049804688 ms to run.
cost realload: 6.047725677490234
Function load_adapters took 6.070375442504883 ms to run.
cost load scan: 0.0171661376953125
load 1 adapters, 8 in total
Function load_lora_A took 9.258031845092773 ms to run.
Function load_lora_B took 9.223699569702148 ms to run.
cost realload: 18.916606903076172
Function load_adapters took 18.941402435302734 ms to run.
current batch size: 8 token used ratio: 0.044123076923076925
cost offload scan: 0.08416175842285156
offload 1 adapters, 7 remains
cost offload cat: 0.038623809814453125
cost offload free mem manager: 0.05221366882324219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.6048679351806641 ms to run.
cost load scan: 0.014781951904296875
load 1 adapters, 8 in total
Function load_lora_A took 9.312152862548828 ms to run.
Function load_lora_B took 9.276390075683594 ms to run.
cost realload: 19.012928009033203
Function load_adapters took 19.03557777404785 ms to run.
current batch size: 8 token used ratio: 0.04623076923076923
cost load scan: 0.015974044799804688
load 1 adapters, 9 in total
Function load_lora_A took 2.870798110961914 ms to run.
Function load_lora_B took 2.8142929077148438 ms to run.
cost realload: 6.090879440307617
Function load_adapters took 6.119251251220703 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 8 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11181831359863281
Function offload_adapters took 0.5888938903808594 ms to run.
current batch size: 8 token used ratio: 0.051061538461538464
cost offload scan: 0.08273124694824219
offload 1 adapters, 7 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.04982948303222656
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5812644958496094 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 6 remains
cost offload cat: 0.039577484130859375
cost offload free mem manager: 0.04863739013671875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11682510375976562
Function offload_adapters took 0.6387233734130859 ms to run.
current batch size: 6 token used ratio: 0.04263076923076923
Avg tokens(prompt+generate) throughput:  463.786 tokens/s
Avg prompt tokens throughput:            257.326 tokens/s
Avg generate tokens throughput:          206.460 tokens/s
cost load scan: 0.018358230590820312
load 1 adapters, 7 in total
Function load_lora_A took 2.831697463989258 ms to run.
Function load_lora_B took 2.7666091918945312 ms to run.
cost realload: 6.05320930480957
Function load_adapters took 6.078004837036133 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 6 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5753040313720703 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 7 in total
Function load_lora_A took 9.313106536865234 ms to run.
Function load_lora_B took 9.25755500793457 ms to run.
cost realload: 18.97716522216797
Function load_adapters took 18.99886131286621 ms to run.
current batch size: 7 token used ratio: 0.04803076923076923
cost offload scan: 0.08320808410644531
offload 1 adapters, 6 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5767345428466797 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 5 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10251998901367188
Function offload_adapters took 0.5612373352050781 ms to run.
cost offload scan: 0.080108642578125
offload 1 adapters, 4 remains
cost offload cat: 0.03719329833984375
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10085105895996094
Function offload_adapters took 0.568389892578125 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 3 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.028371810913085938
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5669593811035156 ms to run.
current batch size: 3 token used ratio: 0.018138461538461537
cost load scan: 0.023365020751953125
load 1 adapters, 4 in total
Function load_lora_A took 4.968404769897461 ms to run.
Function load_lora_B took 4.916191101074219 ms to run.
cost realload: 10.30731201171875
Function load_adapters took 10.329723358154297 ms to run.
cost offload scan: 0.0782012939453125
offload 1 adapters, 3 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5629062652587891 ms to run.
cost load scan: 0.012159347534179688
load 1 adapters, 4 in total
Function load_lora_A took 9.289026260375977 ms to run.
Function load_lora_B took 9.249687194824219 ms to run.
cost realload: 18.942832946777344
Function load_adapters took 18.969058990478516 ms to run.
cost load scan: 0.021696090698242188
load 1 adapters, 5 in total
Function load_lora_A took 9.33074951171875 ms to run.
Function load_lora_B took 9.263992309570312 ms to run.
cost realload: 19.001007080078125
Function load_adapters took 19.022464752197266 ms to run.
current batch size: 5 token used ratio: 0.02253846153846154
cost load scan: 0.022172927856445312
load 1 adapters, 6 in total
Function load_lora_A took 4.9686431884765625 ms to run.
Function load_lora_B took 4.8809051513671875 ms to run.
cost realload: 10.279417037963867
INFO:     127.0.0.1:44954 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44968 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44972 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53510 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53516 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53526 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53528 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53540 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53544 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53552 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53564 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53576 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53582 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53588 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53600 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53602 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_adapters took 10.301351547241211 ms to run.
cost load scan: 0.02384185791015625
load 2 adapters, 8 in total
Function load_lora_A took 9.342670440673828 ms to run.
Function load_lora_B took 9.297370910644531 ms to run.
Function load_lora_A took 4.932880401611328 ms to run.
Function load_lora_B took 4.91642951965332 ms to run.
cost realload: 28.99003028869629
Function load_adapters took 29.01172637939453 ms to run.
current batch size: 8 token used ratio: 0.03823076923076923
cost offload scan: 0.0858306884765625
offload 1 adapters, 7 remains
cost offload cat: 0.03933906555175781
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11515617370605469
Function offload_adapters took 0.6191730499267578 ms to run.
current batch size: 7 token used ratio: 0.036215384615384615
current batch size: 7 token used ratio: 0.0416
cost offload scan: 0.08916854858398438
offload 1 adapters, 6 remains
cost offload cat: 0.044345855712890625
cost offload free mem manager: 0.04982948303222656
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11897087097167969
Function offload_adapters took 0.6406307220458984 ms to run.
cost offload scan: 0.08273124694824219
offload 1 adapters, 5 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5843639373779297 ms to run.
cost load scan: 0.026941299438476562
load 1 adapters, 6 in total
Function load_lora_A took 4.973888397216797 ms to run.
Function load_lora_B took 4.989147186279297 ms to run.
cost realload: 10.426044464111328
Function load_adapters took 10.453462600708008 ms to run.
current batch size: 6 token used ratio: 0.03784615384615385
Avg tokens(prompt+generate) throughput:  426.296 tokens/s
Avg prompt tokens throughput:            217.643 tokens/s
Avg generate tokens throughput:          208.653 tokens/s
cost load scan: 0.012874603271484375
load 1 adapters, 7 in total
Function load_lora_A took 9.325027465820312 ms to run.
Function load_lora_B took 9.24825668334961 ms to run.
cost realload: 19.00959014892578
Function load_adapters took 19.032001495361328 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 6 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.04935264587402344
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5819797515869141 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 5 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5695819854736328 ms to run.
cost load scan: 0.01430511474609375
load 1 adapters, 6 in total
Function load_lora_A took 9.32931900024414 ms to run.
Function load_lora_B took 9.271621704101562 ms to run.
cost realload: 19.003629684448242
Function load_adapters took 19.02604103088379 ms to run.
cost offload scan: 0.08225440979003906
offload 1 adapters, 5 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.5700588226318359 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 6 in total
Function load_lora_A took 9.342432022094727 ms to run.
Function load_lora_B took 9.304285049438477 ms to run.
cost realload: 19.054889678955078
Function load_adapters took 19.07825469970703 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 5 remains
cost offload cat: 0.0438690185546875
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5977153778076172 ms to run.
current batch size: 5 token used ratio: 0.02416923076923077
cost load scan: 0.015735626220703125
load 1 adapters, 6 in total
Function load_lora_A took 2.8350353240966797 ms to run.
Function load_lora_B took 2.778768539428711 ms to run.
cost realload: 6.03032112121582
Function load_adapters took 6.060123443603516 ms to run.
current batch size: 6 token used ratio: 0.03353846153846154
cost load scan: 0.02288818359375
load 1 adapters, 7 in total
Function load_lora_A took 9.310483932495117 ms to run.
Function load_lora_B took 9.25898551940918 ms to run.
cost realload: 19.005298614501953
Function load_adapters took 19.0279483795166 ms to run.
cost load scan: 0.014066696166992188
load 1 adapters, 8 in total
Function load_lora_A took 2.864360809326172 ms to run.
Function load_lora_B took 2.812623977661133 ms to run.
cost realload: 6.09588623046875
Function load_adapters took 6.118535995483398 ms to run.
cost load scan: 0.022172927856445312
load 2 adapters, 10 in total
Function load_lora_A took 2.837657928466797 ms to run.
Function load_lora_B took 2.7952194213867188 ms to run.
Function load_lora_A took 2.789735794067383 ms to run.
Function load_lora_B took 2.796173095703125 ms to run.
cost realload: 11.71112060546875
Function load_adapters took 11.733770370483398 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 9 remains
cost offload cat: 0.03504753112792969
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5807876586914062 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 10 in total
Function load_lora_A took 2.828836441040039 ms to run.
Function load_lora_B took 2.783536911010742 ms to run.
cost realload: 6.021261215209961
Function load_adapters took 6.043195724487305 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 9 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5853176116943359 ms to run.
current batch size: 9 token used ratio: 0.0434
cost load scan: 0.008344650268554688
load 1 adapters, 10 in total
Function load_lora_A took 4.905223846435547 ms to run.
Function load_lora_B took 4.926204681396484 ms to run.
cost realload: 10.255813598632812
Function load_adapters took 10.282278060913086 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 11 in total
Function load_lora_A took 4.919528961181641 ms to run.
Function load_lora_B took 4.9495697021484375 ms to run.
cost realload: 10.282754898071289
Function load_adapters took 10.305643081665039 ms to run.
current batch size: 11 token used ratio: 0.059307692307692304
cost offload scan: 0.08463859558105469
offload 1 adapters, 10 remains
cost offload cat: 0.037670135498046875
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.6077289581298828 ms to run.
cost offload scan: 0.08368492126464844
offload 1 adapters, 9 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5784034729003906 ms to run.
current batch size: 9 token used ratio: 0.05647692307692308
cost load scan: 0.015497207641601562
load 1 adapters, 10 in total
Function load_lora_A took 2.81524658203125 ms to run.
Function load_lora_B took 2.7763843536376953 ms to run.
cost realload: 6.021738052368164
Function load_adapters took 6.047964096069336 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 9 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.5924701690673828 ms to run.
cost load scan: 0.026702880859375INFO:     127.0.0.1:53604 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53616 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53622 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36238 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36254 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36264 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36278 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36292 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36294 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36306 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36320 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36324 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36328 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36342 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36346 - "POST /generate_stream HTTP/1.1" 200 OK

load 1 adapters, 10 in total
Function load_lora_A took 2.8209686279296875 ms to run.
Function load_lora_B took 2.7887821197509766 ms to run.
cost realload: 6.073713302612305
Function load_adapters took 6.096363067626953 ms to run.
cost offload scan: 0.08559226989746094
offload 1 adapters, 9 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5793571472167969 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 8 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5786418914794922 ms to run.
cost load scan: 0.020265579223632812
load 1 adapters, 9 in total
Function load_lora_A took 9.22846794128418 ms to run.
Function load_lora_B took 9.211301803588867 ms to run.
cost realload: 18.860578536987305
Function load_adapters took 18.881797790527344 ms to run.
current batch size: 9 token used ratio: 0.058923076923076925
cost load scan: 0.026941299438476562
load 2 adapters, 11 in total
Function load_lora_A took 4.979610443115234 ms to run.
Function load_lora_B took 4.9076080322265625 ms to run.
Function load_lora_A took 2.832174301147461 ms to run.
Function load_lora_B took 2.767324447631836 ms to run.
cost realload: 15.984296798706055
Function load_adapters took 16.006946563720703 ms to run.
cost offload scan: 0.09417533874511719
offload 1 adapters, 10 remains
cost offload cat: 0.03743171691894531
cost offload free mem manager: 0.0476837158203125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11920928955078125
Function offload_adapters took 0.6241798400878906 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 9 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5741119384765625 ms to run.
cost offload scan: 0.08463859558105469
offload 1 adapters, 8 remains
cost offload cat: 0.03790855407714844
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5922317504882812 ms to run.
current batch size: 8 token used ratio: 0.04853846153846154
Avg tokens(prompt+generate) throughput:  705.953 tokens/s
Avg prompt tokens throughput:            430.678 tokens/s
Avg generate tokens throughput:          275.275 tokens/s
cost offload scan: 0.08869171142578125
offload 1 adapters, 7 remains
cost offload cat: 0.03504753112792969
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.6101131439208984 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 8 in total
Function load_lora_A took 4.940509796142578 ms to run.
Function load_lora_B took 4.862308502197266 ms to run.
cost realload: 10.258674621582031
Function load_adapters took 10.284900665283203 ms to run.
current batch size: 8 token used ratio: 0.05052307692307692
cost offload scan: 0.09369850158691406
offload 1 adapters, 7 remains
cost offload cat: 0.03647804260253906
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.102996826171875
Function offload_adapters took 0.5905628204345703 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 8 in total
Function load_lora_A took 9.303092956542969 ms to run.
Function load_lora_B took 9.283065795898438 ms to run.
cost realload: 19.005537033081055
Function load_adapters took 19.0274715423584 ms to run.
cost offload scan: 0.08392333984375
offload 1 adapters, 7 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11467933654785156
Function offload_adapters took 0.5791187286376953 ms to run.
current batch size: 7 token used ratio: 0.042861538461538465
cost load scan: 0.02002716064453125
load 1 adapters, 8 in total
Function load_lora_A took 2.86102294921875 ms to run.
Function load_lora_B took 2.7947425842285156 ms to run.
cost realload: 6.084442138671875
Function load_adapters took 6.107330322265625 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 9 in total
Function load_lora_A took 2.839326858520508 ms to run.
Function load_lora_B took 2.8023719787597656 ms to run.
cost realload: 6.0577392578125
Function load_adapters took 6.080865859985352 ms to run.
current batch size: 9 token used ratio: 0.058723076923076926
cost offload scan: 0.08845329284667969
offload 1 adapters, 8 remains
cost offload cat: 0.035762786865234375
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5860328674316406 ms to run.
cost load scan: 0.015020370483398438
load 1 adapters, 9 in total
Function load_lora_A took 4.988670349121094 ms to run.
Function load_lora_B took 4.9266815185546875 ms to run.
cost realload: 10.320425033569336
Function load_adapters took 10.342597961425781 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 8 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11181831359863281
Function offload_adapters took 0.5893707275390625 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 7 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5691051483154297 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 6 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5686283111572266 ms to run.
current batch size: 6 token used ratio: 0.03749230769230769
cost offload scan: 0.08440017700195312
offload 1 adapters, 5 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10204315185546875
Function offload_adapters took 0.5650520324707031 ms to run.
cost load scan: 0.019073486328125
load 1 adapters, 6 in total
Function load_lora_A took 2.8200149536132812 ms to run.
Function load_lora_B took 2.778291702270508 ms to run.
cost realload: 6.078243255615234
Function load_adapters took 6.100654602050781 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 7 in total
Function load_lora_A took 2.8069019317626953 ms to run.
Function load_lora_B took 2.7878284454345703 ms to run.
cost realload: 6.080865859985352
Function load_adapters took 6.108522415161133 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 8 in total
Function load_lora_A took 4.994392395019531 ms to run.
Function load_lora_B took 4.923343658447266 ms to run.
cost realload: 10.31637191772461
Function load_adapters took 10.338068008422852 ms to run.
cost load scan: 0.0095367431640625
load 2 adapters, 10 in total
Function load_lora_A took 9.296894073486328 ms to run.
Function load_lora_B took 9.282588958740234 ms to run.
Function load_lora_A took 9.311914443969727 ms to run.
Function load_lora_B took 9.27877426147461 ms to run.
cost realload: 37.65130043029785
Function load_adapters took 37.6739501953125 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 9 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: INFO:     127.0.0.1:36352 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:36356 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59600 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59616 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59630 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59640 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59642 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59644 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59654 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59656 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59670 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37102 - "POST /generate_stream HTTP/1.1" 200 OK
0.10991096496582031
Function offload_adapters took 0.6270408630371094 ms to run.
current batch size: 9 token used ratio: 0.04938461538461539
cost load scan: 0.028371810913085938
load 2 adapters, 11 in total
Function load_lora_A took 4.9877166748046875 ms to run.
Function load_lora_B took 4.901885986328125 ms to run.
Function load_lora_A took 9.297847747802734 ms to run.
Function load_lora_B took 9.29713249206543 ms to run.
cost realload: 28.991222381591797
Function load_adapters took 29.01458740234375 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 11 in total
cost realload: 0.30732154846191406
Function load_adapters took 0.3325939178466797 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 11 in total
cost realload: 0.2810955047607422
Function load_adapters took 0.30517578125 ms to run.
current batch size: 13 token used ratio: 0.07633846153846154
Avg tokens(prompt+generate) throughput:  679.056 tokens/s
Avg prompt tokens throughput:            403.844 tokens/s
Avg generate tokens throughput:          275.212 tokens/s
cost offload scan: 0.08845329284667969
offload 1 adapters, 10 remains
cost offload cat: 0.0362396240234375
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5967617034912109 ms to run.
current batch size: 12 token used ratio: 0.0792
cost offload scan: 0.08416175842285156
offload 1 adapters, 9 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.05030632019042969
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5958080291748047 ms to run.
cost offload scan: 0.12087821960449219
offload 2 adapters, 7 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.053882598876953125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.6268024444580078 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 6 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5674362182617188 ms to run.
offload 0 adapters, 6 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost offload scan: 0.08106231689453125
offload 1 adapters, 5 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5700588226318359 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 6 in total
Function load_lora_A took 2.8476715087890625 ms to run.
Function load_lora_B took 2.774477005004883 ms to run.
cost realload: 6.039142608642578
Function load_adapters took 6.062507629394531 ms to run.
cost offload scan: 0.08559226989746094
offload 1 adapters, 5 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.05054473876953125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10275840759277344
Function offload_adapters took 0.5738735198974609 ms to run.
current batch size: 5 token used ratio: 0.034892307692307695
cost offload scan: 0.08368492126464844
offload 1 adapters, 4 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5712509155273438 ms to run.
cost load scan: 0.026226043701171875
load 2 adapters, 6 in total
Function load_lora_A took 2.8829574584960938 ms to run.
Function load_lora_B took 2.790212631225586 ms to run.
Function load_lora_A took 2.7990341186523438 ms to run.
Function load_lora_B took 2.814769744873047 ms to run.
cost realload: 11.775732040405273
Function load_adapters took 11.798381805419922 ms to run.
current batch size: 6 token used ratio: 0.03516923076923077
cost offload scan: 0.08368492126464844
offload 1 adapters, 5 remains
cost offload cat: 0.036716461181640625
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5939006805419922 ms to run.
cost load scan: 0.020742416381835938
load 1 adapters, 6 in total
Function load_lora_A took 2.841949462890625 ms to run.
Function load_lora_B took 2.8073787689208984 ms to run.
cost realload: 6.070613861083984
Function load_adapters took 6.093263626098633 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 5 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.051021575927734375
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5879402160644531 ms to run.
current batch size: 5 token used ratio: 0.027830769230769232
cost load scan: 0.01621246337890625
load 1 adapters, 6 in total
Function load_lora_A took 9.296178817749023 ms to run.
Function load_lora_B took 9.267807006835938 ms to run.
cost realload: 19.01388168334961
Function load_adapters took 19.03676986694336 ms to run.
cost offload scan: 0.08273124694824219
offload 1 adapters, 5 remains
cost offload cat: 0.03504753112792969
cost offload free mem manager: 0.05173683166503906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5872249603271484 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 6 in total
Function load_lora_A took 9.287834167480469 ms to run.
Function load_lora_B took 9.285211563110352 ms to run.
cost realload: 18.98360252380371
Function load_adapters took 19.006013870239258 ms to run.
cost offload scan: 0.12373924255371094
offload 2 adapters, 4 remains
cost offload cat: 0.027179718017578125
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11515617370605469
Function offload_adapters took 0.6334781646728516 ms to run.
current batch size: 4 token used ratio: 0.01703076923076923
cost load scan: 0.013113021850585938
load 1 adapters, 5 in total
Function load_lora_A took 4.953145980834961 ms to run.
Function load_lora_B took 4.894733428955078 ms to run.
cost realload: 10.288238525390625
Function load_adapters took 10.31351089477539 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 4 remains
cost offload cat: 0.042438507080078125
cost offload free mem manager: 0.04887580871582031
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11944770812988281
Function offload_adapters took 0.6268024444580078 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 5 in total
Function load_lora_A took 2.811908721923828 ms to run.
Function load_lora_B took 2.765178680419922 ms to run.
cost realload: 6.007671356201172
Function load_adapters took 6.03175163269043 ms to run.
current batch size: 5 token used ratio: 0.025923076923076924
cost load scan: 0.010967254638671875
load 1 adapters, 6 in total
Function load_lora_A took 9.272575378417969 ms to run.
Function load_lora_B took 9.255647659301758 ms to run.
cost realload: 18.949031829833984
Function load_adapters took 18.97144317626953 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 5 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5700588226318359 ms to run.
current batch size: 5 token used ratio: 0.028553846153846155
Avg tokens(prompt+generate) throughput:  448.554 tokens/s
Avg prompt tokens throughput:            231.125 tokens/s
Avg generate tokens throughput:          217.429 tokens/s
current batch size: 5 token used ratio: 0.0324
cost load scan: 0.022172927856445312
load 1 adapters, 6 in total
INFO:     127.0.0.1:37118 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37124 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37138 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37148 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37154 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37170 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37178 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37184 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56124 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56128 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56140 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 9.331464767456055 ms to run.
Function load_lora_B took 9.268522262573242 ms to run.
cost realload: 19.085168838500977
Function load_adapters took 19.10853385925293 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 5 remains
cost offload cat: 0.03695487976074219
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.6096363067626953 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 4 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5667209625244141 ms to run.
current batch size: 4 token used ratio: 0.029153846153846155
cost offload scan: 0.08082389831542969
offload 1 adapters, 3 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5574226379394531 ms to run.
cost load scan: 0.014066696166992188
load 1 adapters, 4 in total
Function load_lora_A took 4.912853240966797 ms to run.
Function load_lora_B took 4.947423934936523 ms to run.
cost realload: 10.297298431396484
Function load_adapters took 10.319948196411133 ms to run.
cost load scan: 0.021696090698242188
load 2 adapters, 6 in total
Function load_lora_A took 2.8111934661865234 ms to run.
Function load_lora_B took 2.790689468383789 ms to run.
Function load_lora_A took 2.8183460235595703 ms to run.
Function load_lora_B took 2.7747154235839844 ms to run.
cost realload: 11.688709259033203
Function load_adapters took 11.711597442626953 ms to run.
current batch size: 6 token used ratio: 0.03755384615384615
cost offload scan: 0.08249282836914062
offload 1 adapters, 5 remains
cost offload cat: 0.03647804260253906
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11038780212402344
Function offload_adapters took 0.5936622619628906 ms to run.
current batch size: 5 token used ratio: 0.033861538461538464
cost offload scan: 0.08130073547363281
offload 1 adapters, 4 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.5707740783691406 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 3 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5764961242675781 ms to run.
cost load scan: 0.014543533325195312
load 1 adapters, 4 in total
Function load_lora_A took 2.8443336486816406 ms to run.
Function load_lora_B took 2.8018951416015625 ms to run.
cost realload: 6.070613861083984
Function load_adapters took 6.093263626098633 ms to run.
current batch size: 4 token used ratio: 0.025076923076923077
cost load scan: 0.020265579223632812
load 1 adapters, 5 in total
Function load_lora_A took 4.96363639831543 ms to run.
Function load_lora_B took 4.930973052978516 ms to run.
cost realload: 10.329723358154297
Function load_adapters took 10.352134704589844 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 4 remains
cost offload cat: 0.03790855407714844
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.5996227264404297 ms to run.
cost load scan: 0.028848648071289062
load 1 adapters, 5 in total
Function load_lora_A took 2.8421878814697266 ms to run.
Function load_lora_B took 2.789735794067383 ms to run.
cost realload: 6.0634613037109375
Function load_adapters took 6.085395812988281 ms to run.
current batch size: 5 token used ratio: 0.03076923076923077
cost offload scan: 0.08678436279296875
offload 1 adapters, 4 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5748271942138672 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 5 in total
Function load_lora_A took 2.824544906616211 ms to run.
Function load_lora_B took 2.7725696563720703 ms to run.
cost realload: 6.021022796630859
Function load_adapters took 6.043910980224609 ms to run.
current batch size: 5 token used ratio: 0.027384615384615386
cost load scan: 0.010967254638671875
load 1 adapters, 6 in total
Function load_lora_A took 4.972219467163086 ms to run.
Function load_lora_B took 4.9037933349609375 ms to run.
cost realload: 10.290384292602539
Function load_adapters took 10.312318801879883 ms to run.
cost offload scan: 0.08106231689453125
offload 1 adapters, 5 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.5774497985839844 ms to run.
cost offload scan: 0.08034706115722656
offload 1 adapters, 4 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5698204040527344 ms to run.
current batch size: 4 token used ratio: 0.023384615384615386
Avg tokens(prompt+generate) throughput:  435.061 tokens/s
Avg prompt tokens throughput:            268.245 tokens/s
Avg generate tokens throughput:          166.817 tokens/s
cost offload scan: 0.08368492126464844
offload 1 adapters, 3 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.583648681640625 ms to run.
current batch size: 3 token used ratio: 0.018323076923076925
cost load scan: 0.011682510375976562
load 1 adapters, 4 in total
Function load_lora_A took 4.987478256225586 ms to run.
Function load_lora_B took 4.946708679199219 ms to run.
cost realload: 10.352373123168945
Function load_adapters took 10.3759765625 ms to run.
current batch size: 4 token used ratio: 0.02423076923076923
cost offload scan: 0.07891654968261719
offload 1 adapters, 3 remains
cost offload cat: 0.035762786865234375
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5862712860107422 ms to run.
current batch size: 3 token used ratio: 0.019446153846153846
cost offload scan: 0.08058547973632812
offload 1 adapters, 2 remains
cost offload cat: 0.037670135498046875
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5881786346435547 ms to run.
cost load scan: 0.019073486328125
load 1 adapters, 3 in total
Function load_lora_A took 9.296894073486328 ms to run.
Function load_lora_B took 9.23299789428711 ms to run.
cost realload: 18.959522247314453
Function load_adapters took 18.981456756591797 ms to run.
cost offload scan: 0.0820159912109375
offload 1 adapters, 2 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5657672882080078 ms to run.
current batch size: 2 token used ratio: 0.007261538461538462
current batch size: 2 token used ratio: 0.0088
cost load scan: 0.014066696166992188
load 1 adapters, 3 in total
Function load_lora_A took 2.828836441040039 ms to run.
Function load_lora_B took 2.8226375579833984 ms to run.
cost realload: 6.111383438110352
INFO:     127.0.0.1:56146 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51532 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51534 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51550 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51564 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51578 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51586 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51588 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51598 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51614 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51630 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45726 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45728 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45734 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45742 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45758 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45762 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_adapters took 6.142377853393555 ms to run.
current batch size: 3 token used ratio: 0.014984615384615384
cost offload scan: 0.0820159912109375
offload 1 adapters, 2 remains
cost offload cat: 0.041484832763671875
cost offload free mem manager: 0.04982948303222656
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.12731552124023438
Function offload_adapters took 0.6270408630371094 ms to run.
cost offload scan: 0.08392333984375
offload 1 adapters, 1 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04744529724121094
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.5824565887451172 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 2 in total
Function load_lora_A took 4.9896240234375 ms to run.
Function load_lora_B took 4.91786003112793 ms to run.
cost realload: 10.345220565795898
Function load_adapters took 10.368585586547852 ms to run.
current batch size: 2 token used ratio: 0.011907692307692308
cost load scan: 0.008106231689453125
load 1 adapters, 3 in total
Function load_lora_A took 9.322881698608398 ms to run.
Function load_lora_B took 9.272098541259766 ms to run.
cost realload: 19.01865005493164
Function load_adapters took 19.04153823852539 ms to run.
Avg tokens(prompt+generate) throughput:  233.906 tokens/s
Avg prompt tokens throughput:            132.633 tokens/s
Avg generate tokens throughput:          101.273 tokens/s
current batch size: 3 token used ratio: 0.018723076923076922
cost load scan: 0.012159347534179688
load 1 adapters, 4 in total
Function load_lora_A took 9.299993515014648 ms to run.
Function load_lora_B took 9.245872497558594 ms to run.
cost realload: 18.957138061523438
Function load_adapters took 18.98026466369629 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 5 in total
Function load_lora_A took 4.966974258422852 ms to run.
Function load_lora_B took 4.89354133605957 ms to run.
cost realload: 10.2691650390625
Function load_adapters took 10.291576385498047 ms to run.
current batch size: 5 token used ratio: 0.030384615384615385
cost load scan: 0.01049041748046875
load 1 adapters, 6 in total
Function load_lora_A took 2.7875900268554688 ms to run.
Function load_lora_B took 2.775430679321289 ms to run.
cost realload: 5.95855712890625
Function load_adapters took 5.980253219604492 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 5 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5800724029541016 ms to run.
current batch size: 5 token used ratio: 0.03056923076923077
cost load scan: 0.010728836059570312
load 1 adapters, 6 in total
Function load_lora_A took 9.314775466918945 ms to run.
Function load_lora_B took 9.227275848388672 ms to run.
cost realload: 18.953561782836914
Function load_adapters took 18.975257873535156 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 5 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5810260772705078 ms to run.
cost offload scan: 0.12040138244628906
offload 2 adapters, 3 remains
cost offload cat: 0.026941299438476562
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.6093978881835938 ms to run.
current batch size: 3 token used ratio: 0.016369230769230768
cost load scan: 0.023126602172851562
load 1 adapters, 4 in total
Function load_lora_A took 9.252071380615234 ms to run.
Function load_lora_B took 9.183406829833984 ms to run.
cost realload: 18.848896026611328
Function load_adapters took 18.871784210205078 ms to run.
cost offload scan: 0.07987022399902344
offload 1 adapters, 3 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5719661712646484 ms to run.
current batch size: 3 token used ratio: 0.0194
cost load scan: 0.022649765014648438
load 1 adapters, 4 in total
Function load_lora_A took 2.826213836669922 ms to run.
Function load_lora_B took 2.765655517578125 ms to run.
cost realload: 6.006956100463867
Function load_adapters took 6.027936935424805 ms to run.
cost offload scan: 0.08153915405273438
offload 1 adapters, 3 remains
cost offload cat: 0.03910064697265625
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5917549133300781 ms to run.
current batch size: 3 token used ratio: 0.019215384615384617
cost load scan: 0.021457672119140625
load 1 adapters, 4 in total
Function load_lora_A took 9.320497512817383 ms to run.
Function load_lora_B took 9.251117706298828 ms to run.
cost realload: 19.0126895904541
Function load_adapters took 19.035816192626953 ms to run.
current batch size: 4 token used ratio: 0.0262
cost load scan: 0.0209808349609375
load 1 adapters, 5 in total
Function load_lora_A took 4.9266815185546875 ms to run.
Function load_lora_B took 4.903316497802734 ms to run.
cost realload: 10.255813598632812
Function load_adapters took 10.28299331665039 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 6 in total
Function load_lora_A took 4.9457550048828125 ms to run.
Function load_lora_B took 4.915475845336914 ms to run.
cost realload: 10.271787643432617
Function load_adapters took 10.293722152709961 ms to run.
cost load scan: 0.014781951904296875
load 1 adapters, 7 in total
Function load_lora_A took 4.927873611450195 ms to run.
Function load_lora_B took 4.892826080322266 ms to run.
cost realload: 10.229349136352539
Function load_adapters took 10.251522064208984 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 8 in total
Function load_lora_A took 4.974842071533203 ms to run.
Function load_lora_B took 4.93168830871582 ms to run.
cost realload: 10.302305221557617
Function load_adapters took 10.323762893676758 ms to run.
Avg tokens(prompt+generate) throughput:  463.820 tokens/s
Avg prompt tokens throughput:            314.039 tokens/s
Avg generate tokens throughput:          149.780 tokens/s
current batch size: 8 token used ratio: 0.04736923076923077
cost load scan: 0.0171661376953125
load 2 adapters, 10 in total
Function load_lora_A took 2.796649932861328 ms to run.
Function load_lora_B took 2.7763843536376953 ms to run.
Function load_lora_A took 2.7914047241210938 ms to run.
Function load_lora_B took 2.7742385864257812 ms to run.
cost realload: 11.620521545410156
Function load_adapters took 11.641740798950195 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 9 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.5807876586914062 ms to run.
cost load scan: 0.01430511474609375
load 1 adapters, 10 in total
Function load_lora_A took 9.279251098632812 ms to run.
Function load_lora_B took 9.232282638549805 ms to run.
cost realload: 18.91922950744629
Function load_adapters took 18.941164016723633 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 11 in total
Function load_lora_A took 9.283065795898438 ms to run.
Function load_lora_B took 9.26971435546875 ms to run.
cost realload: 18.94688606262207
Function load_adapters took 18.96834373474121 ms to run.
cost offload scan: 0.08392333984375
offload 1 adapters, 10 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5710124969482422 ms to run.
current batch size: 10 token used ratio: INFO:     127.0.0.1:45768 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45780 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45790 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45798 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47620 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47626 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47634 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47650 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47652 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47660 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47668 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47684 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47698 - "POST /generate_stream HTTP/1.1" 200 OK
0.05187692307692308
cost offload scan: 0.08225440979003906
offload 1 adapters, 9 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5671977996826172 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 9 in total
cost realload: 0.3104209899902344
Function load_adapters took 0.3426074981689453 ms to run.
cost load scan: 0.014781951904296875
load 1 adapters, 10 in total
Function load_lora_A took 9.355545043945312 ms to run.
Function load_lora_B took 9.283304214477539 ms to run.
cost realload: 19.05369758605957
Function load_adapters took 19.07515525817871 ms to run.
current batch size: 11 token used ratio: 0.0586
cost load scan: 0.011205673217773438
load 1 adapters, 11 in total
Function load_lora_A took 2.7954578399658203 ms to run.
Function load_lora_B took 2.7801990509033203 ms to run.
cost realload: 5.979299545288086
Function load_adapters took 6.002187728881836 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 12 in total
Function load_lora_A took 2.8159618377685547 ms to run.
Function load_lora_B took 2.7773380279541016 ms to run.
cost realload: 5.9947967529296875
Function load_adapters took 6.016016006469727 ms to run.
current batch size: 13 token used ratio: 0.07312307692307693
cost offload scan: 0.08416175842285156
offload 1 adapters, 11 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5795955657958984 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 10 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5788803100585938 ms to run.
cost offload scan: 0.08273124694824219
offload 1 adapters, 9 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5769729614257812 ms to run.
cost offload scan: 0.08249282836914062
offload 1 adapters, 8 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5645751953125 ms to run.
current batch size: 9 token used ratio: 0.05726153846153846
cost offload scan: 0.08225440979003906
offload 1 adapters, 7 remains
cost offload cat: 0.038623809814453125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11563301086425781
Function offload_adapters took 0.6031990051269531 ms to run.
cost offload scan: 0.08392333984375
offload 1 adapters, 6 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5826950073242188 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 5 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.5764961242675781 ms to run.
current batch size: 5 token used ratio: 0.034076923076923074
cost offload scan: 0.08630752563476562
offload 1 adapters, 4 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5741119384765625 ms to run.
cost offload scan: 0.080108642578125
offload 1 adapters, 3 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.55694580078125 ms to run.
cost offload scan: 0.0782012939453125
offload 1 adapters, 2 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.09989738464355469
Function offload_adapters took 0.5609989166259766 ms to run.
current batch size: 2 token used ratio: 0.011015384615384616
cost offload scan: 0.07915496826171875
offload 1 adapters, 1 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5638599395751953 ms to run.
offload 1 adapters, 0 remains
Function offload_adapters took 0.09703636169433594 ms to run.
offload 0 adapters, 0 remains
Function offload_adapters took 0.011444091796875 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 1 in total
Function load_lora_A took 4.948854446411133 ms to run.
Function load_lora_B took 4.942178726196289 ms to run.
cost realload: 10.34688949584961
Function load_adapters took 10.36834716796875 ms to run.
Avg tokens(prompt+generate) throughput:  472.472 tokens/s
Avg prompt tokens throughput:            217.162 tokens/s
Avg generate tokens throughput:          255.310 tokens/s
cost load scan: 0.011920928955078125
load 1 adapters, 2 in total
Function load_lora_A took 2.797365188598633 ms to run.
Function load_lora_B took 2.7709007263183594 ms to run.
cost realload: 5.972862243652344
Function load_adapters took 5.993843078613281 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 3 in total
Function load_lora_A took 4.998922348022461 ms to run.
Function load_lora_B took 4.94837760925293 ms to run.
cost realload: 10.38813591003418
Function load_adapters took 10.414361953735352 ms to run.
current batch size: 3 token used ratio: 0.016276923076923078
cost load scan: 0.010967254638671875
load 1 adapters, 4 in total
Function load_lora_A took 2.7990341186523438 ms to run.
Function load_lora_B took 2.7763843536376953 ms to run.
cost realload: 6.002902984619141
Function load_adapters took 6.0253143310546875 ms to run.
current batch size: 4 token used ratio: 0.021892307692307694
cost load scan: 0.011920928955078125
load 1 adapters, 5 in total
Function load_lora_A took 9.343862533569336 ms to run.
Function load_lora_B took 9.287357330322266 ms to run.
cost realload: 19.05655860900879
Function load_adapters took 19.07944679260254 ms to run.
cost load scan: 0.008821487426757812
load 0 adapters, 5 in total
cost realload: 0.29277801513671875
Function load_adapters took 0.31757354736328125 ms to run.
current batch size: 6 token used ratio: 0.03089230769230769
cost load scan: 0.011205673217773438
load 1 adapters, 6 in total
Function load_lora_A took 2.783536911010742 ms to run.
Function load_lora_B took 2.794027328491211 ms to run.
cost realload: 5.989551544189453
Function load_adapters took 6.012201309204102 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 7 in total
Function load_lora_A took 2.805471420288086 ms to run.
Function load_lora_B took 2.775907516479492 ms to run.
cost realload: 5.986690521240234
Function load_adapters took 6.008148193359375 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 6 remains
cost offload cat: 0.03695487976074219
cost offload free mem manager: 0.05125999450683594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.12302398681640625
Function offload_adapters took 0.6310939788818359 ms to run.
current batch size: 7 token used ratio: 0.03863076923076923
cost load scan: 0.009775161743164062
load 1 adapters, 7 in total
Function load_lora_A took 9.305000305175781 ms to run.
Function load_lora_B took 9.282827377319336 ms to run.
cost realload: 18.985986709594727
Function load_adapters took 19.010543823242188 ms to run.INFO:     127.0.0.1:47714 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47726 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47732 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47746 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47760 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47762 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47768 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47784 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47800 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47816 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57656 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57660 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57674 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57688 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57692 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57702 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57714 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57718 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57728 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57742 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57748 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57762 - "POST /generate_stream HTTP/1.1" 200 OK

cost load scan: 0.014543533325195312
load 1 adapters, 8 in total
Function load_lora_A took 4.998683929443359 ms to run.
Function load_lora_B took 4.935026168823242 ms to run.
cost realload: 10.34092903137207
Function load_adapters took 10.363578796386719 ms to run.
cost load scan: 0.03218650817871094
load 5 adapters, 13 in total
Function load_lora_A took 9.31096076965332 ms to run.
Function load_lora_B took 9.229898452758789 ms to run.
Function load_lora_A took 2.8340816497802734 ms to run.
Function load_lora_B took 2.771615982055664 ms to run.
Function load_lora_A took 9.340763092041016 ms to run.
Function load_lora_B took 9.271383285522461 ms to run.
Function load_lora_A took 9.303808212280273 ms to run.
Function load_lora_B took 9.230375289916992 ms to run.
Function load_lora_A took 2.8221607208251953 ms to run.
Function load_lora_B took 2.771139144897461 ms to run.
cost realload: 67.63601303100586
Function load_adapters took 67.66057014465332 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 13 in total
cost realload: 0.2968311309814453
Function load_adapters took 0.3209114074707031 ms to run.
current batch size: 15 token used ratio: 0.07624615384615385
cost load scan: 0.01621246337890625
load 1 adapters, 14 in total
Function load_lora_A took 9.249448776245117 ms to run.
Function load_lora_B took 9.217023849487305 ms to run.
cost realload: 18.88132095336914
Function load_adapters took 18.903732299804688 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 15 in total
Function load_lora_A took 4.993915557861328 ms to run.
Function load_lora_B took 4.942893981933594 ms to run.
cost realload: 10.360002517700195
Function load_adapters took 10.381698608398438 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 14 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.5986690521240234 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 13 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5781650543212891 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 12 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5869865417480469 ms to run.
current batch size: 14 token used ratio: 0.06946153846153846
cost load scan: 0.010967254638671875
load 1 adapters, 13 in total
Function load_lora_A took 5.004644393920898 ms to run.
Function load_lora_B took 4.909515380859375 ms to run.
cost realload: 10.316610336303711
Function load_adapters took 10.338306427001953 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 14 in total
Function load_lora_A took 2.830028533935547 ms to run.
Function load_lora_B took 2.7904510498046875 ms to run.
cost realload: 6.031513214111328
Function load_adapters took 6.05320930480957 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 13 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.5853176116943359 ms to run.
Avg tokens(prompt+generate) throughput:  745.884 tokens/s
Avg prompt tokens throughput:            478.899 tokens/s
Avg generate tokens throughput:          266.986 tokens/s
cost load scan: 0.010967254638671875
load 1 adapters, 14 in total
Function load_lora_A took 4.948854446411133 ms to run.
Function load_lora_B took 4.954099655151367 ms to run.
cost realload: 10.31351089477539
Function load_adapters took 10.335206985473633 ms to run.
current batch size: 16 token used ratio: 0.09024615384615385
cost load scan: 0.01049041748046875
load 1 adapters, 15 in total
Function load_lora_A took 4.979848861694336 ms to run.
Function load_lora_B took 4.909753799438477 ms to run.
cost realload: 10.301351547241211
Function load_adapters took 10.323762893676758 ms to run.
cost load scan: 0.015497207641601562
load 1 adapters, 16 in total
Function load_lora_A took 9.265661239624023 ms to run.
Function load_lora_B took 9.261846542358398 ms to run.
cost realload: 18.932819366455078
Function load_adapters took 18.954753875732422 ms to run.
cost load scan: 0.016927719116210938
load 3 adapters, 19 in total
Function load_lora_A took 9.305000305175781 ms to run.
Function load_lora_B took 9.253501892089844 ms to run.
Function load_lora_A took 4.944086074829102 ms to run.
Function load_lora_B took 4.937410354614258 ms to run.
Function load_lora_A took 9.301424026489258 ms to run.
Function load_lora_B took 9.253978729248047 ms to run.
cost realload: 47.560691833496094
Function load_adapters took 47.58310317993164 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.013113021850585938 ms to run.
current batch size: 21 token used ratio: 0.1288153846153846
cost load scan: 0.01430511474609375
load 1 adapters, 20 in total
Function load_lora_A took 9.30333137512207 ms to run.
Function load_lora_B took 9.28807258605957 ms to run.
cost realload: 19.010543823242188
Function load_adapters took 19.032955169677734 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 19 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.583648681640625 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 18 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5788803100585938 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 17 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5877017974853516 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 16 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.051975250244140625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5843639373779297 ms to run.
offload 0 adapters, 16 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 15 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5822181701660156 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 16 in total
Function load_lora_A took 2.7854442596435547 ms to run.
Function load_lora_B took 2.78472900390625 ms to run.
cost realload: 5.971431732177734
Function load_adapters took 5.993127822875977 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 15 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.5795955657958984 ms to run.
offload 0 adapters, 15 remains
Function offload_adapters took 0.0133514404296875 ms to run.
cost load scan: 0.015735626220703125
load 2 adapters, 17 in total
Function load_lora_A took 4.966020584106445 ms to run.
Function load_lora_B took 4.913091659545898 ms to run.
Function load_lora_A took 9.332656860351562 ms to run.
Function load_lora_B took 9.267807006835938 ms to run.
cost realload: 28.97334098815918
INFO:     127.0.0.1:57766 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57774 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57780 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57794 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57808 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57810 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57818 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57828 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57842 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57854 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34000 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34002 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34018 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_adapters took 28.995990753173828 ms to run.
current batch size: 17 token used ratio: 0.1003076923076923
cost offload scan: 0.087738037109375
offload 1 adapters, 16 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.5898475646972656 ms to run.
cost load scan: 0.014781951904296875
load 2 adapters, 18 in total
Function load_lora_A took 2.8388500213623047 ms to run.
Function load_lora_B took 2.7976036071777344 ms to run.
Function load_lora_A took 9.310245513916016 ms to run.
Function load_lora_B took 9.264230728149414 ms to run.
cost realload: 24.670124053955078
Function load_adapters took 24.69158172607422 ms to run.
cost offload scan: 0.091552734375
offload 1 adapters, 17 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.5979537963867188 ms to run.
cost load scan: 0.013589859008789062
load 2 adapters, 19 in total
Function load_lora_A took 4.988431930541992 ms to run.
Function load_lora_B took 4.928112030029297 ms to run.
Function load_lora_A took 9.302854537963867 ms to run.
Function load_lora_B took 9.28807258605957 ms to run.
cost realload: 28.973817825317383
Function load_adapters took 28.995275497436523 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 18 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5795955657958984 ms to run.
cost load scan: 0.014543533325195312
load 1 adapters, 19 in total
Function load_lora_A took 2.810955047607422 ms to run.
Function load_lora_B took 2.7933120727539062 ms to run.
cost realload: 6.019353866577148
Function load_adapters took 6.041049957275391 ms to run.
current batch size: 19 token used ratio: 0.11084615384615384
cost load scan: 0.008821487426757812
load 1 adapters, 20 in total
Function load_lora_A took 9.262561798095703 ms to run.
Function load_lora_B took 9.224653244018555 ms to run.
cost realload: 18.883466720581055
Function load_adapters took 18.9054012298584 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 19 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.5996227264404297 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 18 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5867481231689453 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 17 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5841255187988281 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 16 remains
cost offload cat: 0.037670135498046875
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.6167888641357422 ms to run.
cost load scan: 0.014781951904296875
load 1 adapters, 17 in total
Function load_lora_A took 9.349584579467773 ms to run.
Function load_lora_B took 9.285449981689453 ms to run.
cost realload: 19.043445587158203
Function load_adapters took 19.069433212280273 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 16 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5788803100585938 ms to run.
current batch size: 16 token used ratio: 0.093
cost offload scan: 0.08630752563476562
offload 1 adapters, 15 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.591278076171875 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 14 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5707740783691406 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 15 in total
Function load_lora_A took 2.8388500213623047 ms to run.
Function load_lora_B took 2.8066635131835938 ms to run.
cost realload: 6.062030792236328
Function load_adapters took 6.085634231567383 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 14 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5762577056884766 ms to run.
cost offload scan: 0.0820159912109375
offload 1 adapters, 13 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5691051483154297 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 14 in total
Function load_lora_A took 2.8243064880371094 ms to run.
Function load_lora_B took 2.788543701171875 ms to run.
cost realload: 5.990743637084961
Function load_adapters took 6.011724472045898 ms to run.
current batch size: 14 token used ratio: 0.07729230769230769
cost offload scan: 0.08940696716308594
offload 1 adapters, 13 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.047206878662109375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5891323089599609 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 14 in total
Function load_lora_A took 9.305477142333984 ms to run.
Function load_lora_B took 9.271621704101562 ms to run.
cost realload: 18.96834373474121
Function load_adapters took 18.989086151123047 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 15 in total
Function load_lora_A took 4.986286163330078 ms to run.
Function load_lora_B took 4.947900772094727 ms to run.
cost realload: 10.324716567993164
Function load_adapters took 10.346412658691406 ms to run.
cost offload scan: 0.08273124694824219
offload 1 adapters, 14 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10251998901367188
Function offload_adapters took 0.5738735198974609 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 15 in total
Function load_lora_A took 9.294509887695312 ms to run.
Function load_lora_B took 9.238004684448242 ms to run.
cost realload: 18.929243087768555
Function load_adapters took 18.9511775970459 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 16 in total
Function load_lora_A took 9.302377700805664 ms to run.
Function load_lora_B took 9.27281379699707 ms to run.
cost realload: 18.9821720123291
Function load_adapters took 19.00339126586914 ms to run.
Avg tokens(prompt+generate) throughput: 1082.166 tokens/s
Avg prompt tokens throughput:            626.087 tokens/s
Avg generate tokens throughput:          456.079 tokens/s
cost offload scan: 0.08416175842285156
offload 1 adapters, 15 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: INFO:     127.0.0.1:34024 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34040 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34054 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34056 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34070 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34074 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34088 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34092 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34108 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34118 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34130 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34132 - "POST /generate_stream HTTP/1.1" 200 OK
0.022172927856445312
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.6129741668701172 ms to run.
current batch size: 15 token used ratio: 0.08247692307692307
cost offload scan: 0.087738037109375
offload 1 adapters, 14 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5908012390136719 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 15 in total
Function load_lora_A took 4.902362823486328 ms to run.
Function load_lora_B took 4.894495010375977 ms to run.
cost realload: 10.197639465332031
Function load_adapters took 10.219573974609375 ms to run.
cost offload scan: 0.08273124694824219
offload 1 adapters, 14 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10204315185546875
Function offload_adapters took 0.5779266357421875 ms to run.
cost load scan: 0.013589859008789062
load 1 adapters, 15 in total
Function load_lora_A took 9.314298629760742 ms to run.
Function load_lora_B took 9.283065795898438 ms to run.
cost realload: 18.99552345275879
Function load_adapters took 19.018888473510742 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 14 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.5872249603271484 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 13 remains
cost offload cat: 0.035762786865234375
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.579833984375 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 14 in total
Function load_lora_A took 4.904985427856445 ms to run.
Function load_lora_B took 4.899024963378906 ms to run.
cost realload: 10.203838348388672
Function load_adapters took 10.225296020507812 ms to run.
current batch size: 14 token used ratio: 0.07541538461538462
cost offload scan: 0.08320808410644531
offload 1 adapters, 13 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04863739013671875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5712509155273438 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 12 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5846023559570312 ms to run.
cost offload scan: 0.08392333984375
offload 1 adapters, 11 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5764961242675781 ms to run.
cost offload scan: 0.0820159912109375
offload 1 adapters, 10 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.568389892578125 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 11 in total
Function load_lora_A took 4.9648284912109375 ms to run.
Function load_lora_B took 4.934072494506836 ms to run.
cost realload: 10.300159454345703
Function load_adapters took 10.321617126464844 ms to run.
cost offload scan: 0.08225440979003906
offload 1 adapters, 10 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5676746368408203 ms to run.
current batch size: 10 token used ratio: 0.05604615384615384
cost load scan: 0.010251998901367188
load 1 adapters, 11 in total
Function load_lora_A took 9.294509887695312 ms to run.
Function load_lora_B took 9.285926818847656 ms to run.
cost realload: 18.99099349975586
Function load_adapters took 19.012928009033203 ms to run.
cost offload scan: 0.08249282836914062
offload 1 adapters, 10 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5755424499511719 ms to run.
current batch size: 10 token used ratio: 0.06049230769230769
cost offload scan: 0.08678436279296875
offload 1 adapters, 9 remains
cost offload cat: 0.041961669921875
cost offload free mem manager: 0.049114227294921875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.6175041198730469 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 10 in total
Function load_lora_A took 9.330272674560547 ms to run.
Function load_lora_B took 9.296655654907227 ms to run.
cost realload: 19.0584659576416
Function load_adapters took 19.08278465270996 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 11 in total
Function load_lora_A took 9.313106536865234 ms to run.
Function load_lora_B took 9.279251098632812 ms to run.
cost realload: 18.985986709594727
Function load_adapters took 19.00792121887207 ms to run.
cost offload scan: 0.09489059448242188
offload 1 adapters, 10 remains
cost offload cat: 0.03743171691894531
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5955696105957031 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 11 in total
Function load_lora_A took 2.8274059295654297 ms to run.
Function load_lora_B took 2.794981002807617 ms to run.
cost realload: 6.039142608642578
Function load_adapters took 6.060361862182617 ms to run.
current batch size: 11 token used ratio: 0.06572307692307693
cost load scan: 0.01430511474609375
load 1 adapters, 12 in total
Function load_lora_A took 9.258747100830078 ms to run.
Function load_lora_B took 9.230613708496094 ms to run.
cost realload: 18.89204978942871
Function load_adapters took 18.915653228759766 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 11 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.57220458984375 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 12 in total
Function load_lora_A took 2.826213836669922 ms to run.
Function load_lora_B took 2.7916431427001953 ms to run.
cost realload: 6.008386611938477
Function load_adapters took 6.029605865478516 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 11 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5693435668945312 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 12 in total
Function load_lora_A took 2.8035640716552734 ms to run.
Function load_lora_B took 2.7799606323242188 ms to run.
cost realload: 5.973577499389648
Function load_adapters took 5.993366241455078 ms to run.
cost offload scan: 0.0820159912109375
offload 1 adapters, 11 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.579833984375 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 12 in total
Function load_lora_A took 2.8142929077148438 ms to run.
INFO:     127.0.0.1:34138 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49506 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49508 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49520 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49536 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49552 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49568 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49576 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49584 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49588 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49604 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49612 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49622 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49632 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49648 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49650 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49656 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49668 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_B took 2.793550491333008 ms to run.
cost realload: 6.041288375854492
Function load_adapters took 6.063222885131836 ms to run.
current batch size: 12 token used ratio: 0.06823076923076923
cost offload scan: 0.08463859558105469
offload 1 adapters, 11 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04744529724121094
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5745887756347656 ms to run.
cost load scan: 0.01239776611328125
load 1 adapters, 12 in total
Function load_lora_A took 2.840757369995117 ms to run.
Function load_lora_B took 2.782583236694336 ms to run.
cost realload: 6.0214996337890625
Function load_adapters took 6.043672561645508 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 11 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.5698204040527344 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 12 in total
Function load_lora_A took 4.980325698852539 ms to run.
Function load_lora_B took 4.94384765625 ms to run.
cost realload: 10.324478149414062
Function load_adapters took 10.34688949584961 ms to run.
current batch size: 12 token used ratio: 0.06910769230769231
cost load scan: 0.01049041748046875
load 1 adapters, 13 in total
Function load_lora_A took 4.972696304321289 ms to run.
Function load_lora_B took 4.952669143676758 ms to run.
cost realload: 10.316610336303711
Function load_adapters took 10.33782958984375 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 12 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.050067901611328125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5941390991210938 ms to run.
Avg tokens(prompt+generate) throughput:  768.985 tokens/s
Avg prompt tokens throughput:            412.833 tokens/s
Avg generate tokens throughput:          356.152 tokens/s
cost offload scan: 0.0820159912109375
offload 1 adapters, 11 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10275840759277344
Function offload_adapters took 0.5645751953125 ms to run.
cost load scan: 0.014543533325195312
load 1 adapters, 12 in total
Function load_lora_A took 2.7856826782226562 ms to run.
Function load_lora_B took 2.7811527252197266 ms to run.
cost realload: 5.963563919067383
Function load_adapters took 5.985260009765625 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 13 in total
Function load_lora_A took 2.8045177459716797 ms to run.
Function load_lora_B took 2.777099609375 ms to run.
cost realload: 5.977153778076172
Function load_adapters took 5.9986114501953125 ms to run.
current batch size: 13 token used ratio: 0.07950769230769231
cost offload scan: 0.08440017700195312
offload 1 adapters, 12 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5753040313720703 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 13 in total
Function load_lora_A took 9.255647659301758 ms to run.
Function load_lora_B took 9.198427200317383 ms to run.
cost realload: 18.8446044921875
Function load_adapters took 18.866539001464844 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 12 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5726814270019531 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 13 in total
Function load_lora_A took 4.987478256225586 ms to run.
Function load_lora_B took 4.943609237670898 ms to run.
cost realload: 10.329246520996094
Function load_adapters took 10.351419448852539 ms to run.
cost offload scan: 0.12159347534179688
offload 2 adapters, 11 remains
cost offload cat: 0.024557113647460938
cost offload free mem manager: 0.04935264587402344
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.6077289581298828 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 10 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5633831024169922 ms to run.
cost load scan: 0.014066696166992188
load 1 adapters, 11 in total
Function load_lora_A took 2.7976036071777344 ms to run.
Function load_lora_B took 2.7604103088378906 ms to run.
cost realload: 5.957126617431641
Function load_adapters took 5.979061126708984 ms to run.
current batch size: 11 token used ratio: 0.06069230769230769
cost load scan: 0.008344650268554688
load 1 adapters, 12 in total
Function load_lora_A took 4.896879196166992 ms to run.
Function load_lora_B took 4.910945892333984 ms to run.
cost realload: 10.20193099975586
Function load_adapters took 10.223865509033203 ms to run.
cost offload scan: 0.08130073547363281
offload 1 adapters, 11 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5691051483154297 ms to run.
cost load scan: 0.014066696166992188
load 2 adapters, 13 in total
Function load_lora_A took 9.300947189331055 ms to run.
Function load_lora_B took 9.281158447265625 ms to run.
Function load_lora_A took 2.8018951416015625 ms to run.
Function load_lora_B took 2.8128623962402344 ms to run.
cost realload: 24.67036247253418
Function load_adapters took 24.692058563232422 ms to run.
cost load scan: 0.01430511474609375
load 2 adapters, 15 in total
Function load_lora_A took 4.9839019775390625 ms to run.
Function load_lora_B took 4.93311882019043 ms to run.
Function load_lora_A took 2.8018951416015625 ms to run.
Function load_lora_B took 2.7718544006347656 ms to run.
cost realload: 15.964031219482422
Function load_adapters took 15.98501205444336 ms to run.
cost offload scan: 0.08559226989746094
offload 1 adapters, 14 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10275840759277344
Function offload_adapters took 0.5695819854736328 ms to run.
current batch size: 14 token used ratio: 0.07546153846153845
cost load scan: 0.013113021850585938
load 1 adapters, 15 in total
Function load_lora_A took 2.808094024658203 ms to run.
Function load_lora_B took 2.8040409088134766 ms to run.
cost realload: 6.003141403198242
Function load_adapters took 6.023883819580078 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 15 in total
cost realload: 0.28395652770996094
Function load_adapters took 0.3077983856201172 ms to run.
offload 0 adapters, 15 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 16 in total
Function load_lora_A took 9.287834167480469 ms to run.
Function load_lora_B took 9.26518440246582 ms to run.
cost realload: 18.950462341308594
Function load_adapters took 18.971681594848633 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 15 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5695819854736328 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 14 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: INFO:     127.0.0.1:49674 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49686 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49690 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49706 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49718 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49730 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49738 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39986 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39994 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:39996 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40012 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40028 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40038 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40050 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40060 - "POST /generate_stream HTTP/1.1" 200 OK
0.022172927856445312
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.6115436553955078 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 15 in total
Function load_lora_A took 9.270191192626953 ms to run.
Function load_lora_B took 9.259223937988281 ms to run.
cost realload: 18.91493797302246
Function load_adapters took 18.9363956451416 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 16 in total
Function load_lora_A took 4.960298538208008 ms to run.
Function load_lora_B took 4.925012588500977 ms to run.
cost realload: 10.292530059814453
Function load_adapters took 10.313034057617188 ms to run.
current batch size: 17 token used ratio: 0.08216923076923077
cost offload scan: 0.08249282836914062
offload 1 adapters, 15 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5793571472167969 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 16 in total
Function load_lora_A took 9.319067001342773 ms to run.
Function load_lora_B took 9.280204772949219 ms to run.
cost realload: 18.996000289916992
Function load_adapters took 19.017696380615234 ms to run.
cost offload scan: 0.08392333984375
offload 1 adapters, 15 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5848407745361328 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 15 in total
cost realload: 0.27632713317871094
Function load_adapters took 0.3006458282470703 ms to run.
cost offload scan: 0.08249282836914062
offload 1 adapters, 14 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5707740783691406 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 14 in total
cost realload: 0.2663135528564453
Function load_adapters took 0.28896331787109375 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 13 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5738735198974609 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 14 in total
Function load_lora_A took 2.757549285888672 ms to run.
Function load_lora_B took 2.814769744873047 ms to run.
cost realload: 5.960702896118164
Function load_adapters took 5.981683731079102 ms to run.
current batch size: 17 token used ratio: 0.08461538461538462
cost load scan: 0.014066696166992188
load 1 adapters, 15 in total
Function load_lora_A took 2.8421878814697266 ms to run.
Function load_lora_B took 2.7818679809570312 ms to run.
cost realload: 6.020069122314453
Function load_adapters took 6.040811538696289 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 14 remains
cost offload cat: 0.03695487976074219
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.5860328674316406 ms to run.
cost load scan: 0.013828277587890625
load 1 adapters, 15 in total
Function load_lora_A took 2.833843231201172 ms to run.
Function load_lora_B took 2.7844905853271484 ms to run.
cost realload: 6.018877029418945
Function load_adapters took 6.041049957275391 ms to run.
offload 0 adapters, 15 remains
Function offload_adapters took 0.014066696166992188 ms to run.
cost load scan: 0.015497207641601562
load 1 adapters, 16 in total
Function load_lora_A took 2.8200149536132812 ms to run.
Function load_lora_B took 2.797365188598633 ms to run.
cost realload: 6.026744842529297
Function load_adapters took 6.047964096069336 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 15 remains
cost offload cat: 0.02956390380859375
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.5748271942138672 ms to run.
current batch size: 17 token used ratio: 0.09358461538461539
cost offload scan: 0.08320808410644531
offload 1 adapters, 14 remains
cost offload cat: 0.03695487976074219
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5772113800048828 ms to run.
Avg tokens(prompt+generate) throughput: 1000.675 tokens/s
Avg prompt tokens throughput:            577.409 tokens/s
Avg generate tokens throughput:          423.266 tokens/s
cost offload scan: 0.0896453857421875
offload 1 adapters, 13 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10180473327636719
Function offload_adapters took 0.5781650543212891 ms to run.
offload 0 adapters, 13 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 12 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.5824565887451172 ms to run.
current batch size: 13 token used ratio: 0.07724615384615384
cost offload scan: 0.08416175842285156
offload 1 adapters, 11 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.029325485229492188
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5803108215332031 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 12 in total
Function load_lora_A took 9.319782257080078 ms to run.
Function load_lora_B took 9.275674819946289 ms to run.
cost realload: 18.984079360961914
Function load_adapters took 19.00482177734375 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 11 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5762577056884766 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 12 in total
Function load_lora_A took 9.284496307373047 ms to run.
Function load_lora_B took 9.255647659301758 ms to run.
cost realload: 18.921375274658203
Function load_adapters took 18.94521713256836 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 13 in total
Function load_lora_A took 4.899024963378906 ms to run.
Function load_lora_B took 4.877328872680664 ms to run.
cost realload: 10.166406631469727
Function load_adapters took 10.188817977905273 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 12 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5726814270019531 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 13 in total
Function load_lora_A took 2.805948257446289 ms to run.
Function load_lora_B took 2.769947052001953 ms to run.
cost realload: 5.950689315795898
Function load_adapters took 5.972385406494141 ms to run.
current batch size: 14 token used ratio: 0.08584615384615385
cost load scan: 0.007867813110351562
load 0 adapters, 13 in total
cost realload: 0.2827644348144531
Function load_adapters took 0.3066062927246094 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 12 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02193450927734375
INFO:     127.0.0.1:40064 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40070 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40074 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40078 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40082 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40086 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40088 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40092 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40100 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40108 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40112 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40118 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40132 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40146 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40158 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40172 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40180 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52194 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5946159362792969 ms to run.
cost offload scan: 0.1201629638671875
offload 2 adapters, 10 remains
cost offload cat: 0.024318695068359375
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5950927734375 ms to run.
cost load scan: 0.011682510375976562
load 2 adapters, 12 in total
Function load_lora_A took 9.280204772949219 ms to run.
Function load_lora_B took 9.256124496459961 ms to run.
Function load_lora_A took 4.959583282470703 ms to run.
Function load_lora_B took 4.911184310913086 ms to run.
cost realload: 28.876781463623047
Function load_adapters took 28.898239135742188 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 13 in total
Function load_lora_A took 2.8231143951416016 ms to run.
Function load_lora_B took 2.801656723022461 ms to run.
cost realload: 6.015539169311523
Function load_adapters took 6.036996841430664 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 14 in total
Function load_lora_A took 2.7670860290527344 ms to run.
Function load_lora_B took 2.779722213745117 ms to run.
cost realload: 5.93876838684082
Function load_adapters took 5.961418151855469 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 13 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10180473327636719
Function offload_adapters took 0.5743503570556641 ms to run.
current batch size: 16 token used ratio: 0.08838461538461538
cost offload scan: 0.08559226989746094
offload 1 adapters, 12 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5707740783691406 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 13 in total
Function load_lora_A took 4.977226257324219 ms to run.
Function load_lora_B took 4.937171936035156 ms to run.
cost realload: 10.309696197509766
Function load_adapters took 10.334491729736328 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 12 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10132789611816406
Function offload_adapters took 0.5755424499511719 ms to run.
cost load scan: 0.013589859008789062
load 2 adapters, 14 in total
Function load_lora_A took 2.8226375579833984 ms to run.
Function load_lora_B took 2.813100814819336 ms to run.
Function load_lora_A took 2.798318862915039 ms to run.
Function load_lora_B took 2.7773380279541016 ms to run.
cost realload: 11.682271957397461
Function load_adapters took 11.703968048095703 ms to run.
cost load scan: 0.010967254638671875
load 2 adapters, 16 in total
Function load_lora_A took 4.938364028930664 ms to run.
Function load_lora_B took 4.937410354614258 ms to run.
Function load_lora_A took 4.901647567749023 ms to run.
Function load_lora_B took 4.9228668212890625 ms to run.
cost realload: 20.170211791992188
Function load_adapters took 20.191431045532227 ms to run.
current batch size: 18 token used ratio: 0.09470769230769231
cost load scan: 0.014543533325195312
load 1 adapters, 17 in total
Function load_lora_A took 9.294509887695312 ms to run.
Function load_lora_B took 9.283065795898438 ms to run.
cost realload: 19.00649070739746
Function load_adapters took 19.028902053833008 ms to run.
offload 0 adapters, 17 remains
Function offload_adapters took 0.014066696166992188 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 16 remains
cost offload cat: 0.040531158447265625
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.6012916564941406 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 17 in total
Function load_lora_A took 2.782106399536133 ms to run.
Function load_lora_B took 2.8100013732910156 ms to run.
cost realload: 5.990505218505859
Function load_adapters took 6.011962890625 ms to run.
cost load scan: 0.012159347534179688
load 2 adapters, 19 in total
Function load_lora_A took 4.998922348022461 ms to run.
Function load_lora_B took 4.928350448608398 ms to run.
Function load_lora_A took 9.281158447265625 ms to run.
Function load_lora_B took 9.302139282226562 ms to run.
cost realload: 28.98097038269043
Function load_adapters took 29.00242805480957 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 18 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.5958080291748047 ms to run.
cost load scan: 0.008821487426757812
load 0 adapters, 18 in total
cost realload: 0.2791881561279297
Function load_adapters took 0.3032684326171875 ms to run.
current batch size: 21 token used ratio: 0.10758461538461539
cost offload scan: 0.09131431579589844
offload 1 adapters, 17 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11205673217773438
Function offload_adapters took 0.6015300750732422 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 18 in total
Function load_lora_A took 2.805471420288086 ms to run.
Function load_lora_B took 2.763032913208008 ms to run.
cost realload: 5.977392196655273
Function load_adapters took 6.001710891723633 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.016927719116210938 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 17 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5939006805419922 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 18 in total
Function load_lora_A took 9.315252304077148 ms to run.
Function load_lora_B took 9.256839752197266 ms to run.
cost realload: 18.963098526000977
Function load_adapters took 18.984079360961914 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 19 in total
Function load_lora_A took 9.237527847290039 ms to run.
Function load_lora_B took 9.201765060424805 ms to run.
cost realload: 18.8596248626709
Function load_adapters took 18.882036209106445 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.012159347534179688 ms to run.
current batch size: 20 token used ratio: 0.10627692307692307
offload 0 adapters, 19 remains
Function offload_adapters took 0.011920928955078125 ms to run.
Avg tokens(prompt+generate) throughput: 1052.650 tokens/s
Avg prompt tokens throughput:            582.224 tokens/s
Avg generate tokens throughput:          470.427 tokens/s
cost offload scan: 0.09059906005859375
offload 1 adapters, 18 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5915164947509766 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 17 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5741119384765625 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 16 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5812644958496094 ms to run.
cost load scan: 0.010251998901367188
INFO:     127.0.0.1:52204 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52212 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52226 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52228 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52238 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52246 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52256 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52270 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52274 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52288 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52296 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52302 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52306 - "POST /generate_stream HTTP/1.1" 200 OK
load 1 adapters, 17 in total
Function load_lora_A took 2.8154850006103516 ms to run.
Function load_lora_B took 2.785921096801758 ms to run.
cost realload: 6.023168563842773
Function load_adapters took 6.043910980224609 ms to run.
current batch size: 17 token used ratio: 0.09441538461538461
cost offload scan: 0.12803077697753906
offload 2 adapters, 15 remains
cost offload cat: 0.025272369384765625
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.6227493286132812 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 16 in total
Function load_lora_A took 9.304046630859375 ms to run.
Function load_lora_B took 9.267091751098633 ms to run.
cost realload: 18.96953582763672
Function load_adapters took 18.990516662597656 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 15 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5767345428466797 ms to run.
cost offload scan: 0.08392333984375
offload 1 adapters, 14 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10204315185546875
Function offload_adapters took 0.5660057067871094 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 13 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5664825439453125 ms to run.
current batch size: 13 token used ratio: 0.07676923076923077
cost load scan: 0.01049041748046875
load 1 adapters, 14 in total
Function load_lora_A took 4.916906356811523 ms to run.
Function load_lora_B took 4.84466552734375 ms to run.
cost realload: 10.159730911254883
Function load_adapters took 10.180950164794922 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 13 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5755424499511719 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 14 in total
Function load_lora_A took 4.975557327270508 ms to run.
Function load_lora_B took 4.947185516357422 ms to run.
cost realload: 10.319709777832031
Function load_adapters took 10.341167449951172 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 15 in total
Function load_lora_A took 4.942893981933594 ms to run.
Function load_lora_B took 4.930257797241211 ms to run.
cost realload: 10.269880294799805
Function load_adapters took 10.29205322265625 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 14 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5879402160644531 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 15 in total
Function load_lora_A took 4.963874816894531 ms to run.
Function load_lora_B took 4.926443099975586 ms to run.
cost realload: 10.285139083862305
Function load_adapters took 10.306358337402344 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 14 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5767345428466797 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 13 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10204315185546875
Function offload_adapters took 0.5650520324707031 ms to run.
current batch size: 13 token used ratio: 0.0751076923076923
cost offload scan: 0.08392333984375
offload 1 adapters, 12 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.5784034729003906 ms to run.
cost load scan: 0.01239776611328125
load 1 adapters, 13 in total
Function load_lora_A took 2.812623977661133 ms to run.
Function load_lora_B took 2.8138160705566406 ms to run.
cost realload: 6.0253143310546875
Function load_adapters took 6.046295166015625 ms to run.
cost load scan: 0.015020370483398438
load 2 adapters, 15 in total
Function load_lora_A took 9.294271469116211 ms to run.
Function load_lora_B took 9.248018264770508 ms to run.
Function load_lora_A took 2.7916431427001953 ms to run.
Function load_lora_B took 2.772808074951172 ms to run.
cost realload: 24.580955505371094
Function load_adapters took 24.602413177490234 ms to run.
cost load scan: 0.00858306884765625
load 0 adapters, 15 in total
cost realload: 0.28967857360839844
Function load_adapters took 0.3139972686767578 ms to run.
current batch size: 17 token used ratio: 0.0946
cost offload scan: 0.08535385131835938
offload 1 adapters, 14 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.583648681640625 ms to run.
cost load scan: 0.01239776611328125
load 1 adapters, 15 in total
Function load_lora_A took 9.314298629760742 ms to run.
Function load_lora_B took 9.293079376220703 ms to run.
cost realload: 18.996715545654297
Function load_adapters took 19.01841163635254 ms to run.
cost offload scan: 0.08392333984375
offload 1 adapters, 14 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5793571472167969 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 13 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5736351013183594 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 12 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04839897155761719
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5733966827392578 ms to run.
cost offload scan: 0.08273124694824219
offload 1 adapters, 11 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.029087066650390625
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5750656127929688 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 12 in total
Function load_lora_A took 2.837657928466797 ms to run.
Function load_lora_B took 2.8002262115478516 ms to run.
cost realload: 6.038665771484375
Function load_adapters took 6.060123443603516 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 11 remains
cost offload cat: 0.02956390380859375
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.5776882171630859 ms to run.
offload 0 adapters, 11 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost load scan: 0.014543533325195312
load 1 adapters, 12 in total
Function load_lora_A took 2.81524658203125 ms to run.
Function load_lora_B took 2.7933120727539062 ms to run.
cost realload: 6.01649284362793
Function load_adapters took 6.038188934326172 ms to run.
cost offload scan: INFO:     127.0.0.1:52310 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52326 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52342 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52346 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:52354 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42066 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42070 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42082 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42098 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42108 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42118 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42120 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42134 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42140 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42148 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42164 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42172 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42188 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42202 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42210 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42224 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42232 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42234 - "POST /generate_stream HTTP/1.1" 200 OK
0.087738037109375
offload 1 adapters, 11 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5977153778076172 ms to run.
current batch size: 12 token used ratio: 0.05686153846153846
cost load scan: 0.007867813110351562
load 0 adapters, 11 in total
cost realload: 0.2818107604980469
Function load_adapters took 0.30517578125 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 11 in total
cost realload: 0.2722740173339844
Function load_adapters took 0.29587745666503906 ms to run.
cost offload scan: 0.08177757263183594
offload 1 adapters, 10 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5729198455810547 ms to run.
cost load scan: 0.009298324584960938
load 2 adapters, 12 in total
Function load_lora_A took 2.8123855590820312 ms to run.
Function load_lora_B took 2.7816295623779297 ms to run.
Function load_lora_A took 4.912614822387695 ms to run.
Function load_lora_B took 4.885196685791016 ms to run.
cost realload: 15.863656997680664
Function load_adapters took 15.885353088378906 ms to run.
cost offload scan: 0.08130073547363281
offload 1 adapters, 11 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10228157043457031
Function offload_adapters took 0.5729198455810547 ms to run.
current batch size: 14 token used ratio: 0.06933846153846154
cost load scan: 0.008106231689453125
load 0 adapters, 11 in total
cost realload: 0.27441978454589844
Function load_adapters took 0.2980232238769531 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 12 in total
Function load_lora_A took 9.282112121582031 ms to run.
Function load_lora_B took 9.276390075683594 ms to run.
cost realload: 18.944740295410156
Function load_adapters took 18.966197967529297 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 11 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10180473327636719
Function offload_adapters took 0.5657672882080078 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 12 in total
Function load_lora_A took 9.250879287719727 ms to run.
Function load_lora_B took 9.264945983886719 ms to run.
cost realload: 18.902063369750977
Function load_adapters took 18.924236297607422 ms to run.
cost offload scan: 0.08177757263183594
offload 1 adapters, 11 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10037422180175781
Function offload_adapters took 0.5576610565185547 ms to run.
Avg tokens(prompt+generate) throughput:  935.943 tokens/s
Avg prompt tokens throughput:            502.908 tokens/s
Avg generate tokens throughput:          433.035 tokens/s
cost load scan: 0.01239776611328125
load 1 adapters, 12 in total
Function load_lora_A took 2.8247833251953125 ms to run.
Function load_lora_B took 2.7484893798828125 ms to run.
cost realload: 5.976676940917969
Function load_adapters took 5.997657775878906 ms to run.
current batch size: 16 token used ratio: 0.08223076923076923
cost load scan: 0.008821487426757812
load 1 adapters, 13 in total
Function load_lora_A took 9.321212768554688 ms to run.
Function load_lora_B took 9.257793426513672 ms to run.
cost realload: 18.984079360961914
Function load_adapters took 19.00625228881836 ms to run.
offload 0 adapters, 13 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost load scan: 0.015020370483398438
load 2 adapters, 15 in total
Function load_lora_A took 9.345531463623047 ms to run.
Function load_lora_B took 9.2315673828125 ms to run.
Function load_lora_A took 2.7723312377929688 ms to run.
Function load_lora_B took 2.7768611907958984 ms to run.
cost realload: 24.60479736328125
Function load_adapters took 24.626731872558594 ms to run.
cost load scan: 0.013589859008789062
load 0 adapters, 15 in total
cost realload: 0.28061866760253906
Function load_adapters took 0.3044605255126953 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 16 in total
Function load_lora_A took 9.313106536865234 ms to run.
Function load_lora_B took 9.238719940185547 ms to run.
cost realload: 18.94974708557129
Function load_adapters took 18.970727920532227 ms to run.
current batch size: 21 token used ratio: 0.10718461538461538
cost load scan: 0.011920928955078125
load 1 adapters, 17 in total
Function load_lora_A took 4.969596862792969 ms to run.
Function load_lora_B took 4.9190521240234375 ms to run.
cost realload: 10.290145874023438
Function load_adapters took 10.311126708984375 ms to run.
offload 0 adapters, 17 remains
Function offload_adapters took 0.013828277587890625 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 18 in total
Function load_lora_A took 2.802610397338867 ms to run.
Function load_lora_B took 2.7959346771240234 ms to run.
cost realload: 5.979299545288086
Function load_adapters took 6.000280380249023 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.017881393432617188 ms to run.
cost load scan: 0.008821487426757812
load 0 adapters, 18 in total
cost realload: 0.2837181091308594
Function load_adapters took 0.30803680419921875 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.012159347534179688 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.013589859008789062
load 1 adapters, 19 in total
Function load_lora_A took 4.988193511962891 ms to run.
Function load_lora_B took 4.891872406005859 ms to run.
cost realload: 10.277986526489258
Function load_adapters took 10.300159454345703 ms to run.
cost offload scan: 0.08392333984375
offload 1 adapters, 18 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.5879402160644531 ms to run.
current batch size: 20 token used ratio: 0.10946153846153846
cost load scan: 0.0133514404296875
load 1 adapters, 19 in total
Function load_lora_A took 9.302854537963867 ms to run.
Function load_lora_B took 9.252071380615234 ms to run.
cost realload: 18.96524429321289
Function load_adapters took 18.98670196533203 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 18 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5805492401123047 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 17 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5795955657958984 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 18 in total
Function load_lora_A took 5.021333694458008 ms to run.
Function load_lora_B took 4.97126579284668 ms to run.
cost realload: 10.375738143920898
Function load_adapters took 10.396718978881836 ms to run.
cost load scan: 0.012159347534179688
load 1 adapters, 19 in total
Function load_lora_A took 9.313344955444336 ms to run.
Function load_lora_B took 9.29403305053711 ms to run.
cost realload: 19.014835357666016
Function load_adapters took 19.036531448364258 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 20 in total
Function load_lora_A took 4.926919937133789 ms to run.
Function load_lora_B took 4.90117073059082 ms to run.
cost realload: 10.219335556030273
Function load_adapters took 10.24174690246582 ms to run.
INFO:     127.0.0.1:42244 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42248 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42250 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42262 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42272 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35376 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35382 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35386 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35402 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35414 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35422 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35434 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload scan: 0.08702278137207031
offload 1 adapters, 19 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.6096363067626953 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 18 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04887580871582031
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5834102630615234 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 19 in total
Function load_lora_A took 4.9343109130859375 ms to run.
Function load_lora_B took 4.912137985229492 ms to run.
cost realload: 10.238885879516602
Function load_adapters took 10.259151458740234 ms to run.
current batch size: 21 token used ratio: 0.11184615384615385
cost offload scan: 0.08845329284667969
offload 1 adapters, 18 remains
cost offload cat: 0.03814697265625
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6084442138671875 ms to run.
cost load scan: 0.0209808349609375
load 1 adapters, 19 in total
Function load_lora_A took 9.28044319152832 ms to run.
Function load_lora_B took 9.222269058227539 ms to run.
cost realload: 18.927812576293945
Function load_adapters took 18.953561782836914 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 18 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5838871002197266 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 19 in total
Function load_lora_A took 4.944562911987305 ms to run.
Function load_lora_B took 4.8656463623046875 ms to run.
cost realload: 10.208845138549805
Function load_adapters took 10.232925415039062 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 20 in total
Function load_lora_A took 9.326457977294922 ms to run.
Function load_lora_B took 9.259939193725586 ms to run.
cost realload: 18.98050308227539
Function load_adapters took 19.002676010131836 ms to run.
current batch size: 22 token used ratio: 0.12476923076923077
cost offload scan: 0.09274482727050781
offload 1 adapters, 19 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5881786346435547 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 18 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5869865417480469 ms to run.
cost load scan: 0.013589859008789062
load 2 adapters, 20 in total
Function load_lora_A took 2.8655529022216797 ms to run.
Function load_lora_B took 2.805948257446289 ms to run.
Function load_lora_A took 9.287118911743164 ms to run.
Function load_lora_B took 9.274005889892578 ms to run.
cost realload: 24.707794189453125
Function load_adapters took 24.72972869873047 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 19 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5776882171630859 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 18 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.576019287109375 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 17 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5822181701660156 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 16 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5848407745361328 ms to run.
cost offload scan: 0.0820159912109375
offload 1 adapters, 15 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.027894973754882812
cost offload a_loc update: 0.10085105895996094
Function offload_adapters took 0.5741119384765625 ms to run.
cost load scan: 0.0152587890625
load 2 adapters, 17 in total
Function load_lora_A took 2.820253372192383 ms to run.
Function load_lora_B took 2.779245376586914 ms to run.
Function load_lora_A took 9.25588607788086 ms to run.
Function load_lora_B took 9.196043014526367 ms to run.
cost realload: 24.5211124420166
Function load_adapters took 24.542808532714844 ms to run.
current batch size: 18 token used ratio: 0.10069230769230769
cost offload scan: 0.12564659118652344
offload 2 adapters, 15 remains
cost offload cat: 0.024318695068359375
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.6091594696044922 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 14 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5738735198974609 ms to run.
cost load scan: 0.0095367431640625
load 2 adapters, 16 in total
Function load_lora_A took 9.305953979492188 ms to run.
Function load_lora_B took 9.295463562011719 ms to run.
Function load_lora_A took 2.7959346771240234 ms to run.
Function load_lora_B took 2.748727798461914 ms to run.
cost realload: 24.617671966552734
Function load_adapters took 24.639606475830078 ms to run.
cost load scan: 0.013589859008789062
load 1 adapters, 17 in total
Function load_lora_A took 2.796173095703125 ms to run.
Function load_lora_B took 2.8123855590820312 ms to run.
cost realload: 6.004810333251953
Function load_adapters took 6.025791168212891 ms to run.
offload 0 adapters, 17 remains
Function offload_adapters took 0.01239776611328125 ms to run.
Avg tokens(prompt+generate) throughput: 1169.099 tokens/s
Avg prompt tokens throughput:            643.863 tokens/s
Avg generate tokens throughput:          525.236 tokens/s
cost offload scan: 0.08559226989746094
offload 1 adapters, 16 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5695819854736328 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 15 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5750656127929688 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 16 in total
Function load_lora_A took 9.314537048339844 ms to run.
Function load_lora_B took 9.263277053833008 ms to run.
cost realload: 18.986940383911133
Function load_adapters took 19.00792121887207 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 15 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022411346435546875
INFO:     127.0.0.1:35450 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35458 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35474 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35484 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35496 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35510 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35522 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35528 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35544 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35560 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35568 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5981922149658203 ms to run.
current batch size: 15 token used ratio: 0.08098461538461539
cost load scan: 0.008344650268554688
load 1 adapters, 16 in total
Function load_lora_A took 2.8121471405029297 ms to run.
Function load_lora_B took 2.783536911010742 ms to run.
cost realload: 5.985498428344727
Function load_adapters took 6.00743293762207 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 15 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04744529724121094
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.6091594696044922 ms to run.
cost load scan: 0.010013580322265625
load 1 adapters, 16 in total
Function load_lora_A took 9.26065444946289 ms to run.
Function load_lora_B took 9.173393249511719 ms to run.
cost realload: 18.822669982910156
Function load_adapters took 18.845081329345703 ms to run.
cost load scan: 0.019788742065429688
load 1 adapters, 17 in total
Function load_lora_A took 4.995107650756836 ms to run.
Function load_lora_B took 4.95147705078125 ms to run.
cost realload: 10.36834716796875
Function load_adapters took 10.390520095825195 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 16 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5788803100585938 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 17 in total
Function load_lora_A took 4.915952682495117 ms to run.
Function load_lora_B took 4.9228668212890625 ms to run.
cost realload: 10.259151458740234
Function load_adapters took 10.282516479492188 ms to run.
current batch size: 17 token used ratio: 0.09424615384615384
cost load scan: 0.013589859008789062
load 1 adapters, 18 in total
Function load_lora_A took 9.293317794799805 ms to run.
Function load_lora_B took 9.255409240722656 ms to run.
cost realload: 18.946170806884766
Function load_adapters took 18.9669132232666 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 17 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5757808685302734 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 18 in total
Function load_lora_A took 9.272575378417969 ms to run.
Function load_lora_B took 9.234428405761719 ms to run.
cost realload: 18.90254020690918
Function load_adapters took 18.924236297607422 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 17 remains
cost offload cat: 0.04482269287109375
cost offload free mem manager: 0.0476837158203125
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.6227493286132812 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 16 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.051021575927734375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5915164947509766 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 15 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04744529724121094
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5764961242675781 ms to run.
current batch size: 16 token used ratio: 0.09064615384615385
cost offload scan: 0.08320808410644531
offload 1 adapters, 14 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04839897155761719
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5753040313720703 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 13 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5803108215332031 ms to run.
current batch size: 14 token used ratio: 0.08815384615384615
cost load scan: 0.011920928955078125
load 1 adapters, 14 in total
Function load_lora_A took 9.272098541259766 ms to run.
Function load_lora_B took 9.250879287719727 ms to run.
cost realload: 18.945932388305664
Function load_adapters took 18.967628479003906 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 13 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5731582641601562 ms to run.
cost offload scan: 0.12350082397460938
offload 2 adapters, 11 remains
cost offload cat: 0.02574920654296875
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.6194114685058594 ms to run.
cost offload scan: 0.08249282836914062
offload 1 adapters, 10 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5671977996826172 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 10 in total
cost realload: 0.2913475036621094
Function load_adapters took 0.31495094299316406 ms to run.
current batch size: 12 token used ratio: 0.07392307692307692
cost load scan: 0.010967254638671875
load 1 adapters, 11 in total
Function load_lora_A took 2.7959346771240234 ms to run.
Function load_lora_B took 2.811431884765625 ms to run.
cost realload: 6.002187728881836
Function load_adapters took 6.023645401000977 ms to run.
cost offload scan: 0.08225440979003906
offload 1 adapters, 10 remains
cost offload cat: 0.03719329833984375
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5779266357421875 ms to run.
cost offload scan: 0.08249282836914062
offload 1 adapters, 9 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5731582641601562 ms to run.
cost offload scan: 0.08153915405273438
offload 1 adapters, 8 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5655288696289062 ms to run.
offload 0 adapters, 8 remains
Function offload_adapters took 0.011920928955078125 ms to run.
current batch size: 9 token used ratio: 0.052046153846153846
cost load scan: 0.015497207641601562
load 2 adapters, 10 in total
Function load_lora_A took 2.7899742126464844 ms to run.
Function load_lora_B took 2.776622772216797 ms to run.
Function load_lora_A took 9.310722351074219 ms to run.
Function load_lora_B took 9.264230728149414 ms to run.
cost realload: 24.621009826660156
Function load_adapters took 24.642467498779297 ms to run.
cost offload scan: 0.08296966552734375
offload 1 adapters, 9 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.5726814270019531 ms to run.
offload 0 adapters, 9 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost offload scan: 0.08153915405273438
offload 1 adapters, 8 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.042438507080078125
INFO:     127.0.0.1:46404 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46408 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46420 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46424 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46436 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46444 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46452 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46454 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46468 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46476 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46480 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46494 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46510 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46520 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54114 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10228157043457031
Function offload_adapters took 0.6110668182373047 ms to run.
cost offload scan: 0.08177757263183594
offload 1 adapters, 7 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5669593811035156 ms to run.
cost offload scan: 0.08034706115722656
offload 1 adapters, 6 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.5731582641601562 ms to run.
Avg tokens(prompt+generate) throughput:  741.891 tokens/s
Avg prompt tokens throughput:            320.553 tokens/s
Avg generate tokens throughput:          421.338 tokens/s
current batch size: 6 token used ratio: 0.035046153846153845
cost load scan: 0.011444091796875
load 1 adapters, 7 in total
Function load_lora_A took 2.8076171875 ms to run.
Function load_lora_B took 2.7794837951660156 ms to run.
cost realload: 5.985021591186523
Function load_adapters took 6.0062408447265625 ms to run.
cost offload scan: 0.08106231689453125
offload 1 adapters, 6 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5631446838378906 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 7 in total
Function load_lora_A took 9.315729141235352 ms to run.
Function load_lora_B took 9.26661491394043 ms to run.
cost realload: 18.977880477905273
Function load_adapters took 18.999338150024414 ms to run.
cost offload scan: 0.07987022399902344
offload 1 adapters, 6 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5636215209960938 ms to run.
current batch size: 6 token used ratio: 0.032784615384615384
cost load scan: 0.013113021850585938
load 1 adapters, 7 in total
Function load_lora_A took 4.978179931640625 ms to run.
Function load_lora_B took 4.981756210327148 ms to run.
cost realload: 10.351181030273438
Function load_adapters took 10.373115539550781 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 8 in total
Function load_lora_A took 2.825498580932617 ms to run.
Function load_lora_B took 2.8121471405029297 ms to run.
cost realload: 6.026506423950195
Function load_adapters took 6.047964096069336 ms to run.
current batch size: 8 token used ratio: 0.045338461538461536
cost load scan: 0.008344650268554688
load 1 adapters, 9 in total
Function load_lora_A took 4.955291748046875 ms to run.
Function load_lora_B took 4.966497421264648 ms to run.
cost realload: 10.30874252319336
Function load_adapters took 10.329723358154297 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 8 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5688667297363281 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 9 in total
Function load_lora_A took 4.992961883544922 ms to run.
Function load_lora_B took 4.923105239868164 ms to run.
cost realload: 10.30731201171875
Function load_adapters took 10.328292846679688 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 10 in total
Function load_lora_A took 9.34147834777832 ms to run.
Function load_lora_B took 9.273290634155273 ms to run.
cost realload: 19.000530242919922
Function load_adapters took 19.02174949645996 ms to run.
cost offload scan: 0.0820159912109375
offload 1 adapters, 9 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5755424499511719 ms to run.
current batch size: 9 token used ratio: 0.05466153846153846
cost load scan: 0.010967254638671875
load 1 adapters, 10 in total
Function load_lora_A took 4.899263381958008 ms to run.
Function load_lora_B took 4.886865615844727 ms to run.
cost realload: 10.180950164794922
Function load_adapters took 10.20193099975586 ms to run.
cost load scan: 0.019788742065429688
load 1 adapters, 11 in total
Function load_lora_A took 4.977703094482422 ms to run.
Function load_lora_B took 4.924774169921875 ms to run.
cost realload: 10.308265686035156
Function load_adapters took 10.329008102416992 ms to run.
current batch size: 11 token used ratio: 0.06787692307692307
cost offload scan: 0.08630752563476562
offload 1 adapters, 10 remains
cost offload cat: 0.03838539123535156
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.5981922149658203 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 11 in total
Function load_lora_A took 2.824068069458008 ms to run.
Function load_lora_B took 2.7887821197509766 ms to run.
cost realload: 6.037473678588867
Function load_adapters took 6.060123443603516 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 12 in total
Function load_lora_A took 9.308338165283203 ms to run.
Function load_lora_B took 9.260177612304688 ms to run.
cost realload: 18.973350524902344
Function load_adapters took 18.995285034179688 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 13 in total
Function load_lora_A took 2.8045177459716797 ms to run.
Function load_lora_B took 2.797365188598633 ms to run.
cost realload: 5.999565124511719
Function load_adapters took 6.020307540893555 ms to run.
current batch size: 13 token used ratio: 0.08552307692307692
cost offload scan: 0.08726119995117188
offload 1 adapters, 12 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5795955657958984 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 11 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.5748271942138672 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 10 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11205673217773438
Function offload_adapters took 0.5807876586914062 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 11 in total
Function load_lora_A took 9.324789047241211 ms to run.
Function load_lora_B took 9.26351547241211 ms to run.
cost realload: 18.982887268066406
Function load_adapters took 19.00458335876465 ms to run.
cost load scan: 0.013589859008789062
load 1 adapters, 12 in total
Function load_lora_A took 4.946708679199219 ms to run.
Function load_lora_B took 4.897594451904297 ms to run.
cost realload: 10.244131088256836
Function load_adapters took 10.267019271850586 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 13 in total
Function load_lora_A took 4.995584487915039 ms to run.
Function load_lora_B took 4.970550537109375 ms to run.
cost realload: 10.363578796386719
Function load_adapters took 10.387659072875977 ms to run.
current batch size: 13 token used ratio: 0.07867692307692307
cost offload scan: 0.08344650268554688
offload 1 adapters, 12 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5667209625244141 ms to run.
INFO:     127.0.0.1:54124 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54140 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54142 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54148 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54162 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54166 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54168 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54174 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54184 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54192 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54206 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54210 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54212 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54226 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54232 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54236 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54240 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54246 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54260 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54268 - "POST /generate_stream HTTP/1.1" 200 OK
cost load scan: 0.014066696166992188
load 1 adapters, 13 in total
Function load_lora_A took 2.8073787689208984 ms to run.
Function load_lora_B took 2.7866363525390625 ms to run.
cost realload: 5.990505218505859
Function load_adapters took 6.012201309204102 ms to run.
cost offload scan: 0.08463859558105469
offload 1 adapters, 12 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5669593811035156 ms to run.
cost offload scan: 0.08296966552734375
offload 1 adapters, 11 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5638599395751953 ms to run.
Avg tokens(prompt+generate) throughput:  725.861 tokens/s
Avg prompt tokens throughput:            430.362 tokens/s
Avg generate tokens throughput:          295.499 tokens/s
cost load scan: 0.012636184692382812
load 1 adapters, 12 in total
Function load_lora_A took 2.8274059295654297 ms to run.
Function load_lora_B took 2.7587413787841797 ms to run.
cost realload: 5.990028381347656
Function load_adapters took 6.011962890625 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 13 in total
Function load_lora_A took 9.327173233032227 ms to run.
Function load_lora_B took 9.283304214477539 ms to run.
cost realload: 18.999814987182617
Function load_adapters took 19.021272659301758 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 12 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04839897155761719
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5781650543212891 ms to run.
current batch size: 12 token used ratio: 0.07496923076923077
cost offload scan: 0.08249282836914062
offload 1 adapters, 11 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5793571472167969 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 12 in total
Function load_lora_A took 4.914760589599609 ms to run.
Function load_lora_B took 4.928827285766602 ms to run.
cost realload: 10.23721694946289
Function load_adapters took 10.25843620300293 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 11 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.5877017974853516 ms to run.
cost load scan: 0.02193450927734375
load 1 adapters, 12 in total
Function load_lora_A took 2.8510093688964844 ms to run.
Function load_lora_B took 2.8133392333984375 ms to run.
cost realload: 6.078004837036133
Function load_adapters took 6.099939346313477 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 11 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5674362182617188 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 12 in total
Function load_lora_A took 9.298324584960938 ms to run.
Function load_lora_B took 9.285688400268555 ms to run.
cost realload: 18.98336410522461
Function load_adapters took 19.00458335876465 ms to run.
current batch size: 12 token used ratio: 0.06869230769230769
cost load scan: 0.012874603271484375
load 1 adapters, 13 in total
Function load_lora_A took 5.001068115234375 ms to run.
Function load_lora_B took 4.911661148071289 ms to run.
cost realload: 10.30278205871582
Function load_adapters took 10.324716567993164 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 14 in total
Function load_lora_A took 4.984378814697266 ms to run.
Function load_lora_B took 4.9304962158203125 ms to run.
cost realload: 10.31041145324707
Function load_adapters took 10.330915451049805 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 15 in total
Function load_lora_A took 9.229660034179688 ms to run.
Function load_lora_B took 9.217023849487305 ms to run.
cost realload: 18.840789794921875
Function load_adapters took 18.86296272277832 ms to run.
cost offload scan: 0.08225440979003906
offload 1 adapters, 14 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5731582641601562 ms to run.
cost offload scan: 0.08463859558105469
offload 1 adapters, 13 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5707740783691406 ms to run.
cost load scan: 0.01239776611328125
load 2 adapters, 15 in total
Function load_lora_A took 2.7816295623779297 ms to run.
Function load_lora_B took 2.7818679809570312 ms to run.
Function load_lora_A took 9.324789047241211 ms to run.
Function load_lora_B took 9.264945983886719 ms to run.
cost realload: 24.614334106445312
Function load_adapters took 24.63698387145996 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 16 in total
Function load_lora_A took 9.304285049438477 ms to run.
Function load_lora_B took 9.283304214477539 ms to run.
cost realload: 18.98956298828125
Function load_adapters took 19.011259078979492 ms to run.
current batch size: 16 token used ratio: 0.09213846153846154
cost load scan: 0.010251998901367188
load 3 adapters, 19 in total
Function load_lora_A took 9.335994720458984 ms to run.
Function load_lora_B took 9.302377700805664 ms to run.
Function load_lora_A took 9.285688400268555 ms to run.
Function load_lora_B took 9.244680404663086 ms to run.
Function load_lora_A took 9.30333137512207 ms to run.
Function load_lora_B took 9.280681610107422 ms to run.
cost realload: 56.29324913024902
Function load_adapters took 56.31375312805176 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 20 in total
Function load_lora_A took 4.960536956787109 ms to run.
Function load_lora_B took 4.931211471557617 ms to run.
cost realload: 10.30421257019043
Function load_adapters took 10.327577590942383 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 21 in total
Function load_lora_A took 2.8035640716552734 ms to run.
Function load_lora_B took 2.768993377685547 ms to run.
cost realload: 5.992412567138672
Function load_adapters took 6.015300750732422 ms to run.
current batch size: 23 token used ratio: 0.14289230769230768
cost load scan: 0.011920928955078125
load 1 adapters, 22 in total
Function load_lora_A took 5.0029754638671875 ms to run.
Function load_lora_B took 4.967689514160156 ms to run.
cost realload: 10.404109954833984
Function load_adapters took 10.426998138427734 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 21 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.05459785461425781
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.12040138244628906
Function offload_adapters took 0.6239414215087891 ms to run.
cost offload scan: 0.12683868408203125
offload 2 adapters, 19 remains
cost offload cat: 0.02574920654296875
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.6153583526611328 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 18 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11324882507324219
INFO:     127.0.0.1:54272 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54286 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54298 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40118 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40130 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40144 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40148 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40160 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40164 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40168 - "POST /generate_stream HTTP/1.1" 200 OK
Function offload_adapters took 0.5865097045898438 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 19 in total
Function load_lora_A took 2.7840137481689453 ms to run.
Function load_lora_B took 2.797365188598633 ms to run.
cost realload: 5.989551544189453
Function load_adapters took 6.011486053466797 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 18 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5898475646972656 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 19 in total
Function load_lora_A took 4.98652458190918 ms to run.
Function load_lora_B took 4.9533843994140625 ms to run.
cost realload: 10.329008102416992
Function load_adapters took 10.34998893737793 ms to run.
current batch size: 21 token used ratio: 0.13066153846153847
cost load scan: 0.007867813110351562
load 0 adapters, 19 in total
cost realload: 0.28967857360839844
Function load_adapters took 0.31304359436035156 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 18 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5977153778076172 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 17 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.5848407745361328 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 16 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5750656127929688 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 15 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.5791187286376953 ms to run.
offload 0 adapters, 15 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 14 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10228157043457031
Function offload_adapters took 0.5762577056884766 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 15 in total
Function load_lora_A took 9.306907653808594 ms to run.
Function load_lora_B took 9.250164031982422 ms to run.
cost realload: 18.958568572998047
Function load_adapters took 18.98050308227539 ms to run.
current batch size: 16 token used ratio: 0.10267692307692308
cost offload scan: 0.08535385131835938
offload 1 adapters, 14 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.102996826171875
Function offload_adapters took 0.5702972412109375 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 13 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5781650543212891 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 12 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5784034729003906 ms to run.
Avg tokens(prompt+generate) throughput: 1101.435 tokens/s
Avg prompt tokens throughput:            645.335 tokens/s
Avg generate tokens throughput:          456.101 tokens/s
cost offload scan: 0.08368492126464844
offload 1 adapters, 11 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.5791187286376953 ms to run.
current batch size: 12 token used ratio: 0.0834
cost offload scan: 0.08130073547363281
offload 1 adapters, 10 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10204315185546875
Function offload_adapters took 0.5648136138916016 ms to run.
cost offload scan: 0.08392333984375
offload 1 adapters, 9 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5702972412109375 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 10 in total
Function load_lora_A took 9.323596954345703 ms to run.
Function load_lora_B took 9.267568588256836 ms to run.
cost realload: 18.990039825439453
Function load_adapters took 19.012451171875 ms to run.
cost load scan: 0.015020370483398438
load 2 adapters, 12 in total
Function load_lora_A took 4.988431930541992 ms to run.
Function load_lora_B took 4.918098449707031 ms to run.
Function load_lora_A took 9.275436401367188 ms to run.
Function load_lora_B took 9.236574172973633 ms to run.
cost realload: 28.8999080657959
Function load_adapters took 28.92136573791504 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 11 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.021457672119140625
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5643367767333984 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 10 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.021457672119140625
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.5745887756347656 ms to run.
offload 0 adapters, 10 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.08368492126464844
offload 1 adapters, 9 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10204315185546875
Function offload_adapters took 0.5645751953125 ms to run.
cost offload scan: 0.08225440979003906
offload 1 adapters, 8 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10275840759277344
Function offload_adapters took 0.5660057067871094 ms to run.
current batch size: 8 token used ratio: 0.0524
cost offload scan: 0.08320808410644531
offload 1 adapters, 7 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10180473327636719
Function offload_adapters took 0.5640983581542969 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 6 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5812644958496094 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 6 in total
cost realload: 0.2765655517578125
Function load_adapters took 0.29969215393066406 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 7 in total
Function load_lora_A took 4.993677139282227 ms to run.
Function load_lora_B took 4.951953887939453 ms to run.
cost realload:INFO:     127.0.0.1:40182 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40198 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40204 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40218 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40230 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40240 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40254 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40266 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60760 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60772 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60784 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60794 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60802 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60806 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60818 - "POST /generate_stream HTTP/1.1" 200 OK
 10.338544845581055
Function load_adapters took 10.38503646850586 ms to run.
current batch size: 8 token used ratio: 0.047384615384615386
cost load scan: 0.010728836059570312
load 1 adapters, 8 in total
Function load_lora_A took 9.290218353271484 ms to run.
Function load_lora_B took 9.262561798095703 ms to run.
cost realload: 18.954753875732422
Function load_adapters took 18.97597312927246 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 9 in total
Function load_lora_A took 9.277582168579102 ms to run.
Function load_lora_B took 9.235143661499023 ms to run.
cost realload: 18.905162811279297
Function load_adapters took 18.92685890197754 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 8 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5664825439453125 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 9 in total
Function load_lora_A took 2.822399139404297 ms to run.
Function load_lora_B took 2.7534961700439453 ms to run.
cost realload: 5.966663360595703
Function load_adapters took 5.9909820556640625 ms to run.
cost offload scan: 0.08392333984375
offload 1 adapters, 8 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5681514739990234 ms to run.
current batch size: 9 token used ratio: 0.049815384615384616
cost load scan: 0.015735626220703125
load 1 adapters, 9 in total
Function load_lora_A took 4.925727844238281 ms to run.
Function load_lora_B took 4.868030548095703 ms to run.
cost realload: 10.218381881713867
Function load_adapters took 10.243654251098633 ms to run.
offload 0 adapters, 9 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.019788742065429688
load 1 adapters, 10 in total
Function load_lora_A took 2.8264522552490234 ms to run.
Function load_lora_B took 2.791881561279297 ms to run.
cost realload: 6.026029586791992
Function load_adapters took 6.049394607543945 ms to run.
current batch size: 10 token used ratio: 0.05870769230769231
cost offload scan: 0.08606910705566406
offload 1 adapters, 9 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.5795955657958984 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 10 in total
Function load_lora_A took 2.7976036071777344 ms to run.
Function load_lora_B took 2.7844905853271484 ms to run.
cost realload: 5.980014801025391
Function load_adapters took 6.00123405456543 ms to run.
cost load scan: 0.014066696166992188
load 2 adapters, 12 in total
Function load_lora_A took 2.8076171875 ms to run.
Function load_lora_B took 2.788543701171875 ms to run.
Function load_lora_A took 2.7971267700195312 ms to run.
Function load_lora_B took 2.7735233306884766 ms to run.
cost realload: 11.633157730102539
Function load_adapters took 11.654853820800781 ms to run.
current batch size: 12 token used ratio: 0.07232307692307692
cost load scan: 0.007867813110351562
load 1 adapters, 13 in total
Function load_lora_A took 4.96983528137207 ms to run.
Function load_lora_B took 4.887819290161133 ms to run.
cost realload: 10.260581970214844
Function load_adapters took 10.281801223754883 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 12 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5853176116943359 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 11 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5702972412109375 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 12 in total
Function load_lora_A took 9.323596954345703 ms to run.
Function load_lora_B took 9.27114486694336 ms to run.
cost realload: 19.002437591552734
Function load_adapters took 19.024133682250977 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 11 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.5822181701660156 ms to run.
Avg tokens(prompt+generate) throughput:  729.559 tokens/s
Avg prompt tokens throughput:            417.204 tokens/s
Avg generate tokens throughput:          312.355 tokens/s
current batch size: 11 token used ratio: 0.06524615384615384
cost load scan: 0.007867813110351562
load 0 adapters, 11 in total
cost realload: 0.28061866760253906
Function load_adapters took 0.3058910369873047 ms to run.
cost offload scan: 0.08273124694824219
offload 1 adapters, 10 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.051021575927734375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10275840759277344
Function offload_adapters took 0.5753040313720703 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 11 in total
Function load_lora_A took 2.812623977661133 ms to run.
Function load_lora_B took 2.7921199798583984 ms to run.
cost realload: 5.990266799926758
Function load_adapters took 6.012201309204102 ms to run.
cost offload scan: 0.08225440979003906
offload 1 adapters, 10 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.5738735198974609 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 11 in total
Function load_lora_A took 9.337425231933594 ms to run.
Function load_lora_B took 9.263992309570312 ms to run.
cost realload: 18.99242401123047
Function load_adapters took 19.0126895904541 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 12 in total
Function load_lora_A took 9.307146072387695 ms to run.
Function load_lora_B took 9.322643280029297 ms to run.
cost realload: 19.034147262573242
Function load_adapters took 19.055843353271484 ms to run.
offload 0 adapters, 12 remains
Function offload_adapters took 0.012159347534179688 ms to run.
current batch size: 12 token used ratio: 0.06967692307692308
cost load scan: 0.0133514404296875
load 1 adapters, 13 in total
Function load_lora_A took 2.7916431427001953 ms to run.
Function load_lora_B took 2.7818679809570312 ms to run.
cost realload: 5.9642791748046875
Function load_adapters took 5.985498428344727 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 12 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5671977996826172 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 13 in total
Function load_lora_A took 9.246826171875 ms to run.
Function load_lora_B took 9.212017059326172 ms to run.
cost realload: 18.866300582885742
Function load_adapters took 18.89324188232422 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 12 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5741119384765625 ms to run.
cost offload scan: 0.08296966552734375
offload 1 adapters, 11 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10466575622558594
INFO:     127.0.0.1:60834 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60840 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60844 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60852 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60866 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60880 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60882 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60894 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60908 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60918 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60926 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60938 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60952 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60964 - "POST /generate_stream HTTP/1.1" 200 OK
Function offload_adapters took 0.5753040313720703 ms to run.
current batch size: 11 token used ratio: 0.06441538461538461
cost load scan: 0.010728836059570312
load 1 adapters, 12 in total
Function load_lora_A took 4.936695098876953 ms to run.
Function load_lora_B took 4.91786003112793 ms to run.
cost realload: 10.254144668579102
Function load_adapters took 10.278701782226562 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 11 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.021457672119140625
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5710124969482422 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 12 in total
Function load_lora_A took 9.320259094238281 ms to run.
Function load_lora_B took 9.26065444946289 ms to run.
cost realload: 18.960952758789062
Function load_adapters took 18.980979919433594 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 13 in total
Function load_lora_A took 2.8085708618164062 ms to run.
Function load_lora_B took 2.773284912109375 ms to run.
cost realload: 5.964994430541992
Function load_adapters took 5.987882614135742 ms to run.
cost offload scan: 0.08106231689453125
offload 1 adapters, 12 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10228157043457031
Function offload_adapters took 0.5757808685302734 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 13 in total
Function load_lora_A took 9.291648864746094 ms to run.
Function load_lora_B took 9.2620849609375 ms to run.
cost realload: 18.94521713256836
Function load_adapters took 18.966197967529297 ms to run.
current batch size: 13 token used ratio: 0.06946153846153846
cost load scan: 0.013113021850585938
load 1 adapters, 14 in total
Function load_lora_A took 5.001544952392578 ms to run.
Function load_lora_B took 4.936933517456055 ms to run.
cost realload: 10.3302001953125
Function load_adapters took 10.351896286010742 ms to run.
cost offload scan: 0.08368492126464844
offload 1 adapters, 13 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5729198455810547 ms to run.
cost load scan: 0.009775161743164062
load 1 adapters, 14 in total
Function load_lora_A took 2.8634071350097656 ms to run.
Function load_lora_B took 2.7832984924316406 ms to run.
cost realload: 6.021976470947266
Function load_adapters took 6.042003631591797 ms to run.
cost load scan: 0.0152587890625
load 3 adapters, 17 in total
Function load_lora_A took 4.939794540405273 ms to run.
Function load_lora_B took 4.945278167724609 ms to run.
Function load_lora_A took 4.970312118530273 ms to run.
Function load_lora_B took 4.926443099975586 ms to run.
Function load_lora_A took 9.296894073486328 ms to run.
Function load_lora_B took 9.271383285522461 ms to run.
cost realload: 38.88988494873047
Function load_adapters took 38.91134262084961 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 18 in total
Function load_lora_A took 9.311914443969727 ms to run.
Function load_lora_B took 9.276866912841797 ms to run.
cost realload: 19.017457962036133
Function load_adapters took 19.040584564208984 ms to run.
cost load scan: 0.017404556274414062
load 2 adapters, 20 in total
Function load_lora_A took 2.7818679809570312 ms to run.
Function load_lora_B took 2.779722213745117 ms to run.
Function load_lora_A took 4.910707473754883 ms to run.
Function load_lora_B took 4.908561706542969 ms to run.
cost realload: 15.868186950683594
Function load_adapters took 15.889644622802734 ms to run.
current batch size: 20 token used ratio: 0.1076923076923077
cost offload scan: 0.08726119995117188
offload 1 adapters, 19 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.5934238433837891 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 20 in total
Function load_lora_A took 4.9724578857421875 ms to run.
Function load_lora_B took 4.960775375366211 ms to run.
cost realload: 10.324716567993164
Function load_adapters took 10.345935821533203 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 21 in total
Function load_lora_A took 2.832174301147461 ms to run.
Function load_lora_B took 2.7518272399902344 ms to run.
cost realload: 5.976200103759766
Function load_adapters took 5.997180938720703 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 20 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5862712860107422 ms to run.
current batch size: 20 token used ratio: 0.11432307692307692
cost offload scan: 0.09131431579589844
offload 1 adapters, 19 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.048160552978515625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11849403381347656
Function offload_adapters took 0.6251335144042969 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 18 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5867481231689453 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 17 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5958080291748047 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 16 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5788803100585938 ms to run.
current batch size: 16 token used ratio: 0.10263076923076923
Avg tokens(prompt+generate) throughput:  949.759 tokens/s
Avg prompt tokens throughput:            512.407 tokens/s
Avg generate tokens throughput:          437.352 tokens/s
cost offload scan: 0.08368492126464844
offload 1 adapters, 15 remains
cost offload cat: 0.03647804260253906
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5774497985839844 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 14 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5769729614257812 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 13 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5738735198974609 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 12 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.0286102294921875
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5877017974853516 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 11 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5784034729003906 ms to run.
INFO:     127.0.0.1:42854 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42860 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42876 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42882 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42898 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42902 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42914 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42926 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42936 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42948 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42962 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42974 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42980 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42994 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48210 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48214 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48222 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48228 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48242 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload scan: 0.08058547973632812
offload 1 adapters, 10 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10251998901367188
Function offload_adapters took 0.6036758422851562 ms to run.
cost offload scan: 0.08225440979003906
offload 1 adapters, 9 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5700588226318359 ms to run.
current batch size: 9 token used ratio: 0.05981538461538462
cost offload scan: 0.08296966552734375
offload 1 adapters, 8 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.5695819854736328 ms to run.
cost offload scan: 0.08106231689453125
offload 1 adapters, 7 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10228157043457031
Function offload_adapters took 0.5664825439453125 ms to run.
cost offload scan: 0.08177757263183594
offload 1 adapters, 6 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5624294281005859 ms to run.
cost offload scan: 0.08225440979003906
offload 1 adapters, 5 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5657672882080078 ms to run.
cost offload scan: 0.08392333984375
offload 1 adapters, 4 remains
cost offload cat: 0.03695487976074219
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10275840759277344
Function offload_adapters took 0.5712509155273438 ms to run.
current batch size: 4 token used ratio: 0.031
cost offload scan: 0.07867813110351562
offload 1 adapters, 3 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10085105895996094
Function offload_adapters took 0.5557537078857422 ms to run.
cost offload scan: 0.07939338684082031
offload 1 adapters, 2 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10180473327636719
Function offload_adapters took 0.5533695220947266 ms to run.
current batch size: 2 token used ratio: 0.018384615384615385
cost offload scan: 0.07772445678710938
offload 1 adapters, 1 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5481243133544922 ms to run.
offload 1 adapters, 0 remains
Function offload_adapters took 0.09393692016601562 ms to run.
offload 0 adapters, 0 remains
Function offload_adapters took 0.014781951904296875 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 1 in total
Function load_lora_A took 5.007505416870117 ms to run.
Function load_lora_B took 4.95600700378418 ms to run.
cost realload: 10.416030883789062
Function load_adapters took 10.44154167175293 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 2 in total
Function load_lora_A took 2.8586387634277344 ms to run.
Function load_lora_B took 2.772092819213867 ms to run.
cost realload: 6.040334701538086
Function load_adapters took 6.062030792236328 ms to run.
cost load scan: 0.014781951904296875
load 1 adapters, 3 in total
Function load_lora_A took 4.932880401611328 ms to run.
Function load_lora_B took 4.950046539306641 ms to run.
cost realload: 10.315418243408203
Function load_adapters took 10.33926010131836 ms to run.
current batch size: 3 token used ratio: 0.013815384615384615
cost load scan: 0.0152587890625
load 2 adapters, 5 in total
Function load_lora_A took 2.8357505798339844 ms to run.
Function load_lora_B took 2.7985572814941406 ms to run.
Function load_lora_A took 9.310722351074219 ms to run.
Function load_lora_B took 9.289979934692383 ms to run.
cost realload: 24.718284606933594
Function load_adapters took 24.73926544189453 ms to run.
cost load scan: 0.015497207641601562
load 1 adapters, 6 in total
Function load_lora_A took 2.8443336486816406 ms to run.
Function load_lora_B took 2.765655517578125 ms to run.
cost realload: 6.001472473144531
Function load_adapters took 6.02269172668457 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 7 in total
Function load_lora_A took 2.8145313262939453 ms to run.
Function load_lora_B took 2.7773380279541016 ms to run.
cost realload: 5.985021591186523
Function load_adapters took 6.0062408447265625 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 8 in total
Function load_lora_A took 9.292364120483398 ms to run.
Function load_lora_B took 9.263753890991211 ms to run.
cost realload: 18.94688606262207
Function load_adapters took 18.968820571899414 ms to run.
current batch size: 9 token used ratio: 0.04329230769230769
cost load scan: 0.013113021850585938
load 2 adapters, 10 in total
Function load_lora_A took 4.987001419067383 ms to run.
Function load_lora_B took 4.929065704345703 ms to run.
Function load_lora_A took 2.7697086334228516 ms to run.
Function load_lora_B took 2.766132354736328 ms to run.
cost realload: 15.931367874145508
Function load_adapters took 15.95449447631836 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 11 in total
Function load_lora_A took 9.319543838500977 ms to run.
Function load_lora_B took 9.289264678955078 ms to run.
cost realload: 18.999576568603516
Function load_adapters took 19.021034240722656 ms to run.
cost load scan: 0.023365020751953125
load 2 adapters, 13 in total
Function load_lora_A took 9.269237518310547 ms to run.
Function load_lora_B took 9.22536849975586 ms to run.
Function load_lora_A took 2.825021743774414 ms to run.
Function load_lora_B took 2.771615982055664 ms to run.
cost realload: 24.569034576416016
Function load_adapters took 24.59263801574707 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 14 in total
Function load_lora_A took 9.266853332519531 ms to run.
Function load_lora_B took 9.280204772949219 ms to run.
cost realload: 18.936634063720703
Function load_adapters took 18.95737648010254 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 14 in total
cost realload: 0.2810955047607422
Function load_adapters took 0.3037452697753906 ms to run.
current batch size: 16 token used ratio: 0.07549230769230769
cost load scan: 0.01239776611328125
load 1 adapters, 15 in total
Function load_lora_A took 9.26518440246582 ms to run.
Function load_lora_B took 9.216547012329102 ms to run.
cost realload: 18.870830535888672
Function load_adapters took 18.892526626586914 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 14 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5917549133300781 ms to run.
Avg tokens(prompt+generate) throughput:  627.421 tokens/s
Avg prompt tokens throughput:            412.351 tokens/s
Avg generate tokens throughput:          215.070 tokens/s
cost load scan: 0.0095367431640625
load 1 adapters, 15 in total
Function load_lora_A took 4.955530166625977 ms to run.
Function load_lora_B took 4.920721054077148 ms to run.
cost realload: 10.271072387695312
Function load_adapters took 10.292768478393555 ms to run.
cost load scan: 0.01239776611328125
load 1 adapters, 16 in total
INFO:     127.0.0.1:48250 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48264 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48270 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48272 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48286 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48300 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48304 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48314 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48320 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48324 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48330 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48346 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48360 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48364 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48366 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48368 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48384 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48396 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48408 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48416 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48432 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48442 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48446 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 4.979133605957031 ms to run.
Function load_lora_B took 4.916191101074219 ms to run.
cost realload: 10.319948196411133
Function load_adapters took 10.341882705688477 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 15 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11682510375976562
Function offload_adapters took 0.5877017974853516 ms to run.
current batch size: 17 token used ratio: 0.08446153846153846
cost offload scan: 0.095367431640625
offload 1 adapters, 14 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5908012390136719 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 15 in total
Function load_lora_A took 2.8007030487060547 ms to run.
Function load_lora_B took 2.744436264038086 ms to run.
cost realload: 5.922555923461914
Function load_adapters took 5.944013595581055 ms to run.
cost load scan: 0.012159347534179688
load 2 adapters, 17 in total
Function load_lora_A took 4.992008209228516 ms to run.
Function load_lora_B took 4.910707473754883 ms to run.
Function load_lora_A took 4.961490631103516 ms to run.
Function load_lora_B took 4.950523376464844 ms to run.
cost realload: 20.276308059692383
Function load_adapters took 20.297527313232422 ms to run.
cost offload scan: 0.08273124694824219
offload 1 adapters, 16 remains
cost offload cat: 0.029325485229492188
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5736351013183594 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 17 in total
Function load_lora_A took 9.280681610107422 ms to run.
Function load_lora_B took 9.232521057128906 ms to run.
cost realload: 18.900632858276367
Function load_adapters took 18.922090530395508 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 18 in total
Function load_lora_A took 9.30929183959961 ms to run.
Function load_lora_B took 9.23919677734375 ms to run.
cost realload: 18.944978713989258
Function load_adapters took 18.967151641845703 ms to run.
current batch size: 21 token used ratio: 0.10813846153846154
cost load scan: 0.013589859008789062
load 1 adapters, 19 in total
Function load_lora_A took 9.273052215576172 ms to run.
Function load_lora_B took 9.24539566040039 ms to run.
cost realload: 18.9208984375
Function load_adapters took 18.94211769104004 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 18 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5807876586914062 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 17 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10275840759277344
Function offload_adapters took 0.5664825439453125 ms to run.
cost load scan: 0.013589859008789062
load 2 adapters, 19 in total
Function load_lora_A took 9.293794631958008 ms to run.
Function load_lora_B took 9.267807006835938 ms to run.
Function load_lora_A took 4.96673583984375 ms to run.
Function load_lora_B took 4.93168830871582 ms to run.
cost realload: 28.923988342285156
Function load_adapters took 28.9456844329834 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 20 in total
Function load_lora_A took 4.951953887939453 ms to run.
Function load_lora_B took 4.936933517456055 ms to run.
cost realload: 10.286569595336914
Function load_adapters took 10.307788848876953 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 19 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5824565887451172 ms to run.
cost load scan: 0.015020370483398438
load 1 adapters, 20 in total
Function load_lora_A took 2.819538116455078 ms to run.
Function load_lora_B took 2.7832984924316406 ms to run.
cost realload: 6.0062408447265625
Function load_adapters took 6.031036376953125 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.01239776611328125 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.012159347534179688 ms to run.
current batch size: 23 token used ratio: 0.12043076923076923
cost load scan: 0.009059906005859375
load 1 adapters, 21 in total
Function load_lora_A took 9.305477142333984 ms to run.
Function load_lora_B took 9.286165237426758 ms to run.
cost realload: 18.99266242980957
Function load_adapters took 19.014835357666016 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 20 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.0514984130859375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5915164947509766 ms to run.
cost load scan: 0.0133514404296875
load 2 adapters, 22 in total
Function load_lora_A took 4.9457550048828125 ms to run.
Function load_lora_B took 4.920482635498047 ms to run.
Function load_lora_A took 9.314537048339844 ms to run.
Function load_lora_B took 9.242534637451172 ms to run.
cost realload: 28.88941764831543
Function load_adapters took 28.91063690185547 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 21 remains
cost offload cat: 0.03695487976074219
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.6155967712402344 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost load scan: 0.013828277587890625
load 1 adapters, 22 in total
Function load_lora_A took 2.8142929077148438 ms to run.
Function load_lora_B took 2.7930736541748047 ms to run.
cost realload: 6.010532379150391
Function load_adapters took 6.032705307006836 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 21 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5919933319091797 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 22 in total
Function load_lora_A took 9.264707565307617 ms to run.
Function load_lora_B took 9.197235107421875 ms to run.
cost realload: 18.86296272277832
Function load_adapters took 18.88751983642578 ms to run.
current batch size: 24 token used ratio: 0.13646153846153847
cost load scan: 0.0133514404296875
load 4 adapters, 26 in total
Function load_lora_A took 2.8018951416015625 ms to run.
Function load_lora_B took 2.782583236694336 ms to run.
Function load_lora_A took 9.293794631958008 ms to run.
Function load_lora_B took 9.278297424316406 ms to run.
Function load_lora_A took 9.282588958740234 ms to run.
Function load_lora_B took 9.289741516113281 ms to run.
Function load_lora_A took 2.772808074951172 ms to run.
Function load_lora_B took 2.772092819213867 ms to run.
cost realload: 48.887014389038086
Function load_adapters took 48.90847206115723 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 27 in total
Function load_lora_A took 4.970550537109375 ms to run.
Function load_lora_B took 4.921674728393555 ms to run.
cost realload: 10.28895378112793
Function load_adapters took 10.31041145324707 ms to run.
offload 0 adapters, 27 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 26 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.043392181396484375
INFO:     127.0.0.1:48450 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48464 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48468 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48482 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:48484 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54040 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54050 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54052 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54058 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54074 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54080 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54086 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54094 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54096 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54112 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54128 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54132 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54134 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54148 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54162 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54170 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11897087097167969
Function offload_adapters took 0.6349086761474609 ms to run.
offload 0 adapters, 26 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 27 in total
Function load_lora_A took 9.351015090942383 ms to run.
Function load_lora_B took 9.271621704101562 ms to run.
cost realload: 19.01865005493164
Function load_adapters took 19.040346145629883 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 26 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5924701690673828 ms to run.
cost load scan: 0.018358230590820312
load 4 adapters, 30 in total
Function load_lora_A took 4.917383193969727 ms to run.
Function load_lora_B took 4.872322082519531 ms to run.
Function load_lora_A took 4.922389984130859 ms to run.
Function load_lora_B took 4.87208366394043 ms to run.
Function load_lora_A took 9.316682815551758 ms to run.
Function load_lora_B took 9.25302505493164 ms to run.
Function load_lora_A took 9.279012680053711 ms to run.
Function load_lora_B took 9.255647659301758 ms to run.
cost realload: 57.30581283569336
Function load_adapters took 57.32846260070801 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 29 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11467933654785156
Function offload_adapters took 0.5946159362792969 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 28 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5834102630615234 ms to run.
current batch size: 28 token used ratio: 0.15467692307692307
cost load scan: 0.009775161743164062
load 1 adapters, 29 in total
Function load_lora_A took 9.30929183959961 ms to run.
Function load_lora_B took 9.225130081176758 ms to run.
cost realload: 18.921852111816406
Function load_adapters took 18.945693969726562 ms to run.
cost offload scan: 0.09655952453613281
offload 1 adapters, 28 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5943775177001953 ms to run.
offload 0 adapters, 28 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.00858306884765625
load 0 adapters, 28 in total
cost realload: 0.28395652770996094
Function load_adapters took 0.3077983856201172 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 27 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5877017974853516 ms to run.
cost load scan: 0.015497207641601562
load 2 adapters, 29 in total
Function load_lora_A took 2.8467178344726562 ms to run.
Function load_lora_B took 2.783060073852539 ms to run.
Function load_lora_A took 9.302616119384766 ms to run.
Function load_lora_B took 9.259939193725586 ms to run.
cost realload: 24.646997451782227
Function load_adapters took 24.67513084411621 ms to run.
Avg tokens(prompt+generate) throughput: 1515.569 tokens/s
Avg prompt tokens throughput:            959.434 tokens/s
Avg generate tokens throughput:          556.135 tokens/s
cost load scan: 0.009059906005859375
load 1 adapters, 30 in total
Function load_lora_A took 2.7990341186523438 ms to run.
Function load_lora_B took 2.7756690979003906 ms to run.
cost realload: 5.966424942016602
Function load_adapters took 5.987405776977539 ms to run.
offload 0 adapters, 30 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 31 in total
Function load_lora_A took 2.8264522552490234 ms to run.
Function load_lora_B took 2.789020538330078 ms to run.
cost realload: 6.01506233215332
Function load_adapters took 6.036281585693359 ms to run.
current batch size: 33 token used ratio: 0.1890153846153846
cost load scan: 0.011682510375976562
load 2 adapters, 33 in total
Function load_lora_A took 2.806425094604492 ms to run.
Function load_lora_B took 2.7730464935302734 ms to run.
Function load_lora_A took 4.95147705078125 ms to run.
Function load_lora_B took 4.974126815795898 ms to run.
cost realload: 15.982866287231445
Function load_adapters took 16.005754470825195 ms to run.
offload 0 adapters, 33 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.09632110595703125
offload 1 adapters, 32 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.6003379821777344 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 33 in total
Function load_lora_A took 2.8333663940429688 ms to run.
Function load_lora_B took 2.8176307678222656 ms to run.
cost realload: 6.040334701538086
Function load_adapters took 6.062030792236328 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 32 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5884170532226562 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 31 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.6000995635986328 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 30 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5805492401123047 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 29 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5905628204345703 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 28 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.5979537963867188 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 29 in total
Function load_lora_A took 2.8302669525146484 ms to run.
Function load_lora_B took 2.7930736541748047 ms to run.
cost realload: 6.011247634887695
Function load_adapters took 6.032228469848633 ms to run.
current batch size: 31 token used ratio: 0.1908153846153846
cost offload scan: 0.09703636169433594
offload 1 adapters, 28 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5888938903808594 ms to run.
cost load scan: 0.0152587890625
load 2 adapters, 30 in total
Function load_lora_A took 4.986047744750977 ms to run.
Function load_lora_B took 4.944562911987305 ms to run.
Function load_lora_A took 9.247064590454102 ms to run.
Function load_lora_B took 9.214162826538086 ms to run.
cost realload: 28.866052627563477
Function load_adapters took 28.887510299682617 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 29 remains
INFO:     127.0.0.1:54186 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54198 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54206 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54218 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54222 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54228 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54230 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54238 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54250 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54254 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54258 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54266 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54270 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54276 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54284 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54294 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54302 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38644 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04696846008300781
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.6229877471923828 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 30 in total
Function load_lora_A took 2.7947425842285156 ms to run.
Function load_lora_B took 2.7642250061035156 ms to run.
cost realload: 5.957365036010742
Function load_adapters took 5.981206893920898 ms to run.
cost offload scan: 0.13494491577148438
offload 2 adapters, 28 remains
cost offload cat: 0.025510787963867188
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.6401538848876953 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 27 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5953311920166016 ms to run.
offload 0 adapters, 27 remains
Function offload_adapters took 0.015497207641601562 ms to run.
cost load scan: 0.013589859008789062
load 1 adapters, 28 in total
Function load_lora_A took 4.921197891235352 ms to run.
Function load_lora_B took 4.900932312011719 ms to run.
cost realload: 10.241270065307617
Function load_adapters took 10.263919830322266 ms to run.
offload 0 adapters, 28 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 27 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11754035949707031
Function offload_adapters took 0.5927085876464844 ms to run.
current batch size: 28 token used ratio: 0.17452307692307692
cost offload scan: 0.08797645568847656
offload 1 adapters, 26 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.58746337890625 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 25 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5941390991210938 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 26 in total
Function load_lora_A took 2.815723419189453 ms to run.
Function load_lora_B took 2.8159618377685547 ms to run.
cost realload: 6.03485107421875
Function load_adapters took 6.056785583496094 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 25 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5946159362792969 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 26 in total
Function load_lora_A took 4.991769790649414 ms to run.
Function load_lora_B took 4.933595657348633 ms to run.
cost realload: 10.342836380004883
Function load_adapters took 10.365962982177734 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 25 remains
cost offload cat: 0.036716461181640625
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11563301086425781
Function offload_adapters took 0.6334781646728516 ms to run.
offload 0 adapters, 25 remains
Function offload_adapters took 0.013589859008789062 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 26 in total
Function load_lora_A took 2.8448104858398438 ms to run.
Function load_lora_B took 2.8090476989746094 ms to run.
cost realload: 6.066799163818359
Function load_adapters took 6.088733673095703 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 25 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5896091461181641 ms to run.
cost load scan: 0.015735626220703125
load 4 adapters, 29 in total
Function load_lora_A took 4.994630813598633 ms to run.
Function load_lora_B took 4.944324493408203 ms to run.
Function load_lora_A took 9.318113327026367 ms to run.
Function load_lora_B took 9.243965148925781 ms to run.
Function load_lora_A took 9.328603744506836 ms to run.
Function load_lora_B took 9.259223937988281 ms to run.
Function load_lora_A took 9.303092956542969 ms to run.
Function load_lora_B took 9.264707565307617 ms to run.
cost realload: 66.27249717712402
Function load_adapters took 66.29419326782227 ms to run.
cost offload scan: 0.09369850158691406
offload 1 adapters, 28 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11444091796875
Function offload_adapters took 0.6020069122314453 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 27 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.591278076171875 ms to run.
current batch size: 30 token used ratio: 0.18458461538461537
cost load scan: 0.008106231689453125
load 0 adapters, 27 in total
cost realload: 0.29850006103515625
Function load_adapters took 0.32448768615722656 ms to run.
cost offload scan: 0.13709068298339844
offload 2 adapters, 25 remains
cost offload cat: 0.024557113647460938
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.6268024444580078 ms to run.
offload 0 adapters, 25 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 25 in total
cost realload: 0.2865791320800781
Function load_adapters took 0.3108978271484375 ms to run.
cost offload scan: 0.09441375732421875
offload 1 adapters, 24 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5958080291748047 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 24 in total
cost realload: 0.2789497375488281
Function load_adapters took 0.30231475830078125 ms to run.
offload 0 adapters, 24 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 23 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.6015300750732422 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 22 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5891323089599609 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 23 in total
Function load_lora_A took 2.8209686279296875 ms to run.
Function load_lora_B took 2.7923583984375 ms to run.
cost realload: 6.006479263305664
Function load_adapters took 6.027936935424805 ms to run.
current batch size: 26 token used ratio: 0.1551076923076923
cost load scan: 0.013113021850585938
load 1 adapters, 24 in total
Function load_lora_A took 2.8219223022460938 ms to run.
Function load_lora_B took 2.79998779296875 ms to run.
cost realload: 6.021022796630859
INFO:     127.0.0.1:38654 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38658 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38664 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38678 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38680 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38682 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38694 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38704 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38714 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38722 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38738 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38750 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38760 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38774 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38780 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38792 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38796 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38800 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38806 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38820 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38828 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38832 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38842 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38856 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38866 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_adapters took 6.042003631591797 ms to run.
cost load scan: 0.013828277587890625
load 3 adapters, 27 in total
Function load_lora_A took 9.326696395874023 ms to run.
Function load_lora_B took 9.283781051635742 ms to run.
Function load_lora_A took 2.831697463989258 ms to run.
Function load_lora_B took 2.8221607208251953 ms to run.
Function load_lora_A took 9.308099746704102 ms to run.
Function load_lora_B took 9.245634078979492 ms to run.
cost realload: 43.35188865661621
Function load_adapters took 43.37310791015625 ms to run.
cost offload scan: 0.09441375732421875
offload 1 adapters, 26 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5996227264404297 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 25 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5812644958496094 ms to run.
Avg tokens(prompt+generate) throughput: 1527.214 tokens/s
Avg prompt tokens throughput:            817.077 tokens/s
Avg generate tokens throughput:          710.137 tokens/s
cost load scan: 0.009059906005859375
load 2 adapters, 27 in total
Function load_lora_A took 2.7849674224853516 ms to run.
Function load_lora_B took 2.7763843536376953 ms to run.
Function load_lora_A took 4.922628402709961 ms to run.
Function load_lora_B took 4.872560501098633 ms to run.
cost realload: 15.81263542175293
Function load_adapters took 15.835762023925781 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 26 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5862712860107422 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 25 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5843639373779297 ms to run.
cost offload scan: 0.1251697540283203
offload 2 adapters, 23 remains
cost offload cat: 0.025272369384765625
cost offload free mem manager: 0.049114227294921875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.6163120269775391 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 24 in total
Function load_lora_A took 9.296894073486328 ms to run.
Function load_lora_B took 9.26518440246582 ms to run.
cost realload: 18.955230712890625
Function load_adapters took 18.976688385009766 ms to run.
current batch size: 28 token used ratio: 0.15512307692307692
cost offload scan: 0.12564659118652344
offload 2 adapters, 22 remains
cost offload cat: 0.024080276489257812
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.6084442138671875 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 21 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.576019287109375 ms to run.
cost load scan: 0.01239776611328125
load 2 adapters, 23 in total
Function load_lora_A took 4.909992218017578 ms to run.
Function load_lora_B took 4.906415939331055 ms to run.
Function load_lora_A took 2.796173095703125 ms to run.
Function load_lora_B took 2.7887821197509766 ms to run.
cost realload: 15.875101089477539
Function load_adapters took 15.896320343017578 ms to run.
offload 0 adapters, 23 remains
Function offload_adapters took 0.011682510375976562 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 24 in total
Function load_lora_A took 2.8312206268310547 ms to run.
Function load_lora_B took 2.791166305541992 ms to run.
cost realload: 6.0176849365234375
Function load_adapters took 6.039142608642578 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 23 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5850791931152344 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 24 in total
Function load_lora_A took 4.963159561157227 ms to run.
Function load_lora_B took 4.923105239868164 ms to run.
cost realload: 10.285377502441406
Function load_adapters took 10.306835174560547 ms to run.
cost load scan: 0.013589859008789062
load 1 adapters, 25 in total
Function load_lora_A took 2.83050537109375 ms to run.
Function load_lora_B took 2.7914047241210938 ms to run.
cost realload: 6.026506423950195
Function load_adapters took 6.047725677490234 ms to run.
current batch size: 29 token used ratio: 0.15895384615384614
cost load scan: 0.009298324584960938
load 1 adapters, 26 in total
Function load_lora_A took 4.975080490112305 ms to run.
Function load_lora_B took 4.936695098876953 ms to run.
cost realload: 10.336875915527344
Function load_adapters took 10.35928726196289 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 25 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.5943775177001953 ms to run.
cost load scan: 0.0152587890625
load 2 adapters, 27 in total
Function load_lora_A took 4.946708679199219 ms to run.
Function load_lora_B took 4.904985427856445 ms to run.
Function load_lora_A took 9.311914443969727 ms to run.
Function load_lora_B took 9.282588958740234 ms to run.
cost realload: 28.917789459228516
Function load_adapters took 28.941631317138672 ms to run.
cost load scan: 0.015497207641601562
load 2 adapters, 29 in total
Function load_lora_A took 4.963874816894531 ms to run.
Function load_lora_B took 4.915952682495117 ms to run.
Function load_lora_A took 2.820253372192383 ms to run.
Function load_lora_B took 2.777099609375 ms to run.
cost realload: 15.952348709106445
Function load_adapters took 15.974044799804688 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 28 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.5965232849121094 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 29 in total
Function load_lora_A took 9.308815002441406 ms to run.
Function load_lora_B took 9.281635284423828 ms to run.
cost realload: 18.995046615600586
Function load_adapters took 19.01698112487793 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 28 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11515617370605469
Function offload_adapters took 0.6046295166015625 ms to run.
cost offload scan: 0.09369850158691406
offload 1 adapters, 27 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.051975250244140625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.598907470703125 ms to run.
current batch size: 30 token used ratio: 0.1696769230769231
cost load scan: 0.00858306884765625
load 1 adapters, 28 in total
Function load_lora_A took 2.836465835571289 ms to run.
Function load_lora_B took 2.779245376586914 ms to run.
cost realload: 5.994319915771484
Function load_adapters took 6.015539169311523 ms to run.
cost offload scan: 0.09059906005859375
INFO:     127.0.0.1:38882 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38894 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38898 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38908 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38922 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46576 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46584 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46590 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46604 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46618 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46620 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46628 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46634 - "POST /generate_stream HTTP/1.1" 200 OK
offload 1 adapters, 27 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.6222724914550781 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 26 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5893707275390625 ms to run.
cost load scan: 0.01430511474609375
load 2 adapters, 28 in total
Function load_lora_A took 9.316682815551758 ms to run.
Function load_lora_B took 9.252786636352539 ms to run.
Function load_lora_A took 9.218931198120117 ms to run.
Function load_lora_B took 9.224891662597656 ms to run.
cost realload: 37.477731704711914
Function load_adapters took 37.499427795410156 ms to run.
cost offload scan: 0.09441375732421875
offload 1 adapters, 27 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5946159362792969 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 28 in total
Function load_lora_A took 2.8159618377685547 ms to run.
Function load_lora_B took 2.8028488159179688 ms to run.
cost realload: 5.999565124511719
Function load_adapters took 6.020307540893555 ms to run.
cost load scan: 0.014543533325195312
load 1 adapters, 29 in total
Function load_lora_A took 9.30023193359375 ms to run.
Function load_lora_B took 9.246349334716797 ms to run.
cost realload: 18.960237503051758
Function load_adapters took 18.983125686645508 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 30 in total
Function load_lora_A took 4.9228668212890625 ms to run.
Function load_lora_B took 4.9304962158203125 ms to run.
cost realload: 10.251522064208984
Function load_adapters took 10.273218154907227 ms to run.
offload 0 adapters, 30 remains
Function offload_adapters took 0.013113021850585938 ms to run.
current batch size: 34 token used ratio: 0.1975230769230769
offload 0 adapters, 30 remains
Function offload_adapters took 0.013589859008789062 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 29 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.11181831359863281
Function offload_adapters took 0.5955696105957031 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 28 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5807876586914062 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 27 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04792213439941406
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5908012390136719 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 26 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5865097045898438 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 25 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5843639373779297 ms to run.
cost offload scan: 0.12803077697753906
offload 2 adapters, 23 remains
cost offload cat: 0.0247955322265625
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.6132125854492188 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 22 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5865097045898438 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 23 in total
Function load_lora_A took 4.9724578857421875 ms to run.
Function load_lora_B took 4.977941513061523 ms to run.
cost realload: 10.32710075378418
Function load_adapters took 10.347843170166016 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 22 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5748271942138672 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 21 remains
cost offload cat: 0.03695487976074219
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5881786346435547 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 22 in total
Function load_lora_A took 4.9190521240234375 ms to run.
Function load_lora_B took 4.934787750244141 ms to run.
cost realload: 10.237693786621094
Function load_adapters took 10.260820388793945 ms to run.
current batch size: 24 token used ratio: 0.14064615384615384
cost offload scan: 0.08845329284667969
offload 1 adapters, 21 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5764961242675781 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 20 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5731582641601562 ms to run.
cost load scan: 0.013828277587890625
load 1 adapters, 21 in total
Function load_lora_A took 4.968881607055664 ms to run.
Function load_lora_B took 4.944086074829102 ms to run.
cost realload: 10.299444198608398
Function load_adapters took 10.319709777832031 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 22 in total
Function load_lora_A took 2.8221607208251953 ms to run.
Function load_lora_B took 2.7933120727539062 ms to run.
cost realload: 6.00886344909668
Function load_adapters took 6.034612655639648 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 21 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5762577056884766 ms to run.
cost load scan: 0.009298324584960938
load 2 adapters, 23 in total
Function load_lora_A took 9.258508682250977 ms to run.
Function load_lora_B took 9.254217147827148 ms to run.
Function load_lora_A took 2.8047561645507812 ms to run.
Function load_lora_B took 2.771615982055664 ms to run.
cost realload: 24.558067321777344
Function load_adapters took 24.57904815673828 ms to run.
Avg tokens(prompt+generate) throughput: 1494.206 tokens/s
Avg prompt tokens throughput:            812.785 tokens/s
Avg generate tokens throughput:          681.421 tokens/s
current batch size: 25 token used ratio: 0.15241538461538462
cost load scan: 0.00858306884765625
load 1 adapters, 24 in total
Function load_lora_A took 9.323835372924805 ms to run.
Function load_lora_B took 9.255647659301758 ms to run.
cost realload: 18.98646354675293
Function load_adapters took 19.008159637451172 ms to run.
INFO:     127.0.0.1:46644 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46658 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46662 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46678 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46694 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46698 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46712 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46724 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46734 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload scan: 0.13494491577148438
offload 2 adapters, 22 remains
cost offload cat: 0.024080276489257812
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.6451606750488281 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 21 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5807876586914062 ms to run.
cost load scan: 0.00858306884765625
load 2 adapters, 23 in total
Function load_lora_A took 2.8023719787597656 ms to run.
Function load_lora_B took 2.7832984924316406 ms to run.
Function load_lora_A took 2.7971267700195312 ms to run.
Function load_lora_B took 2.7723312377929688 ms to run.
cost realload: 11.634349822998047
Function load_adapters took 11.655569076538086 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 22 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5888938903808594 ms to run.
cost offload scan: 0.12946128845214844
offload 2 adapters, 20 remains
cost offload cat: 0.0247955322265625
cost offload free mem manager: 0.04887580871582031
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.6363391876220703 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 19 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5717277526855469 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.00858306884765625
load 0 adapters, 19 in total
cost realload: 0.28204917907714844
Function load_adapters took 0.30612945556640625 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 18 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04696846008300781
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5872249603271484 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 18 in total
cost realload: 0.2827644348144531
Function load_adapters took 0.30922889709472656 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 17 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5707740783691406 ms to run.
offload 0 adapters, 17 remains
Function offload_adapters took 0.011920928955078125 ms to run.
current batch size: 20 token used ratio: 0.11346153846153846
cost load scan: 0.008106231689453125
load 0 adapters, 17 in total
cost realload: 0.2741813659667969
Function load_adapters took 0.29754638671875 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 16 remains
cost offload cat: 0.03790855407714844
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.579833984375 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 15 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5841255187988281 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 16 in total
Function load_lora_A took 2.819061279296875 ms to run.
Function load_lora_B took 2.8121471405029297 ms to run.
cost realload: 6.03175163269043
Function load_adapters took 6.053447723388672 ms to run.
cost offload scan: 0.12159347534179688
offload 2 adapters, 14 remains
cost offload cat: 0.024318695068359375
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.6105899810791016 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 13 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5712509155273438 ms to run.
offload 0 adapters, 13 remains
Function offload_adapters took 0.0133514404296875 ms to run.
current batch size: 16 token used ratio: 0.09115384615384615
cost offload scan: 0.08535385131835938
offload 1 adapters, 12 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5750656127929688 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 11 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5829334259033203 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 12 in total
Function load_lora_A took 4.910945892333984 ms to run.
Function load_lora_B took 4.9304962158203125 ms to run.
cost realload: 10.23244857788086
Function load_adapters took 10.254383087158203 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 13 in total
Function load_lora_A took 9.28640365600586 ms to run.
Function load_lora_B took 9.24062728881836 ms to run.
cost realload: 18.91946792602539
Function load_adapters took 18.940210342407227 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 14 in total
Function load_lora_A took 9.293556213378906 ms to run.
Function load_lora_B took 9.239435195922852 ms to run.
cost realload: 18.93138885498047
Function load_adapters took 18.955230712890625 ms to run.
offload 0 adapters, 14 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.08463859558105469
offload 1 adapters, 13 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5850791931152344 ms to run.
current batch size: 15 token used ratio: 0.0862923076923077
cost offload scan: 0.08249282836914062
offload 1 adapters, 12 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5645751953125 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 11 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11444091796875
Function offload_adapters took 0.5941390991210938 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 12 in total
Function load_lora_A took 2.8116703033447266 ms to run.
Function load_lora_B took 2.803325653076172 ms to run.
cost realload: 6.017923355102539
Function load_adapters took 6.03938102722168 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 11 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5815029144287109 ms to run.
cost offload scan: 0.08392333984375
offload 1 adapters, 10 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: INFO:     127.0.0.1:46744 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46746 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46754 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46770 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46780 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46794 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46808 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42242 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42246 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42256 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42266 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42278 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42286 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42294 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42310 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42322 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42334 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42350 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42358 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42368 - "POST /generate_stream HTTP/1.1" 200 OK
0.0438690185546875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.6012916564941406 ms to run.
offload 0 adapters, 10 remains
Function offload_adapters took 0.01239776611328125 ms to run.
offload 0 adapters, 10 remains
Function offload_adapters took 0.012159347534179688 ms to run.
current batch size: 10 token used ratio: 0.05876923076923077
cost offload scan: 0.08249282836914062
offload 1 adapters, 9 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5750656127929688 ms to run.
cost offload scan: 0.08368492126464844
offload 1 adapters, 8 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5676746368408203 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 9 in total
Function load_lora_A took 9.312152862548828 ms to run.
Function load_lora_B took 9.259462356567383 ms to run.
cost realload: 18.977880477905273
Function load_adapters took 18.999814987182617 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 8 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5686283111572266 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 7 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5846023559570312 ms to run.
cost load scan: 0.010251998901367188
load 3 adapters, 10 in total
Function load_lora_A took 9.279489517211914 ms to run.
Function load_lora_B took 9.25755500793457 ms to run.
Function load_lora_A took 2.8238296508789062 ms to run.
Function load_lora_B took 2.8045177459716797 ms to run.
Function load_lora_A took 2.805471420288086 ms to run.
Function load_lora_B took 2.814769744873047 ms to run.
cost realload: 30.32374382019043
Function load_adapters took 30.344724655151367 ms to run.
offload 0 adapters, 10 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 9 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5769729614257812 ms to run.
cost offload scan: 0.08177757263183594
offload 1 adapters, 8 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5688667297363281 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 9 in total
Function load_lora_A took 9.287118911743164 ms to run.
Function load_lora_B took 9.2620849609375 ms to run.
cost realload: 18.94521713256836
Function load_adapters took 18.967151641845703 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 8 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5872249603271484 ms to run.
cost load scan: 0.010013580322265625
load 1 adapters, 9 in total
Function load_lora_A took 4.889726638793945 ms to run.
Function load_lora_B took 4.876613616943359 ms to run.
cost realload: 10.16378402709961
Function load_adapters took 10.186910629272461 ms to run.
current batch size: 9 token used ratio: 0.04506153846153846
cost load scan: 0.010728836059570312
load 1 adapters, 10 in total
Function load_lora_A took 2.802133560180664 ms to run.
Function load_lora_B took 2.7923583984375 ms to run.
cost realload: 6.006479263305664
Function load_adapters took 6.029367446899414 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 10 in total
cost realload: 0.30040740966796875
Function load_adapters took 0.3256797790527344 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 11 in total
Function load_lora_A took 4.970550537109375 ms to run.
Function load_lora_B took 4.942417144775391 ms to run.
cost realload: 10.315418243408203
Function load_adapters took 10.336637496948242 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 12 in total
Function load_lora_A took 9.32455062866211 ms to run.
Function load_lora_B took 9.27424430847168 ms to run.
cost realload: 19.001483917236328
Function load_adapters took 19.022703170776367 ms to run.
Avg tokens(prompt+generate) throughput: 1069.232 tokens/s
Avg prompt tokens throughput:            633.045 tokens/s
Avg generate tokens throughput:          436.187 tokens/s
current batch size: 13 token used ratio: 0.07138461538461538
cost load scan: 0.012874603271484375
load 1 adapters, 13 in total
Function load_lora_A took 4.975318908691406 ms to run.
Function load_lora_B took 4.9152374267578125 ms to run.
cost realload: 10.295867919921875
Function load_adapters took 10.317087173461914 ms to run.
cost load scan: 0.010013580322265625
load 1 adapters, 14 in total
Function load_lora_A took 9.30023193359375 ms to run.
Function load_lora_B took 9.263038635253906 ms to run.
cost realload: 18.952369689941406
Function load_adapters took 18.97907257080078 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 15 in total
Function load_lora_A took 4.9343109130859375 ms to run.
Function load_lora_B took 4.8389434814453125 ms to run.
cost realload: 10.166645050048828
Function load_adapters took 10.187864303588867 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 14 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04744529724121094
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11849403381347656
Function offload_adapters took 0.6055831909179688 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 15 in total
Function load_lora_A took 4.966974258422852 ms to run.
Function load_lora_B took 4.89354133605957 ms to run.
cost realload: 10.251045227050781
Function load_adapters took 10.271549224853516 ms to run.
current batch size: 16 token used ratio: 0.08998461538461539
cost load scan: 0.011920928955078125
load 1 adapters, 16 in total
Function load_lora_A took 9.239435195922852 ms to run.
Function load_lora_B took 9.218215942382812 ms to run.
cost realload: 18.858671188354492
Function load_adapters took 18.882036209106445 ms to run.
cost offload scan: 0.125885009765625
offload 2 adapters, 14 remains
cost offload cat: 0.024080276489257812
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.6093978881835938 ms to run.
cost load scan: 0.012636184692382812
load 2 adapters, 16 in total
Function load_lora_A took 4.920244216918945 ms to run.
Function load_lora_B took 4.867315292358398 ms to run.
Function load_lora_A took 9.282588958740234 ms to run.
Function load_lora_B took 9.266376495361328 ms to run.
cost realload: 28.81169319152832
Function load_adapters took 28.832674026489258 ms to run.
offload 0 adapters, 16 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.010967254638671875
load 2 adapters, 18 in total
Function load_lora_A took 2.8154850006103516 ms to run.
Function load_lora_B took 2.782106399536133 ms to run.
Function load_lora_A took 9.31549072265625 ms to run.
Function load_lora_B took 9.23609733581543 ms to run.
cost realload: 24.61862564086914
Function load_adapters took 24.640321731567383 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 17 remains
INFO:     127.0.0.1:42370 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42386 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42402 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42408 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42420 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42422 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42434 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42446 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42452 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42462 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42464 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42478 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42490 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40858 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04839897155761719
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.6203651428222656 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 16 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5793571472167969 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 17 in total
Function load_lora_A took 2.877950668334961 ms to run.
Function load_lora_B took 2.8035640716552734 ms to run.
cost realload: 6.076335906982422
Function load_adapters took 6.098747253417969 ms to run.
current batch size: 17 token used ratio: 0.09693846153846154
cost load scan: 0.012636184692382812
load 1 adapters, 18 in total
Function load_lora_A took 9.237527847290039 ms to run.
Function load_lora_B took 9.194612503051758 ms to run.
cost realload: 18.831253051757812
Function load_adapters took 18.85390281677246 ms to run.
cost offload scan: 0.08463859558105469
offload 1 adapters, 17 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5748271942138672 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 18 in total
Function load_lora_A took 9.315967559814453 ms to run.
Function load_lora_B took 9.298563003540039 ms to run.
cost realload: 19.019365310668945
Function load_adapters took 19.041061401367188 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 19 in total
Function load_lora_A took 2.7997493743896484 ms to run.
Function load_lora_B took 2.7735233306884766 ms to run.
cost realload: 5.970954895019531
Function load_adapters took 5.992889404296875 ms to run.
cost offload scan: 0.08559226989746094
offload 1 adapters, 18 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.5826950073242188 ms to run.
current batch size: 18 token used ratio: 0.10923076923076923
cost load scan: 0.011444091796875
load 1 adapters, 19 in total
Function load_lora_A took 2.809286117553711 ms to run.
Function load_lora_B took 2.7565956115722656 ms to run.
cost realload: 5.961894989013672
Function load_adapters took 5.982875823974609 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 18 remains
cost offload cat: 0.03504753112792969
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5941390991210938 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 17 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5848407745361328 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 16 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5865097045898438 ms to run.
cost load scan: 0.010013580322265625
load 1 adapters, 17 in total
Function load_lora_A took 9.307384490966797 ms to run.
Function load_lora_B took 9.252786636352539 ms to run.
cost realload: 18.97406578063965
Function load_adapters took 18.999576568603516 ms to run.
cost load scan: 0.009298324584960938
load 2 adapters, 19 in total
Function load_lora_A took 9.284257888793945 ms to run.
Function load_lora_B took 9.191513061523438 ms to run.
Function load_lora_A took 2.7933120727539062 ms to run.
Function load_lora_B took 2.789020538330078 ms to run.
cost realload: 24.518728256225586
Function load_adapters took 24.540185928344727 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 18 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.576019287109375 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 17 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5898475646972656 ms to run.
current batch size: 17 token used ratio: 0.1034
cost offload scan: 0.09059906005859375
offload 1 adapters, 16 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5927085876464844 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 15 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5724430084228516 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 14 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5724430084228516 ms to run.
cost load scan: 0.015497207641601562
load 1 adapters, 15 in total
Function load_lora_A took 5.00798225402832 ms to run.
Function load_lora_B took 4.959344863891602 ms to run.
cost realload: 10.386228561401367
Function load_adapters took 10.408163070678711 ms to run.
cost load scan: 0.014066696166992188
load 1 adapters, 16 in total
Function load_lora_A took 4.978179931640625 ms to run.
Function load_lora_B took 4.911184310913086 ms to run.
cost realload: 10.28299331665039
Function load_adapters took 10.304927825927734 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 15 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5781650543212891 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 14 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.5810260772705078 ms to run.
cost load scan: 0.013589859008789062
load 2 adapters, 16 in total
Function load_lora_A took 9.285211563110352 ms to run.
Function load_lora_B took 9.24992561340332 ms to run.
Function load_lora_A took 9.293556213378906 ms to run.
Function load_lora_B took 9.248495101928711 ms to run.
cost realload: 37.542104721069336
Function load_adapters took 37.563323974609375 ms to run.
cost offload scan: 0.08368492126464844
offload 1 adapters, 15 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10251998901367188
Function offload_adapters took 0.5605220794677734 ms to run.
current batch size: 16 token used ratio: 0.08993846153846154
cost load scan: 0.015735626220703125
load 1 adapters, 16 in total
Function load_lora_A took 9.308099746704102 ms to run.
Function load_lora_B took 9.276866912841797 ms to run.
cost realload: 18.99123191833496
Function load_adapters took 19.012928009033203 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 15 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: INFO:     127.0.0.1:40870 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40872 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40878 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40888 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40896 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40908 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40916 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40928 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40942 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40954 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40960 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40964 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40966 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40976 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40988 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40992 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41004 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41020 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41036 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41040 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41052 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41056 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41058 - "POST /generate_stream HTTP/1.1" 200 OK
0.022172927856445312
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6124973297119141 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 15 in total
cost realload: 0.28586387634277344
Function load_adapters took 0.3101825714111328 ms to run.
cost load scan: 0.015735626220703125
load 2 adapters, 17 in total
Function load_lora_A took 2.8274059295654297 ms to run.
Function load_lora_B took 2.772092819213867 ms to run.
Function load_lora_A took 9.268522262573242 ms to run.
Function load_lora_B took 9.269952774047852 ms to run.
cost realload: 24.611711502075195
Function load_adapters took 24.632692337036133 ms to run.
Avg tokens(prompt+generate) throughput: 1131.969 tokens/s
Avg prompt tokens throughput:            692.851 tokens/s
Avg generate tokens throughput:          439.118 tokens/s
cost load scan: 0.012874603271484375
load 2 adapters, 19 in total
Function load_lora_A took 2.767801284790039 ms to run.
Function load_lora_B took 2.7632713317871094 ms to run.
Function load_lora_A took 2.808094024658203 ms to run.
Function load_lora_B took 2.7704238891601562 ms to run.
cost realload: 11.574506759643555
Function load_adapters took 11.600017547607422 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 18 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5745887756347656 ms to run.
current batch size: 20 token used ratio: 0.11264615384615384
cost offload scan: 0.08559226989746094
offload 1 adapters, 17 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5741119384765625 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 18 in total
Function load_lora_A took 9.313106536865234 ms to run.
Function load_lora_B took 9.273290634155273 ms to run.
cost realload: 18.9666748046875
Function load_adapters took 18.990516662597656 ms to run.
cost offload scan: 0.1239776611328125
offload 2 adapters, 16 remains
cost offload cat: 0.0247955322265625
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.6120204925537109 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 17 in total
Function load_lora_A took 4.916906356811523 ms to run.
Function load_lora_B took 4.947662353515625 ms to run.
cost realload: 10.252952575683594
Function load_adapters took 10.274887084960938 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 18 in total
Function load_lora_A took 2.826213836669922 ms to run.
Function load_lora_B took 2.7704238891601562 ms to run.
cost realload: 6.000518798828125
Function load_adapters took 6.0214996337890625 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 17 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11515617370605469
Function offload_adapters took 0.583648681640625 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 16 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5867481231689453 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 16 in total
cost realload: 0.2856254577636719
Function load_adapters took 0.3101825714111328 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 15 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5724430084228516 ms to run.
offload 0 adapters, 15 remains
Function offload_adapters took 0.011920928955078125 ms to run.
current batch size: 17 token used ratio: 0.09161538461538461
cost load scan: 0.013113021850585938
load 1 adapters, 16 in total
Function load_lora_A took 4.929065704345703 ms to run.
Function load_lora_B took 4.94384765625 ms to run.
cost realload: 10.274887084960938
Function load_adapters took 10.297298431396484 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 17 in total
Function load_lora_A took 9.308099746704102 ms to run.
Function load_lora_B took 9.229660034179688 ms to run.
cost realload: 18.942832946777344
Function load_adapters took 18.96381378173828 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 18 in total
Function load_lora_A took 4.929065704345703 ms to run.
Function load_lora_B took 4.892587661743164 ms to run.
cost realload: 10.205507278442383
Function load_adapters took 10.226726531982422 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 17 remains
cost offload cat: 0.03910064697265625
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5872249603271484 ms to run.
cost load scan: 0.01239776611328125
load 2 adapters, 19 in total
Function load_lora_A took 2.8209686279296875 ms to run.
Function load_lora_B took 2.753734588623047 ms to run.
Function load_lora_A took 4.926204681396484 ms to run.
Function load_lora_B took 4.943132400512695 ms to run.
cost realload: 15.911340713500977
Function load_adapters took 15.933752059936523 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 18 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.5829334259033203 ms to run.
cost load scan: 0.015735626220703125
load 2 adapters, 20 in total
Function load_lora_A took 9.31096076965332 ms to run.
Function load_lora_B took 9.234905242919922 ms to run.
Function load_lora_A took 2.8281211853027344 ms to run.
Function load_lora_B took 2.7740001678466797 ms to run.
cost realload: 24.615764617919922
Function load_adapters took 24.637937545776367 ms to run.
current batch size: 21 token used ratio: 0.11210769230769231
cost offload scan: 0.08463859558105469
offload 1 adapters, 19 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5686283111572266 ms to run.
cost load scan: 0.015974044799804688
load 3 adapters, 22 in total
Function load_lora_A took 4.927873611450195 ms to run.
Function load_lora_B took 4.90880012512207 ms to run.
Function load_lora_A took 4.951953887939453 ms to run.
Function load_lora_B took 4.912614822387695 ms to run.
Function load_lora_A took 9.282112121582031 ms to run.
Function load_lora_B took 9.242534637451172 ms to run.
cost realload: 38.765907287597656
Function load_adapters took 38.78974914550781 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 21 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5736351013183594 ms to run.
cost load scan: 0.013113021850585938
load 2 adapters, 23 in total
Function load_lora_A took 2.775430679321289 ms to run.
Function load_lora_B took 2.798795700073242 ms to run.
Function load_lora_A took 2.834320068359375 ms to run.
Function load_lora_B took 2.7785301208496094 ms to run.
cost realload: 11.662721633911133
Function load_adapters took 11.685609817504883 ms to run.
cost load scan: 0.011444091796875
load 2 adapters, 25 in total
INFO:     127.0.0.1:41072 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41088 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41100 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41106 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41110 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41114 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41126 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41132 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41148 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35306 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35310 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35318 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35326 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35330 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35336 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35342 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 4.899024963378906 ms to run.
Function load_lora_B took 4.920005798339844 ms to run.
Function load_lora_A took 9.259223937988281 ms to run.
Function load_lora_B took 9.264707565307617 ms to run.
cost realload: 28.85580062866211
Function load_adapters took 28.879880905151367 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 24 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.5857944488525391 ms to run.
cost load scan: 0.013113021850585938
load 2 adapters, 26 in total
Function load_lora_A took 2.7971267700195312 ms to run.
Function load_lora_B took 2.789020538330078 ms to run.
Function load_lora_A took 9.31549072265625 ms to run.
Function load_lora_B took 9.308338165283203 ms to run.
cost realload: 24.72066879272461
Function load_adapters took 24.742603302001953 ms to run.
offload 0 adapters, 26 remains
Function offload_adapters took 0.013589859008789062 ms to run.
current batch size: 26 token used ratio: 0.138
cost load scan: 0.01430511474609375
load 1 adapters, 27 in total
Function load_lora_A took 4.996538162231445 ms to run.
Function load_lora_B took 4.920005798339844 ms to run.
cost realload: 10.329484939575195
Function load_adapters took 10.35165786743164 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 26 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11181831359863281
Function offload_adapters took 0.6053447723388672 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 27 in total
Function load_lora_A took 4.977226257324219 ms to run.
Function load_lora_B took 4.94384765625 ms to run.
cost realload: 10.31947135925293
Function load_adapters took 10.34092903137207 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 26 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11038780212402344
Function offload_adapters took 0.6015300750732422 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 26 in total
cost realload: 0.28896331787109375
Function load_adapters took 0.3132820129394531 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 25 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5846023559570312 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 26 in total
Function load_lora_A took 9.287834167480469 ms to run.
Function load_lora_B took 9.243488311767578 ms to run.
cost realload: 18.919944763183594
Function load_adapters took 18.941879272460938 ms to run.
offload 0 adapters, 26 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 25 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5917549133300781 ms to run.
cost load scan: 0.013589859008789062
load 2 adapters, 27 in total
Function load_lora_A took 2.8035640716552734 ms to run.
Function load_lora_B took 2.7768611907958984 ms to run.
Function load_lora_A took 9.287357330322266 ms to run.
Function load_lora_B took 9.289741516113281 ms to run.
cost realload: 24.62005615234375
Function load_adapters took 24.64127540588379 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 26 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5939006805419922 ms to run.
current batch size: 26 token used ratio: 0.1434923076923077
cost load scan: 0.007867813110351562
load 0 adapters, 26 in total
cost realload: 0.2770423889160156
Function load_adapters took 0.3006458282470703 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 25 remains
cost offload cat: 0.037670135498046875
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5869865417480469 ms to run.
offload 0 adapters, 25 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 24 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5738735198974609 ms to run.
cost load scan: 0.009059906005859375
load 2 adapters, 26 in total
Function load_lora_A took 4.960060119628906 ms to run.
Function load_lora_B took 4.904747009277344 ms to run.
Function load_lora_A took 9.28497314453125 ms to run.
Function load_lora_B took 9.231805801391602 ms to run.
cost realload: 28.86033058166504
Function load_adapters took 28.882503509521484 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 27 in total
Function load_lora_A took 9.311437606811523 ms to run.
Function load_lora_B took 9.278059005737305 ms to run.
cost realload: 18.984556198120117
Function load_adapters took 19.00625228881836 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 26 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5846023559570312 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 25 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5853176116943359 ms to run.
current batch size: 26 token used ratio: 0.14803076923076924
cost load scan: 0.00858306884765625
load 1 adapters, 26 in total
Function load_lora_A took 4.968404769897461 ms to run.
Function load_lora_B took 4.941463470458984 ms to run.
cost realload: 10.315179824829102
Function load_adapters took 10.337114334106445 ms to run.
Avg tokens(prompt+generate) throughput: 1454.442 tokens/s
Avg prompt tokens throughput:            897.051 tokens/s
Avg generate tokens throughput:          557.390 tokens/s
cost offload scan: 0.08845329284667969
offload 1 adapters, 25 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.576019287109375 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 24 remains
cost offload cat: 0.02956390380859375
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5669593811035156 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 25 in total
Function load_lora_A took 2.826213836669922 ms to run.
Function load_lora_B took 2.7828216552734375 ms to run.
cost realload: 5.995035171508789
Function load_adapters took 6.016254425048828 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 24 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5865097045898438 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 24 in total
cost realload: 0.2770423889160156
INFO:     127.0.0.1:35350 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35352 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35356 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35372 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35374 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35384 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35394 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35398 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35400 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35406 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35412 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35418 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35426 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35440 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35442 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35454 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_adapters took 0.30112266540527344 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 23 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5788803100585938 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 24 in total
Function load_lora_A took 2.828836441040039 ms to run.
Function load_lora_B took 2.7778148651123047 ms to run.
cost realload: 6.00886344909668
Function load_adapters took 6.030082702636719 ms to run.
cost offload scan: 0.09632110595703125
offload 1 adapters, 23 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5915164947509766 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 22 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5919933319091797 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 23 in total
Function load_lora_A took 4.973173141479492 ms to run.
Function load_lora_B took 4.94384765625 ms to run.
cost realload: 10.323047637939453
Function load_adapters took 10.345458984375 ms to run.
current batch size: 25 token used ratio: 0.1392
cost offload scan: 0.08845329284667969
offload 1 adapters, 22 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.11658668518066406
Function offload_adapters took 0.5946159362792969 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 21 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04696846008300781
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.6072521209716797 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 20 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5850791931152344 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 19 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5843639373779297 ms to run.
cost offload scan: 0.095367431640625
offload 1 adapters, 18 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5939006805419922 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 18 in total
cost realload: 0.2865791320800781
Function load_adapters took 0.3116130828857422 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 19 in total
Function load_lora_A took 9.325742721557617 ms to run.
Function load_lora_B took 9.247303009033203 ms to run.
cost realload: 18.98050308227539
Function load_adapters took 19.00196075439453 ms to run.
cost offload scan: 0.08559226989746094
offload 1 adapters, 18 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5846023559570312 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.012159347534179688 ms to run.
current batch size: 20 token used ratio: 0.11790769230769231
cost load scan: 0.008344650268554688
load 1 adapters, 19 in total
Function load_lora_A took 9.324312210083008 ms to run.
Function load_lora_B took 9.254932403564453 ms to run.
cost realload: 18.987178802490234
Function load_adapters took 19.010305404663086 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.015735626220703125
load 2 adapters, 21 in total
Function load_lora_A took 4.970073699951172 ms to run.
Function load_lora_B took 4.911899566650391 ms to run.
Function load_lora_A took 9.314537048339844 ms to run.
Function load_lora_B took 9.267091751098633 ms to run.
cost realload: 28.933286666870117
Function load_adapters took 28.954505920410156 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 20 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5886554718017578 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 21 in total
Function load_lora_A took 9.308338165283203 ms to run.
Function load_lora_B took 9.26661491394043 ms to run.
cost realload: 18.975257873535156
Function load_adapters took 18.9971923828125 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 22 in total
Function load_lora_A took 9.284734725952148 ms to run.
Function load_lora_B took 9.254932403564453 ms to run.
cost realload: 18.941879272460938
Function load_adapters took 18.963336944580078 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 21 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5857944488525391 ms to run.
current batch size: 24 token used ratio: 0.14535384615384617
cost offload scan: 0.13303756713867188
offload 2 adapters, 19 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.6279945373535156 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 19 in total
cost realload: 0.2791881561279297
Function load_adapters took 0.3044605255126953 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 18 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5857944488525391 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 17 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5762577056884766 ms to run.
cost load scan: 0.015020370483398438
load 1 adapters, 18 in total
Function load_lora_A took 4.901885986328125 ms to run.
Function load_lora_B took 4.871845245361328 ms to run.
cost realload: 10.18524169921875
Function load_adapters took 10.20956039428711 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 17 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5772113800048828 ms to run.
current batch size: 20 token used ratio: 0.12318461538461538
cost load scan: 0.011920928955078125
load 2 adapters, 19 in total
Function load_lora_A took 2.8264522552490234 ms to run.
Function load_lora_B took 2.740621566772461 ms to run.
Function load_lora_A took 2.770662307739258 ms to run.
Function load_lora_B took 2.7647018432617188 ms to run.
cost realload: 11.563777923583984
Function load_adapters took 11.58452033996582 ms to run.
INFO:     127.0.0.1:35470 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35480 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35492 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35508 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35512 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44080 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44092 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44102 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44108 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44112 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44118 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44122 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44126 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44130 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44140 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44146 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44162 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44170 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44186 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload scan: 0.0972747802734375
offload 1 adapters, 18 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.6315708160400391 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 17 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.05030632019042969
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5822181701660156 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 16 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11467933654785156
Function offload_adapters took 0.5929470062255859 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 15 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5638599395751953 ms to run.
cost load scan: 0.01430511474609375
load 2 adapters, 17 in total
Function load_lora_A took 2.8197765350341797 ms to run.
Function load_lora_B took 2.7709007263183594 ms to run.
Function load_lora_A took 2.8209686279296875 ms to run.
Function load_lora_B took 2.771139144897461 ms to run.
cost realload: 11.64388656616211
Function load_adapters took 11.665105819702148 ms to run.
cost load scan: 0.012159347534179688
load 1 adapters, 18 in total
Function load_lora_A took 9.292125701904297 ms to run.
Function load_lora_B took 9.250402450561523 ms to run.
cost realload: 18.93925666809082
Function load_adapters took 18.962860107421875 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 17 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5869865417480469 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 17 in total
cost realload: 0.2727508544921875
Function load_adapters took 0.2961158752441406 ms to run.
offload 0 adapters, 17 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.012636184692382812
load 3 adapters, 20 in total
Function load_lora_A took 2.8281211853027344 ms to run.
Function load_lora_B took 2.7582645416259766 ms to run.
Function load_lora_A took 9.287118911743164 ms to run.
Function load_lora_B took 9.249687194824219 ms to run.
Function load_lora_A took 9.294271469116211 ms to run.
Function load_lora_B took 9.251832962036133 ms to run.
cost realload: 43.20669174194336
Function load_adapters took 43.2279109954834 ms to run.
current batch size: 24 token used ratio: 0.1317846153846154
offload 0 adapters, 20 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost load scan: 0.013589859008789062
load 2 adapters, 22 in total
Function load_lora_A took 9.239435195922852 ms to run.
Function load_lora_B took 9.21177864074707 ms to run.
Function load_lora_A took 2.7761459350585938 ms to run.
Function load_lora_B took 2.742290496826172 ms to run.
cost realload: 24.44005012512207
Function load_adapters took 24.461984634399414 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.012159347534179688 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 21 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11563301086425781
Function offload_adapters took 0.5881786346435547 ms to run.
cost load scan: 0.011920928955078125
load 2 adapters, 23 in total
Function load_lora_A took 9.2926025390625 ms to run.
Function load_lora_B took 9.253263473510742 ms to run.
Function load_lora_A took 4.979610443115234 ms to run.
Function load_lora_B took 4.948854446411133 ms to run.
cost realload: 28.94282341003418
Function load_adapters took 28.963804244995117 ms to run.
Avg tokens(prompt+generate) throughput: 1359.104 tokens/s
Avg prompt tokens throughput:            777.428 tokens/s
Avg generate tokens throughput:          581.676 tokens/s
cost offload scan: 0.08559226989746094
offload 1 adapters, 22 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5669593811035156 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 21 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5850791931152344 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 22 in total
Function load_lora_A took 9.258508682250977 ms to run.
Function load_lora_B took 9.254932403564453 ms to run.
cost realload: 18.912315368652344
Function load_adapters took 18.934011459350586 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 21 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5869865417480469 ms to run.
current batch size: 22 token used ratio: 0.11338461538461539
cost load scan: 0.012159347534179688
load 1 adapters, 22 in total
Function load_lora_A took 4.985332489013672 ms to run.
Function load_lora_B took 4.945039749145508 ms to run.
cost realload: 10.329246520996094
Function load_adapters took 10.350227355957031 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 21 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.583648681640625 ms to run.
cost load scan: 0.02002716064453125
load 1 adapters, 22 in total
Function load_lora_A took 2.826690673828125 ms to run.
Function load_lora_B took 2.7616024017333984 ms to run.
cost realload: 5.991458892822266
Function load_adapters took 6.012916564941406 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 23 in total
Function load_lora_A took 9.342432022094727 ms to run.
Function load_lora_B took 9.23776626586914 ms to run.
cost realload: 18.974781036376953
Function load_adapters took 18.99576187133789 ms to run.
current batch size: 23 token used ratio: 0.13283076923076922
cost load scan: 0.012874603271484375
load 1 adapters, 24 in total
Function load_lora_A took 4.963159561157227 ms to run.
Function load_lora_B took 4.899501800537109 ms to run.
cost realload: 10.258913040161133
Function load_adapters took 10.280370712280273 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 23 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5898475646972656 ms to run.
cost load scan: 0.0133514404296875
load 2 adapters, 25 in total
Function load_lora_A took 4.964590072631836 ms to run.
Function load_lora_B took 4.935979843139648 ms to run.
Function load_lora_A took 9.281158447265625 ms to run.
Function load_lora_B took 9.245634078979492 ms to run.
cost realload: 28.890609741210938
Function load_adapters took 28.911828994750977 ms to run.
cost offload scan: 0.12922286987304688
offload 2 adapters, 23 remains
cost offload cat: 0.0247955322265625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty:INFO:     127.0.0.1:44192 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44194 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44200 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44208 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44218 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44222 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44236 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44252 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44262 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56240 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56256 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56268 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56282 - "POST /generate_stream HTTP/1.1" 200 OK
 0.02288818359375
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.6437301635742188 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 22 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5779266357421875 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 23 in total
Function load_lora_A took 4.925727844238281 ms to run.
Function load_lora_B took 4.921436309814453 ms to run.
cost realload: 10.241508483886719
Function load_adapters took 10.262727737426758 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 22 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5714893341064453 ms to run.
current batch size: 22 token used ratio: 0.1319846153846154
cost load scan: 0.013113021850585938
load 1 adapters, 23 in total
Function load_lora_A took 2.8192996978759766 ms to run.
Function load_lora_B took 2.7937889099121094 ms to run.
cost realload: 6.009101867675781
Function load_adapters took 6.032228469848633 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 22 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5848407745361328 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 21 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5846023559570312 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 21 in total
cost realload: 0.2779960632324219
Function load_adapters took 0.301361083984375 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 20 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5750656127929688 ms to run.
cost offload scan: 0.08392333984375
offload 1 adapters, 19 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5791187286376953 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 20 in total
Function load_lora_A took 2.833843231201172 ms to run.
Function load_lora_B took 2.7968883514404297 ms to run.
cost realload: 6.030797958374023
Function load_adapters took 6.051778793334961 ms to run.
cost load scan: 0.01430511474609375
load 1 adapters, 21 in total
Function load_lora_A took 4.9591064453125 ms to run.
Function load_lora_B took 4.917383193969727 ms to run.
cost realload: 10.28895378112793
Function load_adapters took 10.313987731933594 ms to run.
cost offload scan: 0.091552734375
offload 1 adapters, 20 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5862712860107422 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 19 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5819797515869141 ms to run.
current batch size: 20 token used ratio: 0.12427692307692308
cost load scan: 0.008821487426757812
load 1 adapters, 20 in total
Function load_lora_A took 2.824068069458008 ms to run.
Function load_lora_B took 2.7914047241210938 ms to run.
cost realload: 6.012678146362305
Function load_adapters took 6.034135818481445 ms to run.
cost offload scan: 0.08463859558105469
offload 1 adapters, 19 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5853176116943359 ms to run.
cost offload scan: 0.091552734375
offload 1 adapters, 18 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.5896091461181641 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 17 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5738735198974609 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 18 in total
Function load_lora_A took 4.968881607055664 ms to run.
Function load_lora_B took 4.903078079223633 ms to run.
cost realload: 10.277032852172852
Function load_adapters took 10.298728942871094 ms to run.
current batch size: 18 token used ratio: 0.11415384615384615
cost offload scan: 0.08416175842285156
offload 1 adapters, 17 remains
cost offload cat: 0.04291534423828125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5946159362792969 ms to run.
cost load scan: 0.014781951904296875
load 1 adapters, 18 in total
Function load_lora_A took 4.962921142578125 ms to run.
Function load_lora_B took 4.930019378662109 ms to run.
cost realload: 10.300159454345703
Function load_adapters took 10.323286056518555 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 17 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5745887756347656 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 18 in total
Function load_lora_A took 4.964590072631836 ms to run.
Function load_lora_B took 4.953622817993164 ms to run.
cost realload: 10.32257080078125
Function load_adapters took 10.344505310058594 ms to run.
cost offload scan: 0.1304149627685547
offload 2 adapters, 16 remains
cost offload cat: 0.024318695068359375
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.6163120269775391 ms to run.
cost load scan: 0.012874603271484375
load 2 adapters, 18 in total
Function load_lora_A took 2.7675628662109375 ms to run.
Function load_lora_B took 2.7849674224853516 ms to run.
Function load_lora_A took 9.330987930297852 ms to run.
Function load_lora_B took 9.254932403564453 ms to run.
cost realload: 24.618864059448242
Function load_adapters took 24.642467498779297 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 17 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.102996826171875
Function offload_adapters took 0.5702972412109375 ms to run.
cost offload scan: 0.08463859558105469
offload 1 adapters, 16 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5800724029541016 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 17 in total
Function load_lora_A took 9.292364120483398 ms to run.
INFO:     127.0.0.1:56290 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56300 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56302 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56318 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56326 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56338 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56352 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56366 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56372 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56386 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56402 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56414 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56430 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56438 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56450 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56456 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56472 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_B took 9.223222732543945 ms to run.
cost realload: 18.9363956451416
Function load_adapters took 18.958091735839844 ms to run.
current batch size: 18 token used ratio: 0.10492307692307692
cost offload scan: 0.08869171142578125
offload 1 adapters, 16 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.583648681640625 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 15 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5731582641601562 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 16 in total
Function load_lora_A took 4.967212677001953 ms to run.
Function load_lora_B took 4.959583282470703 ms to run.
cost realload: 10.321855545043945
Function load_adapters took 10.343790054321289 ms to run.
cost offload scan: 0.08296966552734375
offload 1 adapters, 15 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5774497985839844 ms to run.
Avg tokens(prompt+generate) throughput: 1097.690 tokens/s
Avg prompt tokens throughput:            542.061 tokens/s
Avg generate tokens throughput:          555.630 tokens/s
cost offload scan: 0.11992454528808594
offload 2 adapters, 13 remains
cost offload cat: 0.024080276489257812
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.6124973297119141 ms to run.
cost offload scan: 0.08368492126464844
offload 1 adapters, 12 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5772113800048828 ms to run.
cost offload scan: 0.08273124694824219
offload 1 adapters, 11 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5800724029541016 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 10 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5712509155273438 ms to run.
current batch size: 11 token used ratio: 0.05361538461538461
cost offload scan: 0.08440017700195312
offload 1 adapters, 9 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04887580871582031
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5822181701660156 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 8 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10204315185546875
Function offload_adapters took 0.5617141723632812 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 9 in total
Function load_lora_A took 2.780437469482422 ms to run.
Function load_lora_B took 2.775430679321289 ms to run.
cost realload: 5.954265594482422
Function load_adapters took 5.977392196655273 ms to run.
current batch size: 10 token used ratio: 0.049692307692307695
cost load scan: 0.008821487426757812
load 1 adapters, 10 in total
Function load_lora_A took 2.8085708618164062 ms to run.
Function load_lora_B took 2.7544498443603516 ms to run.
cost realload: 5.956888198852539
Function load_adapters took 5.977869033813477 ms to run.
cost load scan: 0.012159347534179688
load 2 adapters, 12 in total
Function load_lora_A took 4.910707473754883 ms to run.
Function load_lora_B took 4.901885986328125 ms to run.
Function load_lora_A took 4.927158355712891 ms to run.
Function load_lora_B took 4.938840866088867 ms to run.
cost realload: 20.149707794189453
Function load_adapters took 20.171642303466797 ms to run.
cost load scan: 0.00858306884765625
load 2 adapters, 14 in total
Function load_lora_A took 9.314298629760742 ms to run.
Function load_lora_B took 9.287118911743164 ms to run.
Function load_lora_A took 4.954338073730469 ms to run.
Function load_lora_B took 4.903316497802734 ms to run.
cost realload: 28.92589569091797
Function load_adapters took 28.947114944458008 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 13 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5786418914794922 ms to run.
cost offload scan: 0.08177757263183594
offload 1 adapters, 12 remains
cost offload cat: 0.03719329833984375
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5736351013183594 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 11 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5795955657958984 ms to run.
cost load scan: 0.009059906005859375
load 2 adapters, 13 in total
Function load_lora_A took 9.294271469116211 ms to run.
Function load_lora_B took 9.294271469116211 ms to run.
Function load_lora_A took 9.274005889892578 ms to run.
Function load_lora_B took 9.25755500793457 ms to run.
cost realload: 37.58382797241211
Function load_adapters took 37.60552406311035 ms to run.
cost offload scan: 0.0820159912109375
offload 1 adapters, 12 remains
cost offload cat: 0.03647804260253906
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.102996826171875
Function offload_adapters took 0.5731582641601562 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 13 in total
Function load_lora_A took 9.276628494262695 ms to run.
Function load_lora_B took 9.262561798095703 ms to run.
cost realload: 18.93448829650879
Function load_adapters took 18.956661224365234 ms to run.
cost offload scan: 0.08273124694824219
offload 1 adapters, 12 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5767345428466797 ms to run.
current batch size: 14 token used ratio: 0.06767692307692308
cost load scan: 0.014066696166992188
load 2 adapters, 14 in total
Function load_lora_A took 9.338140487670898 ms to run.
Function load_lora_B took 9.291887283325195 ms to run.
Function load_lora_A took 4.960536956787109 ms to run.
Function load_lora_B took 4.913806915283203 ms to run.
cost realload: 28.975963592529297
Function load_adapters took 28.99789810180664 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 15 in total
Function load_lora_A took 2.838134765625 ms to run.
Function load_lora_B took 2.8023719787597656 ms to run.
cost realload: 6.0443878173828125
Function load_adapters took 6.067037582397461 ms to run.
cost load scan: 0.013589859008789062
load 2 adapters, 17 in total
Function load_lora_A took 9.268760681152344 ms to run.
Function load_lora_B took 9.267807006835938 ms to run.
Function load_lora_A took 9.285449981689453 ms to run.
Function load_lora_B took 9.256362915039062 ms to run.
cost realload: 37.55378723144531
Function load_adapters took 37.57429122924805 ms to run.
cost load scan: INFO:     127.0.0.1:56480 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56488 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56498 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56504 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56506 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56520 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56536 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56542 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56554 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56560 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57678 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57680 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57688 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57694 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57708 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57720 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57722 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57724 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57738 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57748 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57750 - "POST /generate_stream HTTP/1.1" 200 OK
0.011682510375976562
load 1 adapters, 18 in total
Function load_lora_A took 2.7947425842285156 ms to run.
Function load_lora_B took 2.801179885864258 ms to run.
cost realload: 6.016731262207031
Function load_adapters took 6.038665771484375 ms to run.
cost load scan: 0.014066696166992188
load 0 adapters, 18 in total
cost realload: 0.31304359436035156
Function load_adapters took 0.3409385681152344 ms to run.
current batch size: 21 token used ratio: 0.10692307692307693
cost load scan: 0.013589859008789062
load 2 adapters, 20 in total
Function load_lora_A took 4.995107650756836 ms to run.
Function load_lora_B took 4.952669143676758 ms to run.
Function load_lora_A took 2.790212631225586 ms to run.
Function load_lora_B took 2.7599334716796875 ms to run.
cost realload: 15.99431037902832
Function load_adapters took 16.017675399780273 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 19 remains
cost offload cat: 0.0362396240234375
cost offload free mem manager: 0.05030632019042969
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1163482666015625
Function offload_adapters took 0.6251335144042969 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 18 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5903244018554688 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 18 in total
cost realload: 0.28514862060546875
Function load_adapters took 0.3094673156738281 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 17 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5884170532226562 ms to run.
offload 0 adapters, 17 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 18 in total
Function load_lora_A took 2.8531551361083984 ms to run.
Function load_lora_B took 2.7856826782226562 ms to run.
cost realload: 6.037473678588867
Function load_adapters took 6.0577392578125 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 17 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5719661712646484 ms to run.
cost load scan: 0.010728836059570312
load 2 adapters, 19 in total
Function load_lora_A took 9.298324584960938 ms to run.
Function load_lora_B took 9.225606918334961 ms to run.
Function load_lora_A took 2.8154850006103516 ms to run.
Function load_lora_B took 2.8007030487060547 ms to run.
cost realload: 24.61862564086914
Function load_adapters took 24.641990661621094 ms to run.
current batch size: 21 token used ratio: 0.10815384615384616
cost offload scan: 0.09107589721679688
offload 1 adapters, 18 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.05078315734863281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5862712860107422 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 19 in total
Function load_lora_A took 4.960536956787109 ms to run.
Function load_lora_B took 4.955530166625977 ms to run.
cost realload: 10.317564010620117
Function load_adapters took 10.339021682739258 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 19 in total
cost realload: 0.2853870391845703
Function load_adapters took 0.30922889709472656 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 18 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5776882171630859 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.011682510375976562 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 19 in total
Function load_lora_A took 2.8142929077148438 ms to run.
Function load_lora_B took 2.7761459350585938 ms to run.
cost realload: 5.973100662231445
Function load_adapters took 5.99360466003418 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 20 in total
Function load_lora_A took 4.965782165527344 ms to run.
Function load_lora_B took 4.914760589599609 ms to run.
cost realload: 10.268926620483398
Function load_adapters took 10.290384292602539 ms to run.
current batch size: 22 token used ratio: 0.11669230769230769
cost load scan: 0.0133514404296875
load 1 adapters, 21 in total
Function load_lora_A took 4.987955093383789 ms to run.
Function load_lora_B took 4.926443099975586 ms to run.
cost realload: 10.320663452148438
Function load_adapters took 10.34235954284668 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 21 in total
cost realload: 0.28395652770996094
Function load_adapters took 0.30732154846191406 ms to run.
Avg tokens(prompt+generate) throughput: 1236.774 tokens/s
Avg prompt tokens throughput:            786.149 tokens/s
Avg generate tokens throughput:          450.625 tokens/s
cost load scan: 0.011920928955078125
load 1 adapters, 22 in total
Function load_lora_A took 2.803325653076172 ms to run.
Function load_lora_B took 2.744436264038086 ms to run.
cost realload: 5.939483642578125
Function load_adapters took 5.960941314697266 ms to run.
cost load scan: 0.011444091796875
load 2 adapters, 24 in total
Function load_lora_A took 9.308576583862305 ms to run.
Function load_lora_B took 9.302139282226562 ms to run.
Function load_lora_A took 4.983663558959961 ms to run.
Function load_lora_B took 4.893302917480469 ms to run.
cost realload: 28.963327407836914
Function load_adapters took 28.985023498535156 ms to run.
current batch size: 28 token used ratio: 0.16430769230769232
cost offload scan: 0.09441375732421875
offload 1 adapters, 23 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5927085876464844 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 22 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5819797515869141 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 21 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5800724029541016 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 20 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.583648681640625 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 19 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5924701690673828 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 19 in total
cost realload: 0.2796649932861328
Function load_adapters took 0.30303001403808594 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 18 remains
INFO:     127.0.0.1:57754 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57762 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57776 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57780 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57790 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57796 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57806 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57820 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57826 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57842 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57850 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57852 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57858 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57870 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57874 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57882 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57892 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57904 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57912 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57922 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57930 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57940 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57950 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57966 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.6067752838134766 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 17 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.5800724029541016 ms to run.
cost load scan: 0.015974044799804688
load 2 adapters, 19 in total
Function load_lora_A took 4.998445510864258 ms to run.
Function load_lora_B took 4.947185516357422 ms to run.
Function load_lora_A took 9.306907653808594 ms to run.
Function load_lora_B took 9.265422821044922 ms to run.
cost realload: 28.989553451538086
Function load_adapters took 29.010295867919922 ms to run.
current batch size: 23 token used ratio: 0.14081538461538462
cost offload scan: 0.08559226989746094
offload 1 adapters, 18 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5822181701660156 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 17 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.5831718444824219 ms to run.
cost offload scan: 0.08559226989746094
offload 1 adapters, 16 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5736351013183594 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 15 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5822181701660156 ms to run.
cost load scan: 0.009775161743164062
load 1 adapters, 16 in total
Function load_lora_A took 9.325504302978516 ms to run.
Function load_lora_B took 9.33694839477539 ms to run.
cost realload: 19.06418800354004
Function load_adapters took 19.086837768554688 ms to run.
offload 0 adapters, 16 remains
Function offload_adapters took 0.012636184692382812 ms to run.
offload 0 adapters, 16 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.015497207641601562
load 4 adapters, 20 in total
Function load_lora_A took 2.8030872344970703 ms to run.
Function load_lora_B took 2.7816295623779297 ms to run.
Function load_lora_A took 9.268522262573242 ms to run.
Function load_lora_B took 9.256362915039062 ms to run.
Function load_lora_A took 4.966020584106445 ms to run.
Function load_lora_B took 4.933834075927734 ms to run.
Function load_lora_A took 4.93931770324707 ms to run.
Function load_lora_B took 4.92095947265625 ms to run.
cost realload: 44.48342323303223
Function load_adapters took 44.50559616088867 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.019311904907226562
load 5 adapters, 25 in total
Function load_lora_A took 4.951238632202148 ms to run.
Function load_lora_B took 4.904747009277344 ms to run.
Function load_lora_A took 9.257078170776367 ms to run.
Function load_lora_B took 9.206771850585938 ms to run.
Function load_lora_A took 2.8045177459716797 ms to run.
Function load_lora_B took 2.7942657470703125 ms to run.
Function load_lora_A took 4.975080490112305 ms to run.
Function load_lora_B took 4.948854446411133 ms to run.
Function load_lora_A took 9.300708770751953 ms to run.
Function load_lora_B took 9.279489517211914 ms to run.
cost realload: 63.11202049255371
Function load_adapters took 63.13323974609375 ms to run.
cost load scan: 0.009775161743164062
load 1 adapters, 26 in total
Function load_lora_A took 2.7971267700195312 ms to run.
Function load_lora_B took 2.7875900268554688 ms to run.
cost realload: 5.9757232666015625
Function load_adapters took 5.996942520141602 ms to run.
current batch size: 29 token used ratio: 0.16686153846153845
cost offload scan: 0.09584426879882812
offload 1 adapters, 25 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.6048679351806641 ms to run.
cost load scan: 0.010967254638671875
load 2 adapters, 27 in total
Function load_lora_A took 2.826213836669922 ms to run.
Function load_lora_B took 2.7756690979003906 ms to run.
Function load_lora_A took 2.814054489135742 ms to run.
Function load_lora_B took 2.800464630126953 ms to run.
cost realload: 11.683940887451172
Function load_adapters took 11.70492172241211 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 26 remains
cost offload cat: 0.03743171691894531
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5984306335449219 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 27 in total
Function load_lora_A took 9.33694839477539 ms to run.
Function load_lora_B took 9.27281379699707 ms to run.
cost realload: 19.01531219482422
Function load_adapters took 19.03700828552246 ms to run.
cost load scan: 0.0152587890625
load 1 adapters, 28 in total
Function load_lora_A took 9.337425231933594 ms to run.
Function load_lora_B took 9.268760681152344 ms to run.
cost realload: 19.00458335876465
Function load_adapters took 19.028663635253906 ms to run.
offload 0 adapters, 28 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 27 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.583648681640625 ms to run.
cost load scan: 0.010013580322265625
load 1 adapters, 28 in total
Function load_lora_A took 4.9571990966796875 ms to run.
Function load_lora_B took 4.9457550048828125 ms to run.
cost realload: 10.297536849975586
Function load_adapters took 10.318756103515625 ms to run.
cost offload scan: 0.09703636169433594
offload 1 adapters, 27 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.029087066650390625
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.6043910980224609 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 26 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5829334259033203 ms to run.
current batch size: 29 token used ratio: 0.16510769230769232
cost load scan: 0.014543533325195312
load 1 adapters, 27 in total
Function load_lora_A took 2.7723312377929688 ms to run.
Function load_lora_B took 2.7849674224853516 ms to run.
cost realload: 5.958795547485352
Function load_adapters took 5.980014801025391 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 26 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11587142944335938
Function offload_adapters took 0.5922317504882812 ms to run.
cost load scan: 0.013113021850585938
load 2 adapters, 28 in total
Function load_lora_A took 4.9610137939453125 ms to run.
Function load_lora_B took 4.9381256103515625 ms to run.
Function load_lora_A took 9.222030639648438 ms to run.
INFO:     127.0.0.1:57974 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57986 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59076 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59080 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59092 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59106 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59112 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59114 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59122 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_B took 9.231805801391602 ms to run.
cost realload: 28.850317001342773
Function load_adapters took 28.872013092041016 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 27 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5996227264404297 ms to run.
cost load scan: 0.015497207641601562
load 3 adapters, 30 in total
Function load_lora_A took 4.96220588684082 ms to run.
Function load_lora_B took 4.929780960083008 ms to run.
Function load_lora_A took 2.767801284790039 ms to run.
Function load_lora_B took 2.789020538330078 ms to run.
Function load_lora_A took 4.979133605957031 ms to run.
Function load_lora_B took 4.922389984130859 ms to run.
cost realload: 25.890588760375977
Function load_adapters took 25.912761688232422 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 29 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5843639373779297 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 28 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.028371810913085938
cost offload a_loc update: 0.10228157043457031
Function offload_adapters took 0.5831718444824219 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 29 in total
Function load_lora_A took 9.309768676757812 ms to run.
Function load_lora_B took 9.297847747802734 ms to run.
cost realload: 19.00458335876465
Function load_adapters took 19.025802612304688 ms to run.
current batch size: 33 token used ratio: 0.19132307692307693
offload 0 adapters, 29 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 28 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5850791931152344 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 29 in total
Function load_lora_A took 2.8200149536132812 ms to run.
Function load_lora_B took 2.801656723022461 ms to run.
cost realload: 6.006956100463867
Function load_adapters took 6.027460098266602 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 28 remains
cost offload cat: 0.03600120544433594
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5919933319091797 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 27 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5848407745361328 ms to run.
Avg tokens(prompt+generate) throughput: 1615.587 tokens/s
Avg prompt tokens throughput:            966.675 tokens/s
Avg generate tokens throughput:          648.912 tokens/s
cost load scan: 0.014066696166992188
load 2 adapters, 29 in total
Function load_lora_A took 9.273290634155273 ms to run.
Function load_lora_B took 9.282112121582031 ms to run.
Function load_lora_A took 4.965782165527344 ms to run.
Function load_lora_B took 4.916906356811523 ms to run.
cost realload: 28.91397476196289
Function load_adapters took 28.935909271240234 ms to run.
offload 0 adapters, 29 remains
Function offload_adapters took 0.014781951904296875 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 28 remains
cost offload cat: 0.02956390380859375
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5848407745361328 ms to run.
cost offload scan: 0.12612342834472656
offload 2 adapters, 26 remains
cost offload cat: 0.0247955322265625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.6196498870849609 ms to run.
offload 0 adapters, 26 remains
Function offload_adapters took 0.012159347534179688 ms to run.
current batch size: 27 token used ratio: 0.16895384615384615
offload 0 adapters, 26 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost offload scan: 0.091552734375
offload 1 adapters, 25 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.05078315734863281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5991458892822266 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 26 in total
Function load_lora_A took 2.850055694580078 ms to run.
Function load_lora_B took 2.766847610473633 ms to run.
cost realload: 6.019115447998047
Function load_adapters took 6.039857864379883 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 25 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5834102630615234 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 24 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5750656127929688 ms to run.
cost offload scan: 0.1251697540283203
offload 2 adapters, 22 remains
cost offload cat: 0.0247955322265625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.6186962127685547 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 21 remains
cost offload cat: 0.03981590270996094
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.6003379821777344 ms to run.
cost load scan: 0.014543533325195312
load 1 adapters, 22 in total
Function load_lora_A took 9.305238723754883 ms to run.
Function load_lora_B took 9.265422821044922 ms to run.
cost realload: 18.984079360961914
Function load_adapters took 19.008398056030273 ms to run.
cost offload scan: 0.12922286987304688
offload 2 adapters, 20 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.6573200225830078 ms to run.
cost load scan: 0.016450881958007812
load 1 adapters, 21 in total
Function load_lora_A took 4.925012588500977 ms to run.
Function load_lora_B took 4.8770904541015625 ms to run.
cost realload: 10.268926620483398
Function load_adapters took 10.296106338500977 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 20 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.5886554718017578 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 19 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11539459228515625
Function offload_adapters took 0.5924701690673828 ms to run.
current batch size: 19 token used ratio: 0.11163076923076923
cost offload scan: 0.08654594421386719
offload 1 adapters, 18 remains
cost offload cat: 0.030755996704101562
INFO:     127.0.0.1:59138 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59152 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59156 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59162 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59172 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59178 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59190 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59194 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59204 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59218 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59230 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59234 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload free mem manager: 0.049591064453125
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.6194114685058594 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 19 in total
Function load_lora_A took 9.27734375 ms to run.
Function load_lora_B took 9.25445556640625 ms to run.
cost realload: 18.93758773803711
Function load_adapters took 18.959999084472656 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 18 remains
cost offload cat: 0.03910064697265625
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11467933654785156
Function offload_adapters took 0.6144046783447266 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 17 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.5886554718017578 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 16 remains
cost offload cat: 0.03552436828613281
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.5962848663330078 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 15 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5877017974853516 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 14 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5924701690673828 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 13 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5929470062255859 ms to run.
current batch size: 13 token used ratio: 0.07972307692307692
cost load scan: 0.009059906005859375
load 1 adapters, 14 in total
Function load_lora_A took 2.791166305541992 ms to run.
Function load_lora_B took 2.7518272399902344 ms to run.
cost realload: 5.9719085693359375
Function load_adapters took 5.9947967529296875 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 13 remains
cost offload cat: 0.03838539123535156
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.6046295166015625 ms to run.
cost load scan: 0.015020370483398438
load 1 adapters, 14 in total
Function load_lora_A took 9.30643081665039 ms to run.
Function load_lora_B took 9.248018264770508 ms to run.
cost realload: 19.004344940185547
Function load_adapters took 19.030094146728516 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 13 remains
cost offload cat: 0.03790855407714844
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.6041526794433594 ms to run.
cost load scan: 0.015020370483398438
load 2 adapters, 15 in total
Function load_lora_A took 2.816438674926758 ms to run.
Function load_lora_B took 2.797365188598633 ms to run.
Function load_lora_A took 9.245157241821289 ms to run.
Function load_lora_B took 9.190797805786133 ms to run.
cost realload: 24.550914764404297
Function load_adapters took 24.575471878051758 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 14 remains
cost offload cat: 0.04029273986816406
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11444091796875
Function offload_adapters took 0.6232261657714844 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 15 in total
Function load_lora_A took 4.955768585205078 ms to run.
Function load_lora_B took 4.962682723999023 ms to run.
cost realload: 10.343551635742188
Function load_adapters took 10.368824005126953 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 14 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.5915164947509766 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 13 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.591278076171875 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 12 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.5941390991210938 ms to run.
current batch size: 12 token used ratio: 0.06116923076923077
cost offload scan: 0.08749961853027344
offload 1 adapters, 11 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11038780212402344
Function offload_adapters took 0.6048679351806641 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 12 in total
Function load_lora_A took 4.98509407043457 ms to run.
Function load_lora_B took 4.965543746948242 ms to run.
cost realload: 10.405302047729492
Function load_adapters took 10.429620742797852 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 11 remains
cost offload cat: 0.03790855407714844
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.12063980102539062
Function offload_adapters took 0.6189346313476562 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 12 in total
Function load_lora_A took 4.960060119628906 ms to run.
Function load_lora_B took 4.944086074829102 ms to run.
cost realload: 10.343313217163086
Function load_adapters took 10.366678237915039 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 11 remains
cost offload cat: 0.03933906555175781
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11658668518066406
Function offload_adapters took 0.6291866302490234 ms to run.
cost load scan: 0.0171661376953125
load 4 adapters, 15 in total
Function load_lora_A took 2.8307437896728516 ms to run.
Function load_lora_B took 2.749919891357422 ms to run.
Function load_lora_A took 2.7883052825927734 ms to run.
Function load_lora_B took 2.81524658203125 ms to run.
Function load_lora_A took 9.248018264770508 ms to run.
Function load_lora_B took 9.230852127075195 ms to run.
Function load_lora_A took 9.269475936889648 ms to run.
Function load_lora_B took 9.239673614501953 ms to run.
cost realload: 48.8736629486084
Function load_adapters took 48.89965057373047 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 14 remains
cost offload cat: 0.0400543212890625
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.6189346313476562 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 13 remains
cost offload cat: 0.039577484130859375
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11181831359863281
INFO:     127.0.0.1:59248 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59252 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58206 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58222 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58232 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58234 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58242 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58248 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58260 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58276 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58288 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58296 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58306 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58322 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58324 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58330 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58344 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58354 - "POST /generate_stream HTTP/1.1" 200 OK
Function offload_adapters took 0.6167888641357422 ms to run.
current batch size: 13 token used ratio: 0.062353846153846156
cost load scan: 0.014543533325195312
load 1 adapters, 14 in total
Function load_lora_A took 4.988193511962891 ms to run.
Function load_lora_B took 4.93621826171875 ms to run.
cost realload: 10.369300842285156
Function load_adapters took 10.392904281616211 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 13 remains
cost offload cat: 0.035762786865234375
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.12469291687011719
Function offload_adapters took 0.6120204925537109 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 14 in total
Function load_lora_A took 2.8841495513916016 ms to run.
Function load_lora_B took 2.7861595153808594 ms to run.
cost realload: 6.067037582397461
Function load_adapters took 6.0882568359375 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 15 in total
Function load_lora_A took 4.938602447509766 ms to run.
Function load_lora_B took 4.907846450805664 ms to run.
cost realload: 10.244607925415039
Function load_adapters took 10.265827178955078 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 14 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.04839897155761719
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.12350082397460938
Function offload_adapters took 0.6256103515625 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 14 in total
cost realload: 0.2989768981933594
Function load_adapters took 0.32401084899902344 ms to run.
current batch size: 15 token used ratio: 0.0755076923076923
cost load scan: 0.012874603271484375
load 2 adapters, 16 in total
Function load_lora_A took 4.976034164428711 ms to run.
Function load_lora_B took 4.961729049682617 ms to run.
Function load_lora_A took 4.908084869384766 ms to run.
Function load_lora_B took 4.904270172119141 ms to run.
cost realload: 20.23029327392578
Function load_adapters took 20.25151252746582 ms to run.
Avg tokens(prompt+generate) throughput: 1081.776 tokens/s
Avg prompt tokens throughput:            599.045 tokens/s
Avg generate tokens throughput:          482.731 tokens/s
cost load scan: 0.01049041748046875
load 1 adapters, 17 in total
Function load_lora_A took 2.8409957885742188 ms to run.
Function load_lora_B took 2.771615982055664 ms to run.
cost realload: 6.036281585693359
Function load_adapters took 6.058454513549805 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 16 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.04982948303222656
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5922317504882812 ms to run.
cost load scan: 0.013828277587890625
load 2 adapters, 18 in total
Function load_lora_A took 4.964590072631836 ms to run.
Function load_lora_B took 4.904031753540039 ms to run.
Function load_lora_A took 9.282350540161133 ms to run.
Function load_lora_B took 9.26971435546875 ms to run.
cost realload: 28.898954391479492
Function load_adapters took 28.91993522644043 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 19 in total
Function load_lora_A took 2.8061866760253906 ms to run.
Function load_lora_B took 2.7921199798583984 ms to run.
cost realload: 5.9986114501953125
Function load_adapters took 6.019830703735352 ms to run.
current batch size: 21 token used ratio: 0.11310769230769231
cost offload scan: 0.09083747863769531
offload 1 adapters, 18 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5893707275390625 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 17 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11610984802246094
Function offload_adapters took 0.5910396575927734 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 16 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5791187286376953 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 17 in total
Function load_lora_A took 4.965305328369141 ms to run.
Function load_lora_B took 4.966259002685547 ms to run.
cost realload: 10.347366333007812
Function load_adapters took 10.369539260864258 ms to run.
current batch size: 19 token used ratio: 0.11521538461538462
cost offload scan: 0.095367431640625
offload 1 adapters, 16 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5886554718017578 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 17 in total
Function load_lora_A took 9.335756301879883 ms to run.
Function load_lora_B took 9.25898551940918 ms to run.
cost realload: 18.992900848388672
Function load_adapters took 19.014358520507812 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 17 in total
cost realload: 0.29158592224121094
Function load_adapters took 0.3161430358886719 ms to run.
cost load scan: 0.016689300537109375
load 1 adapters, 18 in total
Function load_lora_A took 9.297847747802734 ms to run.
Function load_lora_B took 9.245157241821289 ms to run.
cost realload: 18.955707550048828
Function load_adapters took 18.97716522216797 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.0133514404296875 ms to run.
current batch size: 20 token used ratio: 0.12678461538461538
cost load scan: 0.011682510375976562
load 1 adapters, 19 in total
Function load_lora_A took 4.966974258422852 ms to run.
Function load_lora_B took 4.9381256103515625 ms to run.
cost realload: 10.313272476196289
Function load_adapters took 10.335445404052734 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 18 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5838871002197266 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 17 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.5838871002197266 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 16 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5793571472167969 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 17 in total
Function load_lora_A took 2.824544906616211 ms to run.
Function load_lora_B took 2.774477005004883 ms to run.
cost realload: 5.9909820556640625
Function load_adapters took 6.012201309204102 ms to run.
offload 0 adapters, 17 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 16 remains
cost offload cat: 0.03933906555175781
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.6079673767089844 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 15 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11539459228515625
INFO:     127.0.0.1:58360 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58366 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58372 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58376 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58386 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58402 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58418 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58430 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58436 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58446 - "POST /generate_stream HTTP/1.1" 200 OK
Function offload_adapters took 0.5948543548583984 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 16 in total
Function load_lora_A took 2.858400344848633 ms to run.
Function load_lora_B took 2.808809280395508 ms to run.
cost realload: 6.076574325561523
Function load_adapters took 6.098031997680664 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 15 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.029325485229492188
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5822181701660156 ms to run.
cost load scan: 0.014066696166992188
load 1 adapters, 16 in total
Function load_lora_A took 2.813100814819336 ms to run.
Function load_lora_B took 2.762317657470703 ms to run.
cost realload: 5.9795379638671875
Function load_adapters took 6.001472473144531 ms to run.
current batch size: 19 token used ratio: 0.10853846153846154
cost offload scan: 0.08654594421386719
offload 1 adapters, 15 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5815029144287109 ms to run.
cost load scan: 0.016927719116210938
load 3 adapters, 18 in total
Function load_lora_A took 4.998922348022461 ms to run.
Function load_lora_B took 4.940032958984375 ms to run.
Function load_lora_A took 4.977226257324219 ms to run.
Function load_lora_B took 4.919290542602539 ms to run.
Function load_lora_A took 4.968881607055664 ms to run.
Function load_lora_B took 4.904270172119141 ms to run.
cost realload: 30.262231826782227
Function load_adapters took 30.28559684753418 ms to run.
cost load scan: 0.024318695068359375
load 2 adapters, 20 in total
Function load_lora_A took 4.996061325073242 ms to run.
Function load_lora_B took 4.923820495605469 ms to run.
Function load_lora_A took 2.7933120727539062 ms to run.
Function load_lora_B took 2.7773380279541016 ms to run.
cost realload: 15.968561172485352
Function load_adapters took 15.9912109375 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 21 in total
Function load_lora_A took 4.953861236572266 ms to run.
Function load_lora_B took 4.920482635498047 ms to run.
cost realload: 10.265350341796875
Function load_adapters took 10.286331176757812 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 20 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.102996826171875
Function offload_adapters took 0.5707740783691406 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 19 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.102996826171875
Function offload_adapters took 0.5733966827392578 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 18 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5893707275390625 ms to run.
current batch size: 21 token used ratio: 0.12115384615384615
cost load scan: 0.009775161743164062
load 1 adapters, 19 in total
Function load_lora_A took 9.274721145629883 ms to run.
Function load_lora_B took 9.254217147827148 ms to run.
cost realload: 18.91493797302246
Function load_adapters took 18.935441970825195 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 18 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.5838871002197266 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 17 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5857944488525391 ms to run.
current batch size: 18 token used ratio: 0.10816923076923077
offload 0 adapters, 17 remains
Function offload_adapters took 0.01239776611328125 ms to run.
Avg tokens(prompt+generate) throughput: 1110.930 tokens/s
Avg prompt tokens throughput:            555.815 tokens/s
Avg generate tokens throughput:          555.115 tokens/s
cost offload scan: 0.0858306884765625
offload 1 adapters, 16 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5743503570556641 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 15 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.5862712860107422 ms to run.
cost offload scan: 0.0820159912109375
offload 1 adapters, 14 remains
cost offload cat: 0.02956390380859375
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5648136138916016 ms to run.
current batch size: 14 token used ratio: 0.08647692307692308
cost offload scan: 0.08368492126464844
offload 1 adapters, 13 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5674362182617188 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 12 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5712509155273438 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 11 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5702972412109375 ms to run.
current batch size: 11 token used ratio: 0.072
cost offload scan: 0.08463859558105469
offload 1 adapters, 10 remains
cost offload cat: 0.03743171691894531
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5936622619628906 ms to run.
cost offload scan: 0.08273124694824219
offload 1 adapters, 9 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5786418914794922 ms to run.
cost offload scan: 0.08368492126464844
offload 1 adapters, 8 remains
cost offload cat: 0.03719329833984375
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10275840759277344
Function offload_adapters took 0.5741119384765625 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 7 remains
cost offload cat: 0.03719329833984375
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5898475646972656 ms to run.
cost offload scan: 0.08034706115722656
offload 1 adapters, 6 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: INFO:     127.0.0.1:49544 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49548 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49558 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49562 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49572 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49576 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49592 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49606 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49612 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49622 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49372 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49382 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49396 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49400 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49406 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49408 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49414 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49418 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49428 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49430 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49446 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49458 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49472 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49482 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49488 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49498 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49500 - "POST /generate_stream HTTP/1.1" 200 OK
0.04291534423828125
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.6091594696044922 ms to run.
current batch size: 6 token used ratio: 0.04503076923076923
cost offload scan: 0.0820159912109375
offload 1 adapters, 5 remains
cost offload cat: 0.04124641418457031
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5834102630615234 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 4 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.021457672119140625
cost offload a_loc update: 0.102996826171875
Function offload_adapters took 0.5736351013183594 ms to run.
cost offload scan: 0.08106231689453125
offload 1 adapters, 3 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.5662441253662109 ms to run.
cost offload scan: 0.08082389831542969
offload 1 adapters, 2 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10204315185546875
Function offload_adapters took 0.57220458984375 ms to run.
current batch size: 2 token used ratio: 0.01523076923076923
cost offload scan: 0.07963180541992188
offload 1 adapters, 1 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10251998901367188
Function offload_adapters took 0.5576610565185547 ms to run.
offload 1 adapters, 0 remains
Function offload_adapters took 0.09274482727050781 ms to run.
offload 0 adapters, 0 remains
Function offload_adapters took 0.011682510375976562 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 1 in total
Function load_lora_A took 4.982948303222656 ms to run.
Function load_lora_B took 4.908323287963867 ms to run.
cost realload: 10.591506958007812
Function load_adapters took 10.614633560180664 ms to run.
cost load scan: 0.010013580322265625
load 2 adapters, 3 in total
Function load_lora_A took 4.966974258422852 ms to run.
Function load_lora_B took 4.9419403076171875 ms to run.
Function load_lora_A took 2.7871131896972656 ms to run.
Function load_lora_B took 2.7670860290527344 ms to run.
cost realload: 15.935659408569336
Function load_adapters took 15.963077545166016 ms to run.
cost load scan: 0.012874603271484375
load 2 adapters, 5 in total
Function load_lora_A took 2.8276443481445312 ms to run.
Function load_lora_B took 2.7713775634765625 ms to run.
Function load_lora_A took 9.33218002319336 ms to run.
Function load_lora_B took 9.289264678955078 ms to run.
cost realload: 24.735212326049805
Function load_adapters took 24.758100509643555 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 6 in total
Function load_lora_A took 2.8030872344970703 ms to run.
Function load_lora_B took 2.7856826782226562 ms to run.
cost realload: 5.992412567138672
Function load_adapters took 6.016969680786133 ms to run.
current batch size: 7 token used ratio: 0.02683076923076923
cost load scan: 0.01430511474609375
load 2 adapters, 8 in total
Function load_lora_A took 2.7875900268554688 ms to run.
Function load_lora_B took 2.768278121948242 ms to run.
Function load_lora_A took 9.30643081665039 ms to run.
Function load_lora_B took 9.257316589355469 ms to run.
cost realload: 24.61409568786621
Function load_adapters took 24.636030197143555 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 9 in total
Function load_lora_A took 4.979133605957031 ms to run.
Function load_lora_B took 4.929542541503906 ms to run.
cost realload: 10.301828384399414
Function load_adapters took 10.32567024230957 ms to run.
cost load scan: 0.011920928955078125
load 2 adapters, 11 in total
Function load_lora_A took 9.291648864746094 ms to run.
Function load_lora_B took 9.268522262573242 ms to run.
Function load_lora_A took 2.795696258544922 ms to run.
Function load_lora_B took 2.787351608276367 ms to run.
cost realload: 24.61552619934082
Function load_adapters took 24.636268615722656 ms to run.
cost load scan: 0.01430511474609375
load 2 adapters, 13 in total
Function load_lora_A took 9.277105331420898 ms to run.
Function load_lora_B took 9.232282638549805 ms to run.
Function load_lora_A took 2.79998779296875 ms to run.
Function load_lora_B took 2.8121471405029297 ms to run.
cost realload: 24.593353271484375
Function load_adapters took 24.61838722229004 ms to run.
current batch size: 14 token used ratio: 0.06212307692307692
cost load scan: 0.008106231689453125
load 1 adapters, 14 in total
Function load_lora_A took 9.310007095336914 ms to run.
Function load_lora_B took 9.238719940185547 ms to run.
cost realload: 18.930912017822266
Function load_adapters took 18.951892852783203 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 14 in total
cost realload: 0.2837181091308594
Function load_adapters took 0.30803680419921875 ms to run.
Avg tokens(prompt+generate) throughput:  645.118 tokens/s
Avg prompt tokens throughput:            377.698 tokens/s
Avg generate tokens throughput:          267.420 tokens/s
cost load scan: 0.017404556274414062
load 2 adapters, 16 in total
Function load_lora_A took 4.9571990966796875 ms to run.
Function load_lora_B took 4.976034164428711 ms to run.
Function load_lora_A took 9.280920028686523 ms to run.
Function load_lora_B took 9.206295013427734 ms to run.
cost realload: 28.896331787109375
Function load_adapters took 28.916597366333008 ms to run.
cost load scan: 0.012159347534179688
load 2 adapters, 18 in total
Function load_lora_A took 2.7740001678466797 ms to run.
Function load_lora_B took 2.7742385864257812 ms to run.
Function load_lora_A took 4.966497421264648 ms to run.
Function load_lora_B took 4.913091659545898 ms to run.
cost realload: 15.891551971435547
Function load_adapters took 15.913009643554688 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.012636184692382812 ms to run.
current batch size: 19 token used ratio: 0.08961538461538461
cost load scan: 0.008344650268554688
load 1 adapters, 19 in total
Function load_lora_A took 4.997014999389648 ms to run.
Function load_lora_B took 4.934549331665039 ms to run.
cost realload: 10.329484939575195
Function load_adapters took 10.34998893737793 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 20 in total
Function load_lora_A took 4.988431930541992 ms to run.
Function load_lora_B took 4.900693893432617 ms to run.
cost realload: 10.277032852172852
Function load_adapters took 10.29825210571289 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 19 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5805492401123047 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 18 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5905628204345703 ms to run.
cost load scan: 0.013828277587890625
load 3 adapters, 21 in total
Function load_lora_A took 9.286642074584961 ms to run.
Function load_lora_B took 9.26065444946289 ms to run.
Function load_lora_A took 9.314775466918945 ms to run.
Function load_lora_B took 9.267807006835938 ms to run.
Function load_lora_A took 9.309768676757812 ms to run.
Function load_lora_B took 9.289264678955078 ms to run.
cost realload: 56.266069412231445
Function load_adapters took 56.28705024719238 ms to run.
current batch size: 23 token used ratio: 0.11830769230769231
cost load scan: 0.008344650268554688
load 1 adapters, 22 in total
Function load_lora_A took 4.966497421264648 ms to run.
INFO:     127.0.0.1:49504 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49514 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49528 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49534 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49540 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49556 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49564 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49568 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49572 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49586 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49588 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49604 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49616 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49630 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49632 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49646 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49654 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49666 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49672 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49682 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49696 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49710 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49718 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49726 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49736 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49742 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49758 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49762 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49772 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:49776 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_B took 4.913806915283203 ms to run.
cost realload: 10.306358337402344
Function load_adapters took 10.328292846679688 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 21 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.5838871002197266 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 20 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5779266357421875 ms to run.
cost load scan: 0.009298324584960938
load 2 adapters, 22 in total
Function load_lora_A took 9.309768676757812 ms to run.
Function load_lora_B took 9.266138076782227 ms to run.
Function load_lora_A took 2.855539321899414 ms to run.
Function load_lora_B took 2.8002262115478516 ms to run.
cost realload: 24.710893630981445
Function load_adapters took 24.73282814025879 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 21 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5922317504882812 ms to run.
cost offload scan: 0.09489059448242188
offload 1 adapters, 20 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11181831359863281
Function offload_adapters took 0.5958080291748047 ms to run.
cost load scan: 0.01239776611328125
load 5 adapters, 25 in total
Function load_lora_A took 9.32621955871582 ms to run.
Function load_lora_B took 9.274482727050781 ms to run.
Function load_lora_A took 4.955530166625977 ms to run.
Function load_lora_B took 4.963874816894531 ms to run.
Function load_lora_A took 9.293794631958008 ms to run.
Function load_lora_B took 9.30023193359375 ms to run.
Function load_lora_A took 2.7425289154052734 ms to run.
Function load_lora_B took 2.7844905853271484 ms to run.
Function load_lora_A took 4.959583282470703 ms to run.
Function load_lora_B took 4.920005798339844 ms to run.
cost realload: 63.19165229797363
Function load_adapters took 63.21310997009277 ms to run.
cost load scan: 0.01621246337890625
load 4 adapters, 29 in total
Function load_lora_A took 2.8104782104492188 ms to run.
Function load_lora_B took 2.7713775634765625 ms to run.
Function load_lora_A took 2.7916431427001953 ms to run.
Function load_lora_B took 2.7899742126464844 ms to run.
Function load_lora_A took 9.288549423217773 ms to run.
Function load_lora_B took 9.26661491394043 ms to run.
Function load_lora_A took 2.8107166290283203 ms to run.
Function load_lora_B took 2.8047561645507812 ms to run.
cost realload: 35.96758842468262
Function load_adapters took 35.99119186401367 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 28 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.048160552978515625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11515617370605469
Function offload_adapters took 0.6151199340820312 ms to run.
cost load scan: 0.015974044799804688
load 4 adapters, 32 in total
Function load_lora_A took 4.966020584106445 ms to run.
Function load_lora_B took 4.930973052978516 ms to run.
Function load_lora_A took 9.31859016418457 ms to run.
Function load_lora_B took 9.254217147827148 ms to run.
Function load_lora_A took 9.268522262573242 ms to run.
Function load_lora_B took 9.222745895385742 ms to run.
Function load_lora_A took 9.269952774047852 ms to run.
Function load_lora_B took 9.302854537963867 ms to run.
cost realload: 66.27988815307617
Function load_adapters took 66.30682945251465 ms to run.
current batch size: 35 token used ratio: 0.18076923076923077
offload 0 adapters, 32 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.014066696166992188
load 1 adapters, 33 in total
Function load_lora_A took 4.902124404907227 ms to run.
Function load_lora_B took 4.88591194152832 ms to run.
cost realload: 10.207653045654297
Function load_adapters took 10.229349136352539 ms to run.
offload 0 adapters, 33 remains
Function offload_adapters took 0.0133514404296875 ms to run.
cost offload scan: 0.10156631469726562
offload 1 adapters, 32 remains
cost offload cat: 0.03814697265625
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.6110668182373047 ms to run.
offload 0 adapters, 32 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost load scan: 0.015497207641601562
load 2 adapters, 34 in total
Function load_lora_A took 9.293556213378906 ms to run.
Function load_lora_B took 9.260892868041992 ms to run.
Function load_lora_A took 4.912376403808594 ms to run.
Function load_lora_B took 4.928827285766602 ms to run.
cost realload: 28.879165649414062
Function load_adapters took 28.900861740112305 ms to run.
offload 0 adapters, 34 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 35 in total
Function load_lora_A took 9.310483932495117 ms to run.
Function load_lora_B took 9.270668029785156 ms to run.
cost realload: 18.975019454956055
Function load_adapters took 18.996477127075195 ms to run.
cost offload scan: 0.09584426879882812
offload 1 adapters, 34 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.027894973754882812
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.6017684936523438 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 33 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5946159362792969 ms to run.
cost load scan: 0.012874603271484375
load 3 adapters, 36 in total
Function load_lora_A took 9.28187370300293 ms to run.
Function load_lora_B took 9.28044319152832 ms to run.
Function load_lora_A took 2.8007030487060547 ms to run.
Function load_lora_B took 2.7642250061035156 ms to run.
Function load_lora_A took 9.309053421020508 ms to run.
Function load_lora_B took 9.255647659301758 ms to run.
cost realload: 43.24603080749512
Function load_adapters took 43.26772689819336 ms to run.
current batch size: 37 token used ratio: 0.20155384615384617
cost load scan: 0.010728836059570312
load 1 adapters, 37 in total
Function load_lora_A took 2.8221607208251953 ms to run.
Function load_lora_B took 2.785921096801758 ms to run.
cost realload: 6.0024261474609375
Function load_adapters took 6.023168563842773 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 36 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.05078315734863281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5962848663330078 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 37 in total
Function load_lora_A took 2.8221607208251953 ms to run.
Function load_lora_B took 2.7866363525390625 ms to run.
cost realload: 6.0024261474609375
Function load_adapters took 6.023406982421875 ms to run.
cost offload scan: 0.09703636169433594
offload 1 adapters, 36 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5979537963867188 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 35 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
INFO:     127.0.0.1:54958 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54966 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54968 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54978 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54988 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54994 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55002 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55018 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55026 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55032 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55036 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55052 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55056 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55058 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55060 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.6225109100341797 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 36 in total
Function load_lora_A took 2.828836441040039 ms to run.
Function load_lora_B took 2.792835235595703 ms to run.
cost realload: 6.00433349609375
Function load_adapters took 6.024837493896484 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 36 in total
cost realload: 0.2932548522949219
Function load_adapters took 0.316619873046875 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 35 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5881786346435547 ms to run.
offload 0 adapters, 35 remains
Function offload_adapters took 0.012636184692382812 ms to run.
current batch size: 37 token used ratio: 0.21115384615384616
cost offload scan: 0.08988380432128906
offload 1 adapters, 34 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.5893707275390625 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 34 in total
cost realload: 0.2760887145996094
Function load_adapters took 0.29969215393066406 ms to run.
Avg tokens(prompt+generate) throughput: 1836.295 tokens/s
Avg prompt tokens throughput:           1197.462 tokens/s
Avg generate tokens throughput:          638.833 tokens/s
cost offload scan: 0.12803077697753906
offload 2 adapters, 32 remains
cost offload cat: 0.024557113647460938
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.6165504455566406 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 33 in total
Function load_lora_A took 2.8061866760253906 ms to run.
Function load_lora_B took 2.7768611907958984 ms to run.
cost realload: 5.974054336547852
Function load_adapters took 5.995512008666992 ms to run.
cost offload scan: 0.095367431640625
offload 1 adapters, 32 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5950927734375 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 31 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.6017684936523438 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 30 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.028848648071289062
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5993843078613281 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 29 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5939006805419922 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 30 in total
Function load_lora_A took 2.804994583129883 ms to run.
Function load_lora_B took 2.8145313262939453 ms to run.
cost realload: 5.99980354309082
Function load_adapters took 6.020307540893555 ms to run.
current batch size: 33 token used ratio: 0.2046923076923077
cost offload scan: 0.09012222290039062
offload 1 adapters, 29 remains
cost offload cat: 0.03814697265625
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.598907470703125 ms to run.
offload 0 adapters, 29 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.009775161743164062
load 1 adapters, 30 in total
Function load_lora_A took 9.271621704101562 ms to run.
Function load_lora_B took 9.226322174072266 ms to run.
cost realload: 18.880844116210938
Function load_adapters took 18.904924392700195 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 29 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5896091461181641 ms to run.
offload 0 adapters, 29 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.013828277587890625
load 2 adapters, 31 in total
Function load_lora_A took 4.990577697753906 ms to run.
Function load_lora_B took 4.919528961181641 ms to run.
Function load_lora_A took 2.795696258544922 ms to run.
Function load_lora_B took 2.765655517578125 ms to run.
cost realload: 15.933513641357422
Function load_adapters took 15.955448150634766 ms to run.
cost offload scan: 0.1270771026611328
offload 2 adapters, 29 remains
cost offload cat: 0.024318695068359375
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.6203651428222656 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 30 in total
Function load_lora_A took 4.934787750244141 ms to run.
Function load_lora_B took 4.929065704345703 ms to run.
cost realload: 10.263442993164062
Function load_adapters took 10.284662246704102 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 29 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11658668518066406
Function offload_adapters took 0.6008148193359375 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 28 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04887580871582031
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5862712860107422 ms to run.
cost load scan: 0.017881393432617188
load 1 adapters, 29 in total
Function load_lora_A took 2.823352813720703 ms to run.
Function load_lora_B took 2.778768539428711 ms to run.
cost realload: 5.994081497192383
Function load_adapters took 6.0138702392578125 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 28 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5936622619628906 ms to run.
cost offload scan: 0.09822845458984375
offload 1 adapters, 27 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.598907470703125 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 26 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5750656127929688 ms to run.
current batch size: 28 token used ratio: 0.1722923076923077
cost load scan: 0.014781951904296875
load 3 adapters, 29 in total
Function load_lora_A took 2.7980804443359375 ms to run.
Function load_lora_B took 2.780914306640625 ms to run.
Function load_lora_A took 2.804994583129883 ms to run.
Function load_lora_B took 2.7637481689453125 ms to run.
Function load_lora_A took 4.948616027832031 ms to run.
Function load_lora_B took 4.920005798339844 ms to run.
cost realload: 21.553754806518555
INFO:     127.0.0.1:55062 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55064 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55074 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55078 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55092 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55100 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55110 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55114 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55122 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55132 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55140 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55146 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55158 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45974 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45982 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45992 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46002 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46018 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_adapters took 21.5756893157959 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 30 in total
Function load_lora_A took 9.308099746704102 ms to run.
Function load_lora_B took 9.280681610107422 ms to run.
cost realload: 18.98360252380371
Function load_adapters took 19.005298614501953 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 29 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.028371810913085938
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.5981922149658203 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 30 in total
Function load_lora_A took 9.251832962036133 ms to run.
Function load_lora_B took 9.260892868041992 ms to run.
cost realload: 18.904924392700195
Function load_adapters took 18.927335739135742 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 29 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.049114227294921875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5984306335449219 ms to run.
cost load scan: 0.014066696166992188
load 1 adapters, 30 in total
Function load_lora_A took 4.981040954589844 ms to run.
Function load_lora_B took 4.939079284667969 ms to run.
cost realload: 10.315895080566406
Function load_adapters took 10.339021682739258 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 29 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5977153778076172 ms to run.
offload 0 adapters, 29 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 28 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5850791931152344 ms to run.
cost load scan: 0.014066696166992188
load 1 adapters, 29 in total
Function load_lora_A took 9.317636489868164 ms to run.
Function load_lora_B took 9.264707565307617 ms to run.
cost realload: 18.997669219970703
Function load_adapters took 19.019126892089844 ms to run.
current batch size: 33 token used ratio: 0.1942
offload 0 adapters, 29 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 28 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.5860328674316406 ms to run.
cost load scan: 0.014781951904296875
load 1 adapters, 29 in total
Function load_lora_A took 2.8076171875 ms to run.
Function load_lora_B took 2.8333663940429688 ms to run.
cost realload: 6.053447723388672
Function load_adapters took 6.0749053955078125 ms to run.
cost offload scan: 0.12874603271484375
offload 2 adapters, 27 remains
cost offload cat: 0.0247955322265625
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.6361007690429688 ms to run.
cost load scan: 0.012159347534179688
load 3 adapters, 30 in total
Function load_lora_A took 2.820253372192383 ms to run.
Function load_lora_B took 2.805471420288086 ms to run.
Function load_lora_A took 2.818584442138672 ms to run.
Function load_lora_B took 2.8052330017089844 ms to run.
Function load_lora_A took 9.258747100830078 ms to run.
Function load_lora_B took 9.241342544555664 ms to run.
cost realload: 30.27510643005371
Function load_adapters took 30.296802520751953 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 29 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5919933319091797 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 28 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5924701690673828 ms to run.
cost offload scan: 0.09679794311523438
offload 1 adapters, 27 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5958080291748047 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 26 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.102996826171875
Function offload_adapters took 0.5745887756347656 ms to run.
current batch size: 31 token used ratio: 0.1771230769230769
cost offload scan: 0.09393692016601562
offload 1 adapters, 25 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5896091461181641 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 26 in total
Function load_lora_A took 9.287118911743164 ms to run.
Function load_lora_B took 9.273052215576172 ms to run.
cost realload: 18.944501876831055
Function load_adapters took 18.964767456054688 ms to run.
offload 0 adapters, 26 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 25 remains
cost offload cat: 0.02956390380859375
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.5843639373779297 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 26 in total
Function load_lora_A took 4.900217056274414 ms to run.
Function load_lora_B took 4.909515380859375 ms to run.
cost realload: 10.209083557128906
Function load_adapters took 10.230541229248047 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 26 in total
cost realload: 0.2815723419189453
Function load_adapters took 0.30493736267089844 ms to run.
cost offload scan: 0.09417533874511719
offload 1 adapters, 25 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5900859832763672 ms to run.
cost load scan: 0.01430511474609375
load 2 adapters, 27 in total
Function load_lora_A took 9.300470352172852 ms to run.
Function load_lora_B took 9.249210357666016 ms to run.
Function load_lora_A took 4.981517791748047 ms to run.
Function load_lora_B took 4.92095947265625 ms to run.
cost realload: 28.929710388183594
Function load_adapters took 28.95188331604004 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 26 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.05030632019042969
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5981922149658203 ms to run.
cost offload scan: 0.09679794311523438
offload 1 adapters, 25 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5888938903808594 ms to run.
current batch size: 30 token used ratio: 0.16826153846153846
cost load scan: 0.011920928955078125
load 1 adapters, 26 in total
INFO:     127.0.0.1:46020 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46028 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46036 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46048 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46054 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46056 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46068 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46076 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46090 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46106 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46110 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46118 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46120 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46128 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46144 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46158 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46172 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46182 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46184 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46186 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 2.8133392333984375 ms to run.
Function load_lora_B took 2.7489662170410156 ms to run.
cost realload: 5.982398986816406
Function load_adapters took 6.003618240356445 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 25 remains
cost offload cat: 0.03790855407714844
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5881786346435547 ms to run.
Avg tokens(prompt+generate) throughput: 1514.586 tokens/s
Avg prompt tokens throughput:            777.379 tokens/s
Avg generate tokens throughput:          737.206 tokens/s
cost offload scan: 0.09369850158691406
offload 1 adapters, 24 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5872249603271484 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 24 in total
cost realload: 0.27489662170410156
Function load_adapters took 0.29754638671875 ms to run.
offload 0 adapters, 24 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.015974044799804688
load 3 adapters, 27 in total
Function load_lora_A took 4.986047744750977 ms to run.
Function load_lora_B took 4.941701889038086 ms to run.
Function load_lora_A took 2.8128623962402344 ms to run.
Function load_lora_B took 2.7952194213867188 ms to run.
Function load_lora_A took 2.794981002807617 ms to run.
Function load_lora_B took 2.7883052825927734 ms to run.
cost realload: 21.663188934326172
Function load_adapters took 21.684646606445312 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 26 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5800724029541016 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 25 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5822181701660156 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 26 in total
Function load_lora_A took 4.9285888671875 ms to run.
Function load_lora_B took 4.914283752441406 ms to run.
cost realload: 10.220527648925781
Function load_adapters took 10.243654251098633 ms to run.
cost load scan: 0.013113021850585938
load 3 adapters, 29 in total
Function load_lora_A took 4.925966262817383 ms to run.
Function load_lora_B took 4.936695098876953 ms to run.
Function load_lora_A took 9.28497314453125 ms to run.
Function load_lora_B took 9.281635284423828 ms to run.
Function load_lora_A took 2.8142929077148438 ms to run.
Function load_lora_B took 2.811431884765625 ms to run.
cost realload: 34.59286689758301
Function load_adapters took 34.61432456970215 ms to run.
current batch size: 34 token used ratio: 0.18792307692307691
cost load scan: 0.011682510375976562
load 1 adapters, 30 in total
Function load_lora_A took 4.993438720703125 ms to run.
Function load_lora_B took 4.945278167724609 ms to run.
cost realload: 10.340213775634766
Function load_adapters took 10.36214828491211 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 29 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.11467933654785156
Function offload_adapters took 0.5910396575927734 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 28 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.58746337890625 ms to run.
offload 0 adapters, 28 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost load scan: 0.009059906005859375
load 2 adapters, 30 in total
Function load_lora_A took 2.809762954711914 ms to run.
Function load_lora_B took 2.7916431427001953 ms to run.
Function load_lora_A took 9.27114486694336 ms to run.
Function load_lora_B took 9.271621704101562 ms to run.
cost realload: 24.602890014648438
Function load_adapters took 24.624109268188477 ms to run.
offload 0 adapters, 30 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.013589859008789062
load 3 adapters, 33 in total
Function load_lora_A took 2.8045177459716797 ms to run.
Function load_lora_B took 2.7790069580078125 ms to run.
Function load_lora_A took 9.273529052734375 ms to run.
Function load_lora_B took 9.242773056030273 ms to run.
Function load_lora_A took 9.261131286621094 ms to run.
Function load_lora_B took 9.198188781738281 ms to run.
cost realload: 43.09725761413574
Function load_adapters took 43.121337890625 ms to run.
offload 0 adapters, 33 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.09465217590332031
offload 1 adapters, 32 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5922317504882812 ms to run.
offload 0 adapters, 32 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost offload scan: 0.09441375732421875
offload 1 adapters, 31 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5977153778076172 ms to run.
cost load scan: 0.013589859008789062
load 2 adapters, 33 in total
Function load_lora_A took 4.931211471557617 ms to run.
Function load_lora_B took 4.896879196166992 ms to run.
Function load_lora_A took 9.27591323852539 ms to run.
Function load_lora_B took 9.276390075683594 ms to run.
cost realload: 28.834819793701172
Function load_adapters took 28.855323791503906 ms to run.
current batch size: 36 token used ratio: 0.20012307692307693
cost offload scan: 0.08988380432128906
offload 1 adapters, 32 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5867481231689453 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 32 in total
cost realload: 0.27823448181152344
Function load_adapters took 0.3018379211425781 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 31 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.6000995635986328 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 30 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.0286102294921875
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5922317504882812 ms to run.
cost offload scan: 0.09441375732421875
offload 1 adapters, 29 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04982948303222656
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5974769592285156 ms to run.
offload 0 adapters, 29 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.09679794311523438
offload 1 adapters, 28 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10728836059570312
INFO:     127.0.0.1:46194 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46202 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46206 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46220 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46234 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46236 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46238 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46252 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46260 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46272 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38486 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38496 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38502 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38512 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38514 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38530 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38546 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38558 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38574 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38584 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38586 - "POST /generate_stream HTTP/1.1" 200 OK
Function offload_adapters took 0.5970001220703125 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 27 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11539459228515625
Function offload_adapters took 0.5908012390136719 ms to run.
cost offload scan: 0.09799003601074219
offload 1 adapters, 26 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5891323089599609 ms to run.
cost load scan: 0.014543533325195312
load 2 adapters, 28 in total
Function load_lora_A took 4.960536956787109 ms to run.
Function load_lora_B took 4.935979843139648 ms to run.
Function load_lora_A took 4.902362823486328 ms to run.
Function load_lora_B took 4.88734245300293 ms to run.
cost realload: 20.18284797668457
Function load_adapters took 20.206451416015625 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 27 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5977153778076172 ms to run.
current batch size: 30 token used ratio: 0.17535384615384617
cost offload scan: 0.09107589721679688
offload 1 adapters, 26 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5898475646972656 ms to run.
cost offload scan: 0.09679794311523438
offload 1 adapters, 25 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5931854248046875 ms to run.
offload 0 adapters, 25 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 26 in total
Function load_lora_A took 2.817869186401367 ms to run.
Function load_lora_B took 2.809762954711914 ms to run.
cost realload: 6.012201309204102
Function load_adapters took 6.034135818481445 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 27 in total
Function load_lora_A took 2.801179885864258 ms to run.
Function load_lora_B took 2.790212631225586 ms to run.
cost realload: 5.983591079711914
Function load_adapters took 6.006479263305664 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 27 in total
cost realload: 0.278472900390625
Function load_adapters took 0.30303001403808594 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 28 in total
Function load_lora_A took 9.292364120483398 ms to run.
Function load_lora_B took 9.247779846191406 ms to run.
cost realload: 18.938064575195312
Function load_adapters took 18.959760665893555 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 27 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.6062984466552734 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 26 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5910396575927734 ms to run.
current batch size: 29 token used ratio: 0.1733846153846154
cost load scan: 0.009059906005859375
load 1 adapters, 27 in total
Function load_lora_A took 9.365081787109375 ms to run.
Function load_lora_B took 9.332656860351562 ms to run.
cost realload: 19.196510314941406
Function load_adapters took 19.22130584716797 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 26 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04839897155761719
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.12159347534179688
Function offload_adapters took 0.6155967712402344 ms to run.
cost offload scan: 0.12755393981933594
offload 2 adapters, 24 remains
cost offload cat: 0.024557113647460938
cost offload free mem manager: 0.05030632019042969
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.6289482116699219 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 25 in total
Function load_lora_A took 2.837657928466797 ms to run.
Function load_lora_B took 2.7709007263183594 ms to run.
cost realload: 5.992412567138672
Function load_adapters took 6.013631820678711 ms to run.
cost offload scan: 0.1266002655029297
offload 2 adapters, 23 remains
cost offload cat: 0.024318695068359375
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.6086826324462891 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 22 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.5872249603271484 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 23 in total
Function load_lora_A took 2.821683883666992 ms to run.
Function load_lora_B took 2.8100013732910156 ms to run.
cost realload: 6.026268005371094
Function load_adapters took 6.047725677490234 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 22 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5879402160644531 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 21 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5860328674316406 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 20 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5900859832763672 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 20 in total
cost realload: 0.2913475036621094
Function load_adapters took 0.31566619873046875 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 21 in total
Function load_lora_A took 9.321451187133789 ms to run.
Function load_lora_B took 9.262800216674805 ms to run.
cost realload: 19.003868103027344
Function load_adapters took 19.025087356567383 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.012159347534179688 ms to run.
current batch size: 30 token used ratio: 0.1707846153846154
Avg tokens(prompt+generate) throughput: 1665.431 tokens/s
Avg prompt tokens throughput:            952.487 tokens/s
Avg generate tokens throughput:          712.945 tokens/s
cost load scan: 0.013113021850585938
load 2 adapters, 23 in total
Function load_lora_A took 9.307861328125 ms to run.
Function load_lora_B took 9.2620849609375 ms to run.
Function load_lora_A took 2.804994583129883 ms to run.
Function load_lora_B took 2.7840137481689453 ms to run.
cost realload: 24.646759033203125
Function load_adapters took 24.66869354248047 ms to run.
cost load scan: 0.013113021850585938
load 2 adapters, 25 in total
Function load_lora_A took 9.29713249206543 ms to run.
Function load_lora_B took 9.26971435546875 ms to run.
Function load_lora_A took 2.798318862915039 ms to run.
INFO:     127.0.0.1:38602 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38614 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38616 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38620 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38622 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38632 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38642 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38654 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38662 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38678 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38694 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38708 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38718 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38730 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38736 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38742 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38752 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38766 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38776 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38786 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38796 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38798 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38810 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38814 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38820 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38826 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38832 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_B took 2.7899742126464844 ms to run.
cost realload: 24.67179298400879
Function load_adapters took 24.69348907470703 ms to run.
cost offload scan: 0.1316070556640625
offload 2 adapters, 23 remains
cost offload cat: 0.024557113647460938
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.6265640258789062 ms to run.
cost offload scan: 0.091552734375
offload 1 adapters, 22 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5829334259033203 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 22 in total
cost realload: 0.2830028533935547
Function load_adapters took 0.30732154846191406 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.011920928955078125 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 21 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.6155967712402344 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 20 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5857944488525391 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost offload scan: 0.09369850158691406
offload 1 adapters, 19 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5877017974853516 ms to run.
current batch size: 26 token used ratio: 0.14076923076923076
cost load scan: 0.007867813110351562
load 0 adapters, 19 in total
cost realload: 0.2758502960205078
Function load_adapters took 0.29921531677246094 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 18 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5803108215332031 ms to run.
cost load scan: 0.013589859008789062
load 1 adapters, 19 in total
Function load_lora_A took 9.313106536865234 ms to run.
Function load_lora_B took 9.261369705200195 ms to run.
cost realload: 18.97144317626953
Function load_adapters took 18.99242401123047 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 18 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5948543548583984 ms to run.
cost load scan: 0.013828277587890625
load 2 adapters, 20 in total
Function load_lora_A took 4.958391189575195 ms to run.
Function load_lora_B took 4.932880401611328 ms to run.
Function load_lora_A took 2.799510955810547 ms to run.
Function load_lora_B took 2.7704238891601562 ms to run.
cost realload: 15.941619873046875
Function load_adapters took 15.963077545166016 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 19 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5884170532226562 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 18 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.026702880859375
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5881786346435547 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 19 in total
Function load_lora_A took 4.988908767700195 ms to run.
Function load_lora_B took 4.927873611450195 ms to run.
cost realload: 10.325193405151367
Function load_adapters took 10.346651077270508 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.011920928955078125 ms to run.
current batch size: 27 token used ratio: 0.149
cost load scan: 0.016689300537109375
load 2 adapters, 21 in total
Function load_lora_A took 9.283065795898438 ms to run.
Function load_lora_B took 9.25755500793457 ms to run.
Function load_lora_A took 4.985570907592773 ms to run.
Function load_lora_B took 4.9037933349609375 ms to run.
cost realload: 28.900623321533203
Function load_adapters took 28.922080993652344 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.013113021850585938 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.010013580322265625
load 1 adapters, 22 in total
Function load_lora_A took 9.312629699707031 ms to run.
Function load_lora_B took 9.273767471313477 ms to run.
cost realload: 18.98026466369629
Function load_adapters took 19.001483917236328 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.0972747802734375
offload 1 adapters, 21 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5879402160644531 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.011682510375976562 ms to run.
cost load scan: 0.01621246337890625
load 5 adapters, 26 in total
Function load_lora_A took 4.990577697753906 ms to run.
Function load_lora_B took 4.922628402709961 ms to run.
Function load_lora_A took 4.88734245300293 ms to run.
Function load_lora_B took 4.906415939331055 ms to run.
Function load_lora_A took 9.347677230834961 ms to run.
Function load_lora_B took 9.227991104125977 ms to run.
Function load_lora_A took 4.894495010375977 ms to run.
Function load_lora_B took 4.957437515258789 ms to run.
Function load_lora_A took 9.281635284423828 ms to run.
Function load_lora_B took 9.265661239624023 ms to run.
cost realload: 67.38162040710449
Function load_adapters took 67.40427017211914 ms to run.
cost load scan: 0.017404556274414062
load 4 adapters, 30 in total
Function load_lora_A took 2.8107166290283203 ms to run.
Function load_lora_B took 2.820253372192383 ms to run.
Function load_lora_A took 9.273767471313477 ms to run.
Function load_lora_B took 9.216785430908203 ms to run.
Function load_lora_A took 2.845287322998047 ms to run.
Function load_lora_B took 2.793550491333008 ms to run.
Function load_lora_A took 9.308338165283203 ms to run.
Function load_lora_B took 9.280920028686523 ms to run.
cost realload: 48.96354675292969
Function load_adapters took 48.98476600646973 ms to run.
cost load scan: 0.015020370483398438
load 5 adapters, 35 in total
Function load_lora_A took 9.307146072387695 ms to run.
Function load_lora_B took 9.251117706298828 ms to run.
Function load_lora_A took 2.8285980224609375 ms to run.
Function load_lora_B took 2.78472900390625 ms to run.
Function load_lora_A took 2.8035640716552734 ms to run.
Function load_lora_B took 2.8018951416015625 ms to run.
Function load_lora_A took 9.253740310668945 ms to run.
Function load_lora_B took 9.279012680053711 ms to run.
Function load_lora_A took 2.8035640716552734 ms to run.
Function load_lora_B took 2.7968883514404297 ms to run.
cost realload: 54.618120193481445
Function load_adapters took 54.641008377075195 ms to run.
current batch size: 39 token used ratio: 0.20215384615384616
cost load scan: 0.01430511474609375
load 3 adapters, 38 in total
INFO:     127.0.0.1:38840 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38844 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38858 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38872 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38882 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38886 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38888 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53172 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53188 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53194 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53198 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53204 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53210 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53212 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53222 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53236 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53252 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 4.985809326171875 ms to run.
Function load_lora_B took 4.939556121826172 ms to run.
Function load_lora_A took 9.269237518310547 ms to run.
Function load_lora_B took 9.175777435302734 ms to run.
Function load_lora_A took 4.946231842041016 ms to run.
Function load_lora_B took 4.92095947265625 ms to run.
cost realload: 38.82598876953125
Function load_adapters took 38.84720802307129 ms to run.
cost offload scan: 0.10061264038085938
offload 1 adapters, 37 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.6034374237060547 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 37 in total
cost realload: 0.29206275939941406
Function load_adapters took 0.31638145446777344 ms to run.
cost offload scan: 0.09965896606445312
offload 1 adapters, 36 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.6015300750732422 ms to run.
offload 0 adapters, 36 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 37 in total
Function load_lora_A took 9.286165237426758 ms to run.
Function load_lora_B took 9.247541427612305 ms to run.
cost realload: 18.934249877929688
Function load_adapters took 18.95761489868164 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 37 in total
cost realload: 0.27823448181152344
Function load_adapters took 0.301361083984375 ms to run.
cost offload scan: 0.09584426879882812
offload 1 adapters, 36 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.6096363067626953 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 37 in total
Function load_lora_A took 2.8181076049804688 ms to run.
Function load_lora_B took 2.782106399536133 ms to run.
cost realload: 6.000280380249023
Function load_adapters took 6.0214996337890625 ms to run.
current batch size: 44 token used ratio: 0.24163076923076923
offload 0 adapters, 37 remains
Function offload_adapters took 0.012636184692382812 ms to run.
offload 0 adapters, 37 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.012159347534179688
load 1 adapters, 38 in total
Function load_lora_A took 9.301424026489258 ms to run.
Function load_lora_B took 9.280204772949219 ms to run.
cost realload: 18.982410430908203
Function load_adapters took 19.004106521606445 ms to run.
cost offload scan: 0.13375282287597656
offload 2 adapters, 36 remains
cost offload cat: 0.024557113647460938
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.6244182586669922 ms to run.
cost load scan: 0.01239776611328125
load 3 adapters, 39 in total
Function load_lora_A took 9.311437606811523 ms to run.
Function load_lora_B took 9.293079376220703 ms to run.
Function load_lora_A took 4.970312118530273 ms to run.
Function load_lora_B took 4.951953887939453 ms to run.
Function load_lora_A took 2.788543701171875 ms to run.
Function load_lora_B took 2.7816295623779297 ms to run.
cost realload: 34.65437889099121
Function load_adapters took 34.67607498168945 ms to run.
offload 0 adapters, 39 remains
Function offload_adapters took 0.011682510375976562 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 38 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.6043910980224609 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 37 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.58746337890625 ms to run.
cost load scan: 0.013589859008789062
load 1 adapters, 38 in total
Function load_lora_A took 2.7916431427001953 ms to run.
Function load_lora_B took 2.7844905853271484 ms to run.
cost realload: 5.980491638183594
Function load_adapters took 6.001710891723633 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 37 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.58746337890625 ms to run.
cost offload scan: 0.1327991485595703
offload 2 adapters, 35 remains
cost offload cat: 0.024557113647460938
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.0286102294921875
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.6301403045654297 ms to run.
Avg tokens(prompt+generate) throughput: 1857.217 tokens/s
Avg prompt tokens throughput:           1126.993 tokens/s
Avg generate tokens throughput:          730.224 tokens/s
cost offload scan: 0.09799003601074219
offload 1 adapters, 34 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5922317504882812 ms to run.
current batch size: 39 token used ratio: 0.22626153846153846
cost offload scan: 0.09441375732421875
offload 1 adapters, 33 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.6003379821777344 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 33 in total
cost realload: 0.2841949462890625
Function load_adapters took 0.3154277801513672 ms to run.
offload 0 adapters, 33 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 32 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5805492401123047 ms to run.
cost offload scan: 0.09417533874511719
offload 1 adapters, 31 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5884170532226562 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 32 in total
Function load_lora_A took 4.992485046386719 ms to run.
Function load_lora_B took 4.988431930541992 ms to run.
cost realload: 10.372400283813477
Function load_adapters took 10.393381118774414 ms to run.
cost offload scan: 0.09369850158691406
offload 1 adapters, 31 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.6003379821777344 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 30 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5960464477539062 ms to run.
cost offload scan: 0.09465217590332031
offload 1 adapters, 29 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.598907470703125 ms to run.
INFO:     127.0.0.1:53258 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53274 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53290 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53300 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53316 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53330 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53344 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53348 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53364 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53368 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53372 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53382 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53396 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53400 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53408 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53422 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53434 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53442 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53452 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53456 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53464 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53470 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload scan: 0.13184547424316406
offload 2 adapters, 27 remains
cost offload cat: 0.024318695068359375
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.028371810913085938
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.6515979766845703 ms to run.
cost load scan: 0.012636184692382812
load 2 adapters, 29 in total
Function load_lora_A took 4.978418350219727 ms to run.
Function load_lora_B took 4.914522171020508 ms to run.
Function load_lora_A took 4.950761795043945 ms to run.
Function load_lora_B took 4.932641983032227 ms to run.
cost realload: 20.247936248779297
Function load_adapters took 20.274639129638672 ms to run.
cost load scan: 0.014066696166992188
load 2 adapters, 31 in total
Function load_lora_A took 2.826213836669922 ms to run.
Function load_lora_B took 2.797365188598633 ms to run.
Function load_lora_A took 9.307861328125 ms to run.
Function load_lora_B took 9.270429611206055 ms to run.
cost realload: 24.690628051757812
Function load_adapters took 24.71160888671875 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 30 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.5929470062255859 ms to run.
offload 0 adapters, 30 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.015735626220703125
load 2 adapters, 32 in total
Function load_lora_A took 9.273052215576172 ms to run.
Function load_lora_B took 9.249687194824219 ms to run.
Function load_lora_A took 2.819538116455078 ms to run.
Function load_lora_B took 2.7914047241210938 ms to run.
cost realload: 24.609804153442383
Function load_adapters took 24.63364601135254 ms to run.
offload 0 adapters, 32 remains
Function offload_adapters took 0.01239776611328125 ms to run.
current batch size: 36 token used ratio: 0.20536923076923078
cost offload scan: 0.09250640869140625
offload 1 adapters, 31 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11706352233886719
Function offload_adapters took 0.6043910980224609 ms to run.
cost load scan: 0.014066696166992188
load 4 adapters, 35 in total
Function load_lora_A took 2.832174301147461 ms to run.
Function load_lora_B took 2.799510955810547 ms to run.
Function load_lora_A took 4.950523376464844 ms to run.
Function load_lora_B took 4.950046539306641 ms to run.
Function load_lora_A took 9.310722351074219 ms to run.
Function load_lora_B took 9.26661491394043 ms to run.
Function load_lora_A took 4.922628402709961 ms to run.
Function load_lora_B took 4.929542541503906 ms to run.
cost realload: 44.573068618774414
Function load_adapters took 44.59786415100098 ms to run.
offload 0 adapters, 35 remains
Function offload_adapters took 0.013828277587890625 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 34 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5881786346435547 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 35 in total
Function load_lora_A took 4.932641983032227 ms to run.
Function load_lora_B took 4.878044128417969 ms to run.
cost realload: 10.214567184448242
Function load_adapters took 10.236978530883789 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 34 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.6101131439208984 ms to run.
offload 0 adapters, 34 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.017881393432617188
load 2 adapters, 36 in total
Function load_lora_A took 2.81524658203125 ms to run.
Function load_lora_B took 2.8078556060791016 ms to run.
Function load_lora_A took 9.358644485473633 ms to run.
Function load_lora_B took 9.253978729248047 ms to run.
cost realload: 24.707555770874023
Function load_adapters took 24.728775024414062 ms to run.
offload 0 adapters, 36 remains
Function offload_adapters took 0.014066696166992188 ms to run.
offload 0 adapters, 36 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.01239776611328125
load 1 adapters, 37 in total
Function load_lora_A took 4.935741424560547 ms to run.
Function load_lora_B took 4.964351654052734 ms to run.
cost realload: 10.298490524291992
Function load_adapters took 10.320186614990234 ms to run.
cost offload scan: 0.091552734375
offload 1 adapters, 36 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5941390991210938 ms to run.
current batch size: 37 token used ratio: 0.2188
cost offload scan: 0.09417533874511719
offload 1 adapters, 35 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5857944488525391 ms to run.
cost load scan: 0.008821487426757812
load 2 adapters, 37 in total
Function load_lora_A took 4.985332489013672 ms to run.
Function load_lora_B took 4.9285888671875 ms to run.
Function load_lora_A took 9.232759475708008 ms to run.
Function load_lora_B took 9.217262268066406 ms to run.
cost realload: 28.829097747802734
Function load_adapters took 28.850317001342773 ms to run.
cost offload scan: 0.09417533874511719
offload 1 adapters, 36 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5958080291748047 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 36 in total
cost realload: 0.2846717834472656
Function load_adapters took 0.3135204315185547 ms to run.
cost offload scan: 0.10156631469726562
offload 1 adapters, 35 remains
cost offload cat: 0.03814697265625
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6268024444580078 ms to run.
offload 0 adapters, 35 remains
Function offload_adapters took 0.013828277587890625 ms to run.
cost load scan: 0.010251998901367188
load 2 adapters, 37 in total
Function load_lora_A took 2.8069019317626953 ms to run.
Function load_lora_B took 2.781391143798828 ms to run.
Function load_lora_A took 9.269237518310547 ms to run.
Function load_lora_B took 9.257793426513672 ms to run.
cost realload: 24.603605270385742
Function load_adapters took 24.62601661682129 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 38 in total
Function load_lora_A took 9.283781051635742 ms to run.
Function load_lora_B took 9.246826171875 ms to run.
cost realload: 18.940210342407227
Function load_adapters took 18.964052200317383 ms to run.
cost offload scan: 0.09655952453613281
offload 1 adapters, 37 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5922317504882812 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 36 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5919933319091797 ms to run.
current batch size: 38 token used ratio: 0.22555384615384616
cost load scan: 0.00858306884765625
load 0 adapters, 36 in total
cost realload: 0.28634071350097656
INFO:     127.0.0.1:53480 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53488 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53502 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43806 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43814 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43824 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43838 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43840 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43846 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43848 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43856 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43864 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43870 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43872 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43876 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43878 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43882 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43892 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43904 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43908 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_adapters took 0.31065940856933594 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 35 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5972385406494141 ms to run.
cost offload scan: 0.13065338134765625
offload 2 adapters, 33 remains
cost offload cat: 0.024557113647460938
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.6279945373535156 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 33 in total
cost realload: 0.2849102020263672
Function load_adapters took 0.30875205993652344 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 34 in total
Function load_lora_A took 4.980564117431641 ms to run.
Function load_lora_B took 4.937648773193359 ms to run.
cost realload: 10.31947135925293
Function load_adapters took 10.340690612792969 ms to run.
cost offload scan: 0.09465217590332031
offload 1 adapters, 33 remains
cost offload cat: 0.03504753112792969
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.6177425384521484 ms to run.
cost offload scan: 0.09822845458984375
offload 1 adapters, 32 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.6122589111328125 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 33 in total
Function load_lora_A took 2.8235912322998047 ms to run.
Function load_lora_B took 2.8133392333984375 ms to run.
cost realload: 6.040811538696289
Function load_adapters took 6.06226921081543 ms to run.
cost offload scan: 0.09489059448242188
offload 1 adapters, 32 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11801719665527344
Function offload_adapters took 0.6167888641357422 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 31 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.6101131439208984 ms to run.
cost offload scan: 0.09393692016601562
offload 1 adapters, 30 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.6043910980224609 ms to run.
current batch size: 34 token used ratio: 0.20587692307692307
offload 0 adapters, 30 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 29 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.58746337890625 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 29 in total
cost realload: 0.2930164337158203
Function load_adapters took 0.31685829162597656 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 28 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.6000995635986328 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 27 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5948543548583984 ms to run.
offload 0 adapters, 27 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.014543533325195312
load 1 adapters, 28 in total
Function load_lora_A took 2.788066864013672 ms to run.
Function load_lora_B took 2.7894973754882812 ms to run.
cost realload: 5.976676940917969
Function load_adapters took 5.997657775878906 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 27 remains
cost offload cat: 0.03719329833984375
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5960464477539062 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 26 remains
cost offload cat: 0.03695487976074219
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5965232849121094 ms to run.
Avg tokens(prompt+generate) throughput: 1631.130 tokens/s
Avg prompt tokens throughput:            831.382 tokens/s
Avg generate tokens throughput:          799.748 tokens/s
cost load scan: 0.009775161743164062
load 2 adapters, 28 in total
Function load_lora_A took 4.982948303222656 ms to run.
Function load_lora_B took 4.935026168823242 ms to run.
Function load_lora_A took 9.270429611206055 ms to run.
Function load_lora_B took 9.251594543457031 ms to run.
cost realload: 28.917312622070312
Function load_adapters took 28.939247131347656 ms to run.
offload 0 adapters, 28 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 27 remains
cost offload cat: 0.036716461181640625
cost offload free mem manager: 0.04863739013671875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.6074905395507812 ms to run.
cost load scan: 0.009059906005859375
load 2 adapters, 29 in total
Function load_lora_A took 4.973411560058594 ms to run.
Function load_lora_B took 4.935026168823242 ms to run.
Function load_lora_A took 9.304523468017578 ms to run.
Function load_lora_B took 9.289741516113281 ms to run.
cost realload: 28.968095779418945
Function load_adapters took 28.989315032958984 ms to run.
cost offload scan: 0.09369850158691406
offload 1 adapters, 28 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.05340576171875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.6108283996582031 ms to run.
current batch size: 31 token used ratio: 0.18067692307692307
cost load scan: 0.0133514404296875
load 1 adapters, 29 in total
Function load_lora_A took 9.34290885925293 ms to run.
Function load_lora_B took 9.237527847290039 ms to run.
cost realload: 18.990755081176758
Function load_adapters took 19.012451171875 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 28 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5967617034912109 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 28 in total
cost realload: 0.28228759765625
Function load_adapters took 0.3066062927246094 ms to run.
offload 0 adapters, 28 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.01239776611328125
load 2 adapters, 30 in total
Function load_lora_A took 9.325027465820312 ms to run.
Function load_lora_B took 9.270429611206055 ms to run.
Function load_lora_A took 9.30476188659668 ms to run.
Function load_lora_B took 9.248971939086914 ms to run.
cost realload: 37.63246536254883
Function load_adapters took 37.65583038330078 ms to run.
cost offload scan: 0.09584426879882812
offload 1 adapters, 29 remains
cost offload cat: INFO:     127.0.0.1:43910 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43924 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43932 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43948 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43950 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43956 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43964 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43966 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43968 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43974 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43978 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43980 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43986 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43998 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44012 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44016 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44030 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44034 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44046 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44056 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44072 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44078 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44088 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44094 - "POST /generate_stream HTTP/1.1" 200 OK
0.030755996704101562
cost offload free mem manager: 0.05245208740234375
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11539459228515625
Function offload_adapters took 0.6515979766845703 ms to run.
cost load scan: 0.018358230590820312
load 5 adapters, 34 in total
Function load_lora_A took 2.8314590454101562 ms to run.
Function load_lora_B took 2.777576446533203 ms to run.
Function load_lora_A took 2.8162002563476562 ms to run.
Function load_lora_B took 2.76947021484375 ms to run.
Function load_lora_A took 4.904747009277344 ms to run.
Function load_lora_B took 4.913330078125 ms to run.
Function load_lora_A took 2.7801990509033203 ms to run.
Function load_lora_B took 2.7933120727539062 ms to run.
Function load_lora_A took 2.76947021484375 ms to run.
Function load_lora_B took 2.7666091918945312 ms to run.
cost realload: 32.824039459228516
Function load_adapters took 32.845258712768555 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 33 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.6091594696044922 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 32 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.6101131439208984 ms to run.
cost load scan: 0.013113021850585938
load 2 adapters, 34 in total
Function load_lora_A took 9.337902069091797 ms to run.
Function load_lora_B took 9.293794631958008 ms to run.
Function load_lora_A took 2.86102294921875 ms to run.
Function load_lora_B took 2.8116703033447266 ms to run.
cost realload: 24.796009063720703
Function load_adapters took 24.81842041015625 ms to run.
cost offload scan: 0.09369850158691406
offload 1 adapters, 33 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5943775177001953 ms to run.
current batch size: 40 token used ratio: 0.2238
cost offload scan: 0.0934600830078125
offload 1 adapters, 32 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.6105899810791016 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 31 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.6091594696044922 ms to run.
offload 0 adapters, 31 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 31 in total
cost realload: 0.293731689453125
Function load_adapters took 0.3170967102050781 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 32 in total
Function load_lora_A took 9.302139282226562 ms to run.
Function load_lora_B took 9.273529052734375 ms to run.
cost realload: 18.990516662597656
Function load_adapters took 19.011497497558594 ms to run.
cost offload scan: 0.09775161743164062
offload 1 adapters, 31 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11563301086425781
Function offload_adapters took 0.6186962127685547 ms to run.
offload 0 adapters, 31 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.015735626220703125
load 4 adapters, 35 in total
Function load_lora_A took 9.308815002441406 ms to run.
Function load_lora_B took 9.293556213378906 ms to run.
Function load_lora_A took 9.24372673034668 ms to run.
Function load_lora_B took 9.218454360961914 ms to run.
Function load_lora_A took 2.7513504028320312 ms to run.
Function load_lora_B took 2.753734588623047 ms to run.
Function load_lora_A took 4.985809326171875 ms to run.
Function load_lora_B took 4.950046539306641 ms to run.
cost realload: 53.12395095825195
Function load_adapters took 53.1461238861084 ms to run.
cost offload scan: 0.10037422180175781
offload 1 adapters, 34 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.6012916564941406 ms to run.
cost load scan: 0.0152587890625
load 4 adapters, 38 in total
Function load_lora_A took 2.8200149536132812 ms to run.
Function load_lora_B took 2.8133392333984375 ms to run.
Function load_lora_A took 4.979848861694336 ms to run.
Function load_lora_B took 4.901647567749023 ms to run.
Function load_lora_A took 9.286165237426758 ms to run.
Function load_lora_B took 9.294986724853516 ms to run.
Function load_lora_A took 9.2926025390625 ms to run.
Function load_lora_B took 9.247064590454102 ms to run.
cost realload: 53.28702926635742
Function load_adapters took 53.31015586853027 ms to run.
current batch size: 45 token used ratio: 0.2512
cost offload scan: 0.09918212890625
offload 1 adapters, 37 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.6158351898193359 ms to run.
cost load scan: 0.015020370483398438
load 3 adapters, 40 in total
Function load_lora_A took 4.950523376464844 ms to run.
Function load_lora_B took 4.866361618041992 ms to run.
Function load_lora_A took 4.944562911987305 ms to run.
Function load_lora_B took 4.897832870483398 ms to run.
Function load_lora_A took 9.293794631958008 ms to run.
Function load_lora_B took 9.276628494262695 ms to run.
cost realload: 38.7883186340332
Function load_adapters took 38.809776306152344 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 41 in total
Function load_lora_A took 4.949092864990234 ms to run.
Function load_lora_B took 4.905462265014648 ms to run.
cost realload: 10.268688201904297
Function load_adapters took 10.290384292602539 ms to run.
cost offload scan: 0.09632110595703125
offload 1 adapters, 40 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.6043910980224609 ms to run.
cost offload scan: 0.09846687316894531
offload 1 adapters, 39 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5960464477539062 ms to run.
cost offload scan: 0.09942054748535156
offload 1 adapters, 38 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.6093978881835938 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 39 in total
Function load_lora_A took 2.810239791870117 ms to run.
Function load_lora_B took 2.8204917907714844 ms to run.
cost realload: 6.020784378051758
Function load_adapters took 6.041288375854492 ms to run.
offload 0 adapters, 39 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.09989738464355469
offload 1 adapters, 38 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.621795654296875 ms to run.
cost load scan: 0.013589859008789062
load 2 adapters, 40 in total
INFO:     127.0.0.1:44106 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34746 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34748 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34756 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34764 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34776 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34786 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34800 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 2.8188228607177734 ms to run.
Function load_lora_B took 2.81524658203125 ms to run.
Function load_lora_A took 4.918575286865234 ms to run.
Function load_lora_B took 4.961490631103516 ms to run.
cost realload: 16.033649444580078
Function load_adapters took 16.056060791015625 ms to run.
cost offload scan: 0.09632110595703125
offload 1 adapters, 39 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5955696105957031 ms to run.
current batch size: 46 token used ratio: 0.2580923076923077
cost load scan: 0.00858306884765625
load 1 adapters, 40 in total
Function load_lora_A took 2.772808074951172 ms to run.
Function load_lora_B took 2.7933120727539062 ms to run.
cost realload: 5.970239639282227
Function load_adapters took 5.9909820556640625 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 41 in total
Function load_lora_A took 4.943609237670898 ms to run.
Function load_lora_B took 4.949808120727539 ms to run.
cost realload: 10.30111312866211
Function load_adapters took 10.323286056518555 ms to run.
cost offload scan: 0.09751319885253906
offload 1 adapters, 40 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.6127357482910156 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 39 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.591278076171875 ms to run.
offload 0 adapters, 39 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 40 in total
Function load_lora_A took 4.927873611450195 ms to run.
Function load_lora_B took 4.950761795043945 ms to run.
cost realload: 10.263442993164062
Function load_adapters took 10.285615921020508 ms to run.
offload 0 adapters, 40 remains
Function offload_adapters took 0.01239776611328125 ms to run.
offload 0 adapters, 40 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.013113021850585938
load 2 adapters, 42 in total
Function load_lora_A took 4.910469055175781 ms to run.
Function load_lora_B took 4.932880401611328 ms to run.
Function load_lora_A took 2.808809280395508 ms to run.
Function load_lora_B took 2.7718544006347656 ms to run.
cost realload: 15.899658203125
Function load_adapters took 15.921592712402344 ms to run.
cost offload scan: 0.09655952453613281
offload 1 adapters, 41 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5965232849121094 ms to run.
cost offload scan: 0.09679794311523438
offload 1 adapters, 40 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.6055831909179688 ms to run.
Avg tokens(prompt+generate) throughput: 1899.856 tokens/s
Avg prompt tokens throughput:           1105.830 tokens/s
Avg generate tokens throughput:          794.026 tokens/s
cost offload scan: 0.133514404296875
offload 2 adapters, 38 remains
cost offload cat: 0.024557113647460938
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.6361007690429688 ms to run.
cost offload scan: 0.09655952453613281
offload 1 adapters, 37 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5941390991210938 ms to run.
cost offload scan: 0.13494491577148438
offload 2 adapters, 35 remains
cost offload cat: 0.025033950805664062
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.6222724914550781 ms to run.
current batch size: 39 token used ratio: 0.21883076923076922
cost offload scan: 0.09226799011230469
offload 1 adapters, 34 remains
cost offload cat: 0.03790855407714844
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5967617034912109 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 35 in total
Function load_lora_A took 9.343862533569336 ms to run.
Function load_lora_B took 9.255170822143555 ms to run.
cost realload: 18.984079360961914
Function load_adapters took 19.00506019592285 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 34 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5948543548583984 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 33 remains
cost offload cat: 0.03743171691894531
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.5993843078613281 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 32 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.0514984130859375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.6077289581298828 ms to run.
cost offload scan: 0.09679794311523438
offload 1 adapters, 31 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.606536865234375 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 32 in total
Function load_lora_A took 9.304046630859375 ms to run.
Function load_lora_B took 9.274959564208984 ms to run.
cost realload: 18.96357536315918
Function load_adapters took 18.985748291015625 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 31 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.606536865234375 ms to run.
cost offload scan: 0.09608268737792969
offload 1 adapters, 30 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.5993843078613281 ms to run.
cost offload scan: 0.13256072998046875
offload 2 adapters, 28 remains
cost offload cat: 0.024318695068359375
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.6222724914550781 ms to run.
cost offload scan: 0.09417533874511719
offload 1 adapters, 27 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.5974769592285156 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 27 in total
cost realload: 0.2872943878173828
Function load_adapters took 0.31113624572753906 ms to run.
offload 0 adapters, 27 remains
INFO:     127.0.0.1:34806 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34812 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34814 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34822 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34836 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34842 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34848 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34860 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34868 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34870 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34882 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34898 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34908 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34920 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34924 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34940 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34944 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34946 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34960 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34964 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34978 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34984 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34986 - "POST /generate_stream HTTP/1.1" 200 OK
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.009775161743164062
load 3 adapters, 30 in total
Function load_lora_A took 2.8028488159179688 ms to run.
Function load_lora_B took 2.827167510986328 ms to run.
Function load_lora_A took 4.948854446411133 ms to run.
Function load_lora_B took 4.930973052978516 ms to run.
Function load_lora_A took 2.773761749267578 ms to run.
Function load_lora_B took 2.7561187744140625 ms to run.
cost realload: 21.578073501586914
Function load_adapters took 21.599531173706055 ms to run.
cost offload scan: 0.13399124145507812
offload 2 adapters, 28 remains
cost offload cat: 0.025272369384765625
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.6380081176757812 ms to run.
current batch size: 32 token used ratio: 0.1778
cost load scan: 0.013113021850585938
load 4 adapters, 32 in total
Function load_lora_A took 4.956245422363281 ms to run.
Function load_lora_B took 4.909515380859375 ms to run.
Function load_lora_A took 4.974126815795898 ms to run.
Function load_lora_B took 4.9114227294921875 ms to run.
Function load_lora_A took 9.284257888793945 ms to run.
Function load_lora_B took 9.248971939086914 ms to run.
Function load_lora_A took 4.914283752441406 ms to run.
Function load_lora_B took 4.912853240966797 ms to run.
cost realload: 48.72751235961914
Function load_adapters took 48.74897003173828 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 31 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.11038780212402344
Function offload_adapters took 0.5970001220703125 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 32 in total
Function load_lora_A took 9.284734725952148 ms to run.
Function load_lora_B took 9.251594543457031 ms to run.
cost realload: 18.92828941345215
Function load_adapters took 18.94974708557129 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 33 in total
Function load_lora_A took 9.282827377319336 ms to run.
Function load_lora_B took 9.253501892089844 ms to run.
cost realload: 18.94521713256836
Function load_adapters took 18.9666748046875 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 32 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5931854248046875 ms to run.
cost load scan: 0.0133514404296875
load 2 adapters, 34 in total
Function load_lora_A took 9.302616119384766 ms to run.
Function load_lora_B took 9.26065444946289 ms to run.
Function load_lora_A took 4.985332489013672 ms to run.
Function load_lora_B took 4.942893981933594 ms to run.
cost realload: 28.967857360839844
Function load_adapters took 28.989553451538086 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 33 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.5931854248046875 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 32 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5862712860107422 ms to run.
cost load scan: 0.015020370483398438
load 2 adapters, 34 in total
Function load_lora_A took 2.822399139404297 ms to run.
Function load_lora_B took 2.78472900390625 ms to run.
Function load_lora_A took 9.302616119384766 ms to run.
Function load_lora_B took 9.252786636352539 ms to run.
cost realload: 24.64127540588379
Function load_adapters took 24.66273307800293 ms to run.
current batch size: 39 token used ratio: 0.21215384615384617
cost offload scan: 0.1304149627685547
offload 2 adapters, 32 remains
cost offload cat: 0.0247955322265625
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.6272792816162109 ms to run.
offload 0 adapters, 32 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 31 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5888938903808594 ms to run.
cost load scan: 0.012874603271484375
load 3 adapters, 34 in total
Function load_lora_A took 9.306907653808594 ms to run.
Function load_lora_B took 9.235382080078125 ms to run.
Function load_lora_A took 9.287595748901367 ms to run.
Function load_lora_B took 9.227752685546875 ms to run.
Function load_lora_A took 2.7992725372314453 ms to run.
Function load_lora_B took 2.7818679809570312 ms to run.
cost realload: 43.18380355834961
Function load_adapters took 43.20549964904785 ms to run.
cost load scan: 0.010728836059570312
load 0 adapters, 34 in total
cost realload: 0.30493736267089844
Function load_adapters took 0.33020973205566406 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 33 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.028371810913085938
cost offload a_loc update: 0.11444091796875
Function offload_adapters took 0.6091594696044922 ms to run.
cost load scan: 0.015735626220703125
load 2 adapters, 35 in total
Function load_lora_A took 4.955768585205078 ms to run.
Function load_lora_B took 4.891157150268555 ms to run.
Function load_lora_A took 2.7992725372314453 ms to run.
Function load_lora_B took 2.777099609375 ms to run.
cost realload: 15.903949737548828
Function load_adapters took 15.926122665405273 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 34 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.5962848663330078 ms to run.
offload 0 adapters, 34 remains
Function offload_adapters took 0.01239776611328125 ms to run.
current batch size: 37 token used ratio: 0.20524615384615386
cost load scan: 0.009059906005859375
load 1 adapters, 35 in total
Function load_lora_A took 2.8045177459716797 ms to run.
Function load_lora_B took 2.8061866760253906 ms to run.
cost realload: 6.027698516845703
Function load_adapters took 6.052494049072266 ms to run.
cost offload scan: 0.09369850158691406
offload 1 adapters, 34 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.6029605865478516 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 33 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.5924701690673828 ms to run.
offload 0 adapters, 33 remains
Function offload_adapters took 0.0133514404296875 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 32 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.5841255187988281 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 33 in total
Function load_lora_A took 9.252786636352539 ms to run.
Function load_lora_B took 9.251832962036133 ms to run.
cost realload: 18.967866897583008
Function load_adapters took 18.98956298828125 ms to run.
INFO:     127.0.0.1:35000 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35002 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35014 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57536 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57546 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57556 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57572 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57582 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57594 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57608 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57618 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57632 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57646 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload scan: 0.09202957153320312
offload 1 adapters, 32 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.6222724914550781 ms to run.
cost offload scan: 0.09465217590332031
offload 1 adapters, 31 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5915164947509766 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 30 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5903244018554688 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 31 in total
Function load_lora_A took 2.797365188598633 ms to run.
Function load_lora_B took 2.8030872344970703 ms to run.
cost realload: 5.987405776977539
Function load_adapters took 6.007909774780273 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 30 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.05078315734863281
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.6003379821777344 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 30 in total
cost realload: 0.30231475830078125
Function load_adapters took 0.3261566162109375 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 29 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5946159362792969 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 28 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5941390991210938 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 29 in total
Function load_lora_A took 2.8297901153564453 ms to run.
Function load_lora_B took 2.8023719787597656 ms to run.
cost realload: 6.035089492797852
Function load_adapters took 6.056547164916992 ms to run.
current batch size: 33 token used ratio: 0.16964615384615384
cost offload scan: 0.08988380432128906
offload 1 adapters, 28 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11587142944335938
Function offload_adapters took 0.5972385406494141 ms to run.
cost offload scan: 0.09584426879882812
offload 1 adapters, 27 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.6115436553955078 ms to run.
cost load scan: 0.008821487426757812
load 2 adapters, 29 in total
Function load_lora_A took 4.956483840942383 ms to run.
Function load_lora_B took 4.927635192871094 ms to run.
Function load_lora_A took 4.946708679199219 ms to run.
Function load_lora_B took 4.9076080322265625 ms to run.
cost realload: 20.20716667175293
Function load_adapters took 20.227909088134766 ms to run.
offload 0 adapters, 29 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost offload scan: 0.09512901306152344
offload 1 adapters, 28 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5943775177001953 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 27 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5953311920166016 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 27 in total
cost realload: 0.2732276916503906
Function load_adapters took 0.2994537353515625 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 26 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.11444091796875
Function offload_adapters took 0.5962848663330078 ms to run.
Avg tokens(prompt+generate) throughput: 1547.801 tokens/s
Avg prompt tokens throughput:            758.166 tokens/s
Avg generate tokens throughput:          789.635 tokens/s
cost offload scan: 0.09441375732421875
offload 1 adapters, 25 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5948543548583984 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 24 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.6003379821777344 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 25 in total
Function load_lora_A took 2.804279327392578 ms to run.
Function load_lora_B took 2.8028488159179688 ms to run.
cost realload: 5.996227264404297
Function load_adapters took 6.017208099365234 ms to run.
current batch size: 29 token used ratio: 0.1484769230769231
cost offload scan: 0.08940696716308594
offload 1 adapters, 24 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5772113800048828 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 25 in total
Function load_lora_A took 9.298563003540039 ms to run.
Function load_lora_B took 9.234905242919922 ms to run.
cost realload: 18.934965133666992
Function load_adapters took 18.956899642944336 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 24 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.5917549133300781 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 23 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5879402160644531 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 22 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5879402160644531 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 23 in total
Function load_lora_A took 4.971504211425781 ms to run.
Function load_lora_B took 4.920482635498047 ms to run.
cost realload: 10.273218154907227
Function load_adapters took 10.294675827026367 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 22 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5974769592285156 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 21 remains
cost offload cat: 0.030994415283203125
INFO:     127.0.0.1:57652 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57658 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57664 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57672 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57684 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57688 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57692 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57698 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57708 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57714 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57726 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57730 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57734 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57736 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57752 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57764 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57768 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57778 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57790 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57796 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57810 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57814 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57828 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57830 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57832 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57848 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57858 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57874 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57884 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57888 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.6098747253417969 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 21 in total
cost realload: 0.2834796905517578
Function load_adapters took 0.3075599670410156 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 20 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5943775177001953 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost load scan: 0.014066696166992188
load 2 adapters, 22 in total
Function load_lora_A took 4.943132400512695 ms to run.
Function load_lora_B took 4.958629608154297 ms to run.
Function load_lora_A took 9.26065444946289 ms to run.
Function load_lora_B took 9.258270263671875 ms to run.
cost realload: 28.89418601989746
Function load_adapters took 28.915882110595703 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 21 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5977153778076172 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.011682510375976562 ms to run.
cost offload scan: 0.091552734375
offload 1 adapters, 20 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5881786346435547 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.012159347534179688 ms to run.
current batch size: 23 token used ratio: 0.11755384615384615
cost load scan: 0.009059906005859375
load 2 adapters, 22 in total
Function load_lora_A took 9.263038635253906 ms to run.
Function load_lora_B took 9.26971435546875 ms to run.
Function load_lora_A took 4.922628402709961 ms to run.
Function load_lora_B took 4.906415939331055 ms to run.
cost realload: 28.832674026489258
Function load_adapters took 28.853416442871094 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 21 remains
cost offload cat: 0.02956390380859375
cost offload free mem manager: 0.04935264587402344
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5943775177001953 ms to run.
cost load scan: 0.015020370483398438
load 2 adapters, 23 in total
Function load_lora_A took 4.982948303222656 ms to run.
Function load_lora_B took 4.940271377563477 ms to run.
Function load_lora_A took 2.772808074951172 ms to run.
Function load_lora_B took 2.7599334716796875 ms to run.
cost realload: 15.941619873046875
Function load_adapters took 15.964031219482422 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 22 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.579833984375 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.012874603271484375
load 2 adapters, 24 in total
Function load_lora_A took 9.306907653808594 ms to run.
Function load_lora_B took 9.26661491394043 ms to run.
Function load_lora_A took 9.252548217773438 ms to run.
Function load_lora_B took 9.238719940185547 ms to run.
cost realload: 37.540435791015625
Function load_adapters took 37.56308555603027 ms to run.
offload 0 adapters, 24 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.013113021850585938
load 2 adapters, 26 in total
Function load_lora_A took 4.994869232177734 ms to run.
Function load_lora_B took 4.884243011474609 ms to run.
Function load_lora_A took 4.969596862792969 ms to run.
Function load_lora_B took 4.89497184753418 ms to run.
cost realload: 20.212650299072266
Function load_adapters took 20.23625373840332 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 25 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.5948543548583984 ms to run.
cost load scan: 0.0152587890625
load 2 adapters, 27 in total
Function load_lora_A took 2.818584442138672 ms to run.
Function load_lora_B took 2.7909278869628906 ms to run.
Function load_lora_A took 9.264707565307617 ms to run.
Function load_lora_B took 9.258747100830078 ms to run.
cost realload: 24.614810943603516
Function load_adapters took 24.636030197143555 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 26 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.0514984130859375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.6010532379150391 ms to run.
current batch size: 29 token used ratio: 0.14798461538461538
cost load scan: 0.012874603271484375
load 2 adapters, 28 in total
Function load_lora_A took 2.8123855590820312 ms to run.
Function load_lora_B took 2.7854442596435547 ms to run.
Function load_lora_A took 2.79998779296875 ms to run.
Function load_lora_B took 2.7964115142822266 ms to run.
cost realload: 11.665105819702148
Function load_adapters took 11.686086654663086 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 27 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.5979537963867188 ms to run.
cost offload scan: 0.1289844512939453
offload 2 adapters, 25 remains
cost offload cat: 0.0247955322265625
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.6210803985595703 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 26 in total
Function load_lora_A took 2.8171539306640625 ms to run.
Function load_lora_B took 2.805948257446289 ms to run.
cost realload: 6.015300750732422
Function load_adapters took 6.036996841430664 ms to run.
cost load scan: 0.01049041748046875
load 3 adapters, 29 in total
Function load_lora_A took 9.285926818847656 ms to run.
Function load_lora_B took 9.250402450561523 ms to run.
Function load_lora_A took 4.970073699951172 ms to run.
Function load_lora_B took 4.921436309814453 ms to run.
Function load_lora_A took 9.29403305053711 ms to run.
Function load_lora_B took 9.25755500793457 ms to run.
cost realload: 47.55449295043945
Function load_adapters took 47.5771427154541 ms to run.
offload 0 adapters, 29 remains
Function offload_adapters took 0.0171661376953125 ms to run.
cost load scan: 0.016689300537109375
load 3 adapters, 32 in total
Function load_lora_A took 4.9724578857421875 ms to run.
Function load_lora_B took 4.941225051879883 ms to run.
Function load_lora_A took 2.795696258544922 ms to run.
Function load_lora_B took 2.7992725372314453 ms to run.
Function load_lora_A took 9.235620498657227 ms to run.
Function load_lora_B took 9.23609733581543 ms to run.
cost realload: 34.54136848449707
Function load_adapters took 34.56377983093262 ms to run.
offload 0 adapters, 32 remains
Function offload_adapters took 0.01621246337890625 ms to run.
cost offload scan: 0.095367431640625
offload 1 adapters, 31 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.05245208740234375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.12540817260742188
Function offload_adapters took 0.6344318389892578 ms to run.
current batch size: 34 token used ratio: 0.17753846153846153
INFO:     127.0.0.1:57898 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57900 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57906 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57916 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50378 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50392 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50400 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50406 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50414 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50426 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50428 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50436 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50452 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50464 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50470 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50480 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50484 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50492 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50508 - "POST /generate_stream HTTP/1.1" 200 OK
cost load scan: 0.01621246337890625
load 4 adapters, 35 in total
Function load_lora_A took 4.935503005981445 ms to run.
Function load_lora_B took 4.955530166625977 ms to run.
Function load_lora_A took 9.294509887695312 ms to run.
Function load_lora_B took 9.26518440246582 ms to run.
Function load_lora_A took 2.7887821197509766 ms to run.
Function load_lora_B took 2.8204917907714844 ms to run.
Function load_lora_A took 2.817869186401367 ms to run.
Function load_lora_B took 2.8171539306640625 ms to run.
cost realload: 40.354251861572266
Function load_adapters took 40.37761688232422 ms to run.
cost load scan: 0.016689300537109375
load 2 adapters, 37 in total
Function load_lora_A took 9.333372116088867 ms to run.
Function load_lora_B took 9.238958358764648 ms to run.
Function load_lora_A took 4.963159561157227 ms to run.
Function load_lora_B took 4.942893981933594 ms to run.
cost realload: 28.965234756469727
Function load_adapters took 28.986215591430664 ms to run.
offload 0 adapters, 37 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 36 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.5998611450195312 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 37 in total
Function load_lora_A took 2.841949462890625 ms to run.
Function load_lora_B took 2.7964115142822266 ms to run.
cost realload: 6.046056747436523
Function load_adapters took 6.0672760009765625 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 36 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5843639373779297 ms to run.
cost load scan: 0.013589859008789062
load 1 adapters, 37 in total
Function load_lora_A took 9.325265884399414 ms to run.
Function load_lora_B took 9.249448776245117 ms to run.
cost realload: 18.985509872436523
Function load_adapters took 19.009828567504883 ms to run.
cost load scan: 0.013828277587890625
load 1 adapters, 38 in total
Function load_lora_A took 4.929065704345703 ms to run.
Function load_lora_B took 4.873037338256836 ms to run.
cost realload: 10.201692581176758
Function load_adapters took 10.224342346191406 ms to run.
cost offload scan: 0.09703636169433594
offload 1 adapters, 37 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.6031990051269531 ms to run.
current batch size: 40 token used ratio: 0.22244615384615385
cost load scan: 0.010728836059570312
load 1 adapters, 38 in total
Function load_lora_A took 2.842426300048828 ms to run.
Function load_lora_B took 2.7768611907958984 ms to run.
cost realload: 6.023168563842773
Function load_adapters took 6.044626235961914 ms to run.
cost offload scan: 0.09894371032714844
offload 1 adapters, 37 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.6022453308105469 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 38 in total
Function load_lora_A took 9.286880493164062 ms to run.
Function load_lora_B took 9.26828384399414 ms to run.
cost realload: 18.952608108520508
Function load_adapters took 18.978118896484375 ms to run.
Avg tokens(prompt+generate) throughput: 1842.902 tokens/s
Avg prompt tokens throughput:           1152.439 tokens/s
Avg generate tokens throughput:          690.464 tokens/s
cost offload scan: 0.10275840759277344
offload 1 adapters, 37 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.6031990051269531 ms to run.
cost load scan: 0.015020370483398438
load 4 adapters, 41 in total
Function load_lora_A took 4.988431930541992 ms to run.
Function load_lora_B took 4.964351654052734 ms to run.
Function load_lora_A took 4.954099655151367 ms to run.
Function load_lora_B took 4.900932312011719 ms to run.
Function load_lora_A took 2.8090476989746094 ms to run.
Function load_lora_B took 2.763986587524414 ms to run.
Function load_lora_A took 4.928827285766602 ms to run.
Function load_lora_B took 4.945278167724609 ms to run.
cost realload: 35.859107971191406
Function load_adapters took 35.87961196899414 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 40 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.5915164947509766 ms to run.
cost load scan: 0.011920928955078125
load 3 adapters, 43 in total
Function load_lora_A took 2.7840137481689453 ms to run.
Function load_lora_B took 2.7709007263183594 ms to run.
Function load_lora_A took 2.7799606323242188 ms to run.
Function load_lora_B took 2.764463424682617 ms to run.
Function load_lora_A took 9.254693984985352 ms to run.
Function load_lora_B took 9.192705154418945 ms to run.
cost realload: 30.09653091430664
Function load_adapters took 30.118942260742188 ms to run.
cost offload scan: 0.09489059448242188
offload 1 adapters, 42 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5898475646972656 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 41 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5958080291748047 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 42 in total
Function load_lora_A took 9.294748306274414 ms to run.
Function load_lora_B took 9.252071380615234 ms to run.
cost realload: 18.961429595947266
Function load_adapters took 18.982887268066406 ms to run.
current batch size: 45 token used ratio: 0.2553076923076923
cost offload scan: 0.09393692016601562
offload 1 adapters, 41 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5869865417480469 ms to run.
cost load scan: 0.01239776611328125
load 1 adapters, 42 in total
Function load_lora_A took 4.951238632202148 ms to run.
Function load_lora_B took 4.951715469360352 ms to run.
cost realload: 10.300874710083008
Function load_adapters took 10.322093963623047 ms to run.
cost offload scan: 0.10037422180175781
offload 1 adapters, 41 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.6041526794433594 ms to run.
cost offload scan: 0.09608268737792969
offload 1 adapters, 40 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5941390991210938 ms to run.
cost offload scan: 0.09560585021972656
offload 1 adapters, 39 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.598907470703125 ms to run.
cost offload scan: 0.09584426879882812
offload 1 adapters, 38 remains
cost offload cat: 0.030755996704101562
INFO:     127.0.0.1:50524 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50534 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50546 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50552 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50556 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50570 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50576 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50588 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50596 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50606 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50612 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50622 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50626 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50640 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50646 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50656 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50672 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50682 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50684 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50698 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50710 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50722 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50732 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50742 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.6213188171386719 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 39 in total
Function load_lora_A took 2.8417110443115234 ms to run.
Function load_lora_B took 2.8023719787597656 ms to run.
cost realload: 6.03795051574707
Function load_adapters took 6.059885025024414 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 38 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5958080291748047 ms to run.
cost load scan: 0.013589859008789062
load 2 adapters, 40 in total
Function load_lora_A took 4.920482635498047 ms to run.
Function load_lora_B took 4.945039749145508 ms to run.
Function load_lora_A took 4.953861236572266 ms to run.
Function load_lora_B took 4.908323287963867 ms to run.
cost realload: 20.21336555480957
Function load_adapters took 20.235300064086914 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 39 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.050067901611328125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.598907470703125 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 38 remains
cost offload cat: 0.03719329833984375
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5962848663330078 ms to run.
current batch size: 42 token used ratio: 0.24750769230769232
cost load scan: 0.014066696166992188
load 2 adapters, 40 in total
Function load_lora_A took 4.925012588500977 ms to run.
Function load_lora_B took 4.967212677001953 ms to run.
Function load_lora_A took 2.8073787689208984 ms to run.
Function load_lora_B took 2.804279327392578 ms to run.
cost realload: 15.980243682861328
Function load_adapters took 16.00193977355957 ms to run.
cost offload scan: 0.13113021850585938
offload 2 adapters, 38 remains
cost offload cat: 0.024318695068359375
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6268024444580078 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 37 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.6008148193359375 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 38 in total
Function load_lora_A took 4.956245422363281 ms to run.
Function load_lora_B took 4.918575286865234 ms to run.
cost realload: 10.283708572387695
Function load_adapters took 10.305404663085938 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 38 in total
cost realload: 0.28967857360839844
Function load_adapters took 0.3139972686767578 ms to run.
offload 0 adapters, 38 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost offload scan: 0.09560585021972656
offload 1 adapters, 37 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5905628204345703 ms to run.
cost offload scan: 0.09703636169433594
offload 1 adapters, 36 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5979537963867188 ms to run.
cost offload scan: 0.09846687316894531
offload 1 adapters, 35 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04744529724121094
cost offload torch.empty: 0.024318695068359375
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.6155967712402344 ms to run.
offload 0 adapters, 35 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.015020370483398438
load 4 adapters, 39 in total
Function load_lora_A took 2.793550491333008 ms to run.
Function load_lora_B took 2.7980804443359375 ms to run.
Function load_lora_A took 4.91642951965332 ms to run.
Function load_lora_B took 4.95600700378418 ms to run.
Function load_lora_A took 9.291648864746094 ms to run.
Function load_lora_B took 9.289741516113281 ms to run.
Function load_lora_A took 9.285211563110352 ms to run.
Function load_lora_B took 9.236812591552734 ms to run.
cost realload: 53.18450927734375
Function load_adapters took 53.20620536804199 ms to run.
cost offload scan: 0.09393692016601562
offload 1 adapters, 38 remains
cost offload cat: 0.03600120544433594
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.6103515625 ms to run.
cost offload scan: 0.09655952453613281
offload 1 adapters, 37 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.6067752838134766 ms to run.
cost offload scan: 0.0972747802734375
offload 1 adapters, 36 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11444091796875
Function offload_adapters took 0.6046295166015625 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 35 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5896091461181641 ms to run.
cost load scan: 0.015020370483398438
load 2 adapters, 37 in total
Function load_lora_A took 2.812623977661133 ms to run.
Function load_lora_B took 2.7692317962646484 ms to run.
Function load_lora_A took 2.823352813720703 ms to run.
Function load_lora_B took 2.7761459350585938 ms to run.
cost realload: 11.65771484375
Function load_adapters took 11.678695678710938 ms to run.
current batch size: 46 token used ratio: 0.25164615384615385
cost offload scan: 0.09441375732421875
offload 1 adapters, 36 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5891323089599609 ms to run.
cost offload scan: 0.09679794311523438
offload 1 adapters, 35 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.5998611450195312 ms to run.
cost load scan: 0.015020370483398438
load 3 adapters, 38 in total
Function load_lora_A took 4.937648773193359 ms to run.
Function load_lora_B took 4.951000213623047 ms to run.
Function load_lora_A took 4.8980712890625 ms to run.
Function load_lora_B took 4.87065315246582 ms to run.
Function load_lora_A took 4.943609237670898 ms to run.
Function load_lora_B took 4.93621826171875 ms to run.
cost realload: 30.096054077148438
Function load_adapters took 30.117034912109375 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 37 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5915164947509766 ms to run.
cost load scan: 0.013113021850585938
load 2 adapters, 39 in total
INFO:     127.0.0.1:50758 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50774 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50790 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50796 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50810 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50820 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50824 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:50828 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44716 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44720 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44724 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44732 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44746 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44758 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44760 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44776 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44792 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44800 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44810 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44814 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44820 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44836 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44852 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44866 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44878 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 4.989862442016602 ms to run.
Function load_lora_B took 4.915475845336914 ms to run.
Function load_lora_A took 2.7692317962646484 ms to run.
Function load_lora_B took 2.7914047241210938 ms to run.
cost realload: 15.96975326538086
Function load_adapters took 15.991926193237305 ms to run.
offload 0 adapters, 39 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.013828277587890625
load 3 adapters, 42 in total
Function load_lora_A took 4.958152770996094 ms to run.
Function load_lora_B took 4.929304122924805 ms to run.
Function load_lora_A took 9.267568588256836 ms to run.
Function load_lora_B took 9.265899658203125 ms to run.
Function load_lora_A took 2.78472900390625 ms to run.
Function load_lora_B took 2.7573108673095703 ms to run.
cost realload: 34.51371192932129
Function load_adapters took 34.53636169433594 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 41 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5893707275390625 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 42 in total
Function load_lora_A took 9.300470352172852 ms to run.
Function load_lora_B took 9.23919677734375 ms to run.
cost realload: 18.935680389404297
Function load_adapters took 18.95761489868164 ms to run.
cost offload scan: 0.09441375732421875
offload 1 adapters, 41 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.6053447723388672 ms to run.
cost offload scan: 0.09822845458984375
offload 1 adapters, 40 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11706352233886719
Function offload_adapters took 0.6072521209716797 ms to run.
cost offload scan: 0.1404285430908203
offload 2 adapters, 38 remains
cost offload cat: 0.024557113647460938
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.6361007690429688 ms to run.
cost offload scan: 0.09632110595703125
offload 1 adapters, 37 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5891323089599609 ms to run.
current batch size: 46 token used ratio: 0.25487692307692306
cost load scan: 0.013589859008789062
load 2 adapters, 39 in total
Function load_lora_A took 9.272098541259766 ms to run.
Function load_lora_B took 9.257793426513672 ms to run.
Function load_lora_A took 9.28354263305664 ms to run.
Function load_lora_B took 9.243249893188477 ms to run.
cost realload: 37.522077560424805
Function load_adapters took 37.545204162597656 ms to run.
offload 0 adapters, 39 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.016450881958007812
load 3 adapters, 42 in total
Function load_lora_A took 9.317398071289062 ms to run.
Function load_lora_B took 9.250879287719727 ms to run.
Function load_lora_A took 4.950046539306641 ms to run.
Function load_lora_B took 4.918098449707031 ms to run.
Function load_lora_A took 4.938364028930664 ms to run.
Function load_lora_B took 4.946470260620117 ms to run.
cost realload: 38.87677192687988
Function load_adapters took 38.898468017578125 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 41 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.6017684936523438 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 40 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.6017684936523438 ms to run.
cost offload scan: 0.1342296600341797
offload 2 adapters, 38 remains
cost offload cat: 0.024557113647460938
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.6246566772460938 ms to run.
offload 0 adapters, 38 remains
Function offload_adapters took 0.01239776611328125 ms to run.
offload 0 adapters, 38 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 38 in total
cost realload: 0.2765655517578125
Function load_adapters took 0.3001689910888672 ms to run.
Avg tokens(prompt+generate) throughput: 2078.967 tokens/s
Avg prompt tokens throughput:           1239.262 tokens/s
Avg generate tokens throughput:          839.706 tokens/s
cost load scan: 0.013589859008789062
load 1 adapters, 39 in total
Function load_lora_A took 2.8455257415771484 ms to run.
Function load_lora_B took 2.773284912109375 ms to run.
cost realload: 6.032466888427734
Function load_adapters took 6.053924560546875 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 38 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5850791931152344 ms to run.
offload 0 adapters, 38 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost load scan: 0.014066696166992188
load 2 adapters, 40 in total
Function load_lora_A took 9.315729141235352 ms to run.
Function load_lora_B took 9.268999099731445 ms to run.
Function load_lora_A took 4.892110824584961 ms to run.
Function load_lora_B took 4.926919937133789 ms to run.
cost realload: 28.886795043945312
Function load_adapters took 28.908967971801758 ms to run.
current batch size: 50 token used ratio: 0.2774923076923077
cost offload scan: 0.09584426879882812
offload 1 adapters, 39 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.6091594696044922 ms to run.
cost load scan: 0.011444091796875
load 2 adapters, 41 in total
Function load_lora_A took 9.294986724853516 ms to run.
Function load_lora_B took 9.289741516113281 ms to run.
Function load_lora_A took 4.909753799438477 ms to run.
Function load_lora_B took 4.900217056274414 ms to run.
cost realload: 28.86795997619629
Function load_adapters took 28.88965606689453 ms to run.
offload 0 adapters, 41 remains
Function offload_adapters took 0.011682510375976562 ms to run.
cost offload scan: 0.09584426879882812
offload 1 adapters, 40 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5972385406494141 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 39 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5974769592285156 ms to run.
cost load scan: 0.008821487426757812
load 2 adapters, 41 in total
Function load_lora_A took 9.316205978393555 ms to run.
Function load_lora_B took 9.235143661499023 ms to run.
Function load_lora_A took 2.7823448181152344 ms to run.
Function load_lora_B took 2.7637481689453125 ms to run.
cost realload: 24.556636810302734
Function load_adapters took 24.57714080810547 ms to run.
offload 0 adapters, 41 remains
Function offload_adapters took 0.0133514404296875 ms to run.
INFO:     127.0.0.1:44880 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44882 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44884 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44894 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44898 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44906 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44914 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44928 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44936 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44942 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44952 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44966 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44970 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44984 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44988 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44998 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45008 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45018 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45020 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45030 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45046 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45050 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45066 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45074 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45080 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45096 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45112 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45122 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45126 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload scan: 0.1316070556640625
offload 2 adapters, 39 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.6537437438964844 ms to run.
cost offload scan: 0.10275840759277344
offload 1 adapters, 38 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5984306335449219 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 39 in total
Function load_lora_A took 9.304523468017578 ms to run.
Function load_lora_B took 9.28640365600586 ms to run.
cost realload: 18.992185592651367
Function load_adapters took 19.015073776245117 ms to run.
cost offload scan: 0.09560585021972656
offload 1 adapters, 38 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5924701690673828 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 37 remains
cost offload cat: 0.03600120544433594
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5922317504882812 ms to run.
cost load scan: 0.013113021850585938
load 2 adapters, 39 in total
Function load_lora_A took 4.94384765625 ms to run.
Function load_lora_B took 4.937410354614258 ms to run.
Function load_lora_A took 2.7887821197509766 ms to run.
Function load_lora_B took 2.7790069580078125 ms to run.
cost realload: 15.90585708618164
Function load_adapters took 15.929698944091797 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 38 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5981922149658203 ms to run.
cost offload scan: 0.09369850158691406
offload 1 adapters, 37 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5917549133300781 ms to run.
cost offload scan: 0.09512901306152344
offload 1 adapters, 36 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.029325485229492188
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5998611450195312 ms to run.
current batch size: 46 token used ratio: 0.2541230769230769
cost load scan: 0.008821487426757812
load 2 adapters, 38 in total
Function load_lora_A took 2.8619766235351562 ms to run.
Function load_lora_B took 2.8035640716552734 ms to run.
Function load_lora_A took 9.307622909545898 ms to run.
Function load_lora_B took 9.255409240722656 ms to run.
cost realload: 24.701595306396484
Function load_adapters took 24.724721908569336 ms to run.
offload 0 adapters, 38 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost offload scan: 0.09822845458984375
offload 1 adapters, 37 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5943775177001953 ms to run.
cost offload scan: 0.09512901306152344
offload 1 adapters, 36 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.6043910980224609 ms to run.
cost load scan: 0.019788742065429688
load 6 adapters, 42 in total
Function load_lora_A took 4.955530166625977 ms to run.
Function load_lora_B took 4.889726638793945 ms to run.
Function load_lora_A took 2.813577651977539 ms to run.
Function load_lora_B took 2.78472900390625 ms to run.
Function load_lora_A took 9.302139282226562 ms to run.
Function load_lora_B took 9.260177612304688 ms to run.
Function load_lora_A took 2.748250961303711 ms to run.
Function load_lora_B took 2.7801990509033203 ms to run.
Function load_lora_A took 4.93311882019043 ms to run.
Function load_lora_B took 4.9381256103515625 ms to run.
Function load_lora_A took 9.274482727050781 ms to run.
Function load_lora_B took 9.23609733581543 ms to run.
cost realload: 68.65954399108887
Function load_adapters took 68.6802864074707 ms to run.
cost offload scan: 0.09846687316894531
offload 1 adapters, 41 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5996227264404297 ms to run.
offload 0 adapters, 41 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 42 in total
Function load_lora_A took 9.249448776245117 ms to run.
Function load_lora_B took 9.270429611206055 ms to run.
cost realload: 18.929481506347656
Function load_adapters took 18.952608108520508 ms to run.
offload 0 adapters, 42 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.09584426879882812
offload 1 adapters, 41 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11610984802246094
Function offload_adapters took 0.6046295166015625 ms to run.
cost offload scan: 0.09965896606445312
offload 1 adapters, 40 remains
cost offload cat: 0.03552436828613281
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11754035949707031
Function offload_adapters took 0.6313323974609375 ms to run.
cost offload scan: 0.09632110595703125
offload 1 adapters, 39 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.6048679351806641 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 40 in total
Function load_lora_A took 2.8200149536132812 ms to run.
Function load_lora_B took 2.779722213745117 ms to run.
cost realload: 6.014347076416016
Function load_adapters took 6.036043167114258 ms to run.
current batch size: 53 token used ratio: 0.28695384615384617
offload 0 adapters, 40 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 41 in total
Function load_lora_A took 4.919290542602539 ms to run.
Function load_lora_B took 4.967212677001953 ms to run.
cost realload: 10.291576385498047
Function load_adapters took 10.313987731933594 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 40 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5934238433837891 ms to run.
cost offload scan: 0.09679794311523438
offload 1 adapters, 39 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5865097045898438 ms to run.
cost load scan: 0.009298324584960938
load 2 adapters, 41 in total
Function load_lora_A took 2.831697463989258 ms to run.
Function load_lora_B took 2.813100814819336 ms to run.
Function load_lora_A took 2.7861595153808594 ms to run.
Function load_lora_B took 2.8171539306640625 ms to run.
cost realload: 11.71875
Function load_adapters took 11.742353439331055 ms to run.
INFO:     127.0.0.1:45142 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45148 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40136 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40152 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40166 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40174 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40178 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40194 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40200 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40214 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40230 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40242 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40256 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40258 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40260 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40264 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40266 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40276 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload scan: 0.09298324584960938
offload 1 adapters, 40 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.6241798400878906 ms to run.
cost offload scan: 0.09703636169433594
offload 1 adapters, 39 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.6015300750732422 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 40 in total
Function load_lora_A took 2.831697463989258 ms to run.
Function load_lora_B took 2.8073787689208984 ms to run.
cost realload: 6.045103073120117
Function load_adapters took 6.066322326660156 ms to run.
offload 0 adapters, 40 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.10275840759277344
offload 1 adapters, 39 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11205673217773438
Function offload_adapters took 0.6055831909179688 ms to run.
cost offload scan: 0.09679794311523438
offload 1 adapters, 38 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6048679351806641 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 38 in total
cost realload: 0.2849102020263672
Function load_adapters took 0.3082752227783203 ms to run.
offload 0 adapters, 38 remains
Function offload_adapters took 0.013589859008789062 ms to run.
current batch size: 54 token used ratio: 0.30412307692307694
cost load scan: 0.009298324584960938
load 2 adapters, 40 in total
Function load_lora_A took 9.297847747802734 ms to run.
Function load_lora_B took 9.246110916137695 ms to run.
Function load_lora_A took 2.8247833251953125 ms to run.
Function load_lora_B took 2.775907516479492 ms to run.
cost realload: 24.611473083496094
Function load_adapters took 24.633407592773438 ms to run.
cost offload scan: 0.09560585021972656
offload 1 adapters, 39 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5936622619628906 ms to run.
cost offload scan: 0.09393692016601562
offload 1 adapters, 38 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.5927085876464844 ms to run.
cost load scan: 0.012874603271484375
load 2 adapters, 40 in total
Function load_lora_A took 2.804279327392578 ms to run.
Function load_lora_B took 2.7861595153808594 ms to run.
Function load_lora_A took 4.944562911987305 ms to run.
Function load_lora_B took 4.939794540405273 ms to run.
cost realload: 15.951156616210938
Function load_adapters took 15.973091125488281 ms to run.
cost offload scan: 0.09512901306152344
offload 1 adapters, 39 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5972385406494141 ms to run.
offload 0 adapters, 39 remains
Function offload_adapters took 0.012159347534179688 ms to run.
offload 0 adapters, 39 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 39 in total
cost realload: 0.2956390380859375
Function load_adapters took 0.32210350036621094 ms to run.
Avg tokens(prompt+generate) throughput: 2119.664 tokens/s
Avg prompt tokens throughput:           1183.947 tokens/s
Avg generate tokens throughput:          935.717 tokens/s
cost offload scan: 0.095367431640625
offload 1 adapters, 38 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6020069122314453 ms to run.
cost offload scan: 0.1361370086669922
offload 2 adapters, 36 remains
cost offload cat: 0.0247955322265625
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.6303787231445312 ms to run.
cost load scan: 0.012874603271484375
load 2 adapters, 38 in total
Function load_lora_A took 4.967451095581055 ms to run.
Function load_lora_B took 4.890203475952148 ms to run.
Function load_lora_A took 9.28354263305664 ms to run.
Function load_lora_B took 9.294509887695312 ms to run.
cost realload: 28.907060623168945
Function load_adapters took 28.928518295288086 ms to run.
offload 0 adapters, 38 remains
Function offload_adapters took 0.018596649169921875 ms to run.
cost offload scan: 0.13256072998046875
offload 2 adapters, 36 remains
cost offload cat: 0.024080276489257812
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.12278556823730469
Function offload_adapters took 0.6377696990966797 ms to run.
cost offload scan: 0.09417533874511719
offload 1 adapters, 35 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.5867481231689453 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 34 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11539459228515625
Function offload_adapters took 0.5950927734375 ms to run.
offload 0 adapters, 34 remains
Function offload_adapters took 0.012636184692382812 ms to run.
offload 0 adapters, 34 remains
Function offload_adapters took 0.016450881958007812 ms to run.
current batch size: 45 token used ratio: 0.2556923076923077
cost load scan: 0.008344650268554688
load 0 adapters, 34 in total
cost realload: 0.30612945556640625
Function load_adapters took 0.3325939178466797 ms to run.
offload 0 adapters, 34 remains
Function offload_adapters took 0.011682510375976562 ms to run.
cost load scan: 0.013828277587890625
load 3 adapters, 37 in total
Function load_lora_A took 9.337186813354492 ms to run.
Function load_lora_B took 9.249448776245117 ms to run.
Function load_lora_A took 4.921913146972656 ms to run.
Function load_lora_B took 4.910945892333984 ms to run.
Function load_lora_A took 2.8226375579833984 ms to run.
Function load_lora_B took 2.7916431427001953 ms to run.
cost realload: 34.59453582763672
Function load_adapters took 34.61647033691406 ms to run.
cost offload scan: 0.09489059448242188
offload 1 adapters, 36 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5958080291748047 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 36 in total
cost realload: 0.29087066650390625
Function load_adapters took 0.3147125244140625 ms to run.
cost offload scan: 0.09489059448242188
offload 1 adapters, 35 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.6020069122314453 ms to run.
cost load scan: 0.013589859008789062
load 1 adapters, 36 in total
Function load_lora_A took 4.929542541503906 ms to run.
Function load_lora_B took 4.914283752441406 ms to run.
cost realload: 10.257959365844727
INFO:     127.0.0.1:40286 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40294 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40308 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40322 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40334 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40346 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40360 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40368 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40374 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40384 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40396 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40402 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_adapters took 10.279655456542969 ms to run.
cost offload scan: 0.10013580322265625
offload 1 adapters, 35 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5970001220703125 ms to run.
cost offload scan: 0.09751319885253906
offload 1 adapters, 34 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11444091796875
Function offload_adapters took 0.6048679351806641 ms to run.
cost offload scan: 0.09679794311523438
offload 1 adapters, 33 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.6096363067626953 ms to run.
cost load scan: 0.0152587890625
load 3 adapters, 36 in total
Function load_lora_A took 2.8617382049560547 ms to run.
Function load_lora_B took 2.788543701171875 ms to run.
Function load_lora_A took 2.7952194213867188 ms to run.
Function load_lora_B took 2.8243064880371094 ms to run.
Function load_lora_A took 2.767801284790039 ms to run.
Function load_lora_B took 2.7849674224853516 ms to run.
cost realload: 17.371416091918945
Function load_adapters took 17.393827438354492 ms to run.
cost offload scan: 0.09632110595703125
offload 1 adapters, 35 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.0286102294921875
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.6093978881835938 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 34 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5965232849121094 ms to run.
current batch size: 45 token used ratio: 0.2573076923076923
offload 0 adapters, 34 remains
Function offload_adapters took 0.012636184692382812 ms to run.
offload 0 adapters, 34 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 35 in total
Function load_lora_A took 4.950523376464844 ms to run.
Function load_lora_B took 4.883527755737305 ms to run.
cost realload: 10.226726531982422
Function load_adapters took 10.250568389892578 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 34 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5915164947509766 ms to run.
cost offload scan: 0.09489059448242188
offload 1 adapters, 33 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5903244018554688 ms to run.
cost offload scan: 0.09489059448242188
offload 1 adapters, 32 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5917549133300781 ms to run.
offload 0 adapters, 32 remains
Function offload_adapters took 0.011682510375976562 ms to run.
cost load scan: 0.009775161743164062
load 1 adapters, 33 in total
Function load_lora_A took 4.956960678100586 ms to run.
Function load_lora_B took 4.984140396118164 ms to run.
cost realload: 10.331392288208008
Function load_adapters took 10.353803634643555 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 32 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.12063980102539062
Function offload_adapters took 0.5984306335449219 ms to run.
offload 0 adapters, 32 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.00858306884765625
load 0 adapters, 32 in total
cost realload: 0.28777122497558594
Function load_adapters took 0.3120899200439453 ms to run.
offload 0 adapters, 32 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 31 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.583648681640625 ms to run.
cost load scan: 0.01239776611328125
load 1 adapters, 32 in total
Function load_lora_A took 2.8047561645507812 ms to run.
Function load_lora_B took 2.8100013732910156 ms to run.
cost realload: 6.012201309204102
Function load_adapters took 6.034612655639648 ms to run.
offload 0 adapters, 32 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 31 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5939006805419922 ms to run.
current batch size: 36 token used ratio: 0.20476923076923076
cost offload scan: 0.08893013000488281
offload 1 adapters, 30 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.5896091461181641 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 31 in total
Function load_lora_A took 4.98509407043457 ms to run.
Function load_lora_B took 4.922151565551758 ms to run.
cost realload: 10.313034057617188
Function load_adapters took 10.33473014831543 ms to run.
offload 0 adapters, 31 remains
Function offload_adapters took 0.01430511474609375 ms to run.
cost load scan: 0.011205673217773438
load 2 adapters, 33 in total
Function load_lora_A took 4.968404769897461 ms to run.
Function load_lora_B took 4.949331283569336 ms to run.
Function load_lora_A took 4.954338073730469 ms to run.
Function load_lora_B took 4.966259002685547 ms to run.
cost realload: 20.3399658203125
Function load_adapters took 20.36285400390625 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 32 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11181831359863281
Function offload_adapters took 0.6020069122314453 ms to run.
offload 0 adapters, 32 remains
Function offload_adapters took 0.01239776611328125 ms to run.
offload 0 adapters, 32 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.00858306884765625
load 0 adapters, 32 in total
cost realload: 0.28514862060546875
Function load_adapters took 0.30922889709472656 ms to run.
cost offload scan: 0.09393692016601562
offload 1 adapters, 31 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1163482666015625
Function offload_adapters took 0.6012916564941406 ms to run.
cost offload scan: 0.09489059448242188
offload 1 adapters, 30 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5884170532226562 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 31 in total
Function load_lora_A took 2.7914047241210938 ms to run.
Function load_lora_B took 2.7914047241210938 ms to run.
cost realload: 5.973577499389648
INFO:     127.0.0.1:40410 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40412 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40416 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40426 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40428 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33284 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33292 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33298 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33302 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33318 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33328 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33336 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_adapters took 5.994319915771484 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 30 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5857944488525391 ms to run.
cost offload scan: 0.09369850158691406
offload 1 adapters, 29 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.5939006805419922 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 28 remains
cost offload cat: 0.02956390380859375
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5838871002197266 ms to run.
cost offload scan: 0.09584426879882812
offload 1 adapters, 27 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5898475646972656 ms to run.
offload 0 adapters, 27 remains
Function offload_adapters took 0.011920928955078125 ms to run.
current batch size: 31 token used ratio: 0.17496923076923077
cost offload scan: 0.12969970703125
offload 2 adapters, 25 remains
cost offload cat: 0.024557113647460938
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.6310939788818359 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 24 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5915164947509766 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 25 in total
Function load_lora_A took 4.95147705078125 ms to run.
Function load_lora_B took 4.944086074829102 ms to run.
cost realload: 10.298967361450195
Function load_adapters took 10.320186614990234 ms to run.
cost offload scan: 0.09393692016601562
offload 1 adapters, 24 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5824565887451172 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 23 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5888938903808594 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 22 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5967617034912109 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 23 in total
Function load_lora_A took 9.285449981689453 ms to run.
Function load_lora_B took 9.252786636352539 ms to run.
cost realload: 18.930673599243164
Function load_adapters took 18.951892852783203 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 22 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5803108215332031 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 23 in total
Function load_lora_A took 4.988908767700195 ms to run.
Function load_lora_B took 4.898309707641602 ms to run.
cost realload: 10.286569595336914
Function load_adapters took 10.307788848876953 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 22 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5862712860107422 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.011444091796875 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 22 in total
cost realload: 0.2846717834472656
Function load_adapters took 0.3085136413574219 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 21 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.5872249603271484 ms to run.
current batch size: 28 token used ratio: 0.15272307692307693
offload 0 adapters, 21 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 21 in total
cost realload: 0.27251243591308594
Function load_adapters took 0.2963542938232422 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 20 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5826950073242188 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 21 in total
Function load_lora_A took 2.8352737426757812 ms to run.
Function load_lora_B took 2.7816295623779297 ms to run.
cost realload: 6.025552749633789
Function load_adapters took 6.046533584594727 ms to run.
Avg tokens(prompt+generate) throughput: 1584.579 tokens/s
Avg prompt tokens throughput:            744.423 tokens/s
Avg generate tokens throughput:          840.156 tokens/s
cost load scan: 0.008106231689453125
load 1 adapters, 22 in total
Function load_lora_A took 4.982471466064453 ms to run.
Function load_lora_B took 4.978179931640625 ms to run.
cost realload: 10.367155075073242
Function load_adapters took 10.388851165771484 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 21 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5931854248046875 ms to run.
cost offload scan: 0.0972747802734375
offload 1 adapters, 20 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5881786346435547 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 19 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5905628204345703 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 20 in total
Function load_lora_A took 9.306907653808594 ms to run.
Function load_lora_B took 9.261369705200195 ms to run.
cost realload: 18.958091735839844
Function load_adapters took 18.97883415222168 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 19 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.5877017974853516 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 20 in total
Function load_lora_A took 9.300470352172852 ms to run.
Function load_lora_B took 9.289026260375977 ms to run.
cost realload: 18.99099349975586
Function load_adapters took 19.012451171875 ms to run.
current batch size: 27 token used ratio: INFO:     127.0.0.1:33346 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33352 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33354 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33370 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33374 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33388 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33404 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33408 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33414 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33420 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33436 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33446 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33460 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33466 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33476 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33484 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33488 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33490 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33500 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33502 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33512 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33514 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33522 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33536 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:33550 - "POST /generate_stream HTTP/1.1" 200 OK
0.14892307692307694
cost offload scan: 0.08749961853027344
offload 1 adapters, 19 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.5855560302734375 ms to run.
cost offload scan: 0.14090538024902344
offload 2 adapters, 17 remains
cost offload cat: 0.024318695068359375
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.6253719329833984 ms to run.
cost load scan: 0.009059906005859375
load 3 adapters, 20 in total
Function load_lora_A took 4.969120025634766 ms to run.
Function load_lora_B took 4.935026168823242 ms to run.
Function load_lora_A took 4.945993423461914 ms to run.
Function load_lora_B took 4.971981048583984 ms to run.
Function load_lora_A took 2.7549266815185547 ms to run.
Function load_lora_B took 2.774477005004883 ms to run.
cost realload: 25.88796615600586
Function load_adapters took 25.9096622467041 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 19 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5877017974853516 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 18 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10180473327636719
Function offload_adapters took 0.5710124969482422 ms to run.
cost load scan: 0.014543533325195312
load 2 adapters, 20 in total
Function load_lora_A took 2.8553009033203125 ms to run.
Function load_lora_B took 2.7785301208496094 ms to run.
Function load_lora_A took 4.947662353515625 ms to run.
Function load_lora_B took 4.958629608154297 ms to run.
cost realload: 16.01696014404297
Function load_adapters took 16.039371490478516 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.011682510375976562 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 20 in total
cost realload: 0.2808570861816406
Function load_adapters took 0.3108978271484375 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 19 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5812644958496094 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.012636184692382812 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.01430511474609375
load 2 adapters, 21 in total
Function load_lora_A took 4.9724578857421875 ms to run.
Function load_lora_B took 4.910945892333984 ms to run.
Function load_lora_A took 2.7856826782226562 ms to run.
Function load_lora_B took 2.805948257446289 ms to run.
cost realload: 15.952587127685547
Function load_adapters took 15.974044799804688 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 20 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5891323089599609 ms to run.
current batch size: 24 token used ratio: 0.1208
cost offload scan: 0.08702278137207031
offload 1 adapters, 19 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5908012390136719 ms to run.
cost load scan: 0.013828277587890625
load 2 adapters, 21 in total
Function load_lora_A took 9.364128112792969 ms to run.
Function load_lora_B took 9.268522262573242 ms to run.
Function load_lora_A took 4.961967468261719 ms to run.
Function load_lora_B took 4.877567291259766 ms to run.
cost realload: 28.945446014404297
Function load_adapters took 28.96714210510254 ms to run.
cost load scan: 0.0133514404296875
load 3 adapters, 24 in total
Function load_lora_A took 4.906654357910156 ms to run.
Function load_lora_B took 4.855871200561523 ms to run.
Function load_lora_A took 2.806425094604492 ms to run.
Function load_lora_B took 2.761363983154297 ms to run.
Function load_lora_A took 4.8961639404296875 ms to run.
Function load_lora_B took 4.921436309814453 ms to run.
cost realload: 25.704145431518555
Function load_adapters took 25.7260799407959 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 23 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.5924701690673828 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 23 in total
cost realload: 0.2803802490234375
Function load_adapters took 0.3039836883544922 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 22 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5800724029541016 ms to run.
cost load scan: 0.01239776611328125
load 1 adapters, 23 in total
Function load_lora_A took 4.985809326171875 ms to run.
Function load_lora_B took 4.951238632202148 ms to run.
cost realload: 10.337114334106445
Function load_adapters took 10.358810424804688 ms to run.
offload 0 adapters, 23 remains
Function offload_adapters took 0.013828277587890625 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 24 in total
Function load_lora_A took 2.786397933959961 ms to run.
Function load_lora_B took 2.7828216552734375 ms to run.
cost realload: 5.967140197753906
Function load_adapters took 5.990505218505859 ms to run.
current batch size: 31 token used ratio: 0.15321538461538461
cost load scan: 0.015497207641601562
load 1 adapters, 25 in total
Function load_lora_A took 4.962444305419922 ms to run.
Function load_lora_B took 4.949092864990234 ms to run.
cost realload: 10.340213775634766
Function load_adapters took 10.362863540649414 ms to run.
cost offload scan: 0.09560585021972656
offload 1 adapters, 24 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.5979537963867188 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 25 in total
Function load_lora_A took 9.325504302978516 ms to run.
Function load_lora_B took 9.267568588256836 ms to run.
cost realload: 18.993377685546875
Function load_adapters took 19.015789031982422 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 24 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.5970001220703125 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 23 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5762577056884766 ms to run.
offload 0 adapters, 23 remains
Function offload_adapters took 0.011444091796875 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 23 in total
cost realload: 0.28395652770996094
Function load_adapters took 0.3075599670410156 ms to run.
offload 0 adapters, 23 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 23 in total
cost realload: INFO:     127.0.0.1:33562 - "POST /generate_stream HTTP/1.1" 200 OK
0.28228759765625
Function load_adapters took 0.33020973205566406 ms to run.
current batch size: 30 token used ratio: 0.15923076923076923
offload 0 adapters, 23 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 23 in total
cost realload: 0.2930164337158203
Function load_adapters took 0.3197193145751953 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 22 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5812644958496094 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.012159347534179688 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 21 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5922317504882812 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 20 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.5924701690673828 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 19 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5826950073242188 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 18 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5924701690673828 ms to run.
cost offload scan: 0.08559226989746094
offload 1 adapters, 17 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5931854248046875 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 16 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5807876586914062 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 15 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5865097045898438 ms to run.
current batch size: 20 token used ratio: 0.11701538461538462
cost offload scan: 0.08630752563476562
offload 1 adapters, 14 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5865097045898438 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 13 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5769729614257812 ms to run.
cost offload scan: 0.08463859558105469
offload 1 adapters, 12 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.6043910980224609 ms to run.
Avg tokens(prompt+generate) throughput: 1367.614 tokens/s
Avg prompt tokens throughput:            702.342 tokens/s
Avg generate tokens throughput:          665.272 tokens/s
current batch size: 17 token used ratio: 0.11016923076923077
cost offload scan: 0.08416175842285156
offload 1 adapters, 11 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.028133392333984375
cost offload a_loc update: 0.102996826171875
Function offload_adapters took 0.5793571472167969 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 10 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5710124969482422 ms to run.
offload 0 adapters, 10 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 9 remains
cost offload cat: 0.03647804260253906
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10275840759277344
Function offload_adapters took 0.5781650543212891 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 8 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.5800724029541016 ms to run.
offload 0 adapters, 8 remains
Function offload_adapters took 0.011920928955078125 ms to run.
current batch size: 11 token used ratio: 0.07721538461538462
cost offload scan: 0.08153915405273438
offload 1 adapters, 7 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5717277526855469 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 6 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5750656127929688 ms to run.
cost offload scan: 0.08559226989746094
offload 1 adapters, 5 remains
cost offload cat: 0.03719329833984375
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5805492401123047 ms to run.
cost offload scan: 0.08177757263183594
offload 1 adapters, 4 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5671977996826172 ms to run.
cost offload scan: 0.08296966552734375
offload 1 adapters, 3 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.05173683166503906
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5729198455810547 ms to run.
offload 0 adapters, 3 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.08177757263183594
offload 1 adapters, 2 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5724430084228516 ms to run.
current batch size: 2 token used ratio: 0.015184615384615385
cost offload scan: 0.08225440979003906
offload 1 adapters, 1 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.0514984130859375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10395050048828125
