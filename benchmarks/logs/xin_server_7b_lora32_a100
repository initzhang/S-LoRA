For some LLaMA-based models, initializing the fast tokenizer may take a long time. To eliminate the initialization time, consider using 'hf-internal-testing/llama-tokenizer' instead of the original tokenizer.
llama-7b: 12.06 GB
peak working mem for (bs=20, seqlen=512): 0.70 GB
peak working mem for (bs=100, seqlen=512): 3.52 GB
all adapters (101) estimated size: 6.31 GB
avg adapter estimated size: 64.00 MB
INFO:     127.0.0.1:44908 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44918 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44934 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44946 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44956 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44960 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44972 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44976 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44984 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44990 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45006 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45008 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45018 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45030 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45042 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45058 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45068 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45072 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45084 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45094 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45104 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45116 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45126 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53696 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53704 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53720 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53724 - "POST /generate_stream HTTP/1.1" 200 OK
cost load scan: 0.011682510375976562
load 2 adapters, 2 in total
Function load_lora_A took 3.438234329223633 ms to run.
Function load_lora_B took 3.278970718383789 ms to run.
Function load_lora_A took 3.278017044067383 ms to run.
Function load_lora_B took 3.2532215118408203 ms to run.
cost realload: 23.4832763671875
Function load_adapters took 23.517847061157227 ms to run.
Avg tokens(prompt+generate) throughput:   16.299 tokens/s
Avg prompt tokens throughput:             16.299 tokens/s
Avg generate tokens throughput:            0.000 tokens/s
cost load scan: 0.022172927856445312
load 4 adapters, 6 in total
Function load_lora_A took 3.317117691040039 ms to run.
Function load_lora_B took 3.2548904418945312 ms to run.
Function load_lora_A took 3.2994747161865234 ms to run.
Function load_lora_B took 3.2968521118164062 ms to run.
Function load_lora_A took 3.2875537872314453 ms to run.
Function load_lora_B took 3.2465457916259766 ms to run.
Function load_lora_A took 3.27301025390625 ms to run.
Function load_lora_B took 3.2296180725097656 ms to run.
cost realload: 27.08148956298828
Function load_adapters took 27.10700035095215 ms to run.
cost load scan: 0.012874603271484375
load 2 adapters, 8 in total
Function load_lora_A took 3.2346248626708984 ms to run.
Function load_lora_B took 3.244161605834961 ms to run.
Function load_lora_A took 3.234386444091797 ms to run.
Function load_lora_B took 3.238201141357422 ms to run.
cost realload: 13.486862182617188
Function load_adapters took 13.513803482055664 ms to run.
cost load scan: 0.01239776611328125
load 1 adapters, 9 in total
Function load_lora_A took 3.264188766479492 ms to run.
Function load_lora_B took 3.2570362091064453 ms to run.
cost realload: 6.946325302124023
Function load_adapters took 6.96873664855957 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 10 in total
Function load_lora_A took 3.258943557739258 ms to run.
Function load_lora_B took 3.258943557739258 ms to run.
cost realload: 6.955623626708984
Function load_adapters took 6.97779655456543 ms to run.
current batch size: 11 token used ratio: 0.042953846153846155
cost load scan: 0.01430511474609375
load 2 adapters, 12 in total
Function load_lora_A took 3.267049789428711 ms to run.
Function load_lora_B took 3.271818161010742 ms to run.
Function load_lora_A took 3.239154815673828 ms to run.
Function load_lora_B took 3.228902816772461 ms to run.
cost realload: 13.534069061279297
Function load_adapters took 13.557195663452148 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 13 in total
Function load_lora_A took 3.248929977416992 ms to run.
Function load_lora_B took 3.2186508178710938 ms to run.
cost realload: 6.894588470458984
Function load_adapters took 6.916284561157227 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 14 in total
Function load_lora_A took 3.274679183959961 ms to run.
Function load_lora_B took 3.2465457916259766 ms to run.
cost realload: 6.944179534912109
Function load_adapters took 6.966352462768555 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 14 in total
cost realload: 0.3063678741455078
Function load_adapters took 0.33020973205566406 ms to run.
current batch size: 16 token used ratio: 0.07326153846153846
cost load scan: 0.011920928955078125
load 1 adapters, 15 in total
Function load_lora_A took 3.258943557739258 ms to run.
Function load_lora_B took 3.2172203063964844 ms to run.
cost realload: 6.924867630004883
Function load_adapters took 6.947994232177734 ms to run.
cost load scan: 0.013828277587890625
load 1 adapters, 16 in total
Function load_lora_A took 3.256559371948242 ms to run.
Function load_lora_B took 3.2415390014648438 ms to run.
cost realload: 6.941080093383789
Function load_adapters took 6.963491439819336 ms to run.
offload 0 adapters, 16 remains
Function offload_adapters took 0.017881393432617188 ms to run.
cost load scan: 0.014066696166992188
load 2 adapters, 18 in total
Function load_lora_A took 3.224611282348633 ms to run.
Function load_lora_B took 3.255128860473633 ms to run.
Function load_lora_A took 3.271341323852539 ms to run.
Function load_lora_B took 3.270387649536133 ms to run.
cost realload: 13.525962829589844
Function load_adapters took 13.553380966186523 ms to run.
cost load scan: 0.010013580322265625
load 1 adapters, 19 in total
Function load_lora_A took 3.2846927642822266 ms to run.
Function load_lora_B took 3.2596588134765625 ms to run.
cost realload: 6.979703903198242
Function load_adapters took 7.0018768310546875 ms to run.
current batch size: 20 token used ratio: 0.1016
cost offload scan: 0.18858909606933594
offload 1 adapters, 18 remains
cost offload cat: 0.04792213439941406
cost offload free mem manager: 0.04696846008300781
cost offload torch.empty: 0.026464462280273438
cost offload a_loc update: 14.63460922241211
Function offload_adapters took 15.258073806762695 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 19 in total
Function load_lora_A took 3.238677978515625 ms to run.
Function load_lora_B took 3.235340118408203 ms to run.
cost realload: 6.90913200378418
Function load_adapters took 6.930112838745117 ms to run.
cost offload scan: 0.1499652862548828
offload 1 adapters, 18 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11587142944335938
Function offload_adapters took 0.6649494171142578 ms to run.
cost offload scan: 0.14781951904296875
offload 1 adapters, 17 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.6608963012695312 ms to run.
cost offload scan: 0.09393692016601562
offload 1 adapters, 16 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11038780212402344
Function offload_adapters took 0.598907470703125 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 15 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5877017974853516 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 14 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5981922149658203 ms to run.
offload 0 adapters, 14 remains
Function offload_adapters took 0.012636184692382812 ms to run.
current batch size: 15 token used ratio: 0.08652307692307692
cost load scan: 0.015020370483398438
load 1 adapters, 15 in total
Function load_lora_A took 3.2973289489746094 ms to run.
Function load_lora_B took 3.244161605834961 ms to run.
cost realload: 6.974220275878906
Function load_adapters took 6.996870040893555 ms to run.
cost offload scan: 0.08559226989746094
offload 1 adapters, 14 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5917549133300781 ms to run.
cost load scan: 0.01621246337890625
load 3 adapters, 17 in total
Function load_lora_A took 3.2875537872314453 ms to run.
Function load_lora_B took 3.2567977905273438 ms to run.
Function load_lora_A took 3.2677650451660156 ms to run.
Function load_lora_B took 3.2596588134765625 ms to run.
Function load_lora_A took 3.253936767578125 ms to run.
Function load_lora_B took 3.2091140747070312 ms to run.
cost realload: 20.101070404052734
Function load_adapters took 20.12324333190918 ms to run.
offload 0 adapters, 17 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 16 remains
cost offload cat: 0.03504753112792969
cost offload free mem manager: INFO:     127.0.0.1:53734 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53742 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53748 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53752 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53758 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53766 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53770 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53778 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53790 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53804 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53814 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53824 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53830 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53842 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53858 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53868 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53870 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53872 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53880 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53886 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53890 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53892 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53894 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53908 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53918 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53928 - "POST /generate_stream HTTP/1.1" 200 OK
0.044345855712890625
cost offload torch.empty: 0.024318695068359375
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.6401538848876953 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 15 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11038780212402344
Function offload_adapters took 0.6022453308105469 ms to run.
cost load scan: 0.030517578125
load 4 adapters, 19 in total
Function load_lora_A took 3.2689571380615234 ms to run.
Function load_lora_B took 3.2472610473632812 ms to run.
Function load_lora_A took 3.2346248626708984 ms to run.
Function load_lora_B took 3.2219886779785156 ms to run.
Function load_lora_A took 3.2339096069335938 ms to run.
Function load_lora_B took 3.234386444091797 ms to run.
Function load_lora_A took 3.228902816772461 ms to run.
Function load_lora_B took 3.262042999267578 ms to run.
cost realload: 26.593923568725586
Function load_adapters took 26.61585807800293 ms to run.
current batch size: 19 token used ratio: 0.10390769230769231
cost load scan: 0.0171661376953125
load 3 adapters, 22 in total
Function load_lora_A took 3.262042999267578 ms to run.
Function load_lora_B took 3.256082534790039 ms to run.
Function load_lora_A took 3.222942352294922 ms to run.
Function load_lora_B took 3.2460689544677734 ms to run.
Function load_lora_A took 3.2787322998046875 ms to run.
Function load_lora_B took 3.2584667205810547 ms to run.
cost realload: 20.112037658691406
Function load_adapters took 20.134687423706055 ms to run.
cost offload scan: 0.13446807861328125
offload 2 adapters, 20 remains
cost offload cat: 0.028848648071289062
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6508827209472656 ms to run.
cost offload scan: 0.09775161743164062
offload 1 adapters, 19 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.6132125854492188 ms to run.
cost offload scan: 0.09751319885253906
offload 1 adapters, 18 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.6117820739746094 ms to run.
cost load scan: 0.016450881958007812
load 4 adapters, 22 in total
Function load_lora_A took 3.2379627227783203 ms to run.
Function load_lora_B took 3.2486915588378906 ms to run.
Function load_lora_A took 3.262758255004883 ms to run.
Function load_lora_B took 3.2486915588378906 ms to run.
Function load_lora_A took 3.233671188354492 ms to run.
Function load_lora_B took 3.238677978515625 ms to run.
Function load_lora_A took 3.2570362091064453 ms to run.
Function load_lora_B took 3.271341323852539 ms to run.
cost realload: 26.643037796020508
Function load_adapters took 26.66449546813965 ms to run.
cost load scan: 0.01430511474609375
load 2 adapters, 24 in total
Function load_lora_A took 3.2875537872314453 ms to run.
Function load_lora_B took 3.258228302001953 ms to run.
Function load_lora_A took 3.2892227172851562 ms to run.
Function load_lora_B took 3.2501220703125 ms to run.
cost realload: 13.590097427368164
Function load_adapters took 13.611793518066406 ms to run.
cost offload scan: 0.09989738464355469
offload 1 adapters, 23 remains
cost offload cat: 0.03600120544433594
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11610984802246094
Function offload_adapters took 0.6227493286132812 ms to run.
cost load scan: 0.014543533325195312
load 2 adapters, 25 in total
Function load_lora_A took 3.258228302001953 ms to run.
Function load_lora_B took 3.252267837524414 ms to run.
Function load_lora_A took 3.2362937927246094 ms to run.
Function load_lora_B took 3.239870071411133 ms to run.
cost realload: 13.473272323608398
Function load_adapters took 13.494253158569336 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 24 remains
cost offload cat: 0.03600120544433594
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11515617370605469
Function offload_adapters took 0.6122589111328125 ms to run.
cost offload scan: 0.095367431640625
offload 1 adapters, 23 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11181831359863281
Function offload_adapters took 0.6144046783447266 ms to run.
cost load scan: 0.018596649169921875
load 2 adapters, 25 in total
Function load_lora_A took 3.3111572265625 ms to run.
Function load_lora_B took 3.2739639282226562 ms to run.
Function load_lora_A took 3.2389163970947266 ms to run.
Function load_lora_B took 3.2422542572021484 ms to run.
cost realload: 13.58795166015625
Function load_adapters took 13.612031936645508 ms to run.
current batch size: 25 token used ratio: 0.12806153846153845
cost load scan: 0.010967254638671875
load 1 adapters, 26 in total
Function load_lora_A took 3.261089324951172 ms to run.
Function load_lora_B took 3.2646656036376953 ms to run.
cost realload: 6.954431533813477
Function load_adapters took 6.976127624511719 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 27 in total
Function load_lora_A took 3.2923221588134766 ms to run.
Function load_lora_B took 3.2303333282470703 ms to run.
cost realload: 6.970405578613281
Function load_adapters took 6.992816925048828 ms to run.
cost load scan: 0.019073486328125
load 1 adapters, 28 in total
Function load_lora_A took 3.2820701599121094 ms to run.
Function load_lora_B took 3.2334327697753906 ms to run.
cost realload: 6.952047348022461
Function load_adapters took 6.973981857299805 ms to run.
cost offload scan: 0.09703636169433594
offload 1 adapters, 27 remains
cost offload cat: 0.04029273986816406
cost offload free mem manager: 0.06008148193359375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11706352233886719
Function offload_adapters took 0.6656646728515625 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 28 in total
Function load_lora_A took 3.2873153686523438 ms to run.
Function load_lora_B took 3.235340118408203 ms to run.
cost realload: 6.942987442016602
Function load_adapters took 6.963491439819336 ms to run.
cost offload scan: 0.09441375732421875
offload 1 adapters, 27 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.6113052368164062 ms to run.
current batch size: 27 token used ratio: 0.1526
cost load scan: 0.009775161743164062
load 1 adapters, 28 in total
Function load_lora_A took 3.3066272735595703 ms to run.
Function load_lora_B took 3.240823745727539 ms to run.
cost realload: 6.986141204833984
Function load_adapters took 7.00831413269043 ms to run.
cost load scan: 0.011444091796875
load 3 adapters, 31 in total
Function load_lora_A took 3.2646656036376953 ms to run.
Function load_lora_B took 3.2422542572021484 ms to run.
Function load_lora_A took 3.230571746826172 ms to run.
Function load_lora_B took 3.2057762145996094 ms to run.
Function load_lora_A took 3.2312870025634766 ms to run.
Function load_lora_B took 3.2324790954589844 ms to run.
cost realload: 19.99354362487793
Function load_adapters took 20.015478134155273 ms to run.
Avg tokens(prompt+generate) throughput: 2006.474 tokens/s
Avg prompt tokens throughput:           1359.808 tokens/s
Avg generate tokens throughput:          646.666 tokens/s
offload 0 adapters, 31 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost offload scan: 0.14591217041015625
offload 2 adapters, 29 remains
cost offload cat: 0.030755996704101562
INFO:     127.0.0.1:53934 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53946 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53958 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53974 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53984 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54000 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54006 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54010 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload free mem manager: 0.0476837158203125
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.11873245239257812
Function offload_adapters took 0.7185935974121094 ms to run.
cost offload scan: 0.14543533325195312
offload 2 adapters, 27 remains
cost offload cat: 0.026702880859375
cost offload free mem manager: 0.047206878662109375
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.6761550903320312 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 28 in total
Function load_lora_A took 3.2973289489746094 ms to run.
Function load_lora_B took 3.246784210205078 ms to run.
cost realload: 6.961822509765625
Function load_adapters took 6.982564926147461 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 27 remains
cost offload cat: 0.03504753112792969
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11539459228515625
Function offload_adapters took 0.6084442138671875 ms to run.
current batch size: 27 token used ratio: 0.1590923076923077
cost offload scan: 0.09202957153320312
offload 1 adapters, 26 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.6043910980224609 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 25 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11897087097167969
Function offload_adapters took 0.6101131439208984 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 25 in total
cost realload: 0.3275871276855469
Function load_adapters took 0.35119056701660156 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 24 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.5998611450195312 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 23 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11038780212402344
Function offload_adapters took 0.5996227264404297 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 24 in total
Function load_lora_A took 3.2711029052734375 ms to run.
Function load_lora_B took 3.2265186309814453 ms to run.
cost realload: 6.920099258422852
Function load_adapters took 6.941556930541992 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 25 in total
Function load_lora_A took 3.259420394897461 ms to run.
Function load_lora_B took 3.222227096557617 ms to run.
cost realload: 6.9026947021484375
Function load_adapters took 6.923913955688477 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 24 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6008148193359375 ms to run.
offload 0 adapters, 24 remains
Function offload_adapters took 0.012874603271484375 ms to run.
current batch size: 24 token used ratio: 0.15012307692307691
cost offload scan: 0.09679794311523438
offload 1 adapters, 23 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.6084442138671875 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 22 remains
cost offload cat: 0.04076957702636719
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.6172657012939453 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 23 in total
Function load_lora_A took 3.2455921173095703 ms to run.
Function load_lora_B took 3.2501220703125 ms to run.
cost realload: 6.899833679199219
Function load_adapters took 6.921052932739258 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 22 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.6091594696044922 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 21 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.6029605865478516 ms to run.
cost offload scan: 0.09393692016601562
offload 1 adapters, 20 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5948543548583984 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 20 in total
cost realload: 0.30732154846191406
Function load_adapters took 0.33164024353027344 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 19 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.6072521209716797 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 20 in total
Function load_lora_A took 3.2584667205810547 ms to run.
Function load_lora_B took 3.2317638397216797 ms to run.
cost realload: 6.909847259521484
Function load_adapters took 6.931543350219727 ms to run.
current batch size: 21 token used ratio: 0.13763076923076922
cost offload scan: 0.08845329284667969
offload 1 adapters, 19 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.58746337890625 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 18 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.5958080291748047 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 19 in total
Function load_lora_A took 3.2842159271240234 ms to run.
Function load_lora_B took 3.253936767578125 ms to run.
cost realload: 6.974697113037109
Function load_adapters took 7.004976272583008 ms to run.
current batch size: 19 token used ratio: 0.13129230769230768
cost offload scan: 0.09846687316894531
offload 1 adapters, 18 remains
cost offload cat: 0.04363059997558594
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11587142944335938
Function offload_adapters took 0.6346702575683594 ms to run.
cost offload scan: 0.13446807861328125
offload 2 adapters, 16 remains
cost offload cat: 0.028133392333984375
cost offload free mem manager: 0.049591064453125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1220703125
Function offload_adapters took 0.6592273712158203 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 15 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.024557113647460938
cost offload a_loc update: 0.12159347534179688
Function offload_adapters took 0.6194114685058594 ms to run.
cost offload scan: INFO:     127.0.0.1:54022 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35396 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35406 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35410 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35422 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35432 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35440 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35448 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35460 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35468 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35472 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35482 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35490 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35498 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35506 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35508 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35514 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35520 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35526 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35532 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35540 - "POST /generate_stream HTTP/1.1" 200 OK
0.09059906005859375
offload 1 adapters, 14 remains
cost offload cat: 0.03552436828613281
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.64849853515625 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 13 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04744529724121094
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5977153778076172 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 12 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5910396575927734 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 13 in total
Function load_lora_A took 3.3092498779296875 ms to run.
Function load_lora_B took 3.2982826232910156 ms to run.
cost realload: 7.11822509765625
Function load_adapters took 7.139444351196289 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 12 remains
cost offload cat: 0.03910064697265625
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.6124973297119141 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 13 in total
Function load_lora_A took 3.301858901977539 ms to run.
Function load_lora_B took 3.2525062561035156 ms to run.
cost realload: 6.99925422668457
Function load_adapters took 7.021665573120117 ms to run.
cost load scan: 0.010728836059570312
load 2 adapters, 15 in total
Function load_lora_A took 3.2837390899658203 ms to run.
Function load_lora_B took 3.221273422241211 ms to run.
Function load_lora_A took 3.2529830932617188 ms to run.
Function load_lora_B took 3.2575130462646484 ms to run.
cost realload: 13.513565063476562
Function load_adapters took 13.535261154174805 ms to run.
current batch size: 15 token used ratio: 0.08944615384615384
cost load scan: 0.008106231689453125
load 1 adapters, 16 in total
Function load_lora_A took 3.290891647338867 ms to run.
Function load_lora_B took 3.245830535888672 ms to run.
cost realload: 6.955146789550781
Function load_adapters took 6.976604461669922 ms to run.
cost load scan: 0.013589859008789062
load 1 adapters, 17 in total
Function load_lora_A took 3.2303333282470703 ms to run.
Function load_lora_B took 3.252267837524414 ms to run.
cost realload: 6.910800933837891
Function load_adapters took 6.931781768798828 ms to run.
cost offload scan: 0.09655952453613281
offload 1 adapters, 16 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.030040740966796875
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.6251335144042969 ms to run.
cost load scan: 0.012159347534179688
load 2 adapters, 18 in total
Function load_lora_A took 3.291606903076172 ms to run.
Function load_lora_B took 3.2682418823242188 ms to run.
Function load_lora_A took 3.2536983489990234 ms to run.
Function load_lora_B took 3.2520294189453125 ms to run.
cost realload: 13.567686080932617
Function load_adapters took 13.590335845947266 ms to run.
cost offload scan: 0.10132789611816406
offload 1 adapters, 17 remains
cost offload cat: 0.03504753112792969
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.6175041198730469 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 16 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.5970001220703125 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 15 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.5929470062255859 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 16 in total
Function load_lora_A took 3.2525062561035156 ms to run.
Function load_lora_B took 3.245830535888672 ms to run.
cost realload: 6.924629211425781
Function load_adapters took 6.946563720703125 ms to run.
current batch size: 18 token used ratio: 0.10163076923076923
cost offload scan: 0.09012222290039062
offload 1 adapters, 15 remains
cost offload cat: 0.03719329833984375
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.6082057952880859 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 14 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.591278076171875 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 15 in total
Function load_lora_A took 3.2660961151123047 ms to run.
Function load_lora_B took 3.244638442993164 ms to run.
cost realload: 6.936788558959961
Function load_adapters took 6.958484649658203 ms to run.
cost offload scan: 0.091552734375
offload 1 adapters, 14 remains
cost offload cat: 0.039577484130859375
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11181831359863281
Function offload_adapters took 0.6175041198730469 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 15 in total
Function load_lora_A took 3.3042430877685547 ms to run.
Function load_lora_B took 3.2515525817871094 ms to run.
cost realload: 6.991863250732422
Function load_adapters took 7.013797760009766 ms to run.
current batch size: 16 token used ratio: 0.08663076923076923
cost load scan: 0.011682510375976562
load 1 adapters, 16 in total
Function load_lora_A took 3.268718719482422 ms to run.
Function load_lora_B took 3.2584667205810547 ms to run.
cost realload: 6.958961486816406
Function load_adapters took 6.981134414672852 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 17 in total
Function load_lora_A took 3.271818161010742 ms to run.
Function load_lora_B took 3.215312957763672 ms to run.
cost realload: 6.907224655151367
Function load_adapters took 6.928920745849609 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 16 remains
cost offload cat: 0.035762786865234375
cost offload free mem manager: 0.05221366882324219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.6136894226074219 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 16 in total
cost realload: 0.3190040588378906
Function load_adapters took 0.34356117248535156 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 15 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11992454528808594
Function offload_adapters took 0.6036758422851562 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 16 in total
Function load_lora_A took 3.245115280151367 ms to run.
Function load_lora_B took 3.262042999267578 ms to run.
cost realload: 6.916046142578125
Function load_adapters took 6.936311721801758 ms to run.
cost load scan: 0.0133514404296875
load 2 adapters, 18 in total
Function load_lora_A took 3.25775146484375 ms to run.
Function load_lora_B took 3.240346908569336 ms to run.
Function load_lora_A took 3.2868385314941406 ms to run.
Function load_lora_B took 3.238201141357422 ms to run.
cost realload: 13.521671295166016
Function load_adapters took 13.543367385864258 ms to run.
INFO:     127.0.0.1:35548 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35560 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35566 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35582 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35592 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35606 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35610 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35622 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35628 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35634 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35644 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35648 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35662 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35678 - "POST /generate_stream HTTP/1.1" 200 OK
current batch size: 21 token used ratio: 0.11601538461538462
cost load scan: 0.013113021850585938
load 2 adapters, 20 in total
Function load_lora_A took 3.269195556640625 ms to run.
Function load_lora_B took 3.257274627685547 ms to run.
Function load_lora_A took 3.261089324951172 ms to run.
Function load_lora_B took 3.238201141357422 ms to run.
cost realload: 13.521432876586914
Function load_adapters took 13.543367385864258 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 19 remains
cost offload cat: 0.03552436828613281
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.6015300750732422 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.012874603271484375 ms to run.
Avg tokens(prompt+generate) throughput: 1535.166 tokens/s
Avg prompt tokens throughput:            758.591 tokens/s
Avg generate tokens throughput:          776.574 tokens/s
cost offload scan: 0.095367431640625
offload 1 adapters, 18 remains
cost offload cat: 0.03647804260253906
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.6151199340820312 ms to run.
current batch size: 20 token used ratio: 0.11384615384615385
cost offload scan: 0.0896453857421875
offload 1 adapters, 17 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11467933654785156
Function offload_adapters took 0.6124973297119141 ms to run.
cost offload scan: 0.09655952453613281
offload 1 adapters, 16 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5967617034912109 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 17 in total
Function load_lora_A took 3.2701492309570312 ms to run.
Function load_lora_B took 3.2591819763183594 ms to run.
cost realload: 6.9675445556640625
Function load_adapters took 6.991386413574219 ms to run.
offload 0 adapters, 17 remains
Function offload_adapters took 0.012636184692382812 ms to run.
offload 0 adapters, 17 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.014066696166992188
load 1 adapters, 18 in total
Function load_lora_A took 3.281831741333008 ms to run.
Function load_lora_B took 3.2253265380859375 ms to run.
cost realload: 6.939888000488281
Function load_adapters took 6.964445114135742 ms to run.
cost offload scan: 0.10180473327636719
offload 1 adapters, 17 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11205673217773438
Function offload_adapters took 0.6201267242431641 ms to run.
current batch size: 17 token used ratio: 0.10264615384615385
cost load scan: 0.00858306884765625
load 1 adapters, 18 in total
Function load_lora_A took 3.2422542572021484 ms to run.
Function load_lora_B took 3.2448768615722656 ms to run.
cost realload: 6.912946701049805
Function load_adapters took 6.934642791748047 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 17 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11515617370605469
Function offload_adapters took 0.6003379821777344 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 16 remains
cost offload cat: 0.03695487976074219
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11205673217773438
Function offload_adapters took 0.6048679351806641 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 16 in total
cost realload: 0.2982616424560547
Function load_adapters took 0.32138824462890625 ms to run.
cost load scan: 0.014543533325195312
load 2 adapters, 18 in total
Function load_lora_A took 3.2808780670166016 ms to run.
Function load_lora_B took 3.240346908569336 ms to run.
Function load_lora_A took 3.2379627227783203 ms to run.
Function load_lora_B took 3.2422542572021484 ms to run.
cost realload: 13.506412506103516
Function load_adapters took 13.528823852539062 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 17 remains
cost offload cat: 0.03695487976074219
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.6117820739746094 ms to run.
offload 0 adapters, 17 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 16 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.6079673767089844 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 17 in total
Function load_lora_A took 3.2427310943603516 ms to run.
Function load_lora_B took 3.2186508178710938 ms to run.
cost realload: 6.893634796142578
Function load_adapters took 6.914854049682617 ms to run.
cost offload scan: 0.09822845458984375
offload 1 adapters, 16 remains
cost offload cat: 0.03504753112792969
cost offload free mem manager: 0.05078315734863281
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11682510375976562
Function offload_adapters took 0.6291866302490234 ms to run.
current batch size: 16 token used ratio: 0.09024615384615385
cost offload scan: 0.08678436279296875
offload 1 adapters, 15 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.05078315734863281
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5979537963867188 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 14 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5955696105957031 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 14 in total
cost realload: 0.3352165222167969
Function load_adapters took 0.36144256591796875 ms to run.
offload 0 adapters, 14 remains
Function offload_adapters took 0.015020370483398438 ms to run.
cost load scan: 0.013113021850585938
load 2 adapters, 16 in total
Function load_lora_A took 3.2660961151123047 ms to run.
Function load_lora_B took 3.2372474670410156 ms to run.
Function load_lora_A took 3.2558441162109375 ms to run.
Function load_lora_B took 3.267049789428711 ms to run.
cost realload: 13.528108596801758
Function load_adapters took 13.549566268920898 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 15 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.6108283996582031 ms to run.
cost offload scan: 0.10514259338378906
offload 1 adapters, 14 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.028848648071289062
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.6258487701416016 ms to run.
cost load scan: 0.014543533325195312
load 3 adapters, 17 in total
Function load_lora_A took 3.2770633697509766 ms to run.
Function load_lora_B took 3.2775402069091797 ms to run.
Function load_lora_A took 3.2536983489990234 ms to run.
Function load_lora_B took 3.258943557739258 ms to run.
Function load_lora_A took 3.241300582885742 ms to run.
Function load_lora_B took 3.2782554626464844 ms to run.
INFO:     127.0.0.1:35688 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35702 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35708 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:35720 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38040 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38052 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38062 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38074 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38080 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38088 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38100 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38102 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38116 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38130 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38136 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38142 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38144 - "POST /generate_stream HTTP/1.1" 200 OK
cost realload: 20.183086395263672
Function load_adapters took 20.20430564880371 ms to run.
current batch size: 17 token used ratio: 0.09038461538461538
cost offload scan: 0.08916854858398438
offload 1 adapters, 16 remains
cost offload cat: 0.037670135498046875
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.6012916564941406 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 17 in total
Function load_lora_A took 3.260374069213867 ms to run.
Function load_lora_B took 3.248453140258789 ms to run.
cost realload: 6.948947906494141
Function load_adapters took 6.970405578613281 ms to run.
cost load scan: 0.015974044799804688
load 2 adapters, 19 in total
Function load_lora_A took 3.2863616943359375 ms to run.
Function load_lora_B took 3.2291412353515625 ms to run.
Function load_lora_A took 3.2351016998291016 ms to run.
Function load_lora_B took 3.256559371948242 ms to run.
cost realload: 13.505220413208008
Function load_adapters took 13.52691650390625 ms to run.
cost offload scan: 0.09417533874511719
offload 1 adapters, 18 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.6122589111328125 ms to run.
cost offload scan: 0.09894371032714844
offload 1 adapters, 17 remains
cost offload cat: 0.03600120544433594
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.6291866302490234 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 18 in total
Function load_lora_A took 3.254413604736328 ms to run.
Function load_lora_B took 3.258943557739258 ms to run.
cost realload: 6.946325302124023
Function load_adapters took 6.967306137084961 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 17 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.6146430969238281 ms to run.
current batch size: 17 token used ratio: 0.0906923076923077
cost load scan: 0.012159347534179688
load 1 adapters, 18 in total
Function load_lora_A took 3.2711029052734375 ms to run.
Function load_lora_B took 3.2973289489746094 ms to run.
cost realload: 6.992816925048828
Function load_adapters took 7.018089294433594 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 17 remains
cost offload cat: 0.03552436828613281
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11682510375976562
Function offload_adapters took 0.6105899810791016 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 18 in total
Function load_lora_A took 3.2553672790527344 ms to run.
Function load_lora_B took 3.238677978515625 ms to run.
cost realload: 6.908655166625977
Function load_adapters took 6.930828094482422 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 17 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.5998611450195312 ms to run.
cost load scan: 0.014543533325195312
load 2 adapters, 19 in total
Function load_lora_A took 3.2596588134765625 ms to run.
Function load_lora_B took 3.2286643981933594 ms to run.
Function load_lora_A took 3.2281875610351562 ms to run.
Function load_lora_B took 3.259897232055664 ms to run.
cost realload: 13.483524322509766
Function load_adapters took 13.506174087524414 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 20 in total
Function load_lora_A took 3.2384395599365234 ms to run.
Function load_lora_B took 3.241300582885742 ms to run.
cost realload: 6.898403167724609
Function load_adapters took 6.920099258422852 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 19 remains
cost offload cat: 0.03504753112792969
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.6010532379150391 ms to run.
current batch size: 21 token used ratio: 0.11646153846153846
cost load scan: 0.011682510375976562
load 1 adapters, 20 in total
Function load_lora_A took 3.2470226287841797 ms to run.
Function load_lora_B took 3.2372474670410156 ms to run.
cost realload: 6.9179534912109375
Function load_adapters took 6.938934326171875 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 21 in total
Function load_lora_A took 3.2601356506347656 ms to run.
Function load_lora_B took 3.2808780670166016 ms to run.
cost realload: 6.972551345825195
Function load_adapters took 6.994485855102539 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 20 remains
cost offload cat: 0.03504753112792969
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11610984802246094
Function offload_adapters took 0.6093978881835938 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 21 in total
Function load_lora_A took 3.2722949981689453 ms to run.
Function load_lora_B took 3.2732486724853516 ms to run.
cost realload: 6.963968276977539
Function load_adapters took 6.985187530517578 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 20 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.12135505676269531
Function offload_adapters took 0.6117820739746094 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 19 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.12373924255371094
Function offload_adapters took 0.6101131439208984 ms to run.
current batch size: 21 token used ratio: 0.12206153846153846
cost offload scan: 0.09107589721679688
offload 1 adapters, 18 remains
cost offload cat: 0.03600120544433594
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11563301086425781
Function offload_adapters took 0.6160736083984375 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.01430511474609375
load 1 adapters, 19 in total
Function load_lora_A took 3.2720565795898438 ms to run.
Function load_lora_B took 3.248453140258789 ms to run.
cost realload: 6.969451904296875
Function load_adapters took 6.991863250732422 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 18 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11968612670898438
Function offload_adapters took 0.6093978881835938 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 19 in total
Function load_lora_A took 3.2427310943603516 ms to run.
Function load_lora_B took 3.2379627227783203 ms to run.
cost realload: 6.896495819091797
Function load_adapters took 6.918430328369141 ms to run.
current batch size: 20 token used ratio: 0.12381538461538462
cost offload scan: 0.12993812561035156
offload 2 adapters, 17 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.6392002105712891 ms to run.
cost load scan: 0.013589859008789062
load 1 adapters, 18 in total
Function load_lora_A took 3.2854080200195312 ms to run.
Function load_lora_B took 3.2224655151367188 ms to run.
cost realload: 6.932497024536133
INFO:     127.0.0.1:38154 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38168 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38178 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38190 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38200 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38210 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38220 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38236 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38248 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38256 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38264 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38268 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38280 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38288 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38296 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38302 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_adapters took 6.95490837097168 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 17 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5879402160644531 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 18 in total
Function load_lora_A took 3.2634735107421875 ms to run.
Function load_lora_B took 3.2601356506347656 ms to run.
cost realload: 6.943464279174805
Function load_adapters took 6.964921951293945 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 17 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.6070137023925781 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 16 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.5984306335449219 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 15 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11515617370605469
Function offload_adapters took 0.5955696105957031 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 14 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5939006805419922 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 14 in total
cost realload: 0.3116130828857422
Function load_adapters took 0.3387928009033203 ms to run.
cost offload scan: 0.09393692016601562
offload 1 adapters, 13 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11181831359863281
Function offload_adapters took 0.6067752838134766 ms to run.
current batch size: 14 token used ratio: 0.08849230769230769
cost load scan: 0.011682510375976562
load 1 adapters, 14 in total
Function load_lora_A took 3.2367706298828125 ms to run.
Function load_lora_B took 3.2427310943603516 ms to run.
cost realload: 6.902456283569336
Function load_adapters took 6.923198699951172 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 13 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5900859832763672 ms to run.
Avg tokens(prompt+generate) throughput: 1576.964 tokens/s
Avg prompt tokens throughput:            863.374 tokens/s
Avg generate tokens throughput:          713.591 tokens/s
cost offload scan: 0.09179115295410156
offload 1 adapters, 12 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5869865417480469 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 11 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5922317504882812 ms to run.
cost load scan: 0.0073909759521484375
load 0 adapters, 11 in total
cost realload: 0.3063678741455078
Function load_adapters took 0.3304481506347656 ms to run.
cost load scan: 0.013828277587890625
load 1 adapters, 12 in total
Function load_lora_A took 3.2875537872314453 ms to run.
Function load_lora_B took 3.2525062561035156 ms to run.
cost realload: 6.961584091186523
Function load_adapters took 6.983280181884766 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 11 remains
cost offload cat: 0.03695487976074219
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.60272216796875 ms to run.
offload 0 adapters, 11 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.012159347534179688
load 1 adapters, 12 in total
Function load_lora_A took 3.27301025390625 ms to run.
Function load_lora_B took 3.291606903076172 ms to run.
cost realload: 6.992816925048828
Function load_adapters took 7.014751434326172 ms to run.
current batch size: 13 token used ratio: 0.07641538461538462
cost offload scan: 0.08821487426757812
offload 1 adapters, 11 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6034374237060547 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 12 in total
Function load_lora_A took 3.2677650451660156 ms to run.
Function load_lora_B took 3.2701492309570312 ms to run.
cost realload: 6.953954696655273
Function load_adapters took 6.974697113037109 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 11 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04935264587402344
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5936622619628906 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 11 in total
cost realload: 0.29969215393066406
Function load_adapters took 0.32329559326171875 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 11 in total
cost realload: 0.3209114074707031
Function load_adapters took 0.3464221954345703 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 10 remains
cost offload cat: 0.0362396240234375
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.6096363067626953 ms to run.
cost load scan: 0.010728836059570312
load 3 adapters, 13 in total
Function load_lora_A took 3.2629966735839844 ms to run.
Function load_lora_B took 3.2465457916259766 ms to run.
Function load_lora_A took 3.2367706298828125 ms to run.
Function load_lora_B took 3.2396316528320312 ms to run.
Function load_lora_A took 3.2558441162109375 ms to run.
Function load_lora_B took 3.224611282348633 ms to run.
cost realload: 20.050048828125
Function load_adapters took 20.07317543029785 ms to run.
current batch size: 17 token used ratio: 0.08847692307692308
cost offload scan: 0.08988380432128906
offload 1 adapters, 12 remains
cost offload cat: 0.0362396240234375
cost offload free mem manager: 0.049114227294921875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1289844512939453
Function offload_adapters took 0.6344318389892578 ms to run.
cost load scan: 0.010013580322265625
load 1 adapters, 13 in total
Function load_lora_A took 3.2553672790527344 ms to run.
Function load_lora_B took 3.252744674682617 ms to run.
cost realload: 6.93511962890625
Function load_adapters took 6.957769393920898 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 12 remains
cost offload cat: 0.039577484130859375
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11539459228515625
Function offload_adapters took 0.6220340728759766 ms to run.
cost load scan: 0.011682510375976562
load 2 adapters, 14 in total
Function load_lora_A took 3.274202346801758 ms to run.
Function load_lora_B took 3.262042999267578 ms to run.
INFO:     127.0.0.1:38308 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38320 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38334 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38338 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38354 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41510 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41514 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41526 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41530 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41538 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41542 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41558 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41560 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41564 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41570 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41572 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41588 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41598 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41608 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41618 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41624 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41632 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41638 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41644 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41646 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41652 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 3.252744674682617 ms to run.
Function load_lora_B took 3.255128860473633 ms to run.
cost realload: 13.579368591308594
Function load_adapters took 13.601303100585938 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 13 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.6151199340820312 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 14 in total
Function load_lora_A took 3.2296180725097656 ms to run.
Function load_lora_B took 3.2377243041992188 ms to run.
cost realload: 6.893396377563477
Function load_adapters took 6.914377212524414 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 15 in total
Function load_lora_A took 3.2236576080322266 ms to run.
Function load_lora_B took 3.254413604736328 ms to run.
cost realload: 6.911039352416992
Function load_adapters took 6.931543350219727 ms to run.
current batch size: 18 token used ratio: 0.08947692307692308
cost load scan: 0.007867813110351562
load 0 adapters, 15 in total
cost realload: 0.3247261047363281
Function load_adapters took 0.34928321838378906 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 14 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.6024837493896484 ms to run.
offload 0 adapters, 14 remains
Function offload_adapters took 0.012874603271484375 ms to run.
offload 0 adapters, 14 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 14 in total
cost realload: 0.324249267578125
Function load_adapters took 0.34880638122558594 ms to run.
current batch size: 17 token used ratio: 0.08941538461538462
cost load scan: 0.011920928955078125
load 1 adapters, 15 in total
Function load_lora_A took 3.271341323852539 ms to run.
Function load_lora_B took 3.2243728637695312 ms to run.
cost realload: 6.921529769897461
Function load_adapters took 6.94584846496582 ms to run.
offload 0 adapters, 15 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost offload scan: 0.0972747802734375
offload 1 adapters, 14 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.6132125854492188 ms to run.
cost load scan: 0.01621246337890625
load 2 adapters, 16 in total
Function load_lora_A took 3.2248497009277344 ms to run.
Function load_lora_B took 3.2613277435302734 ms to run.
Function load_lora_A took 3.2966136932373047 ms to run.
Function load_lora_B took 3.2362937927246094 ms to run.
cost realload: 13.51785659790039
Function load_adapters took 13.538360595703125 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 16 in total
cost realload: 0.3025531768798828
Function load_adapters took 0.3268718719482422 ms to run.
current batch size: 19 token used ratio: 0.10473846153846154
cost load scan: 0.011682510375976562
load 1 adapters, 17 in total
Function load_lora_A took 3.307342529296875 ms to run.
Function load_lora_B took 3.2639503479003906 ms to run.
cost realload: 6.994485855102539
Function load_adapters took 7.018804550170898 ms to run.
cost load scan: 0.013113021850585938
load 2 adapters, 19 in total
Function load_lora_A took 3.2694339752197266 ms to run.
Function load_lora_B took 3.270387649536133 ms to run.
Function load_lora_A took 3.2875537872314453 ms to run.
Function load_lora_B took 3.2262802124023438 ms to run.
cost realload: 13.566732406616211
Function load_adapters took 13.588190078735352 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 18 remains
cost offload cat: 0.0362396240234375
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.6124973297119141 ms to run.
cost offload scan: 0.10037422180175781
offload 1 adapters, 17 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.60272216796875 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 18 in total
Function load_lora_A took 3.2706260681152344 ms to run.
Function load_lora_B took 3.2396316528320312 ms to run.
cost realload: 6.934881210327148
Function load_adapters took 6.957054138183594 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 19 in total
Function load_lora_A took 3.238677978515625 ms to run.
Function load_lora_B took 3.253459930419922 ms to run.
cost realload: 6.915092468261719
Function load_adapters took 6.937742233276367 ms to run.
current batch size: 22 token used ratio: 0.12521538461538462
cost load scan: 0.01430511474609375
load 4 adapters, 23 in total
Function load_lora_A took 3.232717514038086 ms to run.
Function load_lora_B took 3.2460689544677734 ms to run.
Function load_lora_A took 3.262042999267578 ms to run.
Function load_lora_B took 3.2737255096435547 ms to run.
Function load_lora_A took 3.211498260498047 ms to run.
Function load_lora_B took 3.2422542572021484 ms to run.
Function load_lora_A took 3.2427310943603516 ms to run.
Function load_lora_B took 3.240823745727539 ms to run.
cost realload: 26.58677101135254
Function load_adapters took 26.60846710205078 ms to run.
cost offload scan: 0.17333030700683594
offload 3 adapters, 20 remains
cost offload cat: 0.02956390380859375
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.6852149963378906 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.013589859008789062
load 4 adapters, 24 in total
Function load_lora_A took 3.2422542572021484 ms to run.
Function load_lora_B took 3.2482147216796875 ms to run.
Function load_lora_A took 3.237485885620117 ms to run.
Function load_lora_B took 3.2341480255126953 ms to run.
Function load_lora_A took 3.259897232055664 ms to run.
Function load_lora_B took 3.2608509063720703 ms to run.
Function load_lora_A took 3.2761096954345703 ms to run.
Function load_lora_B took 3.2567977905273438 ms to run.
cost realload: 26.642799377441406
Function load_adapters took 26.66473388671875 ms to run.
offload 0 adapters, 24 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost offload scan: 0.09846687316894531
offload 1 adapters, 23 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.6215572357177734 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 24 in total
Function load_lora_A took 3.2775402069091797 ms to run.
Function load_lora_B took 3.2389163970947266 ms to run.
cost realload: 6.93821907043457
Function load_adapters took 6.960391998291016 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 23 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11777877807617188
Function offload_adapters took 0.6201267242431641 ms to run.
cost load scan: 0.016927719116210938
load 4 adapters, 27 in total
Function load_lora_A took 3.2434463500976562 ms to run.
Function load_lora_B took 3.255605697631836 ms to run.
Function load_lora_A took 3.2682418823242188 ms to run.
Function load_lora_B took 3.2792091369628906 ms to run.
Function load_lora_A took 3.2815933227539062 ms to run.
Function load_lora_B took 3.2613277435302734 ms to run.
Function load_lora_A took 3.268003463745117 ms to run.
INFO:     127.0.0.1:41666 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41668 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41674 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41676 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41690 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41694 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41700 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41714 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41728 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41736 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41742 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_B took 3.234386444091797 ms to run.
cost realload: 26.762962341308594
Function load_adapters took 26.784658432006836 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 26 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.6129741668701172 ms to run.
offload 0 adapters, 26 remains
Function offload_adapters took 0.01239776611328125 ms to run.
current batch size: 26 token used ratio: 0.13495384615384615
cost load scan: 0.009298324584960938
load 1 adapters, 27 in total
Function load_lora_A took 3.255605697631836 ms to run.
Function load_lora_B took 3.2389163970947266 ms to run.
cost realload: 6.913185119628906
Function load_adapters took 6.93511962890625 ms to run.
cost load scan: 0.014543533325195312
load 2 adapters, 29 in total
Function load_lora_A took 3.2405853271484375 ms to run.
Function load_lora_B took 3.2355785369873047 ms to run.
Function load_lora_A took 3.265380859375 ms to run.
Function load_lora_B took 3.2393932342529297 ms to run.
cost realload: 13.474702835083008
Function load_adapters took 13.497352600097656 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 29 in total
cost realload: 0.3070831298828125
Function load_adapters took 0.3314018249511719 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 30 in total
Function load_lora_A took 3.2799243927001953 ms to run.
Function load_lora_B took 3.277301788330078 ms to run.
cost realload: 6.98089599609375
Function load_adapters took 7.002830505371094 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 29 remains
cost offload cat: 0.03600120544433594
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11205673217773438
Function offload_adapters took 0.6093978881835938 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 28 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11515617370605469
Function offload_adapters took 0.6103515625 ms to run.
cost offload scan: 0.09703636169433594
offload 1 adapters, 27 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.6227493286132812 ms to run.
cost offload scan: 0.09775161743164062
offload 1 adapters, 26 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.6115436553955078 ms to run.
current batch size: 27 token used ratio: 0.15196923076923077
cost load scan: 0.00762939453125
load 0 adapters, 26 in total
cost realload: 0.3027915954589844
Function load_adapters took 0.3266334533691406 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 25 remains
cost offload cat: 0.0400543212890625
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.6101131439208984 ms to run.
Avg tokens(prompt+generate) throughput: 1879.224 tokens/s
Avg prompt tokens throughput:           1156.761 tokens/s
Avg generate tokens throughput:          722.463 tokens/s
cost load scan: 0.008821487426757812
load 1 adapters, 26 in total
Function load_lora_A took 3.278493881225586 ms to run.
Function load_lora_B took 3.2324790954589844 ms to run.
cost realload: 6.928443908691406
Function load_adapters took 6.950139999389648 ms to run.
cost offload scan: 0.09942054748535156
offload 1 adapters, 25 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.6122589111328125 ms to run.
cost offload scan: 0.1266002655029297
offload 2 adapters, 23 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.6330013275146484 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 22 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11754035949707031
Function offload_adapters took 0.5993843078613281 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 22 in total
cost realload: 0.3180503845214844
Function load_adapters took 0.3426074981689453 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 21 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.051021575927734375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.6105899810791016 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 20 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.05030632019042969
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.5981922149658203 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 19 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11038780212402344
Function offload_adapters took 0.6003379821777344 ms to run.
current batch size: 22 token used ratio: 0.12796923076923078
cost load scan: 0.007867813110351562
load 1 adapters, 20 in total
Function load_lora_A took 3.253936767578125 ms to run.
Function load_lora_B took 3.2525062561035156 ms to run.
cost realload: 6.911993026733398
Function load_adapters took 6.932735443115234 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 19 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.5953311920166016 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 18 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.6010532379150391 ms to run.
cost offload scan: 0.09393692016601562
offload 1 adapters, 17 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.5972385406494141 ms to run.
cost load scan: 0.01430511474609375
load 1 adapters, 18 in total
Function load_lora_A took 3.261566162109375 ms to run.
Function load_lora_B took 3.258228302001953 ms to run.
cost realload: 6.928205490112305
Function load_adapters took 6.949186325073242 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 17 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5829334259033203 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 16 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5931854248046875 ms to run.
cost load scan: 0.01239776611328125
load 1 adapters, 17 in total
INFO:     127.0.0.1:41744 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41752 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41758 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41762 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41776 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41784 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41788 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41790 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41804 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41818 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41832 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41846 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41862 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56678 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56694 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56708 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56716 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56720 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56726 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56736 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 3.2668113708496094 ms to run.
Function load_lora_B took 3.2358169555664062 ms to run.
cost realload: 6.931781768798828
Function load_adapters took 6.952524185180664 ms to run.
cost load scan: 0.010013580322265625
load 3 adapters, 20 in total
Function load_lora_A took 3.2494068145751953 ms to run.
Function load_lora_B took 3.2379627227783203 ms to run.
Function load_lora_A took 3.3028125762939453 ms to run.
Function load_lora_B took 3.23486328125 ms to run.
Function load_lora_A took 3.2432079315185547 ms to run.
Function load_lora_B took 3.2396316528320312 ms to run.
cost realload: 20.08652687072754
Function load_adapters took 20.10941505432129 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 21 in total
Function load_lora_A took 3.283262252807617 ms to run.
Function load_lora_B took 3.2448768615722656 ms to run.
cost realload: 6.939172744750977
Function load_adapters took 6.960630416870117 ms to run.
current batch size: 24 token used ratio: 0.14009230769230768
cost offload scan: 0.09036064147949219
offload 1 adapters, 20 remains
cost offload cat: 0.03647804260253906
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.6105899810791016 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 19 remains
cost offload cat: 0.038623809814453125
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.6220340728759766 ms to run.
cost offload scan: 0.1266002655029297
offload 2 adapters, 17 remains
cost offload cat: 0.0286102294921875
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.6272792816162109 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 16 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5922317504882812 ms to run.
offload 0 adapters, 16 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 17 in total
Function load_lora_A took 3.2491683959960938 ms to run.
Function load_lora_B took 3.2501220703125 ms to run.
cost realload: 6.940126419067383
Function load_adapters took 6.96253776550293 ms to run.
current batch size: 18 token used ratio: 0.11373846153846154
cost load scan: 0.007867813110351562
load 1 adapters, 18 in total
Function load_lora_A took 3.2808780670166016 ms to run.
Function load_lora_B took 3.2706260681152344 ms to run.
cost realload: 6.9637298583984375
Function load_adapters took 6.985664367675781 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 17 remains
cost offload cat: 0.03719329833984375
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.6117820739746094 ms to run.
cost load scan: 0.007867813110351562
load 1 adapters, 18 in total
Function load_lora_A took 3.225564956665039 ms to run.
Function load_lora_B took 3.2482147216796875 ms to run.
cost realload: 6.890296936035156
Function load_adapters took 6.912708282470703 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 17 remains
cost offload cat: 0.03552436828613281
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.6144046783447266 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 18 in total
Function load_lora_A took 3.2634735107421875 ms to run.
Function load_lora_B took 3.241300582885742 ms to run.
cost realload: 6.916999816894531
Function load_adapters took 6.938695907592773 ms to run.
cost offload scan: 0.09703636169433594
offload 1 adapters, 17 remains
cost offload cat: 0.03790855407714844
cost offload free mem manager: 0.055789947509765625
cost offload torch.empty: 0.0247955322265625
cost offload a_loc update: 0.18095970153808594
Function offload_adapters took 0.7126331329345703 ms to run.
cost load scan: 0.0133514404296875
load 3 adapters, 20 in total
Function load_lora_A took 3.2410621643066406 ms to run.
Function load_lora_B took 3.253459930419922 ms to run.
Function load_lora_A took 3.2515525817871094 ms to run.
Function load_lora_B took 3.2587051391601562 ms to run.
Function load_lora_A took 3.226757049560547 ms to run.
Function load_lora_B took 3.2415390014648438 ms to run.
cost realload: 20.059823989868164
Function load_adapters took 20.08223533630371 ms to run.
current batch size: 21 token used ratio: 0.12270769230769231
cost load scan: 0.010967254638671875
load 1 adapters, 21 in total
Function load_lora_A took 3.267049789428711 ms to run.
Function load_lora_B took 3.2422542572021484 ms to run.
cost realload: 6.954431533813477
Function load_adapters took 6.978511810302734 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 22 in total
Function load_lora_A took 3.2684803009033203 ms to run.
Function load_lora_B took 3.2579898834228516 ms to run.
cost realload: 6.936788558959961
Function load_adapters took 6.958246231079102 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 21 remains
cost offload cat: 0.03838539123535156
cost offload free mem manager: 0.04744529724121094
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1163482666015625
Function offload_adapters took 0.6265640258789062 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 20 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11563301086425781
Function offload_adapters took 0.6151199340820312 ms to run.
cost offload scan: 0.09369850158691406
offload 1 adapters, 19 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6122589111328125 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 20 in total
Function load_lora_A took 3.2694339752197266 ms to run.
Function load_lora_B took 3.2584667205810547 ms to run.
cost realload: 6.960153579711914
Function load_adapters took 6.982326507568359 ms to run.
cost load scan: 0.0171661376953125
load 4 adapters, 24 in total
Function load_lora_A took 3.256559371948242 ms to run.
Function load_lora_B took 3.262042999267578 ms to run.
Function load_lora_A took 3.2777786254882812 ms to run.
Function load_lora_B took 3.2188892364501953 ms to run.
Function load_lora_A took 3.263711929321289 ms to run.
Function load_lora_B took 3.226757049560547 ms to run.
Function load_lora_A took 3.2618045806884766 ms to run.
Function load_lora_B took 3.278970718383789 ms to run.
cost realload: 26.68452262878418
Function load_adapters took 26.706933975219727 ms to run.
cost offload scan: 0.09942054748535156
offload 1 adapters, 23 remains
cost offload cat: 0.037670135498046875
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6201267242431641 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 22 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.052928924560546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.6113052368164062 ms to run.
current batch size: 23 token used ratio: 0.13107692307692306
cost load scan: 0.013113021850585938
load 1 adapters, 23 in total
INFO:     127.0.0.1:56746 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56762 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56776 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56784 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56794 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56810 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56824 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56836 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56842 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56850 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56866 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56882 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 3.240346908569336 ms to run.
Function load_lora_B took 3.231525421142578 ms to run.
cost realload: 6.951570510864258
Function load_adapters took 6.972789764404297 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 22 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.6127357482910156 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 23 in total
Function load_lora_A took 3.267049789428711 ms to run.
Function load_lora_B took 3.2587051391601562 ms to run.
cost realload: 6.931304931640625
Function load_adapters took 6.952762603759766 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 24 in total
Function load_lora_A took 3.2880306243896484 ms to run.
Function load_lora_B took 3.2618045806884766 ms to run.
cost realload: 6.979703903198242
Function load_adapters took 7.002592086791992 ms to run.
cost offload scan: 0.0972747802734375
offload 1 adapters, 23 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.6113052368164062 ms to run.
cost load scan: 0.014066696166992188
load 1 adapters, 24 in total
Function load_lora_A took 3.279447555541992 ms to run.
Function load_lora_B took 3.247499465942383 ms to run.
cost realload: 6.957054138183594
Function load_adapters took 6.978511810302734 ms to run.
cost offload scan: 0.091552734375
offload 1 adapters, 23 remains
cost offload cat: 0.04076957702636719
cost offload free mem manager: 0.04696846008300781
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.6158351898193359 ms to run.
current batch size: 23 token used ratio: 0.13610769230769232
cost offload scan: 0.09036064147949219
offload 1 adapters, 22 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.6017684936523438 ms to run.
cost load scan: 0.012159347534179688
load 1 adapters, 23 in total
Function load_lora_A took 3.252267837524414 ms to run.
Function load_lora_B took 3.237485885620117 ms to run.
cost realload: 6.90770149230957
Function load_adapters took 6.928920745849609 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 22 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5955696105957031 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 21 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11038780212402344
Function offload_adapters took 0.5986690521240234 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 22 in total
Function load_lora_A took 3.249645233154297 ms to run.
Function load_lora_B took 3.2525062561035156 ms to run.
cost realload: 6.918191909790039
Function load_adapters took 6.939888000488281 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 21 remains
cost offload cat: 0.03552436828613281
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6167888641357422 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 22 in total
Function load_lora_A took 3.263711929321289 ms to run.
Function load_lora_B took 3.222227096557617 ms to run.
cost realload: 6.907939910888672
Function load_adapters took 6.929874420166016 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 21 remains
cost offload cat: 0.04100799560546875
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.6101131439208984 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 20 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.12087821960449219
Function offload_adapters took 0.6084442138671875 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 19 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.6139278411865234 ms to run.
cost load scan: 0.0152587890625
load 1 adapters, 20 in total
Function load_lora_A took 3.2432079315185547 ms to run.
Function load_lora_B took 3.2732486724853516 ms to run.
cost realload: 6.930828094482422
Function load_adapters took 6.951093673706055 ms to run.
current batch size: 20 token used ratio: 0.11598461538461538
cost load scan: 0.009059906005859375
load 2 adapters, 22 in total
Function load_lora_A took 3.2553672790527344 ms to run.
Function load_lora_B took 3.255128860473633 ms to run.
Function load_lora_A took 3.228902816772461 ms to run.
Function load_lora_B took 3.2231807708740234 ms to run.
cost realload: 13.442754745483398
Function load_adapters took 13.465166091918945 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 21 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11777877807617188
Function offload_adapters took 0.6036758422851562 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 20 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11038780212402344
Function offload_adapters took 0.5943775177001953 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 21 in total
Function load_lora_A took 3.2584667205810547 ms to run.
Function load_lora_B took 3.2541751861572266 ms to run.
cost realload: 6.931066513061523
Function load_adapters took 6.952524185180664 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 20 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11873245239257812
Function offload_adapters took 0.5996227264404297 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 19 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11205673217773438
Function offload_adapters took 0.5977153778076172 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 18 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.598907470703125 ms to run.
current batch size: 18 token used ratio: 0.10586153846153847
cost load scan: 0.008344650268554688
load 1 adapters, 19 in total
Function load_lora_A took 3.2699108123779297 ms to run.
Function load_lora_B took 3.2472610473632812 ms to run.
cost realload: 6.958484649658203
Function load_adapters took 6.979465484619141 ms to run.
Avg tokens(prompt+generate) throughput: 1766.904 tokens/s
Avg prompt tokens throughput:            948.734 tokens/s
Avg generate tokens throughput:          818.170 tokens/s
cost load scan: 0.007867813110351562
load 0 adapters, 19 in total
INFO:     127.0.0.1:56886 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56898 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56904 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56910 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56926 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56928 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56932 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56938 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56944 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56956 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56962 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56978 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56986 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:56998 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57000 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:57002 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58458 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58474 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58476 - "POST /generate_stream HTTP/1.1" 200 OK
cost realload: 0.3402233123779297
Function load_adapters took 0.3657341003417969 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 18 remains
cost offload cat: 0.03814697265625
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11658668518066406
Function offload_adapters took 0.6148815155029297 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.095367431640625
offload 1 adapters, 17 remains
cost offload cat: 0.03695487976074219
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6132125854492188 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 18 in total
Function load_lora_A took 3.2744407653808594 ms to run.
Function load_lora_B took 3.2644271850585938 ms to run.
cost realload: 6.951093673706055
Function load_adapters took 6.9732666015625 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 17 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.5953311920166016 ms to run.
current batch size: 18 token used ratio: 0.10641538461538462
cost offload scan: 0.08678436279296875
offload 1 adapters, 16 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5934238433837891 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 17 in total
Function load_lora_A took 3.2529830932617188 ms to run.
Function load_lora_B took 3.263235092163086 ms to run.
cost realload: 6.940603256225586
Function load_adapters took 6.963014602661133 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 16 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.049591064453125
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.6041526794433594 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 15 remains
cost offload cat: 0.03552436828613281
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.598907470703125 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 14 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5888938903808594 ms to run.
current batch size: 15 token used ratio: 0.09207692307692307
cost load scan: 0.00858306884765625
load 1 adapters, 15 in total
Function load_lora_A took 3.2415390014648438 ms to run.
Function load_lora_B took 3.2563209533691406 ms to run.
cost realload: 6.923437118530273
Function load_adapters took 6.94584846496582 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 16 in total
Function load_lora_A took 3.2851696014404297 ms to run.
Function load_lora_B took 3.289461135864258 ms to run.
cost realload: 6.995916366577148
Function load_adapters took 7.018566131591797 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 15 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5993843078613281 ms to run.
cost load scan: 0.013589859008789062
load 1 adapters, 16 in total
Function load_lora_A took 3.2765865325927734 ms to run.
Function load_lora_B took 3.2541751861572266 ms to run.
cost realload: 6.957054138183594
Function load_adapters took 6.978034973144531 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 15 remains
cost offload cat: 0.035762786865234375
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.118255615234375
Function offload_adapters took 0.6077289581298828 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 16 in total
Function load_lora_A took 3.270387649536133 ms to run.
Function load_lora_B took 3.2508373260498047 ms to run.
cost realload: 6.928443908691406
Function load_adapters took 6.949424743652344 ms to run.
current batch size: 18 token used ratio: 0.10733846153846154
cost offload scan: 0.087738037109375
offload 1 adapters, 15 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.6003379821777344 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 16 in total
Function load_lora_A took 3.2722949981689453 ms to run.
Function load_lora_B took 3.2753944396972656 ms to run.
cost realload: 6.945371627807617
Function load_adapters took 6.966352462768555 ms to run.
cost load scan: 0.011920928955078125
load 2 adapters, 18 in total
Function load_lora_A took 3.274679183959961 ms to run.
Function load_lora_B took 3.2100677490234375 ms to run.
Function load_lora_A took 3.2243728637695312 ms to run.
Function load_lora_B took 3.245115280151367 ms to run.
cost realload: 13.45062255859375
Function load_adapters took 13.474464416503906 ms to run.
cost offload scan: 0.09465217590332031
offload 1 adapters, 17 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5958080291748047 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 16 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.5939006805419922 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 15 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11706352233886719
Function offload_adapters took 0.6005764007568359 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 15 in total
cost realload: 0.29921531677246094
Function load_adapters took 0.3237724304199219 ms to run.
offload 0 adapters, 15 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 14 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.5977153778076172 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 14 in total
cost realload: 0.3008842468261719
Function load_adapters took 0.32520294189453125 ms to run.
current batch size: 17 token used ratio: 0.09581538461538462
cost load scan: 0.009298324584960938
load 1 adapters, 15 in total
Function load_lora_A took 3.2911300659179688 ms to run.
Function load_lora_B took 3.2761096954345703 ms to run.
cost realload: 6.981372833251953
Function load_adapters took 7.003545761108398 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 16 in total
Function load_lora_A took 3.2660961151123047 ms to run.
Function load_lora_B took 3.2622814178466797 ms to run.
cost realload: 6.958484649658203
Function load_adapters took 6.979465484619141 ms to run.
cost load scan: 0.015974044799804688
load 5 adapters, 21 in total
Function load_lora_A took 3.2346248626708984 ms to run.
Function load_lora_B took 3.2613277435302734 ms to run.
INFO:     127.0.0.1:58488 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58492 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58508 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58524 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58532 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58536 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58542 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58548 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58554 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58560 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58564 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58572 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58574 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58582 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58590 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58594 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58604 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58608 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58620 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58626 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 3.262042999267578 ms to run.
Function load_lora_B took 3.2498836517333984 ms to run.
Function load_lora_A took 3.2525062561035156 ms to run.
Function load_lora_B took 3.2529830932617188 ms to run.
Function load_lora_A took 3.2439231872558594 ms to run.
Function load_lora_B took 3.240346908569336 ms to run.
Function load_lora_A took 3.2160282135009766 ms to run.
Function load_lora_B took 3.268003463745117 ms to run.
cost realload: 33.21075439453125
Function load_adapters took 33.23197364807129 ms to run.
cost load scan: 0.012159347534179688
load 2 adapters, 23 in total
Function load_lora_A took 3.262758255004883 ms to run.
Function load_lora_B took 3.2587051391601562 ms to run.
Function load_lora_A took 3.2634735107421875 ms to run.
Function load_lora_B took 3.245115280151367 ms to run.
cost realload: 13.520240783691406
Function load_adapters took 13.542413711547852 ms to run.
offload 0 adapters, 23 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 22 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.029087066650390625
cost offload a_loc update: 0.11467933654785156
Function offload_adapters took 0.6146430969238281 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 21 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1239776611328125
Function offload_adapters took 0.6203651428222656 ms to run.
current batch size: 24 token used ratio: 0.1316
cost load scan: 0.00762939453125
load 0 adapters, 21 in total
cost realload: 0.3020763397216797
Function load_adapters took 0.32782554626464844 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 22 in total
Function load_lora_A took 3.267049789428711 ms to run.
Function load_lora_B took 3.250598907470703 ms to run.
cost realload: 6.933927536010742
Function load_adapters took 6.955623626708984 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 21 remains
cost offload cat: 0.03743171691894531
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.6089210510253906 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 22 in total
Function load_lora_A took 3.2351016998291016 ms to run.
Function load_lora_B took 3.267526626586914 ms to run.
cost realload: 6.921291351318359
Function load_adapters took 6.942987442016602 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 21 remains
cost offload cat: 0.03790855407714844
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.6117820739746094 ms to run.
current batch size: 24 token used ratio: 0.1383076923076923
cost offload scan: 0.09059906005859375
offload 1 adapters, 20 remains
cost offload cat: 0.03504753112792969
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.6113052368164062 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 21 in total
Function load_lora_A took 3.2591819763183594 ms to run.
Function load_lora_B took 3.2570362091064453 ms to run.
cost realload: 6.951570510864258
Function load_adapters took 6.974458694458008 ms to run.
cost load scan: 0.015497207641601562
load 3 adapters, 24 in total
Function load_lora_A took 3.2591819763183594 ms to run.
Function load_lora_B took 3.253936767578125 ms to run.
Function load_lora_A took 3.2317638397216797 ms to run.
Function load_lora_B took 3.2455921173095703 ms to run.
Function load_lora_A took 3.2711029052734375 ms to run.
Function load_lora_B took 3.2286643981933594 ms to run.
cost realload: 20.049095153808594
Function load_adapters took 20.070314407348633 ms to run.
cost offload scan: 0.091552734375
offload 1 adapters, 23 remains
cost offload cat: 0.03743171691894531
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11539459228515625
Function offload_adapters took 0.6244182586669922 ms to run.
cost offload scan: 0.09512901306152344
offload 1 adapters, 22 remains
cost offload cat: 0.03933906555175781
cost offload free mem manager: 0.047206878662109375
cost offload torch.empty: 0.024557113647460938
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.6334781646728516 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 21 remains
cost offload cat: 0.03838539123535156
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.6012916564941406 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 22 in total
Function load_lora_A took 3.2896995544433594 ms to run.
Function load_lora_B took 3.2482147216796875 ms to run.
cost realload: 6.9599151611328125
Function load_adapters took 6.989240646362305 ms to run.
cost offload scan: 0.09632110595703125
offload 1 adapters, 21 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11658668518066406
Function offload_adapters took 0.6246566772460938 ms to run.
cost load scan: 0.009775161743164062
load 1 adapters, 22 in total
Function load_lora_A took 3.2689571380615234 ms to run.
Function load_lora_B took 3.2601356506347656 ms to run.
cost realload: 6.946325302124023
Function load_adapters took 6.9675445556640625 ms to run.
current batch size: 25 token used ratio: 0.14018461538461538
cost load scan: 0.015020370483398438
load 3 adapters, 25 in total
Function load_lora_A took 3.2453536987304688 ms to run.
Function load_lora_B took 3.27301025390625 ms to run.
Function load_lora_A took 3.240823745727539 ms to run.
Function load_lora_B took 3.255128860473633 ms to run.
Function load_lora_A took 3.27301025390625 ms to run.
Function load_lora_B took 3.2579898834228516 ms to run.
cost realload: 20.133018493652344
Function load_adapters took 20.157814025878906 ms to run.
cost load scan: 0.012874603271484375
load 2 adapters, 27 in total
Function load_lora_A took 3.289937973022461 ms to run.
Function load_lora_B took 3.2501220703125 ms to run.
Function load_lora_A took 3.245830535888672 ms to run.
Function load_lora_B took 3.221750259399414 ms to run.
cost realload: 13.523340225219727
Function load_adapters took 13.545036315917969 ms to run.
offload 0 adapters, 27 remains
Function offload_adapters took 0.018596649169921875 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 26 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.12373924255371094
Function offload_adapters took 0.6268024444580078 ms to run.
cost load scan: 0.01239776611328125
load 2 adapters, 28 in total
Function load_lora_A took 3.2808780670166016 ms to run.
Function load_lora_B took 3.2334327697753906 ms to run.
Function load_lora_A took 3.252744674682617 ms to run.
Function load_lora_B took 3.2196044921875 ms to run.
cost realload: 13.48257064819336
Function load_adapters took 13.507366180419922 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 27 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.6144046783447266 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 26 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: INFO:     127.0.0.1:58642 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58648 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58656 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58672 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58682 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58690 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58700 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58706 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58710 - "POST /generate_stream HTTP/1.1" 200 OK
0.04506111145019531
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11444091796875
Function offload_adapters took 0.6556510925292969 ms to run.
current batch size: 28 token used ratio: 0.15612307692307692
cost offload scan: 0.09131431579589844
offload 1 adapters, 25 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.6127357482910156 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 24 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11181831359863281
Function offload_adapters took 0.6153583526611328 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 23 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5962848663330078 ms to run.
Avg tokens(prompt+generate) throughput: 1864.772 tokens/s
Avg prompt tokens throughput:           1042.137 tokens/s
Avg generate tokens throughput:          822.635 tokens/s
cost load scan: 0.014543533325195312
load 1 adapters, 24 in total
Function load_lora_A took 3.2808780670166016 ms to run.
Function load_lora_B took 3.270864486694336 ms to run.
cost realload: 6.995201110839844
Function load_adapters took 7.017374038696289 ms to run.
cost offload scan: 0.095367431640625
offload 1 adapters, 23 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.6093978881835938 ms to run.
cost offload scan: 0.09489059448242188
offload 1 adapters, 22 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.63323974609375 ms to run.
cost load scan: 0.012159347534179688
load 1 adapters, 23 in total
Function load_lora_A took 3.2567977905273438 ms to run.
Function load_lora_B took 3.2520294189453125 ms to run.
cost realload: 6.930351257324219
Function load_adapters took 6.951570510864258 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 22 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.6005764007568359 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 23 in total
Function load_lora_A took 3.2470226287841797 ms to run.
Function load_lora_B took 3.252267837524414 ms to run.
cost realload: 6.924867630004883
Function load_adapters took 6.946325302124023 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 22 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.6084442138671875 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.012636184692382812 ms to run.
current batch size: 24 token used ratio: 0.13110769230769231
cost load scan: 0.012636184692382812
load 1 adapters, 23 in total
Function load_lora_A took 3.245830535888672 ms to run.
Function load_lora_B took 3.236532211303711 ms to run.
cost realload: 6.902217864990234
Function load_adapters took 6.922483444213867 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 22 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.6144046783447266 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 21 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.6046295166015625 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 20 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5958080291748047 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 19 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.6110668182373047 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 18 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11777877807617188
Function offload_adapters took 0.6055831909179688 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 17 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.028371810913085938
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.5972385406494141 ms to run.
cost offload scan: 0.13208389282226562
offload 2 adapters, 15 remains
cost offload cat: 0.027418136596679688
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.6272792816162109 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 16 in total
Function load_lora_A took 3.266572952270508 ms to run.
Function load_lora_B took 3.2455921173095703 ms to run.
cost realload: 6.93964958190918
Function load_adapters took 6.96110725402832 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 15 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.6079673767089844 ms to run.
cost load scan: 0.014066696166992188
load 1 adapters, 16 in total
Function load_lora_A took 3.262042999267578 ms to run.
Function load_lora_B took 3.239154815673828 ms to run.
cost realload: 6.928205490112305
Function load_adapters took 6.950139999389648 ms to run.
current batch size: 18 token used ratio: 0.10164615384615384
cost load scan: 0.012159347534179688
load 1 adapters, 17 in total
Function load_lora_A took 3.2796859741210938 ms to run.
Function load_lora_B took 3.266572952270508 ms to run.
cost realload: 6.970405578613281
Function load_adapters took 6.992101669311523 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 18 in total
Function load_lora_A took 3.2830238342285156 ms to run.
Function load_lora_B took 3.231525421142578 ms to run.
cost realload: 6.927728652954102
Function load_adapters took 6.948709487915039 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.09489059448242188
offload 1 adapters, 17 remains
cost offload cat: 0.037670135498046875
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11467933654785156
Function offload_adapters took 0.6201267242431641 ms to run.
current batch size: 17 token used ratio: 0.09664615384615384
cost offload scan: 0.08797645568847656
offload 1 adapters, 16 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11467933654785156
INFO:     127.0.0.1:58716 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58726 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58728 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58738 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58748 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58764 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58768 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54010 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54020 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54022 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54030 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54040 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54056 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54062 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54072 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54080 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54086 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54092 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54098 - "POST /generate_stream HTTP/1.1" 200 OK
Function offload_adapters took 0.6082057952880859 ms to run.
cost load scan: 0.013828277587890625
load 1 adapters, 17 in total
Function load_lora_A took 3.2753944396972656 ms to run.
Function load_lora_B took 3.2663345336914062 ms to run.
cost realload: 6.977081298828125
Function load_adapters took 6.998300552368164 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 18 in total
Function load_lora_A took 3.268718719482422 ms to run.
Function load_lora_B took 3.2498836517333984 ms to run.
cost realload: 6.951570510864258
Function load_adapters took 6.973028182983398 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 17 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.6015300750732422 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 16 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.5984306335449219 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 16 in total
cost realload: 0.31185150146484375
Function load_adapters took 0.335693359375 ms to run.
current batch size: 17 token used ratio: 0.09512307692307692
cost offload scan: 0.08845329284667969
offload 1 adapters, 15 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11181831359863281
Function offload_adapters took 0.6055831909179688 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 16 in total
Function load_lora_A took 3.272533416748047 ms to run.
Function load_lora_B took 3.2219886779785156 ms to run.
cost realload: 6.917476654052734
Function load_adapters took 6.938695907592773 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 15 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.606536865234375 ms to run.
cost offload scan: 0.08463859558105469
offload 1 adapters, 14 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.5953311920166016 ms to run.
cost load scan: 0.010967254638671875
load 2 adapters, 16 in total
Function load_lora_A took 3.269672393798828 ms to run.
Function load_lora_B took 3.271818161010742 ms to run.
Function load_lora_A took 3.2281875610351562 ms to run.
Function load_lora_B took 3.2579898834228516 ms to run.
cost realload: 13.540267944335938
Function load_adapters took 13.562679290771484 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 15 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.6012916564941406 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 14 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.6020069122314453 ms to run.
cost load scan: 0.01430511474609375
load 3 adapters, 17 in total
Function load_lora_A took 3.24249267578125 ms to run.
Function load_lora_B took 3.24249267578125 ms to run.
Function load_lora_A took 3.2660961151123047 ms to run.
Function load_lora_B took 3.2646656036376953 ms to run.
Function load_lora_A took 3.2286643981933594 ms to run.
Function load_lora_B took 3.2215118408203125 ms to run.
cost realload: 20.030975341796875
Function load_adapters took 20.05314826965332 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 18 in total
Function load_lora_A took 3.266572952270508 ms to run.
Function load_lora_B took 3.2570362091064453 ms to run.
cost realload: 6.933927536010742
Function load_adapters took 6.954669952392578 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 17 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.6041526794433594 ms to run.
current batch size: 19 token used ratio: 0.09201538461538461
cost load scan: 0.008106231689453125
load 1 adapters, 18 in total
Function load_lora_A took 3.2587051391601562 ms to run.
Function load_lora_B took 3.245830535888672 ms to run.
cost realload: 6.929159164428711
Function load_adapters took 6.951093673706055 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 17 remains
cost offload cat: 0.03910064697265625
cost offload free mem manager: 0.047206878662109375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1163482666015625
Function offload_adapters took 0.6220340728759766 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 16 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.052928924560546875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.6074905395507812 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 17 in total
Function load_lora_A took 3.262042999267578 ms to run.
Function load_lora_B took 3.2546520233154297 ms to run.
cost realload: 6.949186325073242
Function load_adapters took 6.970643997192383 ms to run.
cost load scan: 0.011205673217773438
load 2 adapters, 19 in total
Function load_lora_A took 3.2384395599365234 ms to run.
Function load_lora_B took 3.2799243927001953 ms to run.
Function load_lora_A took 3.2525062561035156 ms to run.
Function load_lora_B took 3.2536983489990234 ms to run.
cost realload: 13.512372970581055
Function load_adapters took 13.533353805541992 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 18 remains
cost offload cat: 0.03504753112792969
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.6043910980224609 ms to run.
current batch size: 20 token used ratio: 0.09835384615384615
cost load scan: 0.011205673217773438
load 1 adapters, 19 in total
Function load_lora_A took 3.2656192779541016 ms to run.
Function load_lora_B took 3.2567977905273438 ms to run.
cost realload: 6.951332092285156
Function load_adapters took 6.972312927246094 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 18 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.12063980102539062
Function offload_adapters took 0.6120204925537109 ms to run.
cost load scan: 0.019311904907226562
load 1 adapters, 19 in total
Function load_lora_A took 3.264188766479492 ms to run.
Function load_lora_B took 3.2227039337158203 ms to run.
cost realload: 6.917476654052734
Function load_adapters took 6.93964958190918 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 18 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.0514984130859375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.6101131439208984 ms to run.
cost offload scan: 0.09584426879882812
offload 1 adapters, 17 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.05269050598144531
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.6177425384521484 ms to run.
cost load scan: 0.017404556274414062INFO:     127.0.0.1:54112 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54128 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54140 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54150 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54164 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54168 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54170 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54176 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54192 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54206 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54218 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54222 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54236 - "POST /generate_stream HTTP/1.1" 200 OK

load 2 adapters, 19 in total
Function load_lora_A took 3.264188766479492 ms to run.
Function load_lora_B took 3.238677978515625 ms to run.
Function load_lora_A took 3.245115280151367 ms to run.
Function load_lora_B took 3.2622814178466797 ms to run.
cost realload: 13.510704040527344
Function load_adapters took 13.531208038330078 ms to run.
cost offload scan: 0.1308917999267578
offload 2 adapters, 17 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1201629638671875
Function offload_adapters took 0.6480216979980469 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 16 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.6070137023925781 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 17 in total
Function load_lora_A took 3.2498836517333984 ms to run.
Function load_lora_B took 3.255128860473633 ms to run.
cost realload: 6.926774978637695
Function load_adapters took 6.949186325073242 ms to run.
current batch size: 19 token used ratio: 0.09103076923076923
offload 0 adapters, 17 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 17 in total
cost realload: 0.31828880310058594
Function load_adapters took 0.34308433532714844 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 16 remains
cost offload cat: 0.037670135498046875
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.6127357482910156 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 17 in total
Function load_lora_A took 3.278017044067383 ms to run.
Function load_lora_B took 3.261566162109375 ms to run.
cost realload: 6.950616836547852
Function load_adapters took 6.972074508666992 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 16 remains
cost offload cat: 0.03743171691894531
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.6165504455566406 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 15 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.6020069122314453 ms to run.
cost load scan: 0.015020370483398438
load 1 adapters, 16 in total
Function load_lora_A took 3.281831741333008 ms to run.
Function load_lora_B took 3.2706260681152344 ms to run.
cost realload: 6.966352462768555
Function load_adapters took 6.986141204833984 ms to run.
current batch size: 18 token used ratio: 0.09173846153846153
offload 0 adapters, 16 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 15 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5958080291748047 ms to run.
cost load scan: 0.012159347534179688
load 2 adapters, 17 in total
Function load_lora_A took 3.2193660736083984 ms to run.
Function load_lora_B took 3.2455921173095703 ms to run.
Function load_lora_A took 3.245115280151367 ms to run.
Function load_lora_B took 3.201723098754883 ms to run.
cost realload: 13.40341567993164
Function load_adapters took 13.424873352050781 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 18 in total
Function load_lora_A took 3.273487091064453 ms to run.
Function load_lora_B took 3.261089324951172 ms to run.
cost realload: 6.964683532714844
Function load_adapters took 6.986141204833984 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 17 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.029325485229492188
cost offload a_loc update: 0.11181831359863281
Function offload_adapters took 0.6024837493896484 ms to run.
Avg tokens(prompt+generate) throughput: 1546.532 tokens/s
Avg prompt tokens throughput:            806.174 tokens/s
Avg generate tokens throughput:          740.358 tokens/s
cost offload scan: 0.08678436279296875
offload 1 adapters, 16 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.5946159362792969 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 15 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5931854248046875 ms to run.
current batch size: 16 token used ratio: 0.08698461538461538
cost load scan: 0.011205673217773438
load 1 adapters, 16 in total
Function load_lora_A took 3.24249267578125 ms to run.
Function load_lora_B took 3.268718719482422 ms to run.
cost realload: 6.936550140380859
Function load_adapters took 6.9580078125 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 17 in total
Function load_lora_A took 3.2706260681152344 ms to run.
Function load_lora_B took 3.245830535888672 ms to run.
cost realload: 6.932258605957031
Function load_adapters took 6.953239440917969 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 16 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.6048679351806641 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 16 in total
cost realload: 0.3135204315185547
Function load_adapters took 0.33783912658691406 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 15 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.5893707275390625 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 14 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.5934238433837891 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 15 in total
Function load_lora_A took 3.240823745727539 ms to run.
Function load_lora_B took 3.242015838623047 ms to run.
cost realload: 6.905317306518555
Function load_adapters took 6.926298141479492 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 14 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.5931854248046875 ms to run.
current batch size: 16 token used ratio: 0.08355384615384616
cost load scan: 0.008344650268554688
load 1 adapters, 15 in total
Function load_lora_A took 3.244161605834961 ms to run.
Function load_lora_B took 3.2529830932617188 ms to run.
cost realload: 6.906270980834961
Function load_adapters took 6.927013397216797 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 14 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11682510375976562
Function offload_adapters took 0.5948543548583984 ms to run.
offload 0 adapters, 14 remains
INFO:     127.0.0.1:54250 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54266 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54276 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54278 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54288 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54298 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54308 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54316 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54320 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44450 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44460 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44474 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44486 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44490 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44494 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44496 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44498 - "POST /generate_stream HTTP/1.1" 200 OK
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 15 in total
Function load_lora_A took 3.2956600189208984 ms to run.
Function load_lora_B took 3.2358169555664062 ms to run.
cost realload: 6.95490837097168
Function load_adapters took 6.976127624511719 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 15 in total
cost realload: 0.2918243408203125
Function load_adapters took 0.3159046173095703 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 14 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.051975250244140625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.5986690521240234 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 13 remains
cost offload cat: 0.03933906555175781
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5915164947509766 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 12 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5738735198974609 ms to run.
offload 0 adapters, 12 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 12 in total
cost realload: 0.301361083984375
Function load_adapters took 0.32520294189453125 ms to run.
current batch size: 14 token used ratio: 0.0664923076923077
cost offload scan: 0.087738037109375
offload 1 adapters, 11 remains
cost offload cat: 0.03695487976074219
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.6060600280761719 ms to run.
cost offload scan: 0.08368492126464844
offload 1 adapters, 10 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5767345428466797 ms to run.
offload 0 adapters, 10 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 11 in total
Function load_lora_A took 3.2961368560791016 ms to run.
Function load_lora_B took 3.2587051391601562 ms to run.
cost realload: 6.989240646362305
Function load_adapters took 7.010698318481445 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 12 in total
Function load_lora_A took 3.2722949981689453 ms to run.
Function load_lora_B took 3.236055374145508 ms to run.
cost realload: 6.923913955688477
Function load_adapters took 6.944894790649414 ms to run.
current batch size: 13 token used ratio: 0.06547692307692307
cost load scan: 0.008821487426757812
load 1 adapters, 13 in total
Function load_lora_A took 3.2951831817626953 ms to run.
Function load_lora_B took 3.2477378845214844 ms to run.
cost realload: 6.970405578613281
Function load_adapters took 6.991863250732422 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 12 remains
cost offload cat: 0.03504753112792969
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.6010532379150391 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 11 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5841255187988281 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 12 in total
Function load_lora_A took 3.246307373046875 ms to run.
Function load_lora_B took 3.2482147216796875 ms to run.
cost realload: 6.894826889038086
Function load_adapters took 6.916284561157227 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 11 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.6041526794433594 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 12 in total
Function load_lora_A took 3.2646656036376953 ms to run.
Function load_lora_B took 3.2291412353515625 ms to run.
cost realload: 6.9103240966796875
Function load_adapters took 6.932258605957031 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 13 in total
Function load_lora_A took 3.2377243041992188 ms to run.
Function load_lora_B took 3.2660961151123047 ms to run.
cost realload: 6.934881210327148
Function load_adapters took 6.956815719604492 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 12 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.5955696105957031 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 13 in total
Function load_lora_A took 3.2651424407958984 ms to run.
Function load_lora_B took 3.2501220703125 ms to run.
cost realload: 6.929874420166016
Function load_adapters took 6.951570510864258 ms to run.
current batch size: 14 token used ratio: 0.06849230769230769
cost offload scan: 0.08630752563476562
offload 1 adapters, 12 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5955696105957031 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 13 in total
Function load_lora_A took 3.2591819763183594 ms to run.
Function load_lora_B took 3.2510757446289062 ms to run.
cost realload: 6.927728652954102
Function load_adapters took 6.948947906494141 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 14 in total
Function load_lora_A took 3.2677650451660156 ms to run.
Function load_lora_B took 3.238201141357422 ms to run.
cost realload: 6.922006607055664
Function load_adapters took 6.942987442016602 ms to run.
cost load scan: 0.014781951904296875
load 2 adapters, 16 in total
Function load_lora_A took 3.2498836517333984 ms to run.
Function load_lora_B took 3.2541751861572266 ms to run.
Function load_lora_A took 3.2396316528320312 ms to run.
Function load_lora_B took 3.2401084899902344 ms to run.
cost realload: 13.480424880981445
Function load_adapters took 13.502836227416992 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 15 remains
cost offload cat: 0.037670135498046875
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11754035949707031
Function offload_adapters took 0.6086826324462891 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 16 in total
Function load_lora_A took 3.2622814178466797 ms to run.
Function load_lora_B took 3.237485885620117 ms to run.
cost realload: 6.906270980834961
Function load_adapters took 6.927490234375 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 15 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5903244018554688 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 14 remains
cost offload cat: 0.04172325134277344
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6186962127685547 ms to run.
current batch size: 16 token used ratio: INFO:     127.0.0.1:44500 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44516 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44526 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44530 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44538 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44540 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44546 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44562 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44578 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44588 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44596 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44610 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44620 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44636 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44646 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44660 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44666 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44674 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44688 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44704 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44706 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44716 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44730 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44734 - "POST /generate_stream HTTP/1.1" 200 OK
0.08216923076923077
cost load scan: 0.01239776611328125
load 1 adapters, 15 in total
Function load_lora_A took 3.2465457916259766 ms to run.
Function load_lora_B took 3.2796859741210938 ms to run.
cost realload: 6.969451904296875
Function load_adapters took 6.99162483215332 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 16 in total
Function load_lora_A took 3.2694339752197266 ms to run.
Function load_lora_B took 3.2584667205810547 ms to run.
cost realload: 6.966114044189453
Function load_adapters took 6.989240646362305 ms to run.
cost load scan: 0.013589859008789062
load 1 adapters, 17 in total
Function load_lora_A took 3.271341323852539 ms to run.
Function load_lora_B took 3.272533416748047 ms to run.
cost realload: 6.985902786254883
Function load_adapters took 7.007837295532227 ms to run.
cost load scan: 0.011920928955078125
load 2 adapters, 19 in total
Function load_lora_A took 3.2775402069091797 ms to run.
Function load_lora_B took 3.249645233154297 ms to run.
Function load_lora_A took 3.2672882080078125 ms to run.
Function load_lora_B took 3.244638442993164 ms to run.
cost realload: 13.554573059082031
Function load_adapters took 13.577938079833984 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 18 remains
cost offload cat: 0.03933906555175781
cost offload free mem manager: 0.049114227294921875
cost offload torch.empty: 0.028848648071289062
cost offload a_loc update: 0.12183189392089844
Function offload_adapters took 0.6430149078369141 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 19 in total
Function load_lora_A took 3.2677650451660156 ms to run.
Function load_lora_B took 3.2529830932617188 ms to run.
cost realload: 6.943702697753906
Function load_adapters took 6.964921951293945 ms to run.
current batch size: 21 token used ratio: 0.10995384615384615
cost load scan: 0.011444091796875
load 1 adapters, 20 in total
Function load_lora_A took 3.262042999267578 ms to run.
Function load_lora_B took 3.2699108123779297 ms to run.
cost realload: 6.971120834350586
Function load_adapters took 6.996393203735352 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 19 remains
cost offload cat: 0.04172325134277344
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11444091796875
Function offload_adapters took 0.6153583526611328 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 20 in total
Function load_lora_A took 3.2563209533691406 ms to run.
Function load_lora_B took 3.273487091064453 ms to run.
cost realload: 6.949186325073242
Function load_adapters took 6.970882415771484 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 19 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.60272216796875 ms to run.
cost load scan: 0.014066696166992188
load 4 adapters, 23 in total
Function load_lora_A took 3.22723388671875 ms to run.
Function load_lora_B took 3.2739639282226562 ms to run.
Function load_lora_A took 3.256082534790039 ms to run.
Function load_lora_B took 3.2286643981933594 ms to run.
Function load_lora_A took 3.2329559326171875 ms to run.
Function load_lora_B took 3.263235092163086 ms to run.
Function load_lora_A took 3.247976303100586 ms to run.
Function load_lora_B took 3.265380859375 ms to run.
cost realload: 26.635408401489258
Function load_adapters took 26.6568660736084 ms to run.
cost load scan: 0.014781951904296875
load 2 adapters, 25 in total
Function load_lora_A took 3.248453140258789 ms to run.
Function load_lora_B took 3.2317638397216797 ms to run.
Function load_lora_A took 3.240346908569336 ms to run.
Function load_lora_B took 3.2377243041992188 ms to run.
cost realload: 13.456344604492188
Function load_adapters took 13.477325439453125 ms to run.
cost offload scan: 0.09441375732421875
offload 1 adapters, 24 remains
cost offload cat: 0.04267692565917969
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1163482666015625
Function offload_adapters took 0.6198883056640625 ms to run.
current batch size: 26 token used ratio: 0.14406153846153846
offload 0 adapters, 24 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.015974044799804688
load 3 adapters, 27 in total
Function load_lora_A took 3.2422542572021484 ms to run.
Function load_lora_B took 3.219127655029297 ms to run.
Function load_lora_A took 3.2439231872558594 ms to run.
Function load_lora_B took 3.2379627227783203 ms to run.
Function load_lora_A took 3.2639503479003906 ms to run.
Function load_lora_B took 3.2646656036376953 ms to run.
cost realload: 20.037174224853516
Function load_adapters took 20.058631896972656 ms to run.
cost load scan: 0.0152587890625
load 3 adapters, 30 in total
Function load_lora_A took 3.277301788330078 ms to run.
Function load_lora_B took 3.2668113708496094 ms to run.
Function load_lora_A took 3.2804012298583984 ms to run.
Function load_lora_B took 3.278017044067383 ms to run.
Function load_lora_A took 3.264904022216797 ms to run.
Function load_lora_B took 3.2150745391845703 ms to run.
cost realload: 20.16901969909668
Function load_adapters took 20.192384719848633 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 31 in total
Function load_lora_A took 3.2737255096435547 ms to run.
Function load_lora_B took 3.2405853271484375 ms to run.
cost realload: 6.937742233276367
Function load_adapters took 6.958246231079102 ms to run.
cost load scan: 0.015497207641601562
load 2 adapters, 33 in total
Function load_lora_A took 3.257274627685547 ms to run.
Function load_lora_B took 3.2455921173095703 ms to run.
Function load_lora_A took 3.2486915588378906 ms to run.
Function load_lora_B took 3.2372474670410156 ms to run.
cost realload: 13.497114181518555
Function load_adapters took 13.518571853637695 ms to run.
Avg tokens(prompt+generate) throughput: 1779.872 tokens/s
Avg prompt tokens throughput:           1124.713 tokens/s
Avg generate tokens throughput:          655.159 tokens/s
cost offload scan: 0.09822845458984375
offload 1 adapters, 32 remains
cost offload cat: 0.03719329833984375
cost offload free mem manager: 0.052928924560546875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11563301086425781
Function offload_adapters took 0.6310939788818359 ms to run.
current batch size: 33 token used ratio: 0.1891076923076923
cost offload scan: 0.09751319885253906
offload 1 adapters, 31 remains
cost offload cat: 0.036716461181640625
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11467933654785156
Function offload_adapters took 0.6361007690429688 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 32 in total
Function load_lora_A took 3.255128860473633 ms to run.
Function load_lora_B took 3.2227039337158203 ms to run.
cost realload: 6.919384002685547
Function load_adapters took 6.941318511962891 ms to run.
cost offload scan: 0.09655952453613281
offload 1 adapters, 31 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.12254714965820312
Function offload_adapters took 0.6284713745117188 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 30 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.05841255187988281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11610984802246094
Function offload_adapters took 0.6368160247802734 ms to run.
cost offload scan: 0.1392364501953125
offload 2 adapters, 28 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.04744529724121094
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.6597042083740234 ms to run.
cost load scan: 0.011682510375976562
INFO:     127.0.0.1:44748 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44760 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44776 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44790 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44794 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44808 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44822 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44826 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44832 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44848 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44862 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44876 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:44884 - "POST /generate_stream HTTP/1.1" 200 OK
load 1 adapters, 29 in total
Function load_lora_A took 3.2672882080078125 ms to run.
Function load_lora_B took 3.2432079315185547 ms to run.
cost realload: 6.949424743652344
Function load_adapters took 6.97016716003418 ms to run.
cost offload scan: 0.09369850158691406
offload 1 adapters, 28 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6091594696044922 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 27 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.6084442138671875 ms to run.
cost load scan: 0.01239776611328125
load 1 adapters, 28 in total
Function load_lora_A took 3.258228302001953 ms to run.
Function load_lora_B took 3.2329559326171875 ms to run.
cost realload: 6.917238235473633
Function load_adapters took 6.939172744750977 ms to run.
current batch size: 29 token used ratio: 0.17498461538461538
cost load scan: 0.00762939453125
load 0 adapters, 28 in total
cost realload: 0.308990478515625
Function load_adapters took 0.33354759216308594 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 27 remains
cost offload cat: 0.03790855407714844
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.6148815155029297 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 26 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5974769592285156 ms to run.
cost load scan: 0.013828277587890625
load 1 adapters, 27 in total
Function load_lora_A took 3.2854080200195312 ms to run.
Function load_lora_B took 3.2765865325927734 ms to run.
cost realload: 6.989479064941406
Function load_adapters took 7.010459899902344 ms to run.
cost offload scan: 0.10037422180175781
offload 1 adapters, 26 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.614166259765625 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 25 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5962848663330078 ms to run.
cost offload scan: 0.0972747802734375
offload 1 adapters, 24 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11205673217773438
Function offload_adapters took 0.6177425384521484 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 25 in total
Function load_lora_A took 3.2644271850585938 ms to run.
Function load_lora_B took 3.2508373260498047 ms to run.
cost realload: 6.93202018737793
Function load_adapters took 6.9522857666015625 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 24 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.598907470703125 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 24 in total
cost realload: 0.2989768981933594
Function load_adapters took 0.3230571746826172 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 23 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.6058216094970703 ms to run.
cost offload scan: 0.09417533874511719
offload 1 adapters, 22 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.6139278411865234 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.012636184692382812 ms to run.
current batch size: 24 token used ratio: 0.1442
cost offload scan: 0.09274482727050781
offload 1 adapters, 21 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11038780212402344
Function offload_adapters took 0.6031990051269531 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 22 in total
Function load_lora_A took 3.274679183959961 ms to run.
Function load_lora_B took 3.2410621643066406 ms to run.
cost realload: 6.927728652954102
Function load_adapters took 6.947994232177734 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 21 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.6022453308105469 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 20 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.6017684936523438 ms to run.
cost offload scan: 0.1366138458251953
offload 2 adapters, 18 remains
cost offload cat: 0.025987625122070312
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.6434917449951172 ms to run.
cost load scan: 0.0152587890625
load 3 adapters, 21 in total
Function load_lora_A took 3.2372474670410156 ms to run.
Function load_lora_B took 3.2515525817871094 ms to run.
Function load_lora_A took 3.254413604736328 ms to run.
Function load_lora_B took 3.2796859741210938 ms to run.
Function load_lora_A took 3.234386444091797 ms to run.
Function load_lora_B took 3.2494068145751953 ms to run.
cost realload: 20.075321197509766
Function load_adapters took 20.096778869628906 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 22 in total
Function load_lora_A took 3.228902816772461 ms to run.
Function load_lora_B took 3.2422542572021484 ms to run.
cost realload: 6.906032562255859
Function load_adapters took 6.927967071533203 ms to run.
cost load scan: 0.012636184692382812
load 2 adapters, 24 in total
Function load_lora_A took 3.2961368560791016 ms to run.
Function load_lora_B took 3.2453536987304688 ms to run.
Function load_lora_A took 3.227710723876953 ms to run.
Function load_lora_B took 3.230571746826172 ms to run.
cost realload: 13.505220413208008
Function load_adapters took 13.527393341064453 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 23 remains
cost offload cat: 0.04363059997558594
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11682510375976562
Function offload_adapters took 0.6256103515625 ms to run.
cost load scan: 0.01430511474609375
load 1 adapters, 24 in total
Function load_lora_A took 3.2503604888916016 ms to run.
Function load_lora_B took 3.269672393798828 ms to run.
cost realload: 6.947040557861328
Function load_adapters took 6.967782974243164 ms to run.
current batch size: 26 token used ratio: 0.14884615384615385
cost offload scan: 0.091552734375
offload 1 adapters, 23 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11587142944335938
INFO:     127.0.0.1:44900 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46166 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46178 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46190 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46204 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46208 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46210 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46220 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46226 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46232 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46236 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46246 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46260 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46274 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46290 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46300 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46314 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46324 - "POST /generate_stream HTTP/1.1" 200 OK
Function offload_adapters took 0.6155967712402344 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 24 in total
Function load_lora_A took 3.2949447631835938 ms to run.
Function load_lora_B took 3.2575130462646484 ms to run.
cost realload: 6.97636604309082
Function load_adapters took 6.9980621337890625 ms to run.
offload 0 adapters, 24 remains
Function offload_adapters took 0.013113021850585938 ms to run.
offload 0 adapters, 24 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost offload scan: 0.09584426879882812
offload 1 adapters, 23 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.118255615234375
Function offload_adapters took 0.629425048828125 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 22 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.029325485229492188
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.6062984466552734 ms to run.
cost offload scan: 0.09441375732421875
offload 1 adapters, 21 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11181831359863281
Function offload_adapters took 0.6127357482910156 ms to run.
current batch size: 21 token used ratio: 0.13101538461538462
cost offload scan: 0.09083747863769531
offload 1 adapters, 20 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.6048679351806641 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 19 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.6082057952880859 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 20 in total
Function load_lora_A took 3.2608509063720703 ms to run.
Function load_lora_B took 3.25775146484375 ms to run.
cost realload: 6.953001022338867
Function load_adapters took 6.974935531616211 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 21 in total
Function load_lora_A took 3.2608509063720703 ms to run.
Function load_lora_B took 3.258228302001953 ms to run.
cost realload: 6.952762603759766
Function load_adapters took 6.974220275878906 ms to run.
cost load scan: 0.01430511474609375
load 2 adapters, 23 in total
Function load_lora_A took 3.238201141357422 ms to run.
Function load_lora_B took 3.245830535888672 ms to run.
Function load_lora_A took 3.268718719482422 ms to run.
Function load_lora_B took 3.2546520233154297 ms to run.
cost realload: 13.503074645996094
Function load_adapters took 13.526439666748047 ms to run.
cost offload scan: 0.13065338134765625
offload 2 adapters, 21 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11920928955078125
Function offload_adapters took 0.6580352783203125 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 20 remains
cost offload cat: 0.03647804260253906
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11444091796875
Function offload_adapters took 0.6167888641357422 ms to run.
cost offload scan: 0.09393692016601562
offload 1 adapters, 19 remains
cost offload cat: 0.039577484130859375
cost offload free mem manager: 0.04696846008300781
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.6203651428222656 ms to run.
cost load scan: 0.01430511474609375
load 1 adapters, 20 in total
Function load_lora_A took 3.2405853271484375 ms to run.
Function load_lora_B took 3.2813549041748047 ms to run.
cost realload: 6.929159164428711
Function load_adapters took 6.950139999389648 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 19 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.5939006805419922 ms to run.
current batch size: 20 token used ratio: 0.11161538461538462
cost offload scan: 0.0858306884765625
offload 1 adapters, 18 remains
cost offload cat: 0.03910064697265625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5905628204345703 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 19 in total
Function load_lora_A took 3.289937973022461 ms to run.
Function load_lora_B took 3.2491683959960938 ms to run.
cost realload: 6.959199905395508
Function load_adapters took 6.980657577514648 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 18 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.6110668182373047 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 17 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.6074905395507812 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 18 in total
Function load_lora_A took 3.2761096954345703 ms to run.
Function load_lora_B took 3.271341323852539 ms to run.
cost realload: 6.951808929443359
Function load_adapters took 6.972312927246094 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 17 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.5979537963867188 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 16 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.05054473876953125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.6039142608642578 ms to run.
cost offload scan: 0.09369850158691406
offload 1 adapters, 15 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.6010532379150391 ms to run.
cost load scan: 0.00858306884765625
load 0 adapters, 15 in total
cost realload: 0.29349327087402344
Function load_adapters took 0.3161430358886719 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 16 in total
Function load_lora_A took 3.206491470336914 ms to run.
Function load_lora_B took 3.234386444091797 ms to run.
cost realload: 6.860494613647461
Function load_adapters took 6.881475448608398 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 15 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.5991458892822266 ms to run.
current batch size: 18 token used ratio: 0.10066153846153846
cost load scan: 0.011444091796875
load 1 adapters, 16 in total
Function load_lora_A took 3.2570362091064453 ms to run.
Function load_lora_B took 3.2682418823242188 ms to run.
cost realload: 6.968259811401367
Function load_adapters took 6.989240646362305 ms to run.
offload 0 adapters, 16 remains
Function offload_adapters took 0.011920928955078125 ms to run.
INFO:     127.0.0.1:46340 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46356 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46370 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46378 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46390 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46396 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46410 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46418 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46426 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46432 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46448 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46458 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46466 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46480 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46488 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46496 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46506 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46522 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46526 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46534 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46548 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46556 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46566 - "POST /generate_stream HTTP/1.1" 200 OK
cost load scan: 0.0095367431640625
load 2 adapters, 18 in total
Function load_lora_A took 3.2520294189453125 ms to run.
Function load_lora_B took 3.2405853271484375 ms to run.
Function load_lora_A took 3.260374069213867 ms to run.
Function load_lora_B took 3.2308101654052734 ms to run.
cost realload: 13.501167297363281
Function load_adapters took 13.522863388061523 ms to run.
cost load scan: 0.0095367431640625
load 2 adapters, 20 in total
Function load_lora_A took 3.264188766479492 ms to run.
Function load_lora_B took 3.2613277435302734 ms to run.
Function load_lora_A took 3.272533416748047 ms to run.
Function load_lora_B took 3.2422542572021484 ms to run.
cost realload: 13.528108596801758
Function load_adapters took 13.556241989135742 ms to run.
cost load scan: 0.012159347534179688
load 1 adapters, 21 in total
Function load_lora_A took 3.2265186309814453 ms to run.
Function load_lora_B took 3.249645233154297 ms to run.
cost realload: 6.905078887939453
Function load_adapters took 6.925821304321289 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 20 remains
cost offload cat: 0.03552436828613281
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11944770812988281
Function offload_adapters took 0.6129741668701172 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.012874603271484375 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.0095367431640625
load 2 adapters, 22 in total
Function load_lora_A took 3.2753944396972656 ms to run.
Function load_lora_B took 3.2286643981933594 ms to run.
Function load_lora_A took 3.236055374145508 ms to run.
Function load_lora_B took 3.2765865325927734 ms to run.
cost realload: 13.496875762939453
Function load_adapters took 13.51785659790039 ms to run.
cost offload scan: 0.09799003601074219
offload 1 adapters, 21 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.6041526794433594 ms to run.
current batch size: 24 token used ratio: 0.12173846153846155
cost offload scan: 0.08940696716308594
offload 1 adapters, 20 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.028371810913085938
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.6079673767089844 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 19 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.11539459228515625
Function offload_adapters took 0.6132125854492188 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 20 in total
Function load_lora_A took 3.2625198364257812 ms to run.
Function load_lora_B took 3.2885074615478516 ms to run.
cost realload: 6.9732666015625
Function load_adapters took 6.995677947998047 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 19 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5891323089599609 ms to run.
cost load scan: 0.012636184692382812
load 2 adapters, 21 in total
Function load_lora_A took 3.259897232055664 ms to run.
Function load_lora_B took 3.254413604736328 ms to run.
Function load_lora_A took 3.245830535888672 ms to run.
Function load_lora_B took 3.2362937927246094 ms to run.
cost realload: 13.48876953125
Function load_adapters took 13.510704040527344 ms to run.
cost load scan: 0.01621246337890625
load 2 adapters, 23 in total
Function load_lora_A took 3.281116485595703 ms to run.
Function load_lora_B took 3.276824951171875 ms to run.
Function load_lora_A took 3.2520294189453125 ms to run.
Function load_lora_B took 3.2613277435302734 ms to run.
cost realload: 13.573646545410156
Function load_adapters took 13.59701156616211 ms to run.
Avg tokens(prompt+generate) throughput: 1964.285 tokens/s
Avg prompt tokens throughput:           1064.769 tokens/s
Avg generate tokens throughput:          899.515 tokens/s
cost load scan: 0.008344650268554688
load 1 adapters, 24 in total
Function load_lora_A took 3.259897232055664 ms to run.
Function load_lora_B took 3.247976303100586 ms to run.
cost realload: 6.928443908691406
Function load_adapters took 6.949901580810547 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 23 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.6089210510253906 ms to run.
current batch size: 25 token used ratio: 0.13044615384615385
cost load scan: 0.011205673217773438
load 1 adapters, 24 in total
Function load_lora_A took 3.2494068145751953 ms to run.
Function load_lora_B took 3.2570362091064453 ms to run.
cost realload: 6.924152374267578
Function load_adapters took 6.945133209228516 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 25 in total
Function load_lora_A took 3.262042999267578 ms to run.
Function load_lora_B took 3.2486915588378906 ms to run.
cost realload: 6.932735443115234
Function load_adapters took 6.953954696655273 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 24 remains
cost offload cat: 0.03552436828613281
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.6074905395507812 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 24 in total
cost realload: 0.3001689910888672
Function load_adapters took 0.32639503479003906 ms to run.
cost load scan: 0.0152587890625
load 2 adapters, 26 in total
Function load_lora_A took 3.263235092163086 ms to run.
Function load_lora_B took 3.265857696533203 ms to run.
Function load_lora_A took 3.2732486724853516 ms to run.
Function load_lora_B took 3.2553672790527344 ms to run.
cost realload: 13.578414916992188
Function load_adapters took 13.599634170532227 ms to run.
offload 0 adapters, 26 remains
Function offload_adapters took 0.01239776611328125 ms to run.
current batch size: 30 token used ratio: 0.1666923076923077
cost load scan: 0.0133514404296875
load 1 adapters, 27 in total
Function load_lora_A took 3.2660961151123047 ms to run.
Function load_lora_B took 3.2143592834472656 ms to run.
cost realload: 6.915092468261719
Function load_adapters took 6.937503814697266 ms to run.
cost load scan: 0.012636184692382812
load 2 adapters, 29 in total
Function load_lora_A took 3.270864486694336 ms to run.
Function load_lora_B took 3.2472610473632812 ms to run.
Function load_lora_A took 3.2732486724853516 ms to run.
Function load_lora_B took 3.2584667205810547 ms to run.
cost realload: 13.539314270019531
Function load_adapters took 13.560771942138672 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 28 remains
cost offload cat: 0.0362396240234375
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1163482666015625
Function offload_adapters took 0.6163120269775391 ms to run.
cost offload scan: 0.09870529174804688
offload 1 adapters, 27 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.6284713745117188 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 26 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11301040649414062
INFO:     127.0.0.1:46580 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46588 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46602 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46614 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46630 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46636 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46646 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46648 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46664 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46680 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37322 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37336 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37346 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37352 - "POST /generate_stream HTTP/1.1" 200 OK
Function offload_adapters took 0.6039142608642578 ms to run.
cost load scan: 0.008821487426757812
load 2 adapters, 28 in total
Function load_lora_A took 3.2601356506347656 ms to run.
Function load_lora_B took 3.2606124877929688 ms to run.
Function load_lora_A took 3.263235092163086 ms to run.
Function load_lora_B took 3.2308101654052734 ms to run.
cost realload: 13.49782943725586
Function load_adapters took 13.518333435058594 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 27 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.0286102294921875
cost offload a_loc update: 0.11181831359863281
Function offload_adapters took 0.6055831909179688 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 26 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.591278076171875 ms to run.
cost offload scan: 0.09584426879882812
offload 1 adapters, 25 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.6043910980224609 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 24 remains
cost offload cat: 0.03933906555175781
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.6046295166015625 ms to run.
offload 0 adapters, 24 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.09489059448242188
offload 1 adapters, 23 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.6115436553955078 ms to run.
current batch size: 26 token used ratio: 0.1472923076923077
cost load scan: 0.011205673217773438
load 1 adapters, 24 in total
Function load_lora_A took 3.2472610473632812 ms to run.
Function load_lora_B took 3.2262802124023438 ms to run.
cost realload: 6.90007209777832
Function load_adapters took 6.921529769897461 ms to run.
cost offload scan: 0.09799003601074219
offload 1 adapters, 23 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11181831359863281
Function offload_adapters took 0.6251335144042969 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 22 remains
cost offload cat: 0.03981590270996094
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.6096363067626953 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 23 in total
Function load_lora_A took 3.27301025390625 ms to run.
Function load_lora_B took 3.256559371948242 ms to run.
cost realload: 6.950139999389648
Function load_adapters took 6.970882415771484 ms to run.
cost load scan: 0.013828277587890625
load 1 adapters, 24 in total
Function load_lora_A took 3.2546520233154297 ms to run.
Function load_lora_B took 3.2465457916259766 ms to run.
cost realload: 6.919384002685547
Function load_adapters took 6.941318511962891 ms to run.
cost load scan: 0.011920928955078125
load 2 adapters, 26 in total
Function load_lora_A took 3.274679183959961 ms to run.
Function load_lora_B took 3.2472610473632812 ms to run.
Function load_lora_A took 3.238201141357422 ms to run.
Function load_lora_B took 3.22723388671875 ms to run.
cost realload: 13.486385345458984
Function load_adapters took 13.508319854736328 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 25 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11610984802246094
Function offload_adapters took 0.6220340728759766 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 24 remains
cost offload cat: 0.03910064697265625
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.6113052368164062 ms to run.
current batch size: 29 token used ratio: 0.15966153846153847
cost load scan: 0.008821487426757812
load 1 adapters, 25 in total
Function load_lora_A took 3.2796859741210938 ms to run.
Function load_lora_B took 3.2472610473632812 ms to run.
cost realload: 6.947755813598633
Function load_adapters took 6.969928741455078 ms to run.
cost offload scan: 0.1327991485595703
offload 2 adapters, 23 remains
cost offload cat: 0.027418136596679688
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.6413459777832031 ms to run.
offload 0 adapters, 23 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.09512901306152344
offload 1 adapters, 22 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.6151199340820312 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 23 in total
Function load_lora_A took 3.2236576080322266 ms to run.
Function load_lora_B took 3.238677978515625 ms to run.
cost realload: 6.879568099975586
Function load_adapters took 6.901025772094727 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 22 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11920928955078125
Function offload_adapters took 0.6113052368164062 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 21 remains
cost offload cat: 0.0400543212890625
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.6017684936523438 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 22 in total
Function load_lora_A took 3.264904022216797 ms to run.
Function load_lora_B took 3.233194351196289 ms to run.
cost realload: 6.920337677001953
Function load_adapters took 6.942987442016602 ms to run.
cost offload scan: 0.1289844512939453
offload 2 adapters, 20 remains
cost offload cat: 0.02765655517578125
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.6277561187744141 ms to run.
cost load scan: 0.014781951904296875
load 1 adapters, 21 in total
Function load_lora_A took 3.2432079315185547 ms to run.
Function load_lora_B took 3.208637237548828 ms to run.
cost realload: 6.87718391418457
Function load_adapters took 6.899118423461914 ms to run.
current batch size: 25 token used ratio: 0.13698461538461537
cost load scan: 0.009059906005859375
load 1 adapters, 22 in total
Function load_lora_A took 3.2575130462646484 ms to run.
Function load_lora_B took 3.2672882080078125 ms to run.
cost realload: 6.940364837646484
Function load_adapters took 6.961822509765625 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.0133514404296875 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 23 in total
Function load_lora_A took 3.2515525817871094 ms to run.
Function load_lora_B took 3.2758712768554688 ms to run.
cost realload: 6.9561004638671875
Function load_adapters took 6.978273391723633 ms to run.
offload 0 adapters, 23 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.09751319885253906
INFO:     127.0.0.1:37368 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37376 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37386 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37396 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37408 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37412 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37428 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37436 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37442 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37446 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37454 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37464 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37480 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37484 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37490 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37502 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37504 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37518 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37528 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37540 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37544 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37550 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37562 - "POST /generate_stream HTTP/1.1" 200 OK
offload 1 adapters, 22 remains
cost offload cat: 0.03719329833984375
cost offload free mem manager: 0.04744529724121094
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.6515979766845703 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 21 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.118255615234375
Function offload_adapters took 0.6029605865478516 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 20 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.047206878662109375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.6093978881835938 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 19 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.05125999450683594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.6022453308105469 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.01239776611328125 ms to run.
current batch size: 20 token used ratio: 0.11544615384615385
cost load scan: 0.00858306884765625
load 1 adapters, 20 in total
Function load_lora_A took 3.2286643981933594 ms to run.
Function load_lora_B took 3.247499465942383 ms to run.
cost realload: 6.906986236572266
Function load_adapters took 6.928443908691406 ms to run.
cost offload scan: 0.09560585021972656
offload 1 adapters, 19 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11539459228515625
Function offload_adapters took 0.6155967712402344 ms to run.
cost load scan: 0.01239776611328125
load 2 adapters, 21 in total
Function load_lora_A took 3.261566162109375 ms to run.
Function load_lora_B took 3.257274627685547 ms to run.
Function load_lora_A took 3.2813549041748047 ms to run.
Function load_lora_B took 3.2567977905273438 ms to run.
cost realload: 13.545989990234375
Function load_adapters took 13.566970825195312 ms to run.
cost load scan: 0.019550323486328125
load 5 adapters, 26 in total
Function load_lora_A took 3.2639503479003906 ms to run.
Function load_lora_B took 3.2815933227539062 ms to run.
Function load_lora_A took 3.2622814178466797 ms to run.
Function load_lora_B took 3.225564956665039 ms to run.
Function load_lora_A took 3.2715797424316406 ms to run.
Function load_lora_B took 3.2205581665039062 ms to run.
Function load_lora_A took 3.2329559326171875 ms to run.
Function load_lora_B took 3.2689571380615234 ms to run.
Function load_lora_A took 3.230571746826172 ms to run.
Function load_lora_B took 3.2236576080322266 ms to run.
cost realload: 33.20598602294922
Function load_adapters took 33.228397369384766 ms to run.
cost offload scan: 0.09775161743164062
offload 1 adapters, 25 remains
cost offload cat: 0.03647804260253906
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11658668518066406
Function offload_adapters took 0.6203651428222656 ms to run.
cost offload scan: 0.09584426879882812
offload 1 adapters, 24 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.028848648071289062
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.6165504455566406 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 25 in total
Function load_lora_A took 3.2591819763183594 ms to run.
Function load_lora_B took 3.262042999267578 ms to run.
cost realload: 6.932735443115234
Function load_adapters took 6.953954696655273 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 26 in total
Function load_lora_A took 3.252267837524414 ms to run.
Function load_lora_B took 3.2362937927246094 ms to run.
cost realload: 6.908893585205078
Function load_adapters took 6.931304931640625 ms to run.
current batch size: 29 token used ratio: 0.15406153846153847
cost load scan: 0.00762939453125
load 0 adapters, 26 in total
cost realload: 0.30994415283203125
Function load_adapters took 0.3337860107421875 ms to run.
cost offload scan: 0.091552734375
offload 1 adapters, 25 remains
cost offload cat: 0.0362396240234375
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11539459228515625
Function offload_adapters took 0.6237030029296875 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 24 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.6170272827148438 ms to run.
cost load scan: 0.009059906005859375
load 2 adapters, 26 in total
Function load_lora_A took 3.2460689544677734 ms to run.
Function load_lora_B took 3.225564956665039 ms to run.
Function load_lora_A took 3.268718719482422 ms to run.
Function load_lora_B took 3.2269954681396484 ms to run.
cost realload: 13.455867767333984
Function load_adapters took 13.477802276611328 ms to run.
cost offload scan: 0.133514404296875
offload 2 adapters, 24 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.12111663818359375
Function offload_adapters took 0.6577968597412109 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 23 remains
cost offload cat: 0.041961669921875
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.12159347534179688
Function offload_adapters took 0.6330013275146484 ms to run.
current batch size: 28 token used ratio: 0.15967692307692308
cost load scan: 0.00858306884765625
load 1 adapters, 24 in total
Function load_lora_A took 3.2601356506347656 ms to run.
Function load_lora_B took 3.2532215118408203 ms to run.
cost realload: 6.949186325073242
Function load_adapters took 6.970643997192383 ms to run.
offload 0 adapters, 24 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost offload scan: 0.09870529174804688
offload 1 adapters, 23 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11205673217773438
Function offload_adapters took 0.6167888641357422 ms to run.
cost load scan: 0.008344650268554688
load 2 adapters, 25 in total
Function load_lora_A took 3.240823745727539 ms to run.
Function load_lora_B took 3.2045841217041016 ms to run.
Function load_lora_A took 3.272533416748047 ms to run.
Function load_lora_B took 3.2312870025634766 ms to run.
cost realload: 13.41700553894043
Function load_adapters took 13.437271118164062 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 24 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.6029605865478516 ms to run.
cost offload scan: 0.09751319885253906
offload 1 adapters, 23 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11730194091796875
Function offload_adapters took 0.6263256072998047 ms to run.
cost load scan: 0.009059906005859375
load 2 adapters, 25 in total
Function load_lora_A took 3.2672882080078125 ms to run.
Function load_lora_B took 3.2341480255126953 ms to run.
Function load_lora_A took 3.273487091064453 ms to run.
Function load_lora_B took 3.2930374145507812 ms to run.
cost realload: 13.565301895141602
Function load_adapters took 13.587474822998047 ms to run.
INFO:     127.0.0.1:37572 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37580 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37588 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37604 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37606 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37622 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37630 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37646 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37652 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37664 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37680 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37696 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37706 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37712 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37720 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:37736 - "POST /generate_stream HTTP/1.1" 200 OK
Avg tokens(prompt+generate) throughput: 2201.696 tokens/s
Avg prompt tokens throughput:           1222.121 tokens/s
Avg generate tokens throughput:          979.575 tokens/s
cost offload scan: 0.09608268737792969
offload 1 adapters, 24 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.6237030029296875 ms to run.
offload 0 adapters, 24 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 23 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.5981922149658203 ms to run.
cost load scan: 0.009059906005859375
load 2 adapters, 25 in total
Function load_lora_A took 3.2525062561035156 ms to run.
Function load_lora_B took 3.2660961151123047 ms to run.
Function load_lora_A took 3.25775146484375 ms to run.
Function load_lora_B took 3.2682418823242188 ms to run.
cost realload: 13.529300689697266
Function load_adapters took 13.5498046875 ms to run.
cost offload scan: 0.1308917999267578
offload 2 adapters, 23 remains
cost offload cat: 0.026941299438476562
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.6468296051025391 ms to run.
cost offload scan: 0.09512901306152344
offload 1 adapters, 22 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04935264587402344
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11706352233886719
Function offload_adapters took 0.6213188171386719 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.012874603271484375 ms to run.
current batch size: 25 token used ratio: 0.13956923076923078
cost load scan: 0.008106231689453125
load 0 adapters, 22 in total
cost realload: 0.31304359436035156
Function load_adapters took 0.33783912658691406 ms to run.
cost offload scan: 0.09703636169433594
offload 1 adapters, 21 remains
cost offload cat: 0.03814697265625
cost offload free mem manager: 0.04982948303222656
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.12278556823730469
Function offload_adapters took 0.6411075592041016 ms to run.
cost load scan: 0.010013580322265625
load 1 adapters, 22 in total
Function load_lora_A took 3.256559371948242 ms to run.
Function load_lora_B took 3.2618045806884766 ms to run.
cost realload: 6.9427490234375
Function load_adapters took 6.964206695556641 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 21 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11944770812988281
Function offload_adapters took 0.6098747253417969 ms to run.
cost load scan: 0.012636184692382812
load 2 adapters, 23 in total
Function load_lora_A took 3.2312870025634766 ms to run.
Function load_lora_B took 3.2122135162353516 ms to run.
Function load_lora_A took 3.247499465942383 ms to run.
Function load_lora_B took 3.254413604736328 ms to run.
cost realload: 13.442039489746094
Function load_adapters took 13.464212417602539 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 22 remains
cost offload cat: 0.03647804260253906
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.6103515625 ms to run.
cost load scan: 0.011920928955078125
load 2 adapters, 24 in total
Function load_lora_A took 3.2405853271484375 ms to run.
Function load_lora_B took 3.2470226287841797 ms to run.
Function load_lora_A took 3.2651424407958984 ms to run.
Function load_lora_B took 3.2296180725097656 ms to run.
cost realload: 13.49186897277832
Function load_adapters took 13.513803482055664 ms to run.
current batch size: 28 token used ratio: 0.15269230769230768
cost offload scan: 0.09131431579589844
offload 1 adapters, 23 remains
cost offload cat: 0.03886222839355469
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11467933654785156
Function offload_adapters took 0.6215572357177734 ms to run.
offload 0 adapters, 23 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 23 in total
cost realload: 0.3173351287841797
Function load_adapters took 0.34332275390625 ms to run.
cost offload scan: 0.09059906005859375
offload 1 adapters, 22 remains
cost offload cat: 0.0362396240234375
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.6165504455566406 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 23 in total
Function load_lora_A took 3.267049789428711 ms to run.
Function load_lora_B took 3.224611282348633 ms to run.
cost realload: 6.942033767700195
Function load_adapters took 6.964206695556641 ms to run.
cost offload scan: 0.09679794311523438
offload 1 adapters, 22 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.6148815155029297 ms to run.
cost offload scan: 0.09584426879882812
offload 1 adapters, 21 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11181831359863281
Function offload_adapters took 0.6196498870849609 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 22 in total
Function load_lora_A took 3.2417774200439453 ms to run.
Function load_lora_B took 3.252267837524414 ms to run.
cost realload: 6.90460205078125
Function load_adapters took 6.924629211425781 ms to run.
current batch size: 26 token used ratio: 0.14864615384615384
cost offload scan: 0.08869171142578125
offload 1 adapters, 21 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5934238433837891 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 20 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.5950927734375 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost offload scan: 0.09942054748535156
offload 1 adapters, 19 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11563301086425781
Function offload_adapters took 0.6296634674072266 ms to run.
cost offload scan: 0.091552734375
offload 1 adapters, 18 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11873245239257812
Function offload_adapters took 0.6058216094970703 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 18 in total
cost realload: 0.3113746643066406
Function load_adapters took 0.33545494079589844 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 17 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: INFO:     127.0.0.1:37742 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43452 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43460 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43476 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43488 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43494 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43510 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43524 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43538 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43542 - "POST /generate_stream HTTP/1.1" 200 OK
0.022649765014648438
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.6475448608398438 ms to run.
cost load scan: 0.016927719116210938
load 3 adapters, 20 in total
Function load_lora_A took 3.247499465942383 ms to run.
Function load_lora_B took 3.244161605834961 ms to run.
Function load_lora_A took 3.2460689544677734 ms to run.
Function load_lora_B took 3.2787322998046875 ms to run.
Function load_lora_A took 3.2567977905273438 ms to run.
Function load_lora_B took 3.2410621643066406 ms to run.
cost realload: 20.08843421936035
Function load_adapters took 20.109891891479492 ms to run.
current batch size: 23 token used ratio: 0.13047692307692307
cost offload scan: 0.09059906005859375
offload 1 adapters, 19 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11849403381347656
Function offload_adapters took 0.6082057952880859 ms to run.
cost offload scan: 0.09393692016601562
offload 1 adapters, 18 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.6015300750732422 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 19 in total
Function load_lora_A took 3.2439231872558594 ms to run.
Function load_lora_B took 3.2372474670410156 ms to run.
cost realload: 6.891727447509766
Function load_adapters took 6.911993026733398 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.013589859008789062 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 18 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.6077289581298828 ms to run.
cost load scan: 0.0152587890625
load 1 adapters, 19 in total
Function load_lora_A took 3.2548904418945312 ms to run.
Function load_lora_B took 3.2737255096435547 ms to run.
cost realload: 6.945371627807617
Function load_adapters took 6.966590881347656 ms to run.
cost offload scan: 0.09632110595703125
offload 1 adapters, 18 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.6039142608642578 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 17 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11658668518066406
Function offload_adapters took 0.6060600280761719 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 16 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.6086826324462891 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 17 in total
Function load_lora_A took 3.2682418823242188 ms to run.
Function load_lora_B took 3.288745880126953 ms to run.
cost realload: 6.981372833251953
Function load_adapters took 7.004976272583008 ms to run.
current batch size: 19 token used ratio: 0.10404615384615384
cost offload scan: 0.1270771026611328
offload 2 adapters, 15 remains
cost offload cat: 0.028848648071289062
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.6382465362548828 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 16 in total
Function load_lora_A took 3.2930374145507812 ms to run.
Function load_lora_B took 3.2501220703125 ms to run.
cost realload: 6.959676742553711
Function load_adapters took 6.980657577514648 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 15 remains
cost offload cat: 0.0362396240234375
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.029802322387695312
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.6072521209716797 ms to run.
cost load scan: 0.01239776611328125
load 1 adapters, 16 in total
Function load_lora_A took 3.2341480255126953 ms to run.
Function load_lora_B took 3.283977508544922 ms to run.
cost realload: 6.93964958190918
Function load_adapters took 6.960630416870117 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 15 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.6029605865478516 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 14 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.05125999450683594
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.6110668182373047 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 13 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5958080291748047 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 14 in total
Function load_lora_A took 3.267049789428711 ms to run.
Function load_lora_B took 3.208637237548828 ms to run.
cost realload: 6.900310516357422
Function load_adapters took 6.921052932739258 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 15 in total
Function load_lora_A took 3.282308578491211 ms to run.
Function load_lora_B took 3.2563209533691406 ms to run.
cost realload: 6.964683532714844
Function load_adapters took 6.986856460571289 ms to run.
current batch size: 17 token used ratio: 0.09332307692307693
offload 0 adapters, 15 remains
Function offload_adapters took 0.012636184692382812 ms to run.
offload 0 adapters, 15 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 16 in total
Function load_lora_A took 3.257274627685547 ms to run.
Function load_lora_B took 3.2341480255126953 ms to run.
cost realload: 6.901741027832031
Function load_adapters took 6.926536560058594 ms to run.
cost offload scan: 0.1266002655029297
offload 2 adapters, 14 remains
cost offload cat: 0.026464462280273438
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.118255615234375
Function offload_adapters took 0.6372928619384766 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 13 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.6084442138671875 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 12 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.5962848663330078 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 13 in total
Function load_lora_A took 3.276348114013672 ms to run.
Function load_lora_B took 3.284931182861328 ms to run.
cost realload: 6.991147994995117
Function load_adapters took 7.012844085693359 ms to run.
current batch size: 13 token used ratio: 0.0658923076923077
cost load scan: 0.013828277587890625
load 1 adapters, 14 in total
Function load_lora_A took 3.2570362091064453 ms to run.
Function load_lora_B took 3.262758255004883 ms to run.
cost realload: 6.93964958190918
Function load_adapters took 6.960630416870117 ms to run.INFO:     127.0.0.1:43548 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43552 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43566 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43576 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43582 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43598 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43606 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43622 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43638 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43640 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43648 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43662 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43672 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43686 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43692 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43708 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43724 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43740 - "POST /generate_stream HTTP/1.1" 200 OK

cost load scan: 0.01239776611328125
load 1 adapters, 15 in total
Function load_lora_A took 3.2689571380615234 ms to run.
Function load_lora_B took 3.221750259399414 ms to run.
cost realload: 6.906986236572266
Function load_adapters took 6.927728652954102 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 14 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6110668182373047 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 13 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5998611450195312 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 14 in total
Function load_lora_A took 3.2656192779541016 ms to run.
Function load_lora_B took 3.2536983489990234 ms to run.
cost realload: 6.925821304321289
Function load_adapters took 6.947517395019531 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 13 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04458427429199219
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.5955696105957031 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 13 in total
cost realload: 0.3044605255126953
Function load_adapters took 0.3287792205810547 ms to run.
current batch size: 16 token used ratio: 0.08147692307692307
cost load scan: 0.009298324584960938
load 1 adapters, 14 in total
Function load_lora_A took 3.2722949981689453 ms to run.
Function load_lora_B took 3.233194351196289 ms to run.
cost realload: 6.947517395019531
Function load_adapters took 6.968498229980469 ms to run.
cost offload scan: 0.1285076141357422
offload 2 adapters, 12 remains
cost offload cat: 0.027179718017578125
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.6289482116699219 ms to run.
cost offload scan: 0.08559226989746094
offload 1 adapters, 11 remains
cost offload cat: 0.03838539123535156
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.6017684936523438 ms to run.
Avg tokens(prompt+generate) throughput: 1606.719 tokens/s
Avg prompt tokens throughput:            822.905 tokens/s
Avg generate tokens throughput:          783.814 tokens/s
current batch size: 14 token used ratio: 0.07446153846153847
cost offload scan: 0.08845329284667969
offload 1 adapters, 10 remains
cost offload cat: 0.03504753112792969
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.6058216094970703 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 9 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.6098747253417969 ms to run.
cost load scan: 0.014543533325195312
load 1 adapters, 10 in total
Function load_lora_A took 3.248929977416992 ms to run.
Function load_lora_B took 3.2303333282470703 ms to run.
cost realload: 6.90460205078125
Function load_adapters took 6.9255828857421875 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 10 in total
cost realload: 0.3199577331542969
Function load_adapters took 0.34499168395996094 ms to run.
cost offload scan: 0.09417533874511719
offload 1 adapters, 9 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.6024837493896484 ms to run.
cost load scan: 0.014781951904296875
load 2 adapters, 11 in total
Function load_lora_A took 3.2815933227539062 ms to run.
Function load_lora_B took 3.268003463745117 ms to run.
Function load_lora_A took 3.2629966735839844 ms to run.
Function load_lora_B took 3.246307373046875 ms to run.
cost realload: 13.553857803344727
Function load_adapters took 13.575077056884766 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 10 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.5948543548583984 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 11 in total
Function load_lora_A took 3.2701492309570312 ms to run.
Function load_lora_B took 3.2377243041992188 ms to run.
cost realload: 6.918907165527344
Function load_adapters took 6.940364837646484 ms to run.
current batch size: 16 token used ratio: 0.08404615384615384
cost offload scan: 0.08463859558105469
offload 1 adapters, 10 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11587142944335938
Function offload_adapters took 0.5888938903808594 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 10 in total
cost realload: 0.3173351287841797
Function load_adapters took 0.34689903259277344 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 9 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.5927085876464844 ms to run.
offload 0 adapters, 9 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 8 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5865097045898438 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 8 in total
cost realload: 0.3082752227783203
Function load_adapters took 0.33283233642578125 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 9 in total
Function load_lora_A took 3.272533416748047 ms to run.
Function load_lora_B took 3.2134056091308594 ms to run.
cost realload: 6.895542144775391
Function load_adapters took 6.91676139831543 ms to run.
current batch size: 15 token used ratio: 0.07907692307692307
offload 0 adapters, 9 remains
Function offload_adapters took 0.012874603271484375 ms to run.
offload 0 adapters, 9 remains
Function offload_adapters took 0.01239776611328125 ms to run.
offload 0 adapters, 9 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 8 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.5950927734375 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 9 in total
Function load_lora_A took 3.254413604736328 ms to run.
Function load_lora_B took 3.2563209533691406 ms to run.
cost realload: 6.942987442016602
Function load_adapters took 6.963968276977539 ms to run.
offload 0 adapters, 9 remains
Function offload_adapters took 0.0133514404296875 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 10 in total
Function load_lora_A took 3.257274627685547 ms to run.
Function load_lora_B took 3.2453536987304688 ms to run.
cost realload: 6.927251815795898
Function load_adapters took 6.949424743652344 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 11 in total
Function load_lora_A took 3.2799243927001953 ms to run.INFO:     127.0.0.1:43744 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43750 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43752 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43766 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:43778 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54812 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54816 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54826 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54836 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54848 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54852 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54856 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54868 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54884 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54886 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54888 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54894 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54896 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54912 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54926 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54934 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54936 - "POST /generate_stream HTTP/1.1" 200 OK

Function load_lora_B took 3.244638442993164 ms to run.
cost realload: 6.982088088989258
Function load_adapters took 7.0037841796875 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 10 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.5943775177001953 ms to run.
current batch size: 12 token used ratio: 0.06470769230769231
cost load scan: 0.00858306884765625
load 1 adapters, 11 in total
Function load_lora_A took 3.242015838623047 ms to run.
Function load_lora_B took 3.2300949096679688 ms to run.
cost realload: 6.894826889038086
Function load_adapters took 6.91676139831543 ms to run.
cost load scan: 0.009298324584960938
load 2 adapters, 13 in total
Function load_lora_A took 3.241300582885742 ms to run.
Function load_lora_B took 3.2770633697509766 ms to run.
Function load_lora_A took 3.231048583984375 ms to run.
Function load_lora_B took 3.2587051391601562 ms to run.
cost realload: 13.5040283203125
Function load_adapters took 13.525247573852539 ms to run.
cost load scan: 0.0133514404296875
load 2 adapters, 15 in total
Function load_lora_A took 3.2787322998046875 ms to run.
Function load_lora_B took 3.2389163970947266 ms to run.
Function load_lora_A took 3.3016204833984375 ms to run.
Function load_lora_B took 3.2525062561035156 ms to run.
cost realload: 13.588190078735352
Function load_adapters took 13.610124588012695 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 15 in total
cost realload: 0.2963542938232422
Function load_adapters took 0.32019615173339844 ms to run.
offload 0 adapters, 15 remains
Function offload_adapters took 0.012636184692382812 ms to run.
offload 0 adapters, 15 remains
Function offload_adapters took 0.013589859008789062 ms to run.
current batch size: 16 token used ratio: 0.08147692307692307
cost load scan: 0.007867813110351562
load 0 adapters, 15 in total
cost realload: 0.2970695495605469
Function load_adapters took 0.32019615173339844 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 16 in total
Function load_lora_A took 3.2711029052734375 ms to run.
Function load_lora_B took 3.238201141357422 ms to run.
cost realload: 6.929874420166016
Function load_adapters took 6.953001022338867 ms to run.
cost offload scan: 0.0896453857421875
offload 1 adapters, 15 remains
cost offload cat: 0.038623809814453125
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.12230873107910156
Function offload_adapters took 0.6246566772460938 ms to run.
cost load scan: 0.0152587890625
load 2 adapters, 17 in total
Function load_lora_A took 3.230571746826172 ms to run.
Function load_lora_B took 3.2491683959960938 ms to run.
Function load_lora_A took 3.2448768615722656 ms to run.
Function load_lora_B took 3.246784210205078 ms to run.
cost realload: 13.484001159667969
Function load_adapters took 13.506174087524414 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 16 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.05245208740234375
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.5993843078613281 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 15 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.0457763671875
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.6029605865478516 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 16 in total
Function load_lora_A took 3.2434463500976562 ms to run.
Function load_lora_B took 3.2486915588378906 ms to run.
cost realload: 6.909847259521484
Function load_adapters took 6.930351257324219 ms to run.
cost load scan: 0.011682510375976562
load 2 adapters, 18 in total
Function load_lora_A took 3.283262252807617 ms to run.
Function load_lora_B took 3.243684768676758 ms to run.
Function load_lora_A took 3.2727718353271484 ms to run.
Function load_lora_B took 3.2515525817871094 ms to run.
cost realload: 13.54670524597168
Function load_adapters took 13.56816291809082 ms to run.
current batch size: 21 token used ratio: 0.09984615384615385
offload 0 adapters, 18 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.015497207641601562
load 1 adapters, 19 in total
Function load_lora_A took 3.2753944396972656 ms to run.
Function load_lora_B took 3.2236576080322266 ms to run.
cost realload: 6.9599151611328125
Function load_adapters took 6.982088088989258 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 18 remains
cost offload cat: 0.041484832763671875
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11515617370605469
Function offload_adapters took 0.6248950958251953 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 18 in total
cost realload: 0.30231475830078125
Function load_adapters took 0.32639503479003906 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 18 in total
cost realload: 0.2918243408203125
Function load_adapters took 0.31638145446777344 ms to run.
cost load scan: 0.012159347534179688
load 1 adapters, 19 in total
Function load_lora_A took 3.2486915588378906 ms to run.
Function load_lora_B took 3.263711929321289 ms to run.
cost realload: 6.934881210327148
Function load_adapters took 6.9561004638671875 ms to run.
current batch size: 23 token used ratio: 0.11403076923076923
cost load scan: 0.009298324584960938
load 1 adapters, 20 in total
Function load_lora_A took 3.2701492309570312 ms to run.
Function load_lora_B took 3.2482147216796875 ms to run.
cost realload: 6.9408416748046875
Function load_adapters took 6.962060928344727 ms to run.
cost offload scan: 0.091552734375
offload 1 adapters, 19 remains
cost offload cat: 0.03647804260253906
cost offload free mem manager: 0.04553794860839844
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.6098747253417969 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 18 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.028848648071289062
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.5970001220703125 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost load scan: 0.01239776611328125
load 1 adapters, 19 in total
Function load_lora_A took 3.265857696533203 ms to run.
Function load_lora_B took 3.235340118408203 ms to run.
cost realload: 6.921291351318359
Function load_adapters took 6.942510604858398 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.09417533874511719
offload 1 adapters, 18 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11396408081054688
Function offload_adapters took 0.61798095703125 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 17 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.60272216796875 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 18 in total
Function load_lora_A took 3.2639503479003906 ms to run.
Function load_lora_B took 3.2677650451660156 ms to run.
cost realload: 6.945610046386719
Function load_adapters took 6.966352462768555 ms to run.
current batch size: 20 token used ratio: 0.10741538461538462
cost offload scan: 0.08559226989746094
offload 1 adapters, 17 remains
INFO:     127.0.0.1:54944 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54960 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54966 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54968 - "POST /generate_stream HTTP/1.1" 200 OK
