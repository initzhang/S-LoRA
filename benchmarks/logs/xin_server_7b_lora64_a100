For some LLaMA-based models, initializing the fast tokenizer may take a long time. To eliminate the initialization time, consider using 'hf-internal-testing/llama-tokenizer' instead of the original tokenizer.
llama-7b: 12.06 GB
peak working mem for (bs=20, seqlen=512): 0.70 GB
peak working mem for (bs=100, seqlen=512): 3.52 GB
all adapters (101) estimated size: 12.62 GB
avg adapter estimated size: 128.00 MB
INFO:     127.0.0.1:58496 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58512 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58528 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58540 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58550 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58562 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58566 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58574 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58582 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46698 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46708 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46716 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46722 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46734 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46738 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46746 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46756 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46758 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46770 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46774 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46780 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46796 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46802 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46808 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46814 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46822 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46830 - "POST /generate_stream HTTP/1.1" 200 OK
cost load scan: 0.010251998901367188
load 2 adapters, 2 in total
Function load_lora_A took 6.1664581298828125 ms to run.
Function load_lora_B took 6.101846694946289 ms to run.
Function load_lora_A took 6.101131439208984 ms to run.
Function load_lora_B took 6.0672760009765625 ms to run.
cost realload: 29.249191284179688
Function load_adapters took 29.277324676513672 ms to run.
Avg tokens(prompt+generate) throughput:   17.440 tokens/s
Avg prompt tokens throughput:             17.440 tokens/s
Avg generate tokens throughput:            0.000 tokens/s
cost load scan: 0.010967254638671875
load 5 adapters, 7 in total
Function load_lora_A took 6.096124649047852 ms to run.
Function load_lora_B took 6.046533584594727 ms to run.
Function load_lora_A took 6.129980087280273 ms to run.
Function load_lora_B took 6.076335906982422 ms to run.
Function load_lora_A took 6.0672760009765625 ms to run.
Function load_lora_B took 6.066799163818359 ms to run.
Function load_lora_A took 6.103992462158203 ms to run.
Function load_lora_B took 6.099462509155273 ms to run.
Function load_lora_A took 6.133794784545898 ms to run.
Function load_lora_B took 6.076812744140625 ms to run.
cost realload: 61.699628829956055
Function load_adapters took 61.72442436218262 ms to run.
current batch size: 8 token used ratio: 0.02926153846153846
cost load scan: 0.008821487426757812
load 1 adapters, 8 in total
Function load_lora_A took 6.09278678894043 ms to run.
Function load_lora_B took 6.030797958374023 ms to run.
cost realload: 12.551069259643555
Function load_adapters took 12.574911117553711 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 9 in total
Function load_lora_A took 6.049394607543945 ms to run.
Function load_lora_B took 6.050825119018555 ms to run.
cost realload: 12.521743774414062
Function load_adapters took 12.547969818115234 ms to run.
cost load scan: 0.009298324584960938
load 2 adapters, 11 in total
Function load_lora_A took 6.03175163269043 ms to run.
Function load_lora_B took 6.053686141967773 ms to run.
Function load_lora_A took 6.027936935424805 ms to run.
Function load_lora_B took 6.035089492797852 ms to run.
cost realload: 24.62935447692871
Function load_adapters took 24.65510368347168 ms to run.
cost load scan: 0.010013580322265625
load 2 adapters, 13 in total
Function load_lora_A took 6.050825119018555 ms to run.
Function load_lora_B took 6.048440933227539 ms to run.
Function load_lora_A took 6.047725677490234 ms to run.
Function load_lora_B took 6.014823913574219 ms to run.
cost realload: 24.65057373046875
Function load_adapters took 24.67799186706543 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 14 in total
Function load_lora_A took 6.03032112121582 ms to run.
Function load_lora_B took 6.025075912475586 ms to run.
cost realload: 12.468338012695312
Function load_adapters took 12.491464614868164 ms to run.
current batch size: 15 token used ratio: 0.06470769230769231
cost load scan: 0.008106231689453125
load 0 adapters, 14 in total
cost realload: 0.2956390380859375
Function load_adapters took 0.32067298889160156 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 15 in total
Function load_lora_A took 6.069421768188477 ms to run.
Function load_lora_B took 6.025075912475586 ms to run.
cost realload: 12.509822845458984
Function load_adapters took 12.534856796264648 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 16 in total
Function load_lora_A took 6.095170974731445 ms to run.
Function load_lora_B took 6.033182144165039 ms to run.
cost realload: 12.540340423583984
Function load_adapters took 12.563467025756836 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 17 in total
Function load_lora_A took 6.094932556152344 ms to run.
Function load_lora_B took 6.056308746337891 ms to run.
cost realload: 12.589693069458008
Function load_adapters took 12.61281967163086 ms to run.
offload 0 adapters, 17 remains
Function offload_adapters took 0.012874603271484375 ms to run.
current batch size: 18 token used ratio: 0.08653846153846154
cost load scan: 0.008821487426757812
load 1 adapters, 18 in total
Function load_lora_A took 6.089210510253906 ms to run.
Function load_lora_B took 6.04248046875 ms to run.
cost realload: 12.546777725219727
Function load_adapters took 12.570858001708984 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 19 in total
Function load_lora_A took 6.0901641845703125 ms to run.
Function load_lora_B took 6.022214889526367 ms to run.
cost realload: 12.520551681518555
Function load_adapters took 12.543439865112305 ms to run.
cost load scan: 0.010013580322265625
load 1 adapters, 20 in total
Function load_lora_A took 6.040811538696289 ms to run.
Function load_lora_B took 6.002187728881836 ms to run.
cost realload: 12.468099594116211
Function load_adapters took 12.49241828918457 ms to run.
cost offload scan: 0.16069412231445312
offload 1 adapters, 19 remains
cost offload cat: 0.03743171691894531
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 13.501644134521484
Function offload_adapters took 14.065980911254883 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 18 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5927085876464844 ms to run.
current batch size: 20 token used ratio: 0.10813846153846154
cost offload scan: 0.14829635620117188
offload 1 adapters, 17 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.6461143493652344 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 16 remains
cost offload cat: 0.03504753112792969
cost offload free mem manager: 0.049591064453125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5922317504882812 ms to run.
offload 0 adapters, 16 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.14591217041015625
offload 1 adapters, 15 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.044345855712890625
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.64849853515625 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 14 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5772113800048828 ms to run.
cost load scan: 0.00858306884765625
load 2 adapters, 16 in total
Function load_lora_A took 6.093263626098633 ms to run.
Function load_lora_B took 6.03795051574707 ms to run.
Function load_lora_A took 6.035566329956055 ms to run.
Function load_lora_B took 6.026268005371094 ms to run.
cost realload: 24.672269821166992
Function load_adapters took 24.692535400390625 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 15 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04982948303222656
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5784034729003906 ms to run.
cost load scan: 0.009059906005859375
load 2 adapters, 17 in total
Function load_lora_A took 6.087303161621094 ms to run.
Function load_lora_B took 6.031274795532227 ms to run.
Function load_lora_A took 6.068229675292969 ms to run.
Function load_lora_B took 6.026268005371094 ms to run.
cost realload: 24.688243865966797
Function load_adapters took 24.710416793823242 ms to run.
current batch size: 18 token used ratio: 0.1021076923076923
cost offload scan: 0.08559226989746094
offload 1 adapters, 16 remains
cost offload cat: 0.03552436828613281
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: INFO:     127.0.0.1:46832 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46838 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46850 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46864 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46868 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46878 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46882 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46896 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46900 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46910 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46912 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46924 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46940 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46954 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46956 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46970 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46974 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46976 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46982 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:46996 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47010 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47026 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47036 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47038 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47054 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47064 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47074 - "POST /generate_stream HTTP/1.1" 200 OK
0.021696090698242188
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.6101131439208984 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 15 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5846023559570312 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 16 in total
Function load_lora_A took 6.045818328857422 ms to run.
Function load_lora_B took 6.044149398803711 ms to run.
cost realload: 12.502908706665039
Function load_adapters took 12.525081634521484 ms to run.
offload 0 adapters, 16 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.012636184692382812
load 6 adapters, 22 in total
Function load_lora_A took 6.048679351806641 ms to run.
Function load_lora_B took 6.009101867675781 ms to run.
Function load_lora_A took 6.036520004272461 ms to run.
Function load_lora_B took 6.058931350708008 ms to run.
Function load_lora_A took 6.067514419555664 ms to run.
Function load_lora_B took 6.027698516845703 ms to run.
Function load_lora_A took 6.0253143310546875 ms to run.
Function load_lora_B took 6.016969680786133 ms to run.
Function load_lora_A took 6.108999252319336 ms to run.
Function load_lora_B took 6.055116653442383 ms to run.
Function load_lora_A took 6.052732467651367 ms to run.
Function load_lora_B took 6.012439727783203 ms to run.
cost realload: 73.28176498413086
Function load_adapters took 73.3041763305664 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 21 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5888938903808594 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 20 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5805492401123047 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 19 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.5900859832763672 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 18 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5881786346435547 ms to run.
cost load scan: 0.010251998901367188
load 4 adapters, 22 in total
Function load_lora_A took 6.082057952880859 ms to run.
Function load_lora_B took 6.035327911376953 ms to run.
Function load_lora_A took 6.056308746337891 ms to run.
Function load_lora_B took 6.036043167114258 ms to run.
Function load_lora_A took 6.084203720092773 ms to run.
Function load_lora_B took 6.034374237060547 ms to run.
Function load_lora_A took 6.047725677490234 ms to run.
Function load_lora_B took 6.009578704833984 ms to run.
cost realload: 49.01862144470215
Function load_adapters took 49.041748046875 ms to run.
cost load scan: 0.009298324584960938
load 2 adapters, 24 in total
Function load_lora_A took 6.055593490600586 ms to run.
Function load_lora_B took 6.052494049072266 ms to run.
Function load_lora_A took 6.06536865234375 ms to run.
Function load_lora_B took 6.0367584228515625 ms to run.
cost realload: 24.692296981811523
Function load_adapters took 24.714231491088867 ms to run.
current batch size: 24 token used ratio: 0.12246153846153846
cost offload scan: 0.102996826171875
offload 1 adapters, 23 remains
cost offload cat: 0.04267692565917969
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11777877807617188
Function offload_adapters took 0.652313232421875 ms to run.
cost load scan: 0.010013580322265625
load 2 adapters, 25 in total
Function load_lora_A took 6.032705307006836 ms to run.
Function load_lora_B took 6.048440933227539 ms to run.
Function load_lora_A took 6.077289581298828 ms to run.
Function load_lora_B took 6.009101867675781 ms to run.
cost realload: 24.68585968017578
Function load_adapters took 24.708271026611328 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 24 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.5972385406494141 ms to run.
cost offload scan: 0.09417533874511719
offload 1 adapters, 23 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.5919933319091797 ms to run.
cost load scan: 0.008821487426757812
load 2 adapters, 25 in total
Function load_lora_A took 6.061077117919922 ms to run.
Function load_lora_B took 6.0272216796875 ms to run.
Function load_lora_A took 6.082296371459961 ms to run.
Function load_lora_B took 6.056785583496094 ms to run.
cost realload: 24.708271026611328
Function load_adapters took 24.731159210205078 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 26 in total
Function load_lora_A took 6.084442138671875 ms to run.
Function load_lora_B took 6.038427352905273 ms to run.
cost realload: 12.54129409790039
Function load_adapters took 12.563228607177734 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 27 in total
Function load_lora_A took 6.081342697143555 ms to run.
Function load_lora_B took 6.048679351806641 ms to run.
cost realload: 12.565135955810547
Function load_adapters took 12.587547302246094 ms to run.
current batch size: 27 token used ratio: 0.14884615384615385
cost load scan: 0.012159347534179688
load 2 adapters, 29 in total
Function load_lora_A took 6.062507629394531 ms to run.
Function load_lora_B took 6.048440933227539 ms to run.
Function load_lora_A took 6.067514419555664 ms to run.
Function load_lora_B took 6.041288375854492 ms to run.
cost realload: 24.772167205810547
Function load_adapters took 24.800539016723633 ms to run.
cost offload scan: 0.10251998901367188
offload 1 adapters, 28 remains
cost offload cat: 0.04601478576660156
cost offload free mem manager: 0.04839897155761719
cost offload torch.empty: 0.0286102294921875
cost offload a_loc update: 0.13136863708496094
Function offload_adapters took 0.7069110870361328 ms to run.
cost offload scan: 0.09965896606445312
offload 1 adapters, 27 remains
cost offload cat: 0.03743171691894531
cost offload free mem manager: 0.0476837158203125
cost offload torch.empty: 0.0286102294921875
cost offload a_loc update: 0.1342296600341797
Function offload_adapters took 0.6983280181884766 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 28 in total
Function load_lora_A took 6.064653396606445 ms to run.
Function load_lora_B took 6.0672760009765625 ms to run.
cost realload: 12.610197067260742
Function load_adapters took 12.639999389648438 ms to run.
cost load scan: 0.013113021850585938
load 3 adapters, 31 in total
Function load_lora_A took 6.089448928833008 ms to run.
Function load_lora_B took 6.060123443603516 ms to run.
Function load_lora_A took 6.075620651245117 ms to run.
Function load_lora_B took 6.055355072021484 ms to run.
Function load_lora_A took 6.042242050170898 ms to run.
Function load_lora_B took 6.005764007568359 ms to run.
cost realload: 36.97514533996582
Function load_adapters took 37.0025634765625 ms to run.
Avg tokens(prompt+generate) throughput: 1993.762 tokens/s
Avg prompt tokens throughput:           1357.415 tokens/s
Avg generate tokens throughput:          636.347 tokens/s
cost offload scan: 0.10466575622558594
offload 1 adapters, 30 remains
INFO:     127.0.0.1:47084 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:47086 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59388 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59394 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59402 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59404 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59408 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59410 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59420 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59428 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload cat: 0.048160552978515625
cost offload free mem manager: 0.05745887756347656
cost offload torch.empty: 0.029802322387695312
cost offload a_loc update: 0.13709068298339844
Function offload_adapters took 0.8745193481445312 ms to run.
current batch size: 31 token used ratio: 0.18323076923076922
cost load scan: 0.01049041748046875
load 1 adapters, 31 in total
Function load_lora_A took 6.082057952880859 ms to run.
Function load_lora_B took 6.05010986328125 ms to run.
cost realload: 12.59922981262207
Function load_adapters took 12.625455856323242 ms to run.
offload 0 adapters, 31 remains
Function offload_adapters took 0.015735626220703125 ms to run.
cost offload scan: 0.10395050048828125
offload 1 adapters, 30 remains
cost offload cat: 0.04601478576660156
cost offload free mem manager: 0.048160552978515625
cost offload torch.empty: 0.0286102294921875
cost offload a_loc update: 0.1316070556640625
Function offload_adapters took 0.713348388671875 ms to run.
cost offload scan: 0.10752677917480469
offload 1 adapters, 29 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.04792213439941406
cost offload torch.empty: 0.0286102294921875
cost offload a_loc update: 0.12731552124023438
Function offload_adapters took 0.6887912750244141 ms to run.
cost load scan: 0.009775161743164062
load 0 adapters, 29 in total
cost realload: 0.3311634063720703
Function load_adapters took 0.35881996154785156 ms to run.
cost offload scan: 0.11110305786132812
offload 1 adapters, 28 remains
cost offload cat: 0.0438690185546875
cost offload free mem manager: 0.0476837158203125
cost offload torch.empty: 0.028371810913085938
cost offload a_loc update: 0.1380443572998047
Function offload_adapters took 0.7109642028808594 ms to run.
cost offload scan: 0.10633468627929688
offload 1 adapters, 27 remains
cost offload cat: 0.03552436828613281
cost offload free mem manager: 0.04839897155761719
cost offload torch.empty: 0.028133392333984375
cost offload a_loc update: 0.1270771026611328
Function offload_adapters took 0.6830692291259766 ms to run.
cost offload scan: 0.10848045349121094
offload 1 adapters, 26 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.04696846008300781
cost offload torch.empty: 0.0286102294921875
cost offload a_loc update: 0.12636184692382812
Function offload_adapters took 0.6773471832275391 ms to run.
cost load scan: 0.011205673217773438
load 2 adapters, 28 in total
Function load_lora_A took 6.051301956176758 ms to run.
Function load_lora_B took 6.041049957275391 ms to run.
Function load_lora_A took 6.069660186767578 ms to run.
Function load_lora_B took 6.038427352905273 ms to run.
cost realload: 24.72972869873047
Function load_adapters took 24.756431579589844 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 27 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.6036758422851562 ms to run.
cost offload scan: 0.09989738464355469
offload 1 adapters, 26 remains
cost offload cat: 0.045299530029296875
cost offload free mem manager: 0.04839897155761719
cost offload torch.empty: 0.028848648071289062
cost offload a_loc update: 0.12969970703125
Function offload_adapters took 0.6940364837646484 ms to run.
cost offload scan: 0.11324882507324219
offload 1 adapters, 25 remains
cost offload cat: 0.04696846008300781
cost offload free mem manager: 0.051021575927734375
cost offload torch.empty: 0.0286102294921875
cost offload a_loc update: 0.12922286987304688
Function offload_adapters took 0.7157325744628906 ms to run.
current batch size: 26 token used ratio: 0.15573846153846155
cost offload scan: 0.10657310485839844
offload 1 adapters, 24 remains
cost offload cat: 0.04673004150390625
cost offload free mem manager: 0.04839897155761719
cost offload torch.empty: 0.0286102294921875
cost offload a_loc update: 0.1289844512939453
Function offload_adapters took 0.701904296875 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 25 in total
Function load_lora_A took 6.06226921081543 ms to run.
Function load_lora_B took 6.051063537597656 ms to run.
cost realload: 12.543678283691406
Function load_adapters took 12.569665908813477 ms to run.
offload 0 adapters, 25 remains
Function offload_adapters took 0.01811981201171875 ms to run.
cost load scan: 0.010728836059570312
load 0 adapters, 25 in total
cost realload: 0.3578662872314453
Function load_adapters took 0.38743019104003906 ms to run.
cost offload scan: 0.10371208190917969
offload 1 adapters, 24 remains
cost offload cat: 0.04458427429199219
cost offload free mem manager: 0.048160552978515625
cost offload torch.empty: 0.027894973754882812
cost offload a_loc update: 0.12946128845214844
Function offload_adapters took 0.7023811340332031 ms to run.
cost offload scan: 0.10204315185546875
offload 1 adapters, 23 remains
cost offload cat: 0.041961669921875
cost offload free mem manager: 0.048160552978515625
cost offload torch.empty: 0.028848648071289062
cost offload a_loc update: 0.14138221740722656
Function offload_adapters took 0.7021427154541016 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 24 in total
Function load_lora_A took 6.058931350708008 ms to run.
Function load_lora_B took 6.0482025146484375 ms to run.
cost realload: 12.579917907714844
Function load_adapters took 12.607812881469727 ms to run.
cost offload scan: 0.10085105895996094
offload 1 adapters, 23 remains
cost offload cat: 0.04076957702636719
cost offload free mem manager: 0.05507469177246094
cost offload torch.empty: 0.028848648071289062
cost offload a_loc update: 0.12946128845214844
Function offload_adapters took 0.6959438323974609 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 22 remains
cost offload cat: 0.03910064697265625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.6222724914550781 ms to run.
current batch size: 23 token used ratio: 0.14884615384615385
cost load scan: 0.011205673217773438
load 1 adapters, 23 in total
Function load_lora_A took 6.078004837036133 ms to run.
Function load_lora_B took 6.043434143066406 ms to run.
cost realload: 12.59922981262207
Function load_adapters took 12.627363204956055 ms to run.
cost offload scan: 0.10824203491210938
offload 1 adapters, 22 remains
cost offload cat: 0.04220008850097656
cost offload free mem manager: 0.0514984130859375
cost offload torch.empty: 0.0324249267578125
cost offload a_loc update: 0.14710426330566406
Function offload_adapters took 0.7624626159667969 ms to run.
cost offload scan: 0.09846687316894531
offload 1 adapters, 21 remains
cost offload cat: 0.0476837158203125
cost offload free mem manager: 0.048160552978515625
cost offload torch.empty: 0.03552436828613281
cost offload a_loc update: 0.13256072998046875
Function offload_adapters took 0.7069110870361328 ms to run.
cost offload scan: 0.10347366333007812
offload 1 adapters, 20 remains
cost offload cat: 0.04363059997558594
cost offload free mem manager: 0.04792213439941406
cost offload torch.empty: 0.029325485229492188
cost offload a_loc update: 0.13017654418945312
Function offload_adapters took 0.7071495056152344 ms to run.
cost offload scan: 0.10442733764648438
offload 1 adapters, 19 remains
cost offload cat: 0.04482269287109375
cost offload free mem manager: 0.05316734313964844
cost offload torch.empty: 0.0324249267578125
cost offload a_loc update: 0.14448165893554688
Function offload_adapters took 0.7643699645996094 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.015974044799804688 ms to run.
cost load scan: 0.009298324584960938
load 1 adapters, 20 in total
Function load_lora_A took 6.071329116821289 ms to run.
Function load_lora_B took 6.0558319091796875 ms to run.
cost realload: 12.578725814819336
Function load_adapters took 12.604475021362305 ms to run.
current batch size: 20 token used ratio: 0.13326153846153846
cost load scan: 0.009059906005859375
load 1 adapters, 21 in total
INFO:     127.0.0.1:59444 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59454 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59456 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59472 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59476 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59488 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59492 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59502 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59508 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59510 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59522 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59536 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59552 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59568 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59582 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59592 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59596 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59602 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59614 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 6.082296371459961 ms to run.
Function load_lora_B took 6.073951721191406 ms to run.
cost realload: 12.806415557861328
Function load_adapters took 12.833118438720703 ms to run.
cost load scan: 0.012159347534179688
load 2 adapters, 23 in total
Function load_lora_A took 6.076574325561523 ms to run.
Function load_lora_B took 6.043672561645508 ms to run.
Function load_lora_A took 6.075859069824219 ms to run.
Function load_lora_B took 6.046533584594727 ms to run.
cost realload: 24.814128875732422
Function load_adapters took 24.845361709594727 ms to run.
cost offload scan: 0.10728836059570312
offload 1 adapters, 22 remains
cost offload cat: 0.047206878662109375
cost offload free mem manager: 0.04887580871582031
cost offload torch.empty: 0.028848648071289062
cost offload a_loc update: 0.12946128845214844
Function offload_adapters took 0.7054805755615234 ms to run.
cost offload scan: 0.0972747802734375
offload 1 adapters, 21 remains
cost offload cat: 0.03981590270996094
cost offload free mem manager: 0.04982948303222656
cost offload torch.empty: 0.0286102294921875
cost offload a_loc update: 0.13136863708496094
Function offload_adapters took 0.6806850433349609 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 22 in total
Function load_lora_A took 6.072521209716797 ms to run.
Function load_lora_B took 6.026268005371094 ms to run.
cost realload: 12.559175491333008
Function load_adapters took 12.589454650878906 ms to run.
cost offload scan: 0.10013580322265625
offload 1 adapters, 21 remains
cost offload cat: 0.038623809814453125
cost offload free mem manager: 0.04792213439941406
cost offload torch.empty: 0.027418136596679688
cost offload a_loc update: 0.13756752014160156
Function offload_adapters took 0.6871223449707031 ms to run.
cost offload scan: 0.09894371032714844
offload 1 adapters, 20 remains
cost offload cat: 0.038623809814453125
cost offload free mem manager: 0.04935264587402344
cost offload torch.empty: 0.028133392333984375
cost offload a_loc update: 0.13494491577148438
Function offload_adapters took 0.6864070892333984 ms to run.
cost offload scan: 0.09775161743164062
offload 1 adapters, 19 remains
cost offload cat: 0.0362396240234375
cost offload free mem manager: 0.04744529724121094
cost offload torch.empty: 0.028133392333984375
cost offload a_loc update: 0.12683868408203125
Function offload_adapters took 0.6666183471679688 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost load scan: 0.0095367431640625
load 3 adapters, 22 in total
Function load_lora_A took 6.085872650146484 ms to run.
Function load_lora_B took 6.073713302612305 ms to run.
Function load_lora_A took 6.047964096069336 ms to run.
Function load_lora_B took 6.035327911376953 ms to run.
Function load_lora_A took 6.096839904785156 ms to run.
Function load_lora_B took 6.046772003173828 ms to run.
cost realload: 36.9722843170166
Function load_adapters took 36.99827194213867 ms to run.
cost offload scan: 0.09441375732421875
offload 1 adapters, 21 remains
cost offload cat: 0.035762786865234375
cost offload free mem manager: 0.05173683166503906
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.6167888641357422 ms to run.
cost offload scan: 0.10347366333007812
offload 1 adapters, 20 remains
cost offload cat: 0.03600120544433594
cost offload free mem manager: 0.0476837158203125
cost offload torch.empty: 0.028371810913085938
cost offload a_loc update: 0.1277923583984375
Function offload_adapters took 0.6759166717529297 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 20 in total
cost realload: 0.30541419982910156
Function load_adapters took 0.3304481506347656 ms to run.
current batch size: 22 token used ratio: 0.12132307692307692
cost load scan: 0.01049041748046875
load 1 adapters, 21 in total
Function load_lora_A took 6.035804748535156 ms to run.
Function load_lora_B took 6.044149398803711 ms to run.
cost realload: 12.57181167602539
Function load_adapters took 12.599945068359375 ms to run.
cost offload scan: 0.09918212890625
offload 1 adapters, 20 remains
cost offload cat: 0.048160552978515625
cost offload free mem manager: 0.048160552978515625
cost offload torch.empty: 0.028371810913085938
cost offload a_loc update: 0.12946128845214844
Function offload_adapters took 0.6916522979736328 ms to run.
cost offload scan: 0.095367431640625
offload 1 adapters, 19 remains
cost offload cat: 0.03647804260253906
cost offload free mem manager: 0.05817413330078125
cost offload torch.empty: 0.028371810913085938
cost offload a_loc update: 0.12946128845214844
Function offload_adapters took 0.6818771362304688 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 20 in total
Function load_lora_A took 6.071567535400391 ms to run.
Function load_lora_B took 6.0596466064453125 ms to run.
cost realload: 12.603998184204102
Function load_adapters took 12.632608413696289 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 21 in total
Function load_lora_A took 6.092071533203125 ms to run.
Function load_lora_B took 6.048917770385742 ms to run.
cost realload: 12.624263763427734
Function load_adapters took 12.65406608581543 ms to run.
cost offload scan: 0.091552734375
offload 1 adapters, 20 remains
cost offload cat: 0.040531158447265625
cost offload free mem manager: 0.04506111145019531
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11610984802246094
Function offload_adapters took 0.6201267242431641 ms to run.
current batch size: 22 token used ratio: 0.12792307692307692
cost offload scan: 0.10132789611816406
offload 1 adapters, 19 remains
cost offload cat: 0.041484832763671875
cost offload free mem manager: 0.04839897155761719
cost offload torch.empty: 0.0286102294921875
cost offload a_loc update: 0.1308917999267578
Function offload_adapters took 0.7028579711914062 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 20 in total
Function load_lora_A took 6.06536865234375 ms to run.
Function load_lora_B took 6.069660186767578 ms to run.
cost realload: 12.609243392944336
Function load_adapters took 12.636423110961914 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 20 in total
cost realload: 0.3273487091064453
Function load_adapters took 0.3533363342285156 ms to run.
cost offload scan: 0.10466575622558594
offload 1 adapters, 19 remains
cost offload cat: 0.03981590270996094
cost offload free mem manager: 0.045299530029296875
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.6434917449951172 ms to run.
cost load scan: 0.011920928955078125
load 2 adapters, 21 in total
Function load_lora_A took 6.053924560546875 ms to run.
Function load_lora_B took 6.021261215209961 ms to run.
Function load_lora_A took 6.063222885131836 ms to run.
Function load_lora_B took 6.034612655639648 ms to run.
cost realload: 24.727582931518555
Function load_adapters took 24.75452423095703 ms to run.
cost offload scan: 0.10061264038085938
offload 1 adapters, 20 remains
cost offload cat: 0.0400543212890625
cost offload free mem manager: 0.047206878662109375
cost offload torch.empty: 0.02765655517578125
cost offload a_loc update: 0.1361370086669922
Function offload_adapters took 0.6818771362304688 ms to run.
cost load scan: 0.0095367431640625
load 2 adapters, 22 in total
Function load_lora_A took 6.073951721191406 ms to run.
Function load_lora_B took 6.061315536499023 ms to run.
Function load_lora_A took 6.0672760009765625 ms to run.
Function load_lora_B took 6.046772003173828 ms to run.
cost realload: 24.846315383911133
Function load_adapters took 24.875164031982422 ms to run.
cost offload scan: 0.11086463928222656
offload 1 adapters, 21 remains
cost offload cat: 0.04839897155761719
cost offload free mem manager: 0.05078315734863281
cost offload torch.empty: 0.028371810913085938
cost offload a_loc update: 0.1308917999267578
Function offload_adapters took 0.7288455963134766 ms to run.
current batch size: 25 token used ratio: 0.13226153846153846
offload 0 adapters, 21 remains
INFO:     127.0.0.1:59620 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54950 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54954 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54966 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54980 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54992 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55006 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55016 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55028 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55030 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55036 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55044 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55054 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55064 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55078 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55082 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55084 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55090 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55096 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55108 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55124 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55132 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55144 - "POST /generate_stream HTTP/1.1" 200 OK
Function offload_adapters took 0.017642974853515625 ms to run.
cost offload scan: 0.11205673217773438
offload 1 adapters, 20 remains
cost offload cat: 0.04863739013671875
cost offload free mem manager: 0.05316734313964844
cost offload torch.empty: 0.02956390380859375
cost offload a_loc update: 0.12946128845214844
Function offload_adapters took 0.7288455963134766 ms to run.
Avg tokens(prompt+generate) throughput: 1492.551 tokens/s
Avg prompt tokens throughput:            758.208 tokens/s
Avg generate tokens throughput:          734.343 tokens/s
cost offload scan: 0.11229515075683594
offload 1 adapters, 19 remains
cost offload cat: 0.052928924560546875
cost offload free mem manager: 0.05412101745605469
cost offload torch.empty: 0.02956390380859375
cost offload a_loc update: 0.13208389282226562
Function offload_adapters took 0.7450580596923828 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 20 in total
Function load_lora_A took 6.050825119018555 ms to run.
Function load_lora_B took 6.009340286254883 ms to run.
cost realload: 12.566328048706055
Function load_adapters took 12.594223022460938 ms to run.
current batch size: 23 token used ratio: 0.1356153846153846
cost load scan: 0.010967254638671875
load 1 adapters, 21 in total
Function load_lora_A took 6.092309951782227 ms to run.
Function load_lora_B took 6.039857864379883 ms to run.
cost realload: 12.668132781982422
Function load_adapters took 12.698173522949219 ms to run.
cost offload scan: 0.10561943054199219
offload 1 adapters, 20 remains
cost offload cat: 0.04935264587402344
cost offload free mem manager: 0.05269050598144531
cost offload torch.empty: 0.02956390380859375
cost offload a_loc update: 0.1342296600341797
Function offload_adapters took 0.7326602935791016 ms to run.
cost load scan: 0.01049041748046875
load 0 adapters, 20 in total
cost realload: 0.3845691680908203
Function load_adapters took 0.4143714904785156 ms to run.
cost offload scan: 0.1049041748046875
offload 1 adapters, 19 remains
cost offload cat: 0.050067901611328125
cost offload free mem manager: 0.0514984130859375
cost offload torch.empty: 0.028133392333984375
cost offload a_loc update: 0.1285076141357422
Function offload_adapters took 0.7159709930419922 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.017881393432617188 ms to run.
cost load scan: 0.011205673217773438
load 0 adapters, 19 in total
cost realload: 0.40602684020996094
Function load_adapters took 0.43582916259765625 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.019550323486328125 ms to run.
cost load scan: 0.012159347534179688
load 2 adapters, 21 in total
Function load_lora_A took 6.0825347900390625 ms to run.
Function load_lora_B took 6.045103073120117 ms to run.
Function load_lora_A took 6.082296371459961 ms to run.
Function load_lora_B took 6.046295166015625 ms to run.
cost realload: 24.908065795898438
Function load_adapters took 24.93739128112793 ms to run.
cost offload scan: 0.10848045349121094
offload 1 adapters, 20 remains
cost offload cat: 0.04744529724121094
cost offload free mem manager: 0.05173683166503906
cost offload torch.empty: 0.028133392333984375
cost offload a_loc update: 0.13208389282226562
Function offload_adapters took 0.7212162017822266 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.017642974853515625 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 21 in total
Function load_lora_A took 6.0749053955078125 ms to run.
Function load_lora_B took 6.057500839233398 ms to run.
cost realload: 12.609481811523438
Function load_adapters took 12.640953063964844 ms to run.
current batch size: 22 token used ratio: 0.12481538461538462
cost load scan: 0.010728836059570312
load 0 adapters, 21 in total
cost realload: 0.4134178161621094
Function load_adapters took 0.4425048828125 ms to run.
cost load scan: 0.011920928955078125
load 2 adapters, 23 in total
Function load_lora_A took 6.080865859985352 ms to run.
Function load_lora_B took 6.057500839233398 ms to run.
Function load_lora_A took 6.083488464355469 ms to run.
Function load_lora_B took 6.043434143066406 ms to run.
cost realload: 24.934768676757812
Function load_adapters took 24.964570999145508 ms to run.
cost offload scan: 0.11086463928222656
offload 1 adapters, 22 remains
cost offload cat: 0.0514984130859375
cost offload free mem manager: 0.05054473876953125
cost offload torch.empty: 0.028371810913085938
cost offload a_loc update: 0.13375282287597656
Function offload_adapters took 0.7359981536865234 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.017642974853515625 ms to run.
cost load scan: 0.012636184692382812
load 2 adapters, 24 in total
Function load_lora_A took 6.099939346313477 ms to run.
Function load_lora_B took 6.04701042175293 ms to run.
Function load_lora_A took 6.047964096069336 ms to run.
Function load_lora_B took 6.047964096069336 ms to run.
cost realload: 24.88422393798828
Function load_adapters took 24.91617202758789 ms to run.
cost offload scan: 0.1201629638671875
offload 1 adapters, 23 remains
cost offload cat: 0.05221366882324219
cost offload free mem manager: 0.05507469177246094
cost offload torch.empty: 0.029802322387695312
cost offload a_loc update: 0.1354217529296875
Function offload_adapters took 0.7636547088623047 ms to run.
cost offload scan: 0.10967254638671875
offload 1 adapters, 22 remains
cost offload cat: 0.04673004150390625
cost offload free mem manager: 0.05054473876953125
cost offload torch.empty: 0.029325485229492188
cost offload a_loc update: 0.1327991485595703
Function offload_adapters took 0.7157325744628906 ms to run.
cost offload scan: 0.10585784912109375
offload 1 adapters, 21 remains
cost offload cat: 0.04935264587402344
cost offload free mem manager: 0.053882598876953125
cost offload torch.empty: 0.029325485229492188
cost offload a_loc update: 0.1327991485595703
Function offload_adapters took 0.7357597351074219 ms to run.
cost load scan: 0.012636184692382812
load 3 adapters, 24 in total
Function load_lora_A took 6.0596466064453125 ms to run.
Function load_lora_B took 6.062746047973633 ms to run.
Function load_lora_A took 6.102323532104492 ms to run.
Function load_lora_B took 6.051778793334961 ms to run.
Function load_lora_A took 6.03032112121582 ms to run.
Function load_lora_B took 6.022930145263672 ms to run.
cost realload: 37.047386169433594
Function load_adapters took 37.0790958404541 ms to run.
cost offload scan: 0.10943412780761719
offload 1 adapters, 23 remains
cost offload cat: 0.06008148193359375
cost offload free mem manager: 0.05364418029785156
cost offload torch.empty: 0.0286102294921875
cost offload a_loc update: 0.12874603271484375
Function offload_adapters took 0.7467269897460938 ms to run.
current batch size: 25 token used ratio: 0.13407692307692307
cost offload scan: 0.11205673217773438
offload 1 adapters, 22 remains
cost offload cat: 0.06008148193359375
cost offload free mem manager: 0.0553131103515625
cost offload torch.empty: 0.029325485229492188
cost offload a_loc update: 0.13303756713867188
Function offload_adapters took 0.7543563842773438 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.017642974853515625 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 23 in total
Function load_lora_A took 6.059408187866211 ms to run.
Function load_lora_B took 6.055355072021484 ms to run.
cost realload: 12.656688690185547
Function load_adapters took 12.686014175415039 ms to run.
offload 0 adapters, 23 remains
Function offload_adapters took 0.017404556274414062 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 24 in total
Function load_lora_A took 6.033897399902344 ms to run.
Function load_lora_B took 6.033420562744141 ms to run.
cost realload: 12.60685920715332
Function load_adapters took 12.636423110961914 ms to run.
cost load scan: 0.012159347534179688
load 1 adapters, 25 in total
Function load_lora_A took 6.063222885131836 ms to run.
Function load_lora_B took 6.052494049072266 ms to run.
cost realload: 12.678384780883789
Function load_adapters took 12.706518173217773 ms to run.
cost offload scan: 0.11157989501953125
offload 1 adapters, 24 remains
INFO:     127.0.0.1:55150 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55158 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55164 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55166 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55178 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55194 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55210 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55212 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55228 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55238 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55248 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload cat: 0.05173683166503906
cost offload free mem manager: 0.06127357482910156
cost offload torch.empty: 0.02956390380859375
cost offload a_loc update: 0.13375282287597656
Function offload_adapters took 0.9157657623291016 ms to run.
cost offload scan: 0.11205673217773438
offload 1 adapters, 23 remains
cost offload cat: 0.050067901611328125
cost offload free mem manager: 0.05793571472167969
cost offload torch.empty: 0.029325485229492188
cost offload a_loc update: 0.1347064971923828
Function offload_adapters took 0.7426738739013672 ms to run.
cost load scan: 0.012159347534179688
load 3 adapters, 26 in total
Function load_lora_A took 6.103038787841797 ms to run.
Function load_lora_B took 6.05010986328125 ms to run.
Function load_lora_A took 6.089210510253906 ms to run.
Function load_lora_B took 6.033420562744141 ms to run.
Function load_lora_A took 6.076335906982422 ms to run.
Function load_lora_B took 6.0558319091796875 ms to run.
cost realload: 37.10055351257324
Function load_adapters took 37.12940216064453 ms to run.
cost offload scan: 0.11610984802246094
offload 1 adapters, 25 remains
cost offload cat: 0.051021575927734375
cost offload free mem manager: 0.05316734313964844
cost offload torch.empty: 0.029087066650390625
cost offload a_loc update: 0.14257431030273438
Function offload_adapters took 0.7605552673339844 ms to run.
current batch size: 27 token used ratio: 0.1414923076923077
cost offload scan: 0.10132789611816406
offload 1 adapters, 24 remains
cost offload cat: 0.043392181396484375
cost offload free mem manager: 0.047206878662109375
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.11754035949707031
Function offload_adapters took 0.6575584411621094 ms to run.
cost offload scan: 0.09799003601074219
offload 1 adapters, 23 remains
cost offload cat: 0.040531158447265625
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11181831359863281
Function offload_adapters took 0.6463527679443359 ms to run.
cost offload scan: 0.102996826171875
offload 1 adapters, 22 remains
cost offload cat: 0.03790855407714844
cost offload free mem manager: 0.046253204345703125
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11539459228515625
Function offload_adapters took 0.644683837890625 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 23 in total
Function load_lora_A took 6.094455718994141 ms to run.
Function load_lora_B took 6.026268005371094 ms to run.
cost realload: 12.546539306640625
Function load_adapters took 12.56871223449707 ms to run.
cost offload scan: 0.09465217590332031
offload 1 adapters, 22 remains
cost offload cat: 0.04124641418457031
cost offload free mem manager: 0.051021575927734375
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.6313323974609375 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 23 in total
Function load_lora_A took 6.081819534301758 ms to run.
Function load_lora_B took 6.034135818481445 ms to run.
cost realload: 12.58397102355957
Function load_adapters took 12.607336044311523 ms to run.
cost offload scan: 0.09942054748535156
offload 1 adapters, 22 remains
cost offload cat: 0.04696846008300781
cost offload free mem manager: 0.049114227294921875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11444091796875
Function offload_adapters took 0.6620883941650391 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 23 in total
Function load_lora_A took 6.048679351806641 ms to run.
Function load_lora_B took 6.01959228515625 ms to run.
cost realload: 12.55488395690918
Function load_adapters took 12.579917907714844 ms to run.
cost offload scan: 0.11229515075683594
offload 1 adapters, 22 remains
cost offload cat: 0.046253204345703125
cost offload free mem manager: 0.050067901611328125
cost offload torch.empty: 0.024318695068359375
cost offload a_loc update: 0.11587142944335938
Function offload_adapters took 0.6761550903320312 ms to run.
current batch size: 24 token used ratio: 0.1317846153846154
cost offload scan: 0.10824203491210938
offload 1 adapters, 21 remains
cost offload cat: 0.0457763671875
cost offload free mem manager: 0.04863739013671875
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.11658668518066406
Function offload_adapters took 0.6794929504394531 ms to run.
cost offload scan: 0.09918212890625
offload 1 adapters, 20 remains
cost offload cat: 0.04410743713378906
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.12111663818359375
Function offload_adapters took 0.6511211395263672 ms to run.
cost load scan: 0.010013580322265625
load 2 adapters, 22 in total
Function load_lora_A took 6.065845489501953 ms to run.
Function load_lora_B took 6.014585494995117 ms to run.
Function load_lora_A took 6.0710906982421875 ms to run.
Function load_lora_B took 6.032228469848633 ms to run.
cost realload: 24.774789810180664
Function load_adapters took 24.80030059814453 ms to run.
cost offload scan: 0.11944770812988281
offload 1 adapters, 21 remains
cost offload cat: 0.05650520324707031
cost offload free mem manager: 0.054836273193359375
cost offload torch.empty: 0.025272369384765625
cost offload a_loc update: 0.12969970703125
Function offload_adapters took 0.7691383361816406 ms to run.
current batch size: 23 token used ratio: 0.13843076923076922
cost offload scan: 0.10895729064941406
offload 1 adapters, 20 remains
cost offload cat: 0.048160552978515625
cost offload free mem manager: 0.04982948303222656
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.11849403381347656
Function offload_adapters took 0.7047653198242188 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 21 in total
Function load_lora_A took 6.108999252319336 ms to run.
Function load_lora_B took 6.0596466064453125 ms to run.
cost realload: 12.796401977539062
Function load_adapters took 12.824296951293945 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 22 in total
Function load_lora_A took 6.0901641845703125 ms to run.
Function load_lora_B took 6.109952926635742 ms to run.
cost realload: 12.734413146972656
Function load_adapters took 12.761116027832031 ms to run.
cost offload scan: 0.14638900756835938
offload 2 adapters, 20 remains
cost offload cat: 0.039577484130859375
cost offload free mem manager: 0.053882598876953125
cost offload torch.empty: 0.024318695068359375
cost offload a_loc update: 0.1163482666015625
Function offload_adapters took 0.7293224334716797 ms to run.
cost offload scan: 0.15163421630859375
offload 2 adapters, 18 remains
cost offload cat: 0.03910064697265625
cost offload free mem manager: 0.04935264587402344
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.12874603271484375
Function offload_adapters took 0.7216930389404297 ms to run.
cost load scan: 0.010728836059570312
load 0 adapters, 18 in total
cost realload: 0.453948974609375
Function load_adapters took 0.4818439483642578 ms to run.
cost offload scan: 0.09369850158691406
offload 1 adapters, 17 remains
cost offload cat: 0.04410743713378906
cost offload free mem manager: 0.04649162292480469
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11491775512695312
Function offload_adapters took 0.629425048828125 ms to run.
current batch size: 19 token used ratio: 0.12141538461538462
cost load scan: 0.00858306884765625
load 1 adapters, 18 in total
Function load_lora_A took 6.079912185668945 ms to run.
Function load_lora_B took 6.042957305908203 ms to run.
cost realload: 12.554645538330078
Function load_adapters took 12.57777214050293 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 17 remains
cost offload cat: 0.03910064697265625
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.6670951843261719 ms to run.
INFO:     127.0.0.1:55252 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:55266 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51078 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51084 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51094 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51110 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51118 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51120 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51134 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51144 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51160 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51172 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51184 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51192 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51198 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51214 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51224 - "POST /generate_stream HTTP/1.1" 200 OK
Avg tokens(prompt+generate) throughput: 1607.861 tokens/s
Avg prompt tokens throughput:            864.641 tokens/s
Avg generate tokens throughput:          743.220 tokens/s
cost load scan: 0.008344650268554688
load 0 adapters, 17 in total
cost realload: 0.2968311309814453
Function load_adapters took 0.3211498260498047 ms to run.
cost offload scan: 0.12159347534179688
offload 1 adapters, 16 remains
cost offload cat: 0.05793571472167969
cost offload free mem manager: 0.05984306335449219
cost offload torch.empty: 0.029325485229492188
cost offload a_loc update: 0.13399124145507812
Function offload_adapters took 0.7731914520263672 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 17 in total
Function load_lora_A took 6.096363067626953 ms to run.
Function load_lora_B took 6.103038787841797 ms to run.
cost realload: 12.788772583007812
Function load_adapters took 12.820005416870117 ms to run.
cost offload scan: 0.10800361633300781
offload 1 adapters, 16 remains
cost offload cat: 0.0476837158203125
cost offload free mem manager: 0.050067901611328125
cost offload torch.empty: 0.024318695068359375
cost offload a_loc update: 0.11849403381347656
Function offload_adapters took 0.69427490234375 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 15 remains
cost offload cat: 0.04029273986816406
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11181831359863281
Function offload_adapters took 0.6017684936523438 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 16 in total
Function load_lora_A took 6.07609748840332 ms to run.
Function load_lora_B took 6.0634613037109375 ms to run.
cost realload: 12.56418228149414
Function load_adapters took 12.58707046508789 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 15 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11205673217773438
Function offload_adapters took 0.5986690521240234 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 14 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.11205673217773438
Function offload_adapters took 0.5929470062255859 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 15 in total
Function load_lora_A took 6.0882568359375 ms to run.
Function load_lora_B took 6.068944931030273 ms to run.
cost realload: 12.574195861816406
Function load_adapters took 12.59613037109375 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 14 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.04839897155761719
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5922317504882812 ms to run.
current batch size: 16 token used ratio: 0.09527692307692308
cost offload scan: 0.1201629638671875
offload 1 adapters, 13 remains
cost offload cat: 0.04673004150390625
cost offload free mem manager: 0.05125999450683594
cost offload torch.empty: 0.024557113647460938
cost offload a_loc update: 0.118255615234375
Function offload_adapters took 0.7071495056152344 ms to run.
cost load scan: 0.00858306884765625
load 0 adapters, 13 in total
cost realload: 0.43463706970214844
Function load_adapters took 0.461578369140625 ms to run.
offload 0 adapters, 13 remains
Function offload_adapters took 0.01430511474609375 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 13 in total
cost realload: 0.31280517578125
Function load_adapters took 0.3390312194824219 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 12 remains
cost offload cat: 0.03838539123535156
cost offload free mem manager: 0.050067901611328125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.6139278411865234 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 11 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5888938903808594 ms to run.
cost load scan: 0.00858306884765625
load 2 adapters, 13 in total
Function load_lora_A took 6.036281585693359 ms to run.
Function load_lora_B took 6.017208099365234 ms to run.
Function load_lora_A took 6.073951721191406 ms to run.
Function load_lora_B took 6.030797958374023 ms to run.
cost realload: 24.633169174194336
Function load_adapters took 24.654150009155273 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 14 in total
Function load_lora_A took 6.077289581298828 ms to run.
Function load_lora_B took 6.054162979125977 ms to run.
cost realload: 12.566804885864258
Function load_adapters took 12.589216232299805 ms to run.
current batch size: 19 token used ratio: 0.10075384615384615
cost offload scan: 0.12946128845214844
offload 1 adapters, 13 remains
cost offload cat: 0.061511993408203125
cost offload free mem manager: 0.057697296142578125
cost offload torch.empty: 0.027418136596679688
cost offload a_loc update: 0.1392364501953125
Function offload_adapters took 0.8223056793212891 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 14 in total
Function load_lora_A took 6.128549575805664 ms to run.
Function load_lora_B took 6.074428558349609 ms to run.
cost realload: 12.685775756835938
Function load_adapters took 12.711524963378906 ms to run.
offload 0 adapters, 14 remains
Function offload_adapters took 0.016927719116210938 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 15 in total
Function load_lora_A took 6.074428558349609 ms to run.
Function load_lora_B took 6.049394607543945 ms to run.
cost realload: 12.586355209350586
Function load_adapters took 12.608766555786133 ms to run.
cost offload scan: 0.11992454528808594
offload 1 adapters, 14 remains
cost offload cat: 0.04673004150390625
cost offload free mem manager: 0.05125999450683594
cost offload torch.empty: 0.024318695068359375
cost offload a_loc update: 0.11968612670898438
Function offload_adapters took 0.6954669952392578 ms to run.
cost load scan: 0.010251998901367188
load 2 adapters, 16 in total
Function load_lora_A took 6.124019622802734 ms to run.
Function load_lora_B took 6.042242050170898 ms to run.
Function load_lora_A took 6.084680557250977 ms to run.
Function load_lora_B took 6.058692932128906 ms to run.
cost realload: 24.909019470214844
Function load_adapters took 24.939775466918945 ms to run.
cost offload scan: 0.09965896606445312
offload 1 adapters, 15 remains
cost offload cat: 0.056743621826171875
cost offload free mem manager: 0.05936622619628906
cost offload torch.empty: 0.030040740966796875
cost offload a_loc update: 0.14710426330566406
Function offload_adapters took 0.7739067077636719 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 15 in total
cost realload: 0.3261566162109375
Function load_adapters took 0.35309791564941406 ms to run.
offload 0 adapters, 15 remains
Function offload_adapters took 0.01621246337890625 ms to run.
current batch size: 19 token used ratio: 0.09524615384615384
cost offload scan: 0.1270771026611328
offload 1 adapters, 14 remains
cost offload cat: 0.05364418029785156
cost offload free mem manager: 0.06222724914550781
cost offload torch.empty: 0.03147125244140625
cost offload a_loc update: 0.1556873321533203
Function offload_adapters took 0.8101463317871094 ms to run.
offload 0 adapters, 14 remains
Function offload_adapters took 0.015497207641601562 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 14 in total
cost realload: 0.3311634063720703
Function load_adapters took 0.3571510314941406 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 15 in total
Function load_lora_A took 6.096124649047852 ms to run.
Function load_lora_B took 6.072282791137695 ms to run.
cost realload: 12.850046157836914
INFO:     127.0.0.1:51234 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51242 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51252 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51264 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51268 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51284 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51290 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51302 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51306 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51308 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51316 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51324 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51330 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51344 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51350 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51366 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51370 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51386 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51390 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51400 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51414 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51420 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51436 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51442 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51444 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51452 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51454 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51466 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:51472 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_adapters took 12.882471084594727 ms to run.
offload 0 adapters, 15 remains
Function offload_adapters took 0.0171661376953125 ms to run.
cost load scan: 0.010251998901367188
load 2 adapters, 17 in total
Function load_lora_A took 6.11567497253418 ms to run.
Function load_lora_B took 6.082773208618164 ms to run.
Function load_lora_A took 6.1092376708984375 ms to run.
Function load_lora_B took 6.063699722290039 ms to run.
cost realload: 25.041818618774414
Function load_adapters took 25.0704288482666 ms to run.
current batch size: 20 token used ratio: 0.10493846153846154
cost load scan: 0.008821487426757812
load 0 adapters, 17 in total
cost realload: 0.4048347473144531
Function load_adapters took 0.43320655822753906 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 18 in total
Function load_lora_A took 6.103754043579102 ms to run.
Function load_lora_B took 6.054401397705078 ms to run.
cost realload: 12.727499008178711
Function load_adapters took 12.756586074829102 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.019550323486328125 ms to run.
cost offload scan: 0.12087821960449219
offload 1 adapters, 17 remains
cost offload cat: 0.05555152893066406
cost offload free mem manager: 0.05984306335449219
cost offload torch.empty: 0.030040740966796875
cost offload a_loc update: 0.1430511474609375
Function offload_adapters took 0.8463859558105469 ms to run.
cost load scan: 0.019073486328125
load 2 adapters, 19 in total
Function load_lora_A took 6.113290786743164 ms to run.
Function load_lora_B took 6.0749053955078125 ms to run.
Function load_lora_A took 6.154537200927734 ms to run.
Function load_lora_B took 6.081104278564453 ms to run.
cost realload: 25.424480438232422
Function load_adapters took 25.47311782836914 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 20 in total
Function load_lora_A took 6.136417388916016 ms to run.
Function load_lora_B took 6.067514419555664 ms to run.
cost realload: 12.823104858398438
Function load_adapters took 12.856483459472656 ms to run.
current batch size: 23 token used ratio: 0.12424615384615384
cost load scan: 0.013828277587890625
load 5 adapters, 25 in total
Function load_lora_A took 6.191492080688477 ms to run.
Function load_lora_B took 6.143808364868164 ms to run.
Function load_lora_A took 6.137609481811523 ms to run.
Function load_lora_B took 6.055355072021484 ms to run.
Function load_lora_A took 6.108760833740234 ms to run.
Function load_lora_B took 6.03175163269043 ms to run.
Function load_lora_A took 6.100893020629883 ms to run.
Function load_lora_B took 6.061315536499023 ms to run.
Function load_lora_A took 6.092071533203125 ms to run.
Function load_lora_B took 6.083250045776367 ms to run.
cost realload: 62.262535095214844
Function load_adapters took 62.29257583618164 ms to run.
cost load scan: 0.015974044799804688
load 4 adapters, 29 in total
Function load_lora_A took 6.114959716796875 ms to run.
Function load_lora_B took 6.078243255615234 ms to run.
Function load_lora_A took 6.106853485107422 ms to run.
Function load_lora_B took 6.127595901489258 ms to run.
Function load_lora_A took 6.190776824951172 ms to run.
Function load_lora_B took 6.124973297119141 ms to run.
Function load_lora_A took 6.126642227172852 ms to run.
Function load_lora_B took 6.099224090576172 ms to run.
cost realload: 50.33230781555176
Function load_adapters took 50.3690242767334 ms to run.
cost offload scan: 0.09465217590332031
offload 1 adapters, 28 remains
cost offload cat: 0.0438690185546875
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.6363391876220703 ms to run.
cost offload scan: 0.11944770812988281
offload 1 adapters, 27 remains
cost offload cat: 0.044345855712890625
cost offload free mem manager: 0.04935264587402344
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.1163482666015625
Function offload_adapters took 0.7081031799316406 ms to run.
cost load scan: 0.009059906005859375
load 2 adapters, 29 in total
Function load_lora_A took 6.065130233764648 ms to run.
Function load_lora_B took 6.050825119018555 ms to run.
Function load_lora_A took 6.073474884033203 ms to run.
Function load_lora_B took 6.046533584594727 ms to run.
cost realload: 24.73139762878418
Function load_adapters took 24.754047393798828 ms to run.
cost load scan: 0.01049041748046875
load 3 adapters, 32 in total
Function load_lora_A took 6.075143814086914 ms to run.
Function load_lora_B took 6.110429763793945 ms to run.
Function load_lora_A took 6.073713302612305 ms to run.
Function load_lora_B took 6.064414978027344 ms to run.
Function load_lora_A took 6.095647811889648 ms to run.
Function load_lora_B took 6.053924560546875 ms to run.
cost realload: 37.32657432556152
Function load_adapters took 37.360191345214844 ms to run.
cost load scan: 0.0095367431640625
load 2 adapters, 34 in total
Function load_lora_A took 6.127834320068359 ms to run.
Function load_lora_B took 6.072998046875 ms to run.
Function load_lora_A took 6.086587905883789 ms to run.
Function load_lora_B took 6.044149398803711 ms to run.
cost realload: 24.909496307373047
Function load_adapters took 24.94025230407715 ms to run.
current batch size: 37 token used ratio: 0.20252307692307692
cost offload scan: 0.15044212341308594
offload 2 adapters, 32 remains
cost offload cat: 0.038623809814453125
cost offload free mem manager: 0.04982948303222656
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.12683868408203125
Function offload_adapters took 0.7216930389404297 ms to run.
cost load scan: 0.01430511474609375
load 1 adapters, 33 in total
Function load_lora_A took 6.118297576904297 ms to run.
Function load_lora_B took 6.064653396606445 ms to run.
cost realload: 12.750387191772461
Function load_adapters took 12.77923583984375 ms to run.
offload 0 adapters, 33 remains
Function offload_adapters took 0.017404556274414062 ms to run.
offload 0 adapters, 33 remains
Function offload_adapters took 0.0171661376953125 ms to run.
cost offload scan: 0.1456737518310547
offload 2 adapters, 31 remains
cost offload cat: 0.0400543212890625
cost offload free mem manager: 0.04935264587402344
cost offload torch.empty: 0.023603439331054688
cost offload a_loc update: 0.12135505676269531
Function offload_adapters took 0.7305145263671875 ms to run.
cost load scan: 0.008821487426757812
load 0 adapters, 31 in total
cost realload: 0.37097930908203125
Function load_adapters took 0.3979206085205078 ms to run.
offload 0 adapters, 31 remains
Function offload_adapters took 0.0171661376953125 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 32 in total
Function load_lora_A took 6.10661506652832 ms to run.
Function load_lora_B took 6.1016082763671875 ms to run.
cost realload: 12.790203094482422
Function load_adapters took 12.822151184082031 ms to run.
cost offload scan: 0.17333030700683594
offload 1 adapters, 31 remains
cost offload cat: 0.08082389831542969
cost offload free mem manager: 0.07748603820800781
cost offload torch.empty: 0.03600120544433594
cost offload a_loc update: 0.17976760864257812
Function offload_adapters took 1.1076927185058594 ms to run.
cost offload scan: 0.10418891906738281
offload 1 adapters, 30 remains
cost offload cat: 0.04410743713378906
cost offload free mem manager: 0.04673004150390625
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.6656646728515625 ms to run.
Avg tokens(prompt+generate) throughput: 1832.316 tokens/s
Avg prompt tokens throughput:           1155.021 tokens/s
Avg generate tokens throughput:          677.295 tokens/s
cost load scan: 0.010013580322265625
load 1 adapters, 31 in total
Function load_lora_A took 6.084442138671875 ms to run.
Function load_lora_B took 6.0520172119140625 ms to run.
cost realload: 12.679815292358398
Function load_adapters took 12.705564498901367 ms to run.
current batch size: 33 token used ratio: 0.18155384615384615
cost load scan: 0.008821487426757812
load 0 adapters, 31 in total
cost realload: 0.43773651123046875
INFO:     127.0.0.1:51478 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38152 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38158 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38166 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38172 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38178 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38184 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38186 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38198 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38202 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38218 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38220 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38236 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38250 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_adapters took 0.4668235778808594 ms to run.
cost offload scan: 0.11515617370605469
offload 1 adapters, 30 remains
cost offload cat: 0.04696846008300781
cost offload free mem manager: 0.05173683166503906
cost offload torch.empty: 0.024080276489257812
cost offload a_loc update: 0.13709068298339844
Function offload_adapters took 0.7703304290771484 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 31 in total
Function load_lora_A took 6.093025207519531 ms to run.
Function load_lora_B took 6.071567535400391 ms to run.
cost realload: 12.60995864868164
Function load_adapters took 12.63284683227539 ms to run.
cost offload scan: 0.14257431030273438
offload 1 adapters, 30 remains
cost offload cat: 0.06723403930664062
cost offload free mem manager: 0.0667572021484375
cost offload torch.empty: 0.03719329833984375
cost offload a_loc update: 0.1652240753173828
Function offload_adapters took 0.9641647338867188 ms to run.
cost offload scan: 0.16498565673828125
offload 2 adapters, 28 remains
cost offload cat: 0.0438690185546875
cost offload free mem manager: 0.05316734313964844
cost offload torch.empty: 0.029325485229492188
cost offload a_loc update: 0.1354217529296875
Function offload_adapters took 0.8115768432617188 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 29 in total
Function load_lora_A took 6.078243255615234 ms to run.
Function load_lora_B took 6.020784378051758 ms to run.
cost realload: 12.531518936157227
Function load_adapters took 12.55488395690918 ms to run.
cost offload scan: 0.09632110595703125
offload 1 adapters, 28 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.5943775177001953 ms to run.
cost offload scan: 0.09441375732421875
offload 1 adapters, 27 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.6127357482910156 ms to run.
cost load scan: 0.010013580322265625
load 3 adapters, 30 in total
Function load_lora_A took 6.109476089477539 ms to run.
Function load_lora_B took 6.045818328857422 ms to run.
Function load_lora_A took 6.018400192260742 ms to run.
Function load_lora_B took 6.028413772583008 ms to run.
Function load_lora_A took 6.037235260009766 ms to run.
Function load_lora_B took 6.016254425048828 ms to run.
cost realload: 36.789894104003906
Function load_adapters took 36.81492805480957 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 29 remains
cost offload cat: 0.03504753112792969
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.598907470703125 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 28 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.58746337890625 ms to run.
current batch size: 32 token used ratio: 0.18913846153846153
cost load scan: 0.008344650268554688
load 1 adapters, 29 in total
Function load_lora_A took 6.087064743041992 ms to run.
Function load_lora_B took 6.0443878173828125 ms to run.
cost realload: 12.53652572631836
Function load_adapters took 12.558937072753906 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 28 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.021457672119140625
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5884170532226562 ms to run.
cost offload scan: 0.09226799011230469
offload 1 adapters, 27 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04124641418457031
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5784034729003906 ms to run.
cost offload scan: 0.164031982421875
offload 3 adapters, 24 remains
cost offload cat: 0.027179718017578125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.6568431854248047 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 23 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04887580871582031
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5855560302734375 ms to run.
offload 0 adapters, 23 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost offload scan: 0.095367431640625
offload 1 adapters, 22 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5817413330078125 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 21 remains
cost offload cat: 0.0362396240234375
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11229515075683594
Function offload_adapters took 0.5924701690673828 ms to run.
current batch size: 24 token used ratio: 0.14672307692307693
cost offload scan: 0.08988380432128906
offload 1 adapters, 20 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.583648681640625 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 20 in total
cost realload: 0.28133392333984375
Function load_adapters took 0.30493736267089844 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 21 in total
Function load_lora_A took 6.083011627197266 ms to run.
Function load_lora_B took 6.031513214111328 ms to run.
cost realload: 12.533426284790039
Function load_adapters took 12.5579833984375 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.014781951904296875 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 22 in total
Function load_lora_A took 6.090641021728516 ms to run.
Function load_lora_B took 6.050586700439453 ms to run.
cost realload: 12.543439865112305
Function load_adapters took 12.566089630126953 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 21 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11873245239257812
Function offload_adapters took 0.5931854248046875 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 20 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5831718444824219 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.015974044799804688 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 19 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5633831024169922 ms to run.
cost load scan: 0.01239776611328125
load 1 adapters, 20 in total
Function load_lora_A took 6.081819534301758 ms to run.
Function load_lora_B took 6.019830703735352 ms to run.
cost realload: 12.50767707824707
Function load_adapters took 12.529373168945312 ms to run.
cost load scan: 0.015020370483398438
load 3 adapters, 23 in total
INFO:     127.0.0.1:38256 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38258 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38266 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38268 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38278 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38292 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38296 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38298 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38314 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38320 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38324 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38326 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38338 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38342 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 6.061077117919922 ms to run.
Function load_lora_B took 6.071805953979492 ms to run.
Function load_lora_A took 6.080150604248047 ms to run.
Function load_lora_B took 6.035327911376953 ms to run.
Function load_lora_A took 6.024360656738281 ms to run.
Function load_lora_B took 6.00743293762207 ms to run.
cost realload: 36.85784339904785
Function load_adapters took 36.8807315826416 ms to run.
cost offload scan: 0.09465217590332031
offload 1 adapters, 22 remains
cost offload cat: 0.03600120544433594
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.5927085876464844 ms to run.
current batch size: 23 token used ratio: 0.13504615384615384
cost load scan: 0.013828277587890625
load 1 adapters, 23 in total
Function load_lora_A took 6.077051162719727 ms to run.
Function load_lora_B took 6.047487258911133 ms to run.
cost realload: 12.531518936157227
Function load_adapters took 12.552499771118164 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 22 remains
cost offload cat: 0.038623809814453125
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.118255615234375
Function offload_adapters took 0.6046295166015625 ms to run.
cost load scan: 0.010013580322265625
load 1 adapters, 23 in total
Function load_lora_A took 6.084442138671875 ms to run.
Function load_lora_B took 6.043434143066406 ms to run.
cost realload: 12.531042098999023
Function load_adapters took 12.555122375488281 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 22 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5910396575927734 ms to run.
cost load scan: 0.014543533325195312
load 1 adapters, 23 in total
Function load_lora_A took 6.06536865234375 ms to run.
Function load_lora_B took 6.01506233215332 ms to run.
cost realload: 12.480020523071289
Function load_adapters took 12.502193450927734 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 22 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5972385406494141 ms to run.
cost load scan: 0.0171661376953125
load 4 adapters, 26 in total
Function load_lora_A took 6.079912185668945 ms to run.
Function load_lora_B took 6.024599075317383 ms to run.
Function load_lora_A took 6.06846809387207 ms to run.
Function load_lora_B took 6.033897399902344 ms to run.
Function load_lora_A took 6.080389022827148 ms to run.
Function load_lora_B took 6.054162979125977 ms to run.
Function load_lora_A took 6.079912185668945 ms to run.
Function load_lora_B took 6.048917770385742 ms to run.
cost realload: 49.088239669799805
Function load_adapters took 49.11065101623535 ms to run.
current batch size: 27 token used ratio: 0.15856923076923077
cost offload scan: 0.09083747863769531
offload 1 adapters, 25 remains
cost offload cat: 0.03790855407714844
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5967617034912109 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 24 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5903244018554688 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 23 remains
cost offload cat: 0.03933906555175781
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5848407745361328 ms to run.
cost load scan: 0.01430511474609375
load 1 adapters, 24 in total
Function load_lora_A took 6.08372688293457 ms to run.
Function load_lora_B took 6.0291290283203125 ms to run.
cost realload: 12.537240982055664
Function load_adapters took 12.559890747070312 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 25 in total
Function load_lora_A took 6.080150604248047 ms to run.
Function load_lora_B took 6.036281585693359 ms to run.
cost realload: 12.517690658569336
Function load_adapters took 12.539386749267578 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 24 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04100799560546875
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5695819854736328 ms to run.
cost load scan: 0.014781951904296875
load 1 adapters, 25 in total
Function load_lora_A took 6.084680557250977 ms to run.
Function load_lora_B took 6.040811538696289 ms to run.
cost realload: 12.5274658203125
Function load_adapters took 12.550115585327148 ms to run.
offload 0 adapters, 25 remains
Function offload_adapters took 0.012636184692382812 ms to run.
current batch size: 25 token used ratio: 0.15096923076923077
cost load scan: 0.014066696166992188
load 1 adapters, 26 in total
Function load_lora_A took 6.079912185668945 ms to run.
Function load_lora_B took 6.036281585693359 ms to run.
cost realload: 12.519359588623047
Function load_adapters took 12.541532516479492 ms to run.
cost offload scan: 0.1308917999267578
offload 2 adapters, 24 remains
cost offload cat: 0.026464462280273438
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.6163120269775391 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 25 in total
Function load_lora_A took 6.078004837036133 ms to run.
Function load_lora_B took 6.0596466064453125 ms to run.
cost realload: 12.528419494628906
Function load_adapters took 12.549638748168945 ms to run.
cost offload scan: 0.09846687316894531
offload 1 adapters, 24 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.58746337890625 ms to run.
cost offload scan: 0.12803077697753906
offload 2 adapters, 22 remains
cost offload cat: 0.0247955322265625
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.6122589111328125 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 21 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5755424499511719 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 22 in total
Function load_lora_A took 6.072759628295898 ms to run.
Function load_lora_B took 6.018400192260742 ms to run.
cost realload: 12.486696243286133
Function load_adapters took 12.508392333984375 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 23 in total
Function load_lora_A took 6.036043167114258 ms to run.
Function load_lora_B took 6.026029586791992 ms to run.
cost realload: 12.461185455322266
Function load_adapters took 12.483358383178711 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 22 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5743503570556641 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 21 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.042438507080078125
INFO:     127.0.0.1:38350 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38366 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38382 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38388 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38396 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38402 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38410 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:38420 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59794 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59800 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59816 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59828 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59844 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59852 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.6122589111328125 ms to run.
current batch size: 21 token used ratio: 0.12361538461538461
cost offload scan: 0.08440017700195312
offload 1 adapters, 20 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5652904510498047 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 21 in total
Function load_lora_A took 6.078481674194336 ms to run.
Function load_lora_B took 6.023406982421875 ms to run.
cost realload: 12.502908706665039
Function load_adapters took 12.524843215942383 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 20 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.5838871002197266 ms to run.
cost load scan: 0.0095367431640625
load 2 adapters, 22 in total
Function load_lora_A took 6.095170974731445 ms to run.
Function load_lora_B took 6.042003631591797 ms to run.
Function load_lora_A took 6.091594696044922 ms to run.
Function load_lora_B took 6.045103073120117 ms to run.
cost realload: 24.74188804626465
Function load_adapters took 24.76358413696289 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 21 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5822181701660156 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 20 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.576019287109375 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 21 in total
Function load_lora_A took 6.087779998779297 ms to run.
Function load_lora_B took 6.03795051574707 ms to run.
cost realload: 12.534141540527344
Function load_adapters took 12.557506561279297 ms to run.
cost offload scan: 0.08368492126464844
offload 1 adapters, 20 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5748271942138672 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 19 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04792213439941406
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5738735198974609 ms to run.
current batch size: 19 token used ratio: 0.10963076923076923
cost offload scan: 0.08511543273925781
offload 1 adapters, 18 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5714893341064453 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 19 in total
Function load_lora_A took 6.079196929931641 ms to run.
Function load_lora_B took 6.051063537597656 ms to run.
cost realload: 12.53652572631836
Function load_adapters took 12.558937072753906 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 19 in total
cost realload: 0.2963542938232422
Function load_adapters took 0.32258033752441406 ms to run.
Avg tokens(prompt+generate) throughput: 1860.702 tokens/s
Avg prompt tokens throughput:            962.256 tokens/s
Avg generate tokens throughput:          898.445 tokens/s
cost offload scan: 0.09036064147949219
offload 1 adapters, 18 remains
cost offload cat: 0.03647804260253906
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5810260772705078 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.012159347534179688 ms to run.
current batch size: 19 token used ratio: 0.11236923076923076
cost offload scan: 0.12183189392089844
offload 2 adapters, 16 remains
cost offload cat: 0.027179718017578125
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.598907470703125 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 17 in total
Function load_lora_A took 6.080389022827148 ms to run.
Function load_lora_B took 6.06226921081543 ms to run.
cost realload: 12.524604797363281
Function load_adapters took 12.549638748168945 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 16 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5691051483154297 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 17 in total
Function load_lora_A took 6.072044372558594 ms to run.
Function load_lora_B took 6.052494049072266 ms to run.
cost realload: 12.52436637878418
Function load_adapters took 12.546777725219727 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 16 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04124641418457031
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.110626220703125
Function offload_adapters took 0.5726814270019531 ms to run.
current batch size: 17 token used ratio: 0.10533846153846153
cost offload scan: 0.08225440979003906
offload 1 adapters, 15 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11658668518066406
Function offload_adapters took 0.5788803100585938 ms to run.
cost offload scan: 0.08273124694824219
offload 1 adapters, 14 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10275840759277344
Function offload_adapters took 0.5614757537841797 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 15 in total
Function load_lora_A took 6.062984466552734 ms to run.
Function load_lora_B took 6.032466888427734 ms to run.
cost realload: 12.496709823608398
Function load_adapters took 12.519121170043945 ms to run.
cost load scan: 0.014066696166992188
load 1 adapters, 16 in total
Function load_lora_A took 6.023645401000977 ms to run.
Function load_lora_B took 6.016969680786133 ms to run.
cost realload: 12.453794479370117
Function load_adapters took 12.475252151489258 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 15 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5664825439453125 ms to run.
cost load scan: 0.01430511474609375
load 1 adapters, 16 in total
Function load_lora_A took 6.066560745239258 ms to run.
Function load_lora_B took 6.030797958374023 ms to run.
cost realload: 12.491703033447266
Function load_adapters took 12.515068054199219 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 15 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5688667297363281 ms to run.
current batch size: 17 token used ratio: 0.10221538461538461
cost load scan: 0.012159347534179688
load 1 adapters, 16 in total
INFO:     127.0.0.1:59860 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59866 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59874 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59876 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59888 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59896 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59910 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59918 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59928 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59934 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59944 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59954 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59966 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59972 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59986 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:59988 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60004 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60020 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60032 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60034 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60040 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60042 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60058 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 6.089210510253906 ms to run.
Function load_lora_B took 6.066083908081055 ms to run.
cost realload: 12.591123580932617
Function load_adapters took 12.613058090209961 ms to run.
cost offload scan: 0.08296966552734375
offload 1 adapters, 15 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5729198455810547 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 16 in total
Function load_lora_A took 6.082057952880859 ms to run.
Function load_lora_B took 6.069421768188477 ms to run.
cost realload: 12.536048889160156
Function load_adapters took 12.558221817016602 ms to run.
cost load scan: 0.009059906005859375
load 2 adapters, 18 in total
Function load_lora_A took 6.070852279663086 ms to run.
Function load_lora_B took 6.06083869934082 ms to run.
Function load_lora_A took 6.044864654541016 ms to run.
Function load_lora_B took 6.029844284057617 ms to run.
cost realload: 24.68419075012207
Function load_adapters took 24.706363677978516 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 17 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5757808685302734 ms to run.
cost offload scan: 0.08368492126464844
offload 1 adapters, 16 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10251998901367188
Function offload_adapters took 0.5612373352050781 ms to run.
cost offload scan: 0.08249282836914062
offload 1 adapters, 15 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5776882171630859 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 15 in total
cost realload: 0.2872943878173828
Function load_adapters took 0.3139972686767578 ms to run.
offload 0 adapters, 15 remains
Function offload_adapters took 0.011682510375976562 ms to run.
current batch size: 17 token used ratio: 0.09878461538461539
cost offload scan: 0.08392333984375
offload 1 adapters, 14 remains
cost offload cat: 0.036716461181640625
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5700588226318359 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 14 in total
cost realload: 0.2841949462890625
Function load_adapters took 0.308990478515625 ms to run.
cost load scan: 0.0152587890625
load 1 adapters, 15 in total
Function load_lora_A took 6.089210510253906 ms to run.
Function load_lora_B took 6.048679351806641 ms to run.
cost realload: 12.540340423583984
Function load_adapters took 12.562990188598633 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 16 in total
Function load_lora_A took 6.089448928833008 ms to run.
Function load_lora_B took 6.039142608642578 ms to run.
cost realload: 12.530803680419922
Function load_adapters took 12.552976608276367 ms to run.
cost load scan: 0.015974044799804688
load 5 adapters, 21 in total
Function load_lora_A took 6.071329116821289 ms to run.
Function load_lora_B took 6.042718887329102 ms to run.
Function load_lora_A took 6.056308746337891 ms to run.
Function load_lora_B took 6.043434143066406 ms to run.
Function load_lora_A took 6.058931350708008 ms to run.
Function load_lora_B took 6.031036376953125 ms to run.
Function load_lora_A took 6.066322326660156 ms to run.
Function load_lora_B took 6.034374237060547 ms to run.
Function load_lora_A took 6.072998046875 ms to run.
Function load_lora_B took 6.038427352905273 ms to run.
cost realload: 61.19036674499512
Function load_adapters took 61.21253967285156 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.0133514404296875 ms to run.
current batch size: 23 token used ratio: 0.13353846153846155
cost load scan: 0.015974044799804688
load 2 adapters, 23 in total
Function load_lora_A took 6.093263626098633 ms to run.
Function load_lora_B took 6.048917770385742 ms to run.
Function load_lora_A took 6.063938140869141 ms to run.
Function load_lora_B took 6.052732467651367 ms to run.
cost realload: 24.742603302001953
Function load_adapters took 24.764299392700195 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 22 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5857944488525391 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 21 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.040531158447265625
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5643367767333984 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 21 in total
cost realload: 0.286102294921875
Function load_adapters took 0.3123283386230469 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 22 in total
Function load_lora_A took 6.092309951782227 ms to run.
Function load_lora_B took 6.023883819580078 ms to run.
cost realload: 12.498140335083008
Function load_adapters took 12.519598007202148 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 21 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5681514739990234 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 22 in total
Function load_lora_A took 6.04248046875 ms to run.
Function load_lora_B took 6.016016006469727 ms to run.
cost realload: 12.460708618164062
Function load_adapters took 12.482881546020508 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.01239776611328125 ms to run.
current batch size: 25 token used ratio: 0.1426
cost offload scan: 0.08654594421386719
offload 1 adapters, 21 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5846023559570312 ms to run.
cost offload scan: 0.08559226989746094
offload 1 adapters, 20 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5805492401123047 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 21 in total
Function load_lora_A took 6.092548370361328 ms to run.
Function load_lora_B took 6.0405731201171875 ms to run.
cost realload: 12.529850006103516
Function load_adapters took 12.551307678222656 ms to run.
cost load scan: 0.009298324584960938
load 3 adapters, 24 in total
Function load_lora_A took 6.09278678894043 ms to run.
Function load_lora_B took 6.049871444702148 ms to run.
Function load_lora_A took 6.043434143066406 ms to run.
Function load_lora_B took 5.993127822875977 ms to run.
Function load_lora_A took 6.037235260009766 ms to run.
Function load_lora_B took 6.019353866577148 ms to run.
cost realload: 36.779165267944336
Function load_adapters took 36.79990768432617 ms to run.
cost offload scan: 0.09179115295410156
offload 1 adapters, 23 remains
cost offload cat: 0.03528594970703125
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5850791931152344 ms to run.
cost offload scan: 0.09512901306152344
offload 1 adapters, 22 remains
cost offload cat: INFO:     127.0.0.1:60072 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60080 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60090 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60094 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60096 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60106 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60110 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60124 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60130 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60134 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60136 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60144 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60150 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:60156 - "POST /generate_stream HTTP/1.1" 200 OK
0.03170967102050781
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.6146430969238281 ms to run.
cost offload scan: 0.09560585021972656
offload 1 adapters, 21 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.102996826171875
Function offload_adapters took 0.5788803100585938 ms to run.
current batch size: 24 token used ratio: 0.13983076923076923
cost load scan: 0.008821487426757812
load 1 adapters, 22 in total
Function load_lora_A took 6.077289581298828 ms to run.
Function load_lora_B took 6.047248840332031 ms to run.
cost realload: 12.52436637878418
Function load_adapters took 12.546539306640625 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 21 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11181831359863281
Function offload_adapters took 0.5776882171630859 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 22 in total
Function load_lora_A took 6.079912185668945 ms to run.
Function load_lora_B took 6.037473678588867 ms to run.
cost realload: 12.517929077148438
Function load_adapters took 12.540340423583984 ms to run.
cost load scan: 0.0171661376953125
load 3 adapters, 25 in total
Function load_lora_A took 6.052255630493164 ms to run.
Function load_lora_B took 6.055355072021484 ms to run.
Function load_lora_A took 6.08515739440918 ms to run.
Function load_lora_B took 6.050825119018555 ms to run.
Function load_lora_A took 6.073474884033203 ms to run.
Function load_lora_B took 6.062030792236328 ms to run.
cost realload: 36.931753158569336
Function load_adapters took 36.95368766784668 ms to run.
cost load scan: 0.012636184692382812
load 2 adapters, 27 in total
Function load_lora_A took 6.101369857788086 ms to run.
Function load_lora_B took 6.036043167114258 ms to run.
Function load_lora_A took 6.062507629394531 ms to run.
Function load_lora_B took 6.025552749633789 ms to run.
cost realload: 24.707794189453125
Function load_adapters took 24.72996711730957 ms to run.
offload 0 adapters, 27 remains
Function offload_adapters took 0.0133514404296875 ms to run.
cost offload scan: 0.09942054748535156
offload 1 adapters, 26 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.5934238433837891 ms to run.
cost load scan: 0.01430511474609375
load 2 adapters, 28 in total
Function load_lora_A took 6.061553955078125 ms to run.
Function load_lora_B took 6.029367446899414 ms to run.
Function load_lora_A took 6.055593490600586 ms to run.
Function load_lora_B took 6.048440933227539 ms to run.
cost realload: 24.667024612426758
Function load_adapters took 24.689435958862305 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 27 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.041484832763671875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5686283111572266 ms to run.
current batch size: 29 token used ratio: 0.1585076923076923
cost offload scan: 0.09202957153320312
offload 1 adapters, 26 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5745887756347656 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 25 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.0476837158203125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5898475646972656 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 24 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5724430084228516 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 23 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5753040313720703 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 22 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.5810260772705078 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 23 in total
Function load_lora_A took 6.046295166015625 ms to run.
Function load_lora_B took 5.997180938720703 ms to run.
cost realload: 12.447834014892578
Function load_adapters took 12.469053268432617 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 22 remains
cost offload cat: 0.03790855407714844
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5936622619628906 ms to run.
Avg tokens(prompt+generate) throughput: 1898.402 tokens/s
Avg prompt tokens throughput:           1071.513 tokens/s
Avg generate tokens throughput:          826.889 tokens/s
cost load scan: 0.007867813110351562
load 1 adapters, 23 in total
Function load_lora_A took 6.049156188964844 ms to run.
Function load_lora_B took 6.026983261108398 ms to run.
cost realload: 12.472867965698242
Function load_adapters took 12.496709823608398 ms to run.
current batch size: 26 token used ratio: 0.14756923076923076
cost offload scan: 0.08511543273925781
offload 1 adapters, 22 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5700588226318359 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 21 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5614757537841797 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost load scan: 0.01430511474609375
load 1 adapters, 22 in total
Function load_lora_A took 6.071329116821289 ms to run.
Function load_lora_B took 6.055355072021484 ms to run.
cost realload: 12.51983642578125
Function load_adapters took 12.541055679321289 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 21 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.568389892578125 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 22 in total
Function load_lora_A took 6.09588623046875 ms to run.
Function load_lora_B took 6.054878234863281 ms to run.
cost realload: 12.555837631225586
Function load_adapters took 12.578248977661133 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 21 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.028848648071289062
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5755424499511719 ms to run.
cost offload scan: 0.08368492126464844
offload 1 adapters, 20 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: INFO:     127.0.0.1:42160 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42174 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42182 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42184 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42186 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42198 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42212 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42226 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42240 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42250 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42258 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42272 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42278 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42288 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42302 - "POST /generate_stream HTTP/1.1" 200 OK
0.02193450927734375
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5934238433837891 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 19 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.041484832763671875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5590915679931641 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 18 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.5741119384765625 ms to run.
cost offload scan: 0.08153915405273438
offload 1 adapters, 17 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.1010894775390625
Function offload_adapters took 0.5626678466796875 ms to run.
cost offload scan: 0.12612342834472656
offload 2 adapters, 15 remains
cost offload cat: 0.02574920654296875
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.6000995635986328 ms to run.
current batch size: 17 token used ratio: 0.09773846153846154
cost load scan: 0.008106231689453125
load 1 adapters, 16 in total
Function load_lora_A took 6.090402603149414 ms to run.
Function load_lora_B took 6.0558319091796875 ms to run.
cost realload: 12.540340423583984
Function load_adapters took 12.561798095703125 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 15 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5741119384765625 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 16 in total
Function load_lora_A took 6.047725677490234 ms to run.
Function load_lora_B took 6.014585494995117 ms to run.
cost realload: 12.465715408325195
Function load_adapters took 12.486696243286133 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 17 in total
Function load_lora_A took 6.06083869934082 ms to run.
Function load_lora_B took 6.03032112121582 ms to run.
cost realload: 12.481689453125
Function load_adapters took 12.502908706665039 ms to run.
cost load scan: 0.007867813110351562
load 1 adapters, 18 in total
Function load_lora_A took 6.071329116821289 ms to run.
Function load_lora_B took 6.047248840332031 ms to run.
cost realload: 12.502908706665039
Function load_adapters took 12.524604797363281 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.01430511474609375 ms to run.
current batch size: 18 token used ratio: 0.1012
cost offload scan: 0.08845329284667969
offload 1 adapters, 17 remains
cost offload cat: 0.036716461181640625
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.5924701690673828 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 16 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5748271942138672 ms to run.
cost load scan: 0.020503997802734375
load 1 adapters, 17 in total
Function load_lora_A took 6.094932556152344 ms to run.
Function load_lora_B took 6.0367584228515625 ms to run.
cost realload: 12.53819465637207
Function load_adapters took 12.560129165649414 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 16 remains
cost offload cat: 0.03886222839355469
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5872249603271484 ms to run.
current batch size: 16 token used ratio: 0.0950923076923077
cost load scan: 0.008344650268554688
load 1 adapters, 17 in total
Function load_lora_A took 6.053686141967773 ms to run.
Function load_lora_B took 6.028413772583008 ms to run.
cost realload: 12.485980987548828
Function load_adapters took 12.508392333984375 ms to run.
cost offload scan: 0.08296966552734375
offload 1 adapters, 16 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04792213439941406
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5681514739990234 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 16 in total
cost realload: 0.2827644348144531
Function load_adapters took 0.30684471130371094 ms to run.
cost offload scan: 0.08368492126464844
offload 1 adapters, 15 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10275840759277344
Function offload_adapters took 0.5660057067871094 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 14 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.027894973754882812
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.5927085876464844 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 15 in total
Function load_lora_A took 6.107091903686523 ms to run.
Function load_lora_B took 6.062746047973633 ms to run.
cost realload: 12.563228607177734
Function load_adapters took 12.584924697875977 ms to run.
cost offload scan: 0.08463859558105469
offload 1 adapters, 14 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10228157043457031
Function offload_adapters took 0.5583763122558594 ms to run.
cost offload scan: 0.0820159912109375
offload 1 adapters, 13 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04124641418457031
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.1010894775390625
Function offload_adapters took 0.5500316619873047 ms to run.
cost load scan: 0.009059906005859375
load 2 adapters, 15 in total
Function load_lora_A took 6.077289581298828 ms to run.
Function load_lora_B took 6.051778793334961 ms to run.
Function load_lora_A took 6.096124649047852 ms to run.
Function load_lora_B took 6.04557991027832 ms to run.
cost realload: 24.755001068115234
Function load_adapters took 24.775981903076172 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 14 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04601478576660156
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.11038780212402344
Function offload_adapters took 0.5824565887451172 ms to run.
current batch size: 16 token used ratio: 0.08107692307692307
cost load scan: 0.012636184692382812
load 3 adapters, 17 in total
Function load_lora_A took 6.096839904785156 ms to run.
Function load_lora_B took 6.041049957275391 ms to run.
Function load_lora_A took 6.056308746337891 ms to run.
Function load_lora_B took 6.001949310302734 ms to run.
Function load_lora_A took 6.078481674194336 ms to run.
Function load_lora_B took 6.064653396606445 ms to run.
cost realload: 36.879777908325195
Function load_adapters took 36.90290451049805 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 16 remains
cost offload cat: 0.036716461181640625
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.5891323089599609 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 15 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: INFO:     127.0.0.1:42310 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42322 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42330 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42346 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42356 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42362 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42370 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42386 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42402 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42404 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42420 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42430 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42444 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42452 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42462 - "POST /generate_stream HTTP/1.1" 200 OK
0.04220008850097656
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.6246566772460938 ms to run.
cost load scan: 0.012159347534179688
load 1 adapters, 16 in total
Function load_lora_A took 6.088972091674805 ms to run.
Function load_lora_B took 6.04248046875 ms to run.
cost realload: 12.534856796264648
Function load_adapters took 12.5579833984375 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 17 in total
Function load_lora_A took 6.096363067626953 ms to run.
Function load_lora_B took 6.049871444702148 ms to run.
cost realload: 12.54415512084961
Function load_adapters took 12.565851211547852 ms to run.
cost offload scan: 0.08940696716308594
offload 1 adapters, 16 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.5791187286376953 ms to run.
cost load scan: 0.013113021850585938
load 2 adapters, 18 in total
Function load_lora_A took 6.038904190063477 ms to run.
Function load_lora_B took 6.014585494995117 ms to run.
Function load_lora_A took 6.062984466552734 ms to run.
Function load_lora_B took 6.031274795532227 ms to run.
cost realload: 24.626493453979492
Function load_adapters took 24.648189544677734 ms to run.
current batch size: 20 token used ratio: 0.09887692307692307
cost offload scan: 0.09298324584960938
offload 1 adapters, 17 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5848407745361328 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 18 in total
Function load_lora_A took 6.068944931030273 ms to run.
Function load_lora_B took 6.039857864379883 ms to run.
cost realload: 12.515068054199219
Function load_adapters took 12.537002563476562 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 19 in total
Function load_lora_A took 6.096363067626953 ms to run.
Function load_lora_B took 6.054162979125977 ms to run.
cost realload: 12.561798095703125
Function load_adapters took 12.588977813720703 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 18 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5762577056884766 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 17 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10228157043457031
Function offload_adapters took 0.5598068237304688 ms to run.
cost load scan: 0.010013580322265625
load 1 adapters, 18 in total
Function load_lora_A took 6.047248840332031 ms to run.
Function load_lora_B took 6.023883819580078 ms to run.
cost realload: 12.46023178100586
Function load_adapters took 12.481451034545898 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 17 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5767345428466797 ms to run.
current batch size: 19 token used ratio: 0.09621538461538462
cost load scan: 0.01049041748046875
load 1 adapters, 18 in total
Function load_lora_A took 6.065845489501953 ms to run.
Function load_lora_B took 6.047487258911133 ms to run.
cost realload: 12.504339218139648
Function load_adapters took 12.52603530883789 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 17 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5764961242675781 ms to run.
cost offload scan: 0.08296966552734375
offload 1 adapters, 16 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.021457672119140625
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5576610565185547 ms to run.
cost offload scan: 0.08273124694824219
offload 1 adapters, 15 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.5679130554199219 ms to run.
cost load scan: 0.012636184692382812
load 2 adapters, 17 in total
Function load_lora_A took 6.042003631591797 ms to run.
Function load_lora_B took 6.044626235961914 ms to run.
Function load_lora_A took 6.066799163818359 ms to run.
Function load_lora_B took 6.041765213012695 ms to run.
cost realload: 24.66106414794922
Function load_adapters took 24.685144424438477 ms to run.
offload 0 adapters, 17 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 17 in total
cost realload: 0.30303001403808594
Function load_adapters took 0.32830238342285156 ms to run.
current batch size: 19 token used ratio: 0.09935384615384615
cost offload scan: 0.08392333984375
offload 1 adapters, 16 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.049591064453125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5819797515869141 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 17 in total
Function load_lora_A took 6.077766418457031 ms to run.
Function load_lora_B took 6.046056747436523 ms to run.
cost realload: 12.520074844360352
Function load_adapters took 12.542009353637695 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 16 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5633831024169922 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 15 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5726814270019531 ms to run.
offload 0 adapters, 15 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 16 in total
Function load_lora_A took 6.052255630493164 ms to run.
Function load_lora_B took 6.0329437255859375 ms to run.
cost realload: 12.488365173339844
Function load_adapters took 12.509346008300781 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 15 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5714893341064453 ms to run.
cost load scan: 0.011444091796875
load 2 adapters, 17 in total
Function load_lora_A took 6.098747253417969 ms to run.
Function load_lora_B took 6.044626235961914 ms to run.
Function load_lora_A took 6.078958511352539 ms to run.
Function load_lora_B took 6.040334701538086 ms to run.
cost realload: 24.732589721679688
Function load_adapters took 24.755239486694336 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 18 in total
Function load_lora_A took 6.0577392578125 ms to run.
Function load_lora_B took 6.035089492797852 ms to run.
cost realload: 12.486696243286133
Function load_adapters took 12.508392333984375 ms to run.
current batch size: 19 token used ratio: 0.0982
cost offload scan: 0.09083747863769531
offload 1 adapters, 17 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: INFO:     127.0.0.1:42478 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42482 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45544 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45546 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45554 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45564 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45572 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45584 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45586 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45588 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45602 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45610 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45626 - "POST /generate_stream HTTP/1.1" 200 OK
0.04172325134277344
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.6067752838134766 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 16 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.57220458984375 ms to run.
cost offload scan: 0.08296966552734375
offload 1 adapters, 15 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.09965896606445312
Function offload_adapters took 0.5652904510498047 ms to run.
Avg tokens(prompt+generate) throughput: 1499.396 tokens/s
Avg prompt tokens throughput:            760.837 tokens/s
Avg generate tokens throughput:          738.559 tokens/s
cost load scan: 0.009775161743164062
load 1 adapters, 16 in total
Function load_lora_A took 6.111860275268555 ms to run.
Function load_lora_B took 6.04557991027832 ms to run.
cost realload: 12.559652328491211
Function load_adapters took 12.581348419189453 ms to run.
cost load scan: 0.007867813110351562
load 1 adapters, 17 in total
Function load_lora_A took 6.070137023925781 ms to run.
Function load_lora_B took 6.063938140869141 ms to run.
cost realload: 12.521982192993164
Function load_adapters took 12.542963027954102 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 16 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.028848648071289062
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5879402160644531 ms to run.
current batch size: 17 token used ratio: 0.09466153846153846
cost load scan: 0.008106231689453125
load 0 adapters, 16 in total
cost realload: 0.27823448181152344
Function load_adapters took 0.3020763397216797 ms to run.
cost offload scan: 0.12564659118652344
offload 2 adapters, 14 remains
cost offload cat: 0.02574920654296875
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.6103515625 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 13 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5676746368408203 ms to run.
cost load scan: 0.0095367431640625
load 1 adapters, 14 in total
Function load_lora_A took 6.091833114624023 ms to run.
Function load_lora_B took 6.034612655639648 ms to run.
cost realload: 12.51840591430664
Function load_adapters took 12.539863586425781 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 13 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5612373352050781 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 14 in total
Function load_lora_A took 6.100177764892578 ms to run.
Function load_lora_B took 6.058692932128906 ms to run.
cost realload: 12.565135955810547
Function load_adapters took 12.586832046508789 ms to run.
offload 0 adapters, 14 remains
Function offload_adapters took 0.011682510375976562 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 15 in total
Function load_lora_A took 6.0825347900390625 ms to run.
Function load_lora_B took 6.057024002075195 ms to run.
cost realload: 12.537002563476562
Function load_adapters took 12.558698654174805 ms to run.
cost offload scan: 0.08225440979003906
offload 1 adapters, 14 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5669593811035156 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 14 in total
cost realload: 0.27751922607421875
Function load_adapters took 0.3018379211425781 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 13 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10132789611816406
Function offload_adapters took 0.5645751953125 ms to run.
current batch size: 15 token used ratio: 0.07112307692307693
cost offload scan: 0.08106231689453125
offload 1 adapters, 12 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.09918212890625
Function offload_adapters took 0.5559921264648438 ms to run.
offload 0 adapters, 12 remains
Function offload_adapters took 0.011682510375976562 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 12 in total
cost realload: 0.2830028533935547
Function load_adapters took 0.30684471130371094 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 11 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5652904510498047 ms to run.
cost offload scan: 0.08106231689453125
offload 1 adapters, 10 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5626678466796875 ms to run.
offload 0 adapters, 10 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost load scan: 0.010728836059570312
load 1 adapters, 11 in total
Function load_lora_A took 6.081342697143555 ms to run.
Function load_lora_B took 6.077766418457031 ms to run.
cost realload: 12.560844421386719
Function load_adapters took 12.582540512084961 ms to run.
current batch size: 12 token used ratio: 0.056876923076923075
cost load scan: 0.013828277587890625
load 1 adapters, 12 in total
Function load_lora_A took 6.050348281860352 ms to run.
Function load_lora_B took 6.035089492797852 ms to run.
cost realload: 12.479305267333984
Function load_adapters took 12.502431869506836 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 13 in total
Function load_lora_A took 6.061553955078125 ms to run.
Function load_lora_B took 6.027936935424805 ms to run.
cost realload: 12.484073638916016
Function load_adapters took 12.505292892456055 ms to run.
cost offload scan: 0.08130073547363281
offload 1 adapters, 12 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11277198791503906
Function offload_adapters took 0.5710124969482422 ms to run.
cost offload scan: 0.08082389831542969
offload 1 adapters, 11 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5648136138916016 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 12 in total
Function load_lora_A took 6.010770797729492 ms to run.
Function load_lora_B took 6.02269172668457 ms to run.
cost realload: 12.430191040039062
Function load_adapters took 12.452125549316406 ms to run.
cost offload scan: 0.08177757263183594
offload 1 adapters, 11 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10085105895996094
Function offload_adapters took 0.5562305450439453 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 12 in total
Function load_lora_A took 6.085634231567383 ms to run.
INFO:     127.0.0.1:45632 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45636 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45648 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45656 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45668 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45682 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45694 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45696 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45698 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45706 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45710 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45724 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45734 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45748 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45754 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45764 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45778 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45788 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45802 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45816 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45822 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45830 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45834 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45846 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45848 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45860 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_B took 6.047964096069336 ms to run.
cost realload: 12.543439865112305
Function load_adapters took 12.565135955810547 ms to run.
current batch size: 13 token used ratio: 0.06470769230769231
cost load scan: 0.013828277587890625
load 1 adapters, 13 in total
Function load_lora_A took 6.014585494995117 ms to run.
Function load_lora_B took 5.992889404296875 ms to run.
cost realload: 12.403726577758789
Function load_adapters took 12.42518424987793 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 12 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5695819854736328 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 13 in total
Function load_lora_A took 6.054162979125977 ms to run.
Function load_lora_B took 6.041526794433594 ms to run.
cost realload: 12.497663497924805
Function load_adapters took 12.518882751464844 ms to run.
cost offload scan: 0.08153915405273438
offload 1 adapters, 12 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.041484832763671875
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5679130554199219 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 13 in total
Function load_lora_A took 6.0577392578125 ms to run.
Function load_lora_B took 6.056785583496094 ms to run.
cost realload: 12.503623962402344
Function load_adapters took 12.526512145996094 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 14 in total
Function load_lora_A took 6.128072738647461 ms to run.
Function load_lora_B took 6.045103073120117 ms to run.
cost realload: 12.558937072753906
Function load_adapters took 12.58087158203125 ms to run.
current batch size: 15 token used ratio: 0.07793846153846154
cost load scan: 0.015497207641601562
load 2 adapters, 16 in total
Function load_lora_A took 6.077051162719727 ms to run.
Function load_lora_B took 6.066083908081055 ms to run.
Function load_lora_A took 6.089210510253906 ms to run.
Function load_lora_B took 6.040096282958984 ms to run.
cost realload: 24.7495174407959
Function load_adapters took 24.77121353149414 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 15 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11515617370605469
Function offload_adapters took 0.5867481231689453 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 16 in total
Function load_lora_A took 6.055593490600586 ms to run.
Function load_lora_B took 6.025791168212891 ms to run.
cost realload: 12.481689453125
Function load_adapters took 12.502670288085938 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 15 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5645751953125 ms to run.
cost offload scan: 0.08225440979003906
offload 1 adapters, 14 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.029325485229492188
cost offload a_loc update: 0.10204315185546875
Function offload_adapters took 0.5676746368408203 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 15 in total
Function load_lora_A took 6.057262420654297 ms to run.
Function load_lora_B took 6.021261215209961 ms to run.
cost realload: 12.474775314331055
Function load_adapters took 12.497186660766602 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 16 in total
Function load_lora_A took 6.079912185668945 ms to run.
Function load_lora_B took 6.035804748535156 ms to run.
cost realload: 12.505531311035156
Function load_adapters took 12.526988983154297 ms to run.
cost load scan: 0.01430511474609375
load 1 adapters, 17 in total
Function load_lora_A took 6.080865859985352 ms to run.
Function load_lora_B took 6.050348281860352 ms to run.
cost realload: 12.531042098999023
Function load_adapters took 12.556076049804688 ms to run.
current batch size: 19 token used ratio: 0.09955384615384616
cost load scan: 0.0152587890625
load 2 adapters, 19 in total
Function load_lora_A took 6.0882568359375 ms to run.
Function load_lora_B took 6.031274795532227 ms to run.
Function load_lora_A took 6.043672561645508 ms to run.
Function load_lora_B took 6.011486053466797 ms to run.
cost realload: 24.64771270751953
Function load_adapters took 24.669170379638672 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 18 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5736351013183594 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 19 in total
Function load_lora_A took 6.024837493896484 ms to run.
Function load_lora_B took 6.029844284057617 ms to run.
cost realload: 12.451887130737305
Function load_adapters took 12.472867965698242 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 20 in total
Function load_lora_A took 6.0482025146484375 ms to run.
Function load_lora_B took 6.03485107421875 ms to run.
cost realload: 12.485504150390625
Function load_adapters took 12.506723403930664 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 19 remains
cost offload cat: 0.03981590270996094
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5774497985839844 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 20 in total
Function load_lora_A took 6.05010986328125 ms to run.
Function load_lora_B took 6.041526794433594 ms to run.
cost realload: 12.496709823608398
Function load_adapters took 12.518644332885742 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 19 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.11134147644042969
Function offload_adapters took 0.5786418914794922 ms to run.
current batch size: 21 token used ratio: 0.112
cost load scan: 0.009775161743164062
load 4 adapters, 23 in total
Function load_lora_A took 6.091833114624023 ms to run.
Function load_lora_B took 6.01959228515625 ms to run.
Function load_lora_A took 6.091117858886719 ms to run.
Function load_lora_B took 6.053447723388672 ms to run.
Function load_lora_A took 6.0596466064453125 ms to run.
Function load_lora_B took 6.03485107421875 ms to run.
Function load_lora_A took 6.067752838134766 ms to run.
Function load_lora_B took 6.051063537597656 ms to run.
cost realload: 49.06439781188965
Function load_adapters took 49.086809158325195 ms to run.
cost load scan: 0.009059906005859375
load 2 adapters, 25 in total
Function load_lora_A took 6.071567535400391 ms to run.
Function load_lora_B took 6.039619445800781 ms to run.
Function load_lora_A took 6.067991256713867 ms to run.
Function load_lora_B took 6.037712097167969 ms to run.
cost realload: 24.678945541381836
Function load_adapters took 24.70111846923828 ms to run.
cost offload scan: 0.09107589721679688
offload 1 adapters, 24 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.5838871002197266 ms to run.
offload 0 adapters, 24 remains
Function offload_adapters took 0.013828277587890625 ms to run.
cost load scan: 0.013113021850585938
load 2 adapters, 26 in total
Function load_lora_A took 6.070613861083984 ms to run.
Function load_lora_B took 6.051778793334961 ms to run.
Function load_lora_A took 6.080389022827148 ms to run.
INFO:     127.0.0.1:45868 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45880 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45890 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45900 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45916 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45926 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:45936 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40520 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40532 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40538 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40540 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40544 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40552 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40566 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40576 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_B took 6.038188934326172 ms to run.
cost realload: 24.727344512939453
Function load_adapters took 24.749040603637695 ms to run.
cost load scan: 0.0133514404296875
load 3 adapters, 29 in total
Function load_lora_A took 6.050348281860352 ms to run.
Function load_lora_B took 6.025791168212891 ms to run.
Function load_lora_A took 6.052732467651367 ms to run.
Function load_lora_B took 6.03032112121582 ms to run.
Function load_lora_A took 6.047487258911133 ms to run.
Function load_lora_B took 6.012201309204102 ms to run.
cost realload: 36.74912452697754
Function load_adapters took 36.77105903625488 ms to run.
cost load scan: 0.008821487426757812
load 2 adapters, 31 in total
Function load_lora_A took 6.088972091674805 ms to run.
Function load_lora_B took 6.047487258911133 ms to run.
Function load_lora_A took 6.076335906982422 ms to run.
Function load_lora_B took 6.037235260009766 ms to run.
cost realload: 24.726152420043945
Function load_adapters took 24.748563766479492 ms to run.
current batch size: 32 token used ratio: 0.17824615384615386
cost load scan: 0.014543533325195312
load 2 adapters, 33 in total
Function load_lora_A took 6.101131439208984 ms to run.
Function load_lora_B took 6.036996841430664 ms to run.
Function load_lora_A took 6.101846694946289 ms to run.
Function load_lora_B took 6.04248046875 ms to run.
cost realload: 24.749755859375
Function load_adapters took 24.77121353149414 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 32 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5879402160644531 ms to run.
Avg tokens(prompt+generate) throughput: 1785.044 tokens/s
Avg prompt tokens throughput:           1124.889 tokens/s
Avg generate tokens throughput:          660.155 tokens/s
cost offload scan: 0.08916854858398438
offload 1 adapters, 31 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.028848648071289062
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5910396575927734 ms to run.
cost load scan: 0.00762939453125
load 1 adapters, 32 in total
Function load_lora_A took 6.0253143310546875 ms to run.
Function load_lora_B took 6.0253143310546875 ms to run.
cost realload: 12.448549270629883
Function load_adapters took 12.470245361328125 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 31 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.027894973754882812
cost offload a_loc update: 0.10919570922851562
Function offload_adapters took 0.5943775177001953 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 32 in total
Function load_lora_A took 6.061553955078125 ms to run.
Function load_lora_B took 6.016016006469727 ms to run.
cost realload: 12.475728988647461
Function load_adapters took 12.497663497924805 ms to run.
cost offload scan: 0.12469291687011719
offload 2 adapters, 30 remains
cost offload cat: 0.027894973754882812
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.6225109100341797 ms to run.
current batch size: 31 token used ratio: 0.18736923076923076
cost offload scan: 0.09179115295410156
offload 1 adapters, 29 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5831718444824219 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 28 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5784034729003906 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 29 in total
Function load_lora_A took 6.059169769287109 ms to run.
Function load_lora_B took 6.018400192260742 ms to run.
cost realload: 12.47549057006836
Function load_adapters took 12.497186660766602 ms to run.
cost offload scan: 0.09512901306152344
offload 1 adapters, 28 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5810260772705078 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 28 in total
cost realload: 0.29587745666503906
Function load_adapters took 0.3197193145751953 ms to run.
cost offload scan: 0.0972747802734375
offload 1 adapters, 27 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11801719665527344
Function offload_adapters took 0.6086826324462891 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 28 in total
Function load_lora_A took 6.090879440307617 ms to run.
Function load_lora_B took 6.046772003173828 ms to run.
cost realload: 12.54582405090332
Function load_adapters took 12.568473815917969 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 27 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5755424499511719 ms to run.
cost offload scan: 0.08869171142578125
offload 1 adapters, 26 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5779266357421875 ms to run.
cost load scan: 0.015020370483398438
load 1 adapters, 27 in total
Function load_lora_A took 6.079196929931641 ms to run.
Function load_lora_B took 6.041526794433594 ms to run.
cost realload: 12.517452239990234
Function load_adapters took 12.539386749267578 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 26 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5748271942138672 ms to run.
current batch size: 28 token used ratio: 0.1684923076923077
cost offload scan: 0.09179115295410156
offload 1 adapters, 25 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11086463928222656
Function offload_adapters took 0.5941390991210938 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 25 in total
cost realload: 0.2884864807128906
Function load_adapters took 0.31280517578125 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 24 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10442733764648438
Function offload_adapters took 0.5712509155273438 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 23 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.041484832763671875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11157989501953125
Function offload_adapters took 0.5762577056884766 ms to run.
cost offload scan: 0.09083747863769531
offload 1 adapters, 22 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5795955657958984 ms to run.
cost load scan: 0.014543533325195312
load 2 adapters, 24 in total
INFO:     127.0.0.1:40578 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40582 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40590 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40592 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40606 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40616 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40618 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40630 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40632 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40640 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40642 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40658 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40666 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_A took 6.0787200927734375 ms to run.
Function load_lora_B took 6.009101867675781 ms to run.
Function load_lora_A took 6.088733673095703 ms to run.
Function load_lora_B took 6.039857864379883 ms to run.
cost realload: 24.723291397094727
Function load_adapters took 24.746417999267578 ms to run.
offload 0 adapters, 24 remains
Function offload_adapters took 0.017642974853515625 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 23 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.5860328674316406 ms to run.
cost offload scan: 0.08797645568847656
offload 1 adapters, 22 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10180473327636719
Function offload_adapters took 0.5698204040527344 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 21 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5686283111572266 ms to run.
cost load scan: 0.011682510375976562
load 2 adapters, 23 in total
Function load_lora_A took 6.079673767089844 ms to run.
Function load_lora_B took 6.0367584228515625 ms to run.
Function load_lora_A took 6.088495254516602 ms to run.
Function load_lora_B took 6.045103073120117 ms to run.
cost realload: 24.718284606933594
Function load_adapters took 24.740219116210938 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 22 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10251998901367188
Function offload_adapters took 0.5660057067871094 ms to run.
cost load scan: 0.013113021850585938
load 2 adapters, 24 in total
Function load_lora_A took 6.053686141967773 ms to run.
Function load_lora_B took 6.044864654541016 ms to run.
Function load_lora_A took 6.034135818481445 ms to run.
Function load_lora_B took 6.002664566040039 ms to run.
cost realload: 24.608612060546875
Function load_adapters took 24.634361267089844 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 23 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5879402160644531 ms to run.
current batch size: 25 token used ratio: 0.14223076923076924
cost load scan: 0.013113021850585938
load 1 adapters, 24 in total
Function load_lora_A took 6.100893020629883 ms to run.
Function load_lora_B took 6.0176849365234375 ms to run.
cost realload: 12.510299682617188
Function load_adapters took 12.53509521484375 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 23 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04982948303222656
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5893707275390625 ms to run.
cost load scan: 0.015735626220703125
load 1 adapters, 24 in total
Function load_lora_A took 6.097078323364258 ms to run.
Function load_lora_B took 6.04557991027832 ms to run.
cost realload: 12.532472610473633
Function load_adapters took 12.552976608276367 ms to run.
cost offload scan: 0.0972747802734375
offload 1 adapters, 23 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04982948303222656
cost offload torch.empty: 0.023126602172851562
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5972385406494141 ms to run.
cost load scan: 0.01239776611328125
load 1 adapters, 24 in total
Function load_lora_A took 6.056308746337891 ms to run.
Function load_lora_B took 6.016016006469727 ms to run.
cost realload: 12.470245361328125
Function load_adapters took 12.491703033447266 ms to run.
offload 0 adapters, 24 remains
Function offload_adapters took 0.013589859008789062 ms to run.
current batch size: 25 token used ratio: 0.15183076923076924
offload 0 adapters, 24 remains
Function offload_adapters took 0.013589859008789062 ms to run.
cost offload scan: 0.09250640869140625
offload 1 adapters, 23 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1163482666015625
Function offload_adapters took 0.6048679351806641 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 22 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5741119384765625 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 21 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.041484832763671875
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5695819854736328 ms to run.
cost offload scan: 0.09036064147949219
offload 1 adapters, 20 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11372566223144531
Function offload_adapters took 0.5826950073242188 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 21 in total
Function load_lora_A took 6.048679351806641 ms to run.
Function load_lora_B took 6.029367446899414 ms to run.
cost realload: 12.49241828918457
Function load_adapters took 12.513160705566406 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 22 in total
Function load_lora_A took 6.028652191162109 ms to run.
Function load_lora_B took 6.00123405456543 ms to run.
cost realload: 12.433767318725586
Function load_adapters took 12.456417083740234 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 21 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5855560302734375 ms to run.
cost load scan: 0.011444091796875
load 2 adapters, 23 in total
Function load_lora_A took 6.077766418457031 ms to run.
Function load_lora_B took 6.026029586791992 ms to run.
Function load_lora_A took 6.077051162719727 ms to run.
Function load_lora_B took 6.037712097167969 ms to run.
cost realload: 24.694204330444336
Function load_adapters took 24.716615676879883 ms to run.
current batch size: 24 token used ratio: 0.14166153846153845
cost offload scan: 0.08654594421386719
offload 1 adapters, 22 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5671977996826172 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 21 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.102996826171875
Function offload_adapters took 0.5636215209960938 ms to run.
cost offload scan: 0.1304149627685547
offload 2 adapters, 19 remains
cost offload cat: 0.025987625122070312
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.6115436553955078 ms to run.
cost load scan: 0.01049041748046875
load 1 adapters, 20 in total
Function load_lora_A took 6.08372688293457 ms to run.
Function load_lora_B took 6.035327911376953 ms to run.
cost realload: 12.514114379882812
INFO:     127.0.0.1:40668 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40672 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40678 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40692 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40700 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40702 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40714 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40718 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40724 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40740 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40750 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40758 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40768 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40776 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40784 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40794 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40806 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40818 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40822 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40828 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40838 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_adapters took 12.53652572631836 ms to run.
cost offload scan: 0.08463859558105469
offload 1 adapters, 19 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10228157043457031
Function offload_adapters took 0.5617141723632812 ms to run.
cost offload scan: 0.08463859558105469
offload 1 adapters, 18 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10228157043457031
Function offload_adapters took 0.5688667297363281 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 19 in total
Function load_lora_A took 6.063222885131836 ms to run.
Function load_lora_B took 6.005764007568359 ms to run.
cost realload: 12.468576431274414
Function load_adapters took 12.490272521972656 ms to run.
cost offload scan: 0.09274482727050781
offload 1 adapters, 18 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5817413330078125 ms to run.
cost load scan: 0.013828277587890625
load 1 adapters, 19 in total
Function load_lora_A took 6.087064743041992 ms to run.
Function load_lora_B took 6.019353866577148 ms to run.
cost realload: 12.513160705566406
Function load_adapters took 12.53509521484375 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 18 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.021457672119140625
cost offload a_loc update: 0.10156631469726562
Function offload_adapters took 0.5614757537841797 ms to run.
cost offload scan: 0.08320808410644531
offload 1 adapters, 17 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04100799560546875
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.11301040649414062
Function offload_adapters took 0.5667209625244141 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 16 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5700588226318359 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 15 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5691051483154297 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 15 in total
cost realload: 0.2911090850830078
Function load_adapters took 0.3154277801513672 ms to run.
current batch size: 18 token used ratio: 0.09592307692307692
cost load scan: 0.008344650268554688
load 1 adapters, 16 in total
Function load_lora_A took 6.084918975830078 ms to run.
Function load_lora_B took 6.034135818481445 ms to run.
cost realload: 12.515068054199219
Function load_adapters took 12.539148330688477 ms to run.
cost offload scan: 0.08463859558105469
offload 1 adapters, 15 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10228157043457031
Function offload_adapters took 0.5600452423095703 ms to run.
cost load scan: 0.01430511474609375
load 1 adapters, 16 in total
Function load_lora_A took 6.094217300415039 ms to run.
Function load_lora_B took 6.025791168212891 ms to run.
cost realload: 12.514591217041016
Function load_adapters took 12.536287307739258 ms to run.
offload 0 adapters, 16 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.01430511474609375
load 3 adapters, 19 in total
Function load_lora_A took 6.074666976928711 ms to run.
Function load_lora_B took 6.03032112121582 ms to run.
Function load_lora_A took 6.04248046875 ms to run.
Function load_lora_B took 6.038188934326172 ms to run.
Function load_lora_A took 6.056547164916992 ms to run.
Function load_lora_B took 6.0291290283203125 ms to run.
cost realload: 36.79633140563965
Function load_adapters took 36.818504333496094 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 20 in total
Function load_lora_A took 6.09135627746582 ms to run.
Function load_lora_B took 6.049633026123047 ms to run.
cost realload: 12.544393539428711
Function load_adapters took 12.56561279296875 ms to run.
current batch size: 24 token used ratio: 0.12926153846153846
cost load scan: 0.0095367431640625
load 1 adapters, 21 in total
Function load_lora_A took 6.0672760009765625 ms to run.
Function load_lora_B took 6.052494049072266 ms to run.
cost realload: 12.506723403930664
Function load_adapters took 12.528181076049805 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 20 remains
cost offload cat: 0.034332275390625
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5831718444824219 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.012636184692382812 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 19 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.04029273986816406
cost offload torch.empty: 0.023365020751953125
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5693435668945312 ms to run.
cost load scan: 0.014543533325195312
load 2 adapters, 21 in total
Function load_lora_A took 6.0882568359375 ms to run.
Function load_lora_B took 6.029844284057617 ms to run.
Function load_lora_A took 6.04557991027832 ms to run.
Function load_lora_B took 6.015777587890625 ms to run.
cost realload: 24.655818939208984
Function load_adapters took 24.67799186706543 ms to run.
offload 0 adapters, 21 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.09465217590332031
offload 1 adapters, 20 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5774497985839844 ms to run.
cost offload scan: 0.08392333984375
offload 1 adapters, 19 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04124641418457031
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10251998901367188
Function offload_adapters took 0.5657672882080078 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 20 in total
Function load_lora_A took 6.069183349609375 ms to run.
Function load_lora_B took 6.037235260009766 ms to run.
cost realload: 12.483358383178711
Function load_adapters took 12.503385543823242 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 19 remains
cost offload cat: 0.03361701965332031
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5788803100585938 ms to run.
cost load scan: 0.012159347534179688
load 2 adapters, 21 in total
Function load_lora_A took 6.066083908081055 ms to run.
Function load_lora_B took 6.047725677490234 ms to run.
Function load_lora_A took 6.056070327758789 ms to run.
Function load_lora_B took 6.020069122314453 ms to run.
cost realload: 24.64127540588379
Function load_adapters took 24.66273307800293 ms to run.
cost load scan: 0.011444091796875
load 2 adapters, 23 in total
Function load_lora_A took 6.09135627746582 ms to run.
Function load_lora_B took 6.012201309204102 ms to run.
Function load_lora_A took 6.071329116821289 ms to run.
Function load_lora_B took 6.064891815185547 ms to run.
cost realload: INFO:     127.0.0.1:40850 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40856 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40872 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40884 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:40888 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53710 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53726 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53728 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53740 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53750 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53766 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53776 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53784 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53786 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53798 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53806 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53808 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53810 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53826 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53828 - "POST /generate_stream HTTP/1.1" 200 OK
24.71613883972168
Function load_adapters took 24.764060974121094 ms to run.
current batch size: 25 token used ratio: 0.1267230769230769
cost load scan: 0.010728836059570312
load 1 adapters, 24 in total
Function load_lora_A took 6.0596466064453125 ms to run.
Function load_lora_B took 6.011486053466797 ms to run.
cost realload: 12.46190071105957
Function load_adapters took 12.483358383178711 ms to run.
Avg tokens(prompt+generate) throughput: 1986.239 tokens/s
Avg prompt tokens throughput:           1092.819 tokens/s
Avg generate tokens throughput:          893.419 tokens/s
cost offload scan: 0.09274482727050781
offload 1 adapters, 23 remains
cost offload cat: 0.03552436828613281
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11801719665527344
Function offload_adapters took 0.6039142608642578 ms to run.
cost load scan: 0.011205673217773438
load 1 adapters, 24 in total
Function load_lora_A took 6.071329116821289 ms to run.
Function load_lora_B took 6.04248046875 ms to run.
cost realload: 12.502193450927734
Function load_adapters took 12.524127960205078 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 25 in total
Function load_lora_A took 6.088018417358398 ms to run.
Function load_lora_B took 6.035089492797852 ms to run.
cost realload: 12.514352798461914
Function load_adapters took 12.535333633422852 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 24 remains
cost offload cat: 0.03504753112792969
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11587142944335938
Function offload_adapters took 0.5879402160644531 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 24 in total
cost realload: 0.28443336486816406
Function load_adapters took 0.30875205993652344 ms to run.
current batch size: 29 token used ratio: 0.15955384615384616
offload 0 adapters, 24 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost load scan: 0.010728836059570312
load 2 adapters, 26 in total
Function load_lora_A took 6.080865859985352 ms to run.
Function load_lora_B took 6.063699722290039 ms to run.
Function load_lora_A took 6.073474884033203 ms to run.
Function load_lora_B took 6.053447723388672 ms to run.
cost realload: 24.737119674682617
Function load_adapters took 24.760961532592773 ms to run.
cost load scan: 0.014066696166992188
load 1 adapters, 27 in total
Function load_lora_A took 6.055116653442383 ms to run.
Function load_lora_B took 6.013393402099609 ms to run.
cost realload: 12.461662292480469
Function load_adapters took 12.483596801757812 ms to run.
cost load scan: 0.012636184692382812
load 2 adapters, 29 in total
Function load_lora_A took 6.0443878173828125 ms to run.
Function load_lora_B took 6.016969680786133 ms to run.
Function load_lora_A took 6.03795051574707 ms to run.
Function load_lora_B took 6.02269172668457 ms to run.
cost realload: 24.59239959716797
Function load_adapters took 24.613380432128906 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 28 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5815029144287109 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 27 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.576019287109375 ms to run.
offload 0 adapters, 27 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 28 in total
Function load_lora_A took 6.0520172119140625 ms to run.
Function load_lora_B took 6.024599075317383 ms to run.
cost realload: 12.474536895751953
Function load_adapters took 12.495756149291992 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 27 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04887580871582031
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5824565887451172 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 26 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.041484832763671875
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5710124969482422 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 25 remains
cost offload cat: 0.029802322387695312
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.11324882507324219
Function offload_adapters took 0.5819797515869141 ms to run.
current batch size: 29 token used ratio: 0.16196923076923078
cost offload scan: 0.08893013000488281
offload 1 adapters, 24 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.5750656127929688 ms to run.
offload 0 adapters, 24 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.0934600830078125
offload 1 adapters, 23 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5829334259033203 ms to run.
cost load scan: 0.014781951904296875
load 1 adapters, 24 in total
Function load_lora_A took 6.072521209716797 ms to run.
Function load_lora_B took 6.048440933227539 ms to run.
cost realload: 12.527704238891602
Function load_adapters took 12.552022933959961 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 23 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5795955657958984 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 24 in total
Function load_lora_A took 6.077289581298828 ms to run.
Function load_lora_B took 6.041526794433594 ms to run.
cost realload: 12.515068054199219
Function load_adapters took 12.536048889160156 ms to run.
cost offload scan: 0.08678436279296875
offload 1 adapters, 23 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.028848648071289062
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5815029144287109 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 24 in total
Function load_lora_A took 6.084203720092773 ms to run.
Function load_lora_B took 6.042242050170898 ms to run.
cost realload: 12.515783309936523
Function load_adapters took 12.537479400634766 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 23 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5781650543212891 ms to run.
cost load scan: 0.0171661376953125
load 2 adapters, 25 in total
Function load_lora_A took 6.062984466552734 ms to run.
Function load_lora_B took 6.035566329956055 ms to run.
Function load_lora_A took 6.056308746337891 ms to run.
Function load_lora_B took 6.02269172668457 ms to run.
cost realload: 24.658918380737305
Function load_adapters took 24.681568145751953 ms to run.
current batch size: 30 token used ratio: 0.15903076923076923
cost offload scan: 0.08654594421386719
offload 1 adapters, 24 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04839897155761719
cost offload torch.empty: 0.02288818359375
INFO:     127.0.0.1:53832 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53844 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53850 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53862 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53872 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53884 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53892 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53898 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53908 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53912 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53920 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53926 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53936 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53938 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53944 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53952 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53954 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53966 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53978 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53980 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53982 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:53998 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54002 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.6043910980224609 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 25 in total
Function load_lora_A took 6.069660186767578 ms to run.
Function load_lora_B took 6.021261215209961 ms to run.
cost realload: 12.481451034545898
Function load_adapters took 12.504100799560547 ms to run.
cost offload scan: 0.12946128845214844
offload 2 adapters, 23 remains
cost offload cat: 0.026226043701171875
cost offload free mem manager: 0.04363059997558594
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.6182193756103516 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 24 in total
Function load_lora_A took 6.099224090576172 ms to run.
Function load_lora_B took 6.045341491699219 ms to run.
cost realload: 12.52889633178711
Function load_adapters took 12.550592422485352 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 23 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5712509155273438 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 22 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5724430084228516 ms to run.
cost load scan: 0.008344650268554688
load 1 adapters, 23 in total
Function load_lora_A took 6.054401397705078 ms to run.
Function load_lora_B took 6.043672561645508 ms to run.
cost realload: 12.471914291381836
Function load_adapters took 12.492179870605469 ms to run.
cost offload scan: 0.08749961853027344
offload 1 adapters, 22 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.57220458984375 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 23 in total
Function load_lora_A took 6.091833114624023 ms to run.
Function load_lora_B took 6.050586700439453 ms to run.
cost realload: 12.534618377685547
Function load_adapters took 12.55655288696289 ms to run.
current batch size: 27 token used ratio: 0.14778461538461538
cost offload scan: 0.12278556823730469
offload 2 adapters, 21 remains
cost offload cat: 0.025987625122070312
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.6008148193359375 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 22 in total
Function load_lora_A took 6.095647811889648 ms to run.
Function load_lora_B took 6.050348281860352 ms to run.
cost realload: 12.54415512084961
Function load_adapters took 12.566566467285156 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.012636184692382812 ms to run.
cost load scan: 0.013589859008789062
load 1 adapters, 23 in total
Function load_lora_A took 6.093502044677734 ms to run.
Function load_lora_B took 6.047964096069336 ms to run.
cost realload: 12.529134750366211
Function load_adapters took 12.550115585327148 ms to run.
offload 0 adapters, 23 remains
Function offload_adapters took 0.012159347534179688 ms to run.
offload 0 adapters, 23 remains
Function offload_adapters took 0.0133514404296875 ms to run.
cost offload scan: 0.09393692016601562
offload 1 adapters, 22 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.5984306335449219 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 21 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5817413330078125 ms to run.
cost offload scan: 0.08463859558105469
offload 1 adapters, 20 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5693435668945312 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 19 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5681514739990234 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.01239776611328125 ms to run.
current batch size: 20 token used ratio: 0.11186153846153846
cost load scan: 0.008106231689453125
load 1 adapters, 20 in total
Function load_lora_A took 6.076335906982422 ms to run.
Function load_lora_B took 6.008148193359375 ms to run.
cost realload: 12.506723403930664
Function load_adapters took 12.528419494628906 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 19 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11038780212402344
Function offload_adapters took 0.5805492401123047 ms to run.
cost load scan: 0.013113021850585938
load 2 adapters, 21 in total
Function load_lora_A took 6.086587905883789 ms to run.
Function load_lora_B took 6.042242050170898 ms to run.
Function load_lora_A took 6.057977676391602 ms to run.
Function load_lora_B took 6.052255630493164 ms to run.
cost realload: 24.712324142456055
Function load_adapters took 24.734973907470703 ms to run.
cost load scan: 0.02002716064453125
load 5 adapters, 26 in total
Function load_lora_A took 6.081104278564453 ms to run.
Function load_lora_B took 6.050825119018555 ms to run.
Function load_lora_A took 6.070375442504883 ms to run.
Function load_lora_B took 6.026744842529297 ms to run.
Function load_lora_A took 6.06083869934082 ms to run.
Function load_lora_B took 6.014108657836914 ms to run.
Function load_lora_A took 6.064176559448242 ms to run.
Function load_lora_B took 6.045103073120117 ms to run.
Function load_lora_A took 6.05463981628418 ms to run.
Function load_lora_B took 6.023645401000977 ms to run.
cost realload: 61.16294860839844
Function load_adapters took 61.18512153625488 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 25 remains
cost offload cat: 0.03552436828613281
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10967254638671875
Function offload_adapters took 0.5888938903808594 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 26 in total
Function load_lora_A took 6.075620651245117 ms to run.
Function load_lora_B took 6.050586700439453 ms to run.
cost realload: 12.528419494628906
Function load_adapters took 12.549877166748047 ms to run.
cost offload scan: 0.08845329284667969
offload 1 adapters, 25 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04887580871582031
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10895729064941406
Function offload_adapters took 0.5860328674316406 ms to run.
current batch size: 27 token used ratio: 0.1445076923076923
cost load scan: 0.008821487426757812
load 1 adapters, 26 in total
Function load_lora_A took 6.0882568359375 ms to run.
Function load_lora_B took 6.035327911376953 ms to run.
cost realload: 12.51840591430664
Function load_adapters took 12.53962516784668 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 26 in total
cost realload: 0.2930164337158203
Function load_adapters took 0.3161430358886719 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 25 remains
cost offload cat: 0.034332275390625
INFO:     127.0.0.1:54010 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54014 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54022 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54030 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54032 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54046 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54052 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54066 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:54072 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41964 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41976 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41980 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:41992 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42006 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42022 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02384185791015625
cost offload a_loc update: 0.10824203491210938
Function offload_adapters took 0.6251335144042969 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 24 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10704994201660156
Function offload_adapters took 0.5726814270019531 ms to run.
cost load scan: 0.009298324584960938
load 2 adapters, 26 in total
Function load_lora_A took 6.096839904785156 ms to run.
Function load_lora_B took 6.057024002075195 ms to run.
Function load_lora_A took 6.069421768188477 ms to run.
Function load_lora_B took 6.062507629394531 ms to run.
cost realload: 24.742841720581055
Function load_adapters took 24.764299392700195 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 25 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.11348724365234375
Function offload_adapters took 0.5815029144287109 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 24 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5903244018554688 ms to run.
current batch size: 29 token used ratio: 0.16112307692307692
cost offload scan: 0.08606910705566406
offload 1 adapters, 23 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5679130554199219 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 24 in total
Function load_lora_A took 6.112337112426758 ms to run.
Function load_lora_B took 6.054401397705078 ms to run.
cost realload: 12.563705444335938
Function load_adapters took 12.586832046508789 ms to run.
offload 0 adapters, 24 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 25 in total
Function load_lora_A took 6.089687347412109 ms to run.
Function load_lora_B took 6.027936935424805 ms to run.
cost realload: 12.522459030151367
Function load_adapters took 12.545108795166016 ms to run.
cost offload scan: 0.08893013000488281
offload 1 adapters, 24 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.043392181396484375
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5736351013183594 ms to run.
cost offload scan: 0.09918212890625
offload 1 adapters, 23 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5855560302734375 ms to run.
cost offload scan: 0.09441375732421875
offload 1 adapters, 22 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5896091461181641 ms to run.
cost load scan: 0.014781951904296875
load 3 adapters, 25 in total
Function load_lora_A took 6.043434143066406 ms to run.
Function load_lora_B took 6.037473678588867 ms to run.
Function load_lora_A took 6.033182144165039 ms to run.
Function load_lora_B took 6.031036376953125 ms to run.
Function load_lora_A took 6.084918975830078 ms to run.
Function load_lora_B took 6.047248840332031 ms to run.
cost realload: 36.82875633239746
Function load_adapters took 36.850690841674805 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 24 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10800361633300781
Function offload_adapters took 0.5857944488525391 ms to run.
cost offload scan: 0.09012222290039062
offload 1 adapters, 23 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.1087188720703125
Function offload_adapters took 0.5865097045898438 ms to run.
offload 0 adapters, 23 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost load scan: 0.008821487426757812
load 2 adapters, 25 in total
Function load_lora_A took 6.095647811889648 ms to run.
Function load_lora_B took 6.057262420654297 ms to run.
Function load_lora_A took 6.042718887329102 ms to run.
Function load_lora_B took 6.018877029418945 ms to run.
cost realload: 24.669408798217773
Function load_adapters took 24.69038963317871 ms to run.
Avg tokens(prompt+generate) throughput: 2275.986 tokens/s
Avg prompt tokens throughput:           1308.240 tokens/s
Avg generate tokens throughput:          967.746 tokens/s
cost offload scan: 0.08916854858398438
offload 1 adapters, 24 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11110305786132812
Function offload_adapters took 0.5831718444824219 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 23 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04124641418457031
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5719661712646484 ms to run.
offload 0 adapters, 23 remains
Function offload_adapters took 0.012159347534179688 ms to run.
current batch size: 27 token used ratio: 0.14686153846153846
cost offload scan: 0.08416175842285156
offload 1 adapters, 22 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10180473327636719
Function offload_adapters took 0.560760498046875 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.013113021850585938 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 22 in total
cost realload: 0.30732154846191406
Function load_adapters took 0.33402442932128906 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 21 remains
cost offload cat: 0.033855438232421875
cost offload free mem manager: 0.04792213439941406
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.11420249938964844
Function offload_adapters took 0.6170272827148438 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 22 in total
Function load_lora_A took 6.096601486206055 ms to run.
Function load_lora_B took 6.036520004272461 ms to run.
cost realload: 12.521505355834961
Function load_adapters took 12.543201446533203 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 21 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10848045349121094
Function offload_adapters took 0.5891323089599609 ms to run.
cost load scan: 0.011205673217773438
load 2 adapters, 23 in total
Function load_lora_A took 6.087541580200195 ms to run.
Function load_lora_B took 6.028413772583008 ms to run.
Function load_lora_A took 6.067514419555664 ms to run.
Function load_lora_B took 6.042957305908203 ms to run.
cost realload: 24.709224700927734
Function load_adapters took 24.731874465942383 ms to run.
cost offload scan: 0.09298324584960938
offload 1 adapters, 22 remains
cost offload cat: 0.03266334533691406
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.028848648071289062
cost offload a_loc update: 0.10943412780761719
INFO:     127.0.0.1:42038 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42050 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42066 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42070 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42076 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42078 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42082 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42096 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42112 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42120 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42132 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42140 - "POST /generate_stream HTTP/1.1" 200 OK
Function offload_adapters took 0.5984306335449219 ms to run.
current batch size: 25 token used ratio: 0.1388
cost load scan: 0.011444091796875
load 2 adapters, 24 in total
Function load_lora_A took 6.102561950683594 ms to run.
Function load_lora_B took 6.026744842529297 ms to run.
Function load_lora_A took 6.05320930480957 ms to run.
Function load_lora_B took 6.04248046875 ms to run.
cost realload: 24.6889591217041
Function load_adapters took 24.713516235351562 ms to run.
cost offload scan: 0.09822845458984375
offload 1 adapters, 23 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5962848663330078 ms to run.
offload 0 adapters, 23 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 23 in total
cost realload: 0.3085136413574219
Function load_adapters took 0.3337860107421875 ms to run.
cost offload scan: 0.09322166442871094
offload 1 adapters, 22 remains
cost offload cat: 0.0324249267578125
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.028848648071289062
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5939006805419922 ms to run.
cost load scan: 0.010967254638671875
load 1 adapters, 23 in total
Function load_lora_A took 6.088972091674805 ms to run.
Function load_lora_B took 6.050348281860352 ms to run.
cost realload: 12.546062469482422
Function load_adapters took 12.568235397338867 ms to run.
current batch size: 27 token used ratio: 0.15784615384615386
cost offload scan: 0.08749961853027344
offload 1 adapters, 22 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10728836059570312
Function offload_adapters took 0.5748271942138672 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 23 in total
Function load_lora_A took 6.094217300415039 ms to run.
Function load_lora_B took 6.031036376953125 ms to run.
cost realload: 12.52126693725586
Function load_adapters took 12.542247772216797 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 22 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5686283111572266 ms to run.
offload 0 adapters, 22 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost offload scan: 0.08654594421386719
offload 1 adapters, 21 remains
cost offload cat: 0.03504753112792969
cost offload free mem manager: 0.04124641418457031
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5738735198974609 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 20 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5750656127929688 ms to run.
offload 0 adapters, 20 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.08606910705566406
offload 1 adapters, 19 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10538101196289062
Function offload_adapters took 0.5788803100585938 ms to run.
cost offload scan: 0.08726119995117188
offload 1 adapters, 18 remains
cost offload cat: 0.030279159545898438
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5731582641601562 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 18 in total
cost realload: 0.3066062927246094
Function load_adapters took 0.3311634063720703 ms to run.
cost offload scan: 0.08416175842285156
offload 1 adapters, 17 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5655288696289062 ms to run.
current batch size: 20 token used ratio: 0.11416923076923077
cost load scan: 0.0152587890625
load 3 adapters, 20 in total
Function load_lora_A took 6.083011627197266 ms to run.
Function load_lora_B took 6.0443878173828125 ms to run.
Function load_lora_A took 6.048917770385742 ms to run.
Function load_lora_B took 6.042957305908203 ms to run.
Function load_lora_A took 6.041288375854492 ms to run.
Function load_lora_B took 6.027460098266602 ms to run.
cost realload: 36.83161735534668
Function load_adapters took 36.85355186462402 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 19 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5676746368408203 ms to run.
cost offload scan: 0.08821487426757812
offload 1 adapters, 18 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.102996826171875
Function offload_adapters took 0.5667209625244141 ms to run.
cost load scan: 0.007867813110351562
load 1 adapters, 19 in total
Function load_lora_A took 6.060123443603516 ms to run.
Function load_lora_B took 6.04701042175293 ms to run.
cost realload: 12.499809265136719
Function load_adapters took 12.521505355834961 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.01239776611328125 ms to run.
cost offload scan: 0.09202957153320312
offload 1 adapters, 18 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10776519775390625
Function offload_adapters took 0.5893707275390625 ms to run.
cost load scan: 0.01430511474609375
load 1 adapters, 19 in total
Function load_lora_A took 6.098747253417969 ms to run.
Function load_lora_B took 6.051063537597656 ms to run.
cost realload: 12.54129409790039
Function load_adapters took 12.56418228149414 ms to run.
cost offload scan: 0.08273124694824219
offload 1 adapters, 18 remains
cost offload cat: 0.031232833862304688
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.021457672119140625
cost offload a_loc update: 0.10275840759277344
Function offload_adapters took 0.5664825439453125 ms to run.
cost offload scan: 0.08535385131835938
offload 1 adapters, 17 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5633831024169922 ms to run.
cost offload scan: 0.08296966552734375
offload 1 adapters, 16 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10085105895996094
Function offload_adapters took 0.5550384521484375 ms to run.
current batch size: 18 token used ratio: 0.09852307692307692
cost load scan: 0.013113021850585938
load 1 adapters, 17 in total
Function load_lora_A took 6.07609748840332 ms to run.
Function load_lora_B took 6.035804748535156 ms to run.
cost realload: 12.510538101196289
Function load_adapters took 12.532234191894531 ms to run.
cost offload scan: 0.08988380432128906
offload 1 adapters, 16 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.102996826171875
Function offload_adapters took 0.568389892578125 ms to run.
INFO:     127.0.0.1:42146 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42156 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42162 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42176 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42180 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42182 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42196 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42212 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42226 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42228 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42234 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:42246 - "POST /generate_stream HTTP/1.1" 200 OK
cost offload scan: 0.087738037109375
offload 1 adapters, 15 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.5941390991210938 ms to run.
cost load scan: 0.013113021850585938
load 1 adapters, 16 in total
Function load_lora_A took 6.043434143066406 ms to run.
Function load_lora_B took 6.00123405456543 ms to run.
cost realload: 12.439250946044922
Function load_adapters took 12.46333122253418 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 15 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5614757537841797 ms to run.
cost load scan: 0.011444091796875
load 1 adapters, 16 in total
Function load_lora_A took 6.050825119018555 ms to run.
Function load_lora_B took 6.009817123413086 ms to run.
cost realload: 12.468338012695312
Function load_adapters took 12.491226196289062 ms to run.
cost offload scan: 0.08273124694824219
offload 1 adapters, 15 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.04792213439941406
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5719661712646484 ms to run.
cost offload scan: 0.08249282836914062
offload 1 adapters, 14 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.041484832763671875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5688667297363281 ms to run.
cost offload scan: 0.08392333984375
offload 1 adapters, 13 remains
cost offload cat: 0.030040740966796875
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10275840759277344
Function offload_adapters took 0.5578994750976562 ms to run.
current batch size: 15 token used ratio: 0.08386153846153846
cost load scan: 0.01239776611328125
load 1 adapters, 14 in total
Function load_lora_A took 6.077766418457031 ms to run.
Function load_lora_B took 6.049871444702148 ms to run.
cost realload: 12.527704238891602
Function load_adapters took 12.55178451538086 ms to run.
offload 0 adapters, 14 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.014066696166992188
load 1 adapters, 15 in total
Function load_lora_A took 6.055116653442383 ms to run.
Function load_lora_B took 6.027698516845703 ms to run.
cost realload: 12.468338012695312
Function load_adapters took 12.490510940551758 ms to run.
offload 0 adapters, 15 remains
Function offload_adapters took 0.012874603271484375 ms to run.
cost load scan: 0.008821487426757812
load 1 adapters, 16 in total
Function load_lora_A took 6.048679351806641 ms to run.
Function load_lora_B took 6.017923355102539 ms to run.
cost realload: 12.475013732910156
Function load_adapters took 12.497663497924805 ms to run.
cost offload scan: 0.1220703125
offload 2 adapters, 14 remains
cost offload cat: 0.026941299438476562
cost offload free mem manager: 0.0438690185546875
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10585784912109375
Function offload_adapters took 0.6079673767089844 ms to run.
cost offload scan: 0.08225440979003906
offload 1 adapters, 13 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.5681514739990234 ms to run.
current batch size: 13 token used ratio: 0.06869230769230769
cost offload scan: 0.08177757263183594
offload 1 adapters, 12 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10275840759277344
Function offload_adapters took 0.5617141723632812 ms to run.
cost load scan: 0.012159347534179688
load 1 adapters, 13 in total
Function load_lora_A took 6.050825119018555 ms to run.
Function load_lora_B took 6.019830703735352 ms to run.
cost realload: 12.46190071105957
Function load_adapters took 12.487173080444336 ms to run.
cost load scan: 0.015497207641601562
load 1 adapters, 14 in total
Function load_lora_A took 6.099224090576172 ms to run.
Function load_lora_B took 6.056547164916992 ms to run.
cost realload: 12.553930282592773
Function load_adapters took 12.575387954711914 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 13 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5645751953125 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 14 in total
Function load_lora_A took 6.015777587890625 ms to run.
Function load_lora_B took 6.000280380249023 ms to run.
cost realload: 12.404203414916992
Function load_adapters took 12.427806854248047 ms to run.
cost offload scan: 0.08153915405273438
offload 1 adapters, 13 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.021457672119140625
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.5686283111572266 ms to run.
cost offload scan: 0.08630752563476562
offload 1 adapters, 12 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04267692565917969
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10371208190917969
Function offload_adapters took 0.5650520324707031 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 13 in total
Function load_lora_A took 6.061792373657227 ms to run.
Function load_lora_B took 6.0291290283203125 ms to run.
cost realload: 12.465953826904297
Function load_adapters took 12.485980987548828 ms to run.
current batch size: 14 token used ratio: 0.06986153846153846
cost load scan: 0.008106231689453125
load 0 adapters, 13 in total
cost realload: 0.28634071350097656
Function load_adapters took 0.3101825714111328 ms to run.
cost load scan: 0.0133514404296875
load 1 adapters, 14 in total
Function load_lora_A took 6.085395812988281 ms to run.
Function load_lora_B took 6.03485107421875 ms to run.
cost realload: 12.516260147094727
Function load_adapters took 12.538433074951172 ms to run.
cost offload scan: 0.08440017700195312
offload 1 adapters, 13 remains
cost offload cat: 0.03457069396972656
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10752677917480469
Function offload_adapters took 0.5848407745361328 ms to run.
cost offload scan: 0.08082389831542969
offload 1 adapters, 12 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.04863739013671875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10132789611816406
Function offload_adapters took 0.5612373352050781 ms to run.
cost offload scan: 0.08273124694824219
offload 1 adapters, 11 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5655288696289062 ms to run.
current batch size: 14 token used ratio: 0.07158461538461539
cost offload scan: 0.08726119995117188
offload 1 adapters, 10 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.041484832763671875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10156631469726562
Function offload_adapters took 0.5633831024169922 ms to run.
Avg tokens(prompt+generate) throughput: 1500.617 tokens/s
Avg prompt tokens throughput:            704.845 tokens/s
Avg generate tokens throughput:          795.773 tokens/s
cost offload scan: 0.07891654968261719
INFO:     127.0.0.1:42258 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34480 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34496 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34504 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34512 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34528 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34544 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34548 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34558 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34568 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34572 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34580 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34596 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34598 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34606 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34616 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34620 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34626 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34636 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34646 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34654 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34668 - "POST /generate_stream HTTP/1.1" 200 OK
offload 1 adapters, 9 remains
cost offload cat: 0.03337860107421875
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5817413330078125 ms to run.
cost load scan: 0.014066696166992188
load 1 adapters, 10 in total
Function load_lora_A took 6.111621856689453 ms to run.
Function load_lora_B took 6.027936935424805 ms to run.
cost realload: 12.545108795166016
Function load_adapters took 12.567281723022461 ms to run.
cost offload scan: 0.08225440979003906
offload 1 adapters, 9 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.021457672119140625
cost offload a_loc update: 0.1049041748046875
Function offload_adapters took 0.55694580078125 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 9 in total
cost realload: 0.2956390380859375
Function load_adapters took 0.32067298889160156 ms to run.
current batch size: 13 token used ratio: 0.07424615384615385
cost offload scan: 0.08225440979003906
offload 1 adapters, 8 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.021696090698242188
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5593299865722656 ms to run.
cost load scan: 0.01621246337890625
load 2 adapters, 10 in total
Function load_lora_A took 6.07609748840332 ms to run.
Function load_lora_B took 6.044864654541016 ms to run.
Function load_lora_A took 6.081342697143555 ms to run.
Function load_lora_B took 6.045341491699219 ms to run.
cost realload: 24.703264236450195
Function load_adapters took 24.72400665283203 ms to run.
cost offload scan: 0.07891654968261719
offload 1 adapters, 9 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.041484832763671875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10204315185546875
Function offload_adapters took 0.5626678466796875 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 10 in total
Function load_lora_A took 6.06536865234375 ms to run.
Function load_lora_B took 6.024837493896484 ms to run.
cost realload: 12.465953826904297
Function load_adapters took 12.486457824707031 ms to run.
cost offload scan: 0.08273124694824219
offload 1 adapters, 9 remains
cost offload cat: 0.030755996704101562
cost offload free mem manager: 0.041484832763671875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10347366333007812
Function offload_adapters took 0.5543231964111328 ms to run.
cost load scan: 0.0073909759521484375
load 0 adapters, 9 in total
cost realload: 0.28133392333984375
Function load_adapters took 0.30541419982910156 ms to run.
offload 0 adapters, 9 remains
Function offload_adapters took 0.0133514404296875 ms to run.
cost offload scan: 0.08177757263183594
offload 1 adapters, 8 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.041484832763671875
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10418891906738281
Function offload_adapters took 0.5626678466796875 ms to run.
current batch size: 13 token used ratio: 0.06721538461538462
cost load scan: 0.00762939453125
load 0 adapters, 8 in total
cost realload: 0.28228759765625
Function load_adapters took 0.30684471130371094 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 9 in total
Function load_lora_A took 6.098747253417969 ms to run.
Function load_lora_B took 6.046772003173828 ms to run.
cost realload: 12.53199577331543
Function load_adapters took 12.554168701171875 ms to run.
offload 0 adapters, 9 remains
Function offload_adapters took 0.011920928955078125 ms to run.
offload 0 adapters, 9 remains
Function offload_adapters took 0.013828277587890625 ms to run.
offload 0 adapters, 9 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost offload scan: 0.08106231689453125
offload 1 adapters, 8 remains
cost offload cat: 0.030517578125
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.102996826171875
Function offload_adapters took 0.5600452423095703 ms to run.
cost load scan: 0.011920928955078125
load 1 adapters, 9 in total
Function load_lora_A took 6.129264831542969 ms to run.
Function load_lora_B took 6.047487258911133 ms to run.
cost realload: 12.586355209350586
Function load_adapters took 12.60828971862793 ms to run.
offload 0 adapters, 9 remains
Function offload_adapters took 0.012874603271484375 ms to run.
current batch size: 11 token used ratio: 0.05887692307692308
cost load scan: 0.00858306884765625
load 1 adapters, 10 in total
Function load_lora_A took 6.081342697143555 ms to run.
Function load_lora_B took 6.037473678588867 ms to run.
cost realload: 12.523174285888672
Function load_adapters took 12.54582405090332 ms to run.
cost offload scan: 0.08296966552734375
offload 1 adapters, 9 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1068115234375
Function offload_adapters took 0.5707740783691406 ms to run.
cost load scan: 0.00858306884765625
load 1 adapters, 10 in total
Function load_lora_A took 6.084918975830078 ms to run.
Function load_lora_B took 6.038427352905273 ms to run.
cost realload: 12.511253356933594
Function load_adapters took 12.532711029052734 ms to run.
cost load scan: 0.008106231689453125
load 1 adapters, 11 in total
Function load_lora_A took 6.047487258911133 ms to run.
Function load_lora_B took 6.032466888427734 ms to run.
cost realload: 12.485980987548828
Function load_adapters took 12.507915496826172 ms to run.
cost load scan: 0.00858306884765625
load 2 adapters, 13 in total
Function load_lora_A took 6.078481674194336 ms to run.
Function load_lora_B took 6.014823913574219 ms to run.
Function load_lora_A took 6.084680557250977 ms to run.
Function load_lora_B took 6.021261215209961 ms to run.
cost realload: 24.66607093811035
Function load_adapters took 24.6884822845459 ms to run.
current batch size: 15 token used ratio: 0.08103076923076923
cost load scan: 0.010013580322265625
load 2 adapters, 15 in total
Function load_lora_A took 6.091594696044922 ms to run.
Function load_lora_B took 6.037235260009766 ms to run.
Function load_lora_A took 6.053924560546875 ms to run.
Function load_lora_B took 6.001710891723633 ms to run.
cost realload: 24.656295776367188
Function load_adapters took 24.678468704223633 ms to run.
offload 0 adapters, 15 remains
Function offload_adapters took 0.013113021850585938 ms to run.
offload 0 adapters, 15 remains
Function offload_adapters took 0.011920928955078125 ms to run.
cost load scan: 0.008344650268554688
load 0 adapters, 15 in total
cost realload: 0.286102294921875
Function load_adapters took 0.3097057342529297 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 15 in total
cost realload: 0.28252601623535156
Function load_adapters took 0.3066062927246094 ms to run.
cost load scan: 0.009059906005859375
load 1 adapters, 16 in total
Function load_lora_A took 6.093263626098633 ms to run.
Function load_lora_B took 6.038904190063477 ms to run.
cost realload: 12.532949447631836
Function load_adapters took 12.555599212646484 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 15 remains
cost offload cat: 0.032901763916015625
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.5738735198974609 ms to run.
cost offload scan: 0.08916854858398438
offload 1 adapters, 14 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10561943054199219
Function offload_adapters took 0.5717277526855469 ms to run.
cost load scan: 0.0133514404296875
load 2 adapters, 16 in total
Function load_lora_A took 6.067991256713867 ms to run.
INFO:     127.0.0.1:34682 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34684 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34696 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34706 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34714 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34724 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34730 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34736 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34740 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34748 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34754 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34758 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34772 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34786 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34788 - "POST /generate_stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:34796 - "POST /generate_stream HTTP/1.1" 200 OK
Function load_lora_B took 6.0596466064453125 ms to run.
Function load_lora_A took 6.093025207519531 ms to run.
Function load_lora_B took 6.043195724487305 ms to run.
cost realload: 24.75571632385254
Function load_adapters took 24.776458740234375 ms to run.
cost offload scan: 0.0858306884765625
offload 1 adapters, 15 remains
cost offload cat: 0.03218650817871094
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10991096496582031
Function offload_adapters took 0.57220458984375 ms to run.
current batch size: 17 token used ratio: 0.07781538461538462
cost load scan: 0.0133514404296875
load 1 adapters, 16 in total
Function load_lora_A took 6.053447723388672 ms to run.
Function load_lora_B took 6.026983261108398 ms to run.
cost realload: 12.47406005859375
Function load_adapters took 12.494802474975586 ms to run.
cost offload scan: 0.087738037109375
offload 1 adapters, 15 remains
cost offload cat: 0.03409385681152344
cost offload free mem manager: 0.04291534423828125
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.10633468627929688
Function offload_adapters took 0.5800724029541016 ms to run.
cost load scan: 0.013589859008789062
load 3 adapters, 18 in total
Function load_lora_A took 6.054401397705078 ms to run.
Function load_lora_B took 6.038188934326172 ms to run.
Function load_lora_A took 6.058216094970703 ms to run.
Function load_lora_B took 6.024837493896484 ms to run.
Function load_lora_A took 6.055593490600586 ms to run.
Function load_lora_B took 6.050586700439453 ms to run.
cost realload: 36.81325912475586
Function load_adapters took 36.8344783782959 ms to run.
cost load scan: 0.012636184692382812
load 1 adapters, 19 in total
Function load_lora_A took 6.06989860534668 ms to run.
Function load_lora_B took 6.045341491699219 ms to run.
cost realload: 12.512922286987305
Function load_adapters took 12.534379959106445 ms to run.
cost offload scan: 0.08511543273925781
offload 1 adapters, 18 remains
cost offload cat: 0.035762786865234375
cost offload free mem manager: 0.041961669921875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.5829334259033203 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 18 in total
cost realload: 0.27108192443847656
Function load_adapters took 0.2951622009277344 ms to run.
current batch size: 22 token used ratio: 0.10755384615384615
offload 0 adapters, 18 remains
Function offload_adapters took 0.012159347534179688 ms to run.
cost load scan: 0.007867813110351562
load 0 adapters, 18 in total
cost realload: 0.2722740173339844
Function load_adapters took 0.2951622009277344 ms to run.
cost load scan: 0.012874603271484375
load 1 adapters, 19 in total
Function load_lora_A took 6.035804748535156 ms to run.
Function load_lora_B took 6.00433349609375 ms to run.
cost realload: 12.433528900146484
Function load_adapters took 12.455463409423828 ms to run.
cost load scan: 0.007867813110351562
load 1 adapters, 20 in total
Function load_lora_A took 6.078958511352539 ms to run.
Function load_lora_B took 6.03938102722168 ms to run.
cost realload: 12.508392333984375
Function load_adapters took 12.529373168945312 ms to run.
cost offload scan: 0.08702278137207031
offload 1 adapters, 19 remains
cost offload cat: 0.03647804260253906
cost offload free mem manager: 0.04482269287109375
cost offload torch.empty: 0.022649765014648438
cost offload a_loc update: 0.10514259338378906
Function offload_adapters took 0.5893707275390625 ms to run.
cost offload scan: 0.08487701416015625
offload 1 adapters, 18 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04124641418457031
cost offload torch.empty: 0.021219253540039062
cost offload a_loc update: 0.10395050048828125
Function offload_adapters took 0.5586147308349609 ms to run.
offload 0 adapters, 18 remains
Function offload_adapters took 0.011920928955078125 ms to run.
current batch size: 21 token used ratio: 0.11075384615384615
cost load scan: 0.01430511474609375
load 1 adapters, 19 in total
Function load_lora_A took 6.12950325012207 ms to run.
Function load_lora_B took 6.047964096069336 ms to run.
cost realload: 12.584924697875977
Function load_adapters took 12.606143951416016 ms to run.
offload 0 adapters, 19 remains
Function offload_adapters took 0.02002716064453125 ms to run.
cost offload scan: 0.09942054748535156
offload 1 adapters, 18 remains
cost offload cat: 0.031948089599609375
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.1125335693359375
Function offload_adapters took 0.5931854248046875 ms to run.
cost offload scan: 0.1277923583984375
offload 2 adapters, 16 remains
cost offload cat: 0.025987625122070312
cost offload free mem manager: 0.04315376281738281
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10657310485839844
Function offload_adapters took 0.6041526794433594 ms to run.
cost load scan: 0.010251998901367188
load 1 adapters, 17 in total
Function load_lora_A took 6.099224090576172 ms to run.
Function load_lora_B took 6.050586700439453 ms to run.
cost realload: 12.542247772216797
Function load_adapters took 12.565135955810547 ms to run.
cost offload scan: 0.0820159912109375
offload 1 adapters, 16 remains
cost offload cat: 0.034809112548828125
cost offload free mem manager: 0.04410743713378906
cost offload torch.empty: 0.02193450927734375
cost offload a_loc update: 0.10943412780761719
Function offload_adapters took 0.5822181701660156 ms to run.
cost offload scan: 0.08130073547363281
offload 1 adapters, 15 remains
cost offload cat: 0.030994415283203125
cost offload free mem manager: 0.041484832763671875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10609626770019531
Function offload_adapters took 0.5705356597900391 ms to run.
cost load scan: 0.011682510375976562
load 1 adapters, 16 in total
Function load_lora_A took 6.039857864379883 ms to run.
Function load_lora_B took 6.028652191162109 ms to run.
cost realload: 12.483596801757812
Function load_adapters took 12.506246566772461 ms to run.
current batch size: 18 token used ratio: 0.10390769230769231
cost offload scan: 0.08296966552734375
offload 1 adapters, 15 remains
cost offload cat: 0.035762786865234375
cost offload free mem manager: 0.04220008850097656
cost offload torch.empty: 0.02288818359375
cost offload a_loc update: 0.11014938354492188
Function offload_adapters took 0.5753040313720703 ms to run.
cost offload scan: 0.0820159912109375
offload 1 adapters, 14 remains
cost offload cat: 0.03147125244140625
cost offload free mem manager: 0.04887580871582031
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10466575622558594
Function offload_adapters took 0.5693435668945312 ms to run.
cost load scan: 0.00762939453125
load 0 adapters, 14 in total
cost realload: 0.28443336486816406
Function load_adapters took 0.30875205993652344 ms to run.
cost offload scan: 0.09131431579589844
offload 1 adapters, 13 remains
cost offload cat: 0.03314018249511719
cost offload free mem manager: 0.042438507080078125
cost offload torch.empty: 0.022411346435546875
cost offload a_loc update: 0.10323524475097656
Function offload_adapters took 0.5705356597900391 ms to run.
cost load scan: 0.008106231689453125
load 0 adapters, 13 in total
cost realload: 0.29087066650390625
Function load_adapters took 0.3151893615722656 ms to run.
cost offload scan: 0.08344650268554688
offload 1 adapters, 12 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.041484832763671875
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10204315185546875
Function offload_adapters took 0.5671977996826172 ms to run.
cost offload scan: 0.08058547973632812
offload 1 adapters, 11 remains
cost offload cat: 0.03170967102050781
cost offload free mem manager: 0.04172325134277344
cost offload torch.empty: 0.022172927856445312
cost offload a_loc update: 0.10180473327636719
Function offload_adapters took 0.5521774291992188 ms to run.
